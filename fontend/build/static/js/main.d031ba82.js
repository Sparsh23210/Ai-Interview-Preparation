/*! For license information please see main.d031ba82.js.LICENSE.txt */
(()=>{var t={14:t=>{t.exports=function(){return!1}},78:(t,e,n)=>{"use strict";var r=n(8366);t.exports=r([].slice)},89:(t,e,n)=>{"use strict";var r=n(2372);t.exports=r},138:(t,e,n)=>{var r=n(1137),a=n(358),i=n(4121),o=n(5309);t.exports=r?Object.defineProperties:function(t,e){i(t);for(var n,r=o(e),s=r.length,c=0;s>c;)a.f(t,n=r[c++],e[n]);return t}},153:(t,e,n)=>{"use strict";n(302)},228:(t,e,n)=>{"use strict";var r=n(3570),a=n(4071),i=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,s=a(i,"name"),c=s&&"something"===function(){}.name,l=s&&(!r||r&&o(i,"name").configurable);t.exports={EXISTS:s,PROPER:c,CONFIGURABLE:l}},302:(t,e,n)=>{"use strict";n(3005)("dispose")},307:(t,e,n)=>{"use strict";var r=n(5749),a=n(9607),i=n(1363),o=n(4482),s=Object;t.exports=o?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return a(e)&&i(e.prototype,s(t))}},329:(t,e,n)=>{var r=n(5655),a=n(3334).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,a)}},358:(t,e,n)=>{var r=n(1137),a=n(1178),i=n(4121),o=n(1452),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(i(t),e=o(e),i(n),a)try{return s(t,e,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},375:(t,e,n)=>{"use strict";var r=n(7886),a=Function.prototype,i=a.apply,o=a.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?o.bind(i):function(){return o.apply(i,arguments)})},385:(t,e,n)=>{t.exports=n(6809)},438:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,a=(r=n(9853))&&r.__esModule?r:{default:r},i=n(5043);var o=function(t){var e,n,r=(0,i.useRef)(null);return e=t,n=r.current,(0,a.default)(e,n)&&(r.current=t),r.current},s=function(t,e){(0,i.useEffect)(t,[o(e),t])};e.default=s},446:(t,e,n)=>{var r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,o=/^0o[0-7]+$/i,s=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,u=c||l||Function("return this")(),h=Object.prototype.toString,d=Math.max,f=Math.min,p=function(){return u.Date.now()};function m(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==h.call(t)}(t))return NaN;if(m(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=m(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(r,"");var n=i.test(t);return n||o.test(t)?s(t.slice(2),n?2:8):a.test(t)?NaN:+t}t.exports=function(t,e,n){var r,a,i,o,s,c,l=0,u=!1,h=!1,y=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function v(e){var n=r,i=a;return r=a=void 0,l=e,o=t.apply(i,n)}function b(t){var n=t-c;return void 0===c||n>=e||n<0||h&&t-l>=i}function w(){var t=p();if(b(t))return x(t);s=setTimeout(w,function(t){var n=e-(t-c);return h?f(n,i-(t-l)):n}(t))}function x(t){return s=void 0,y&&r?v(t):(r=a=void 0,o)}function k(){var t=p(),n=b(t);if(r=arguments,a=this,c=t,n){if(void 0===s)return function(t){return l=t,s=setTimeout(w,e),u?v(t):o}(c);if(h)return s=setTimeout(w,e),v(c)}return void 0===s&&(s=setTimeout(w,e)),o}return e=g(e)||0,m(n)&&(u=!!n.leading,i=(h="maxWait"in n)?d(g(n.maxWait)||0,e):i,y="trailing"in n?!!n.trailing:y),k.cancel=function(){void 0!==s&&clearTimeout(s),l=0,r=c=a=s=void 0},k.flush=function(){return void 0===s?o:x(p())},k}},455:(t,e,n)=>{"use strict";var r=n(7592);t.exports=r},468:(t,e,n)=>{"use strict";var r=n(7800),a=n(5231),i=n(8420),o=n(4721),s=n(5612),c=n(1773),l=n(8967),u=n(7403),h=n(4794),d=n(1816),f=n(1903)("splice"),p=Math.max,m=Math.min;r({target:"Array",proto:!0,forced:!f},{splice:function(t,e){var n,r,f,g,y,v,b=a(this),w=s(b),x=i(t,w),k=arguments.length;for(0===k?n=r=0:1===k?(n=0,r=w-x):(n=k-2,r=m(p(o(e),0),w-x)),l(w+n-r),f=u(b,r),g=0;g<r;g++)(y=x+g)in b&&h(f,g,b[y]);if(f.length=r,n<r){for(g=x;g<w-r;g++)v=g+n,(y=g+r)in b?b[v]=b[y]:d(b,v);for(g=w;g>w-r+n;g--)d(b,g-1)}else if(n>r)for(g=w-r;g>x;g--)v=g+n-1,(y=g+r-1)in b?b[v]=b[y]:d(b,v);for(g=0;g<n;g++)b[g+x]=arguments[g+2];return c(b,w-r+n),f}})},473:(t,e,n)=>{"use strict";var r=n(4606),a=n(607).f,i=n(9825),o=n(4071),s=n(6337),c=n(4205)("toStringTag");t.exports=function(t,e,n,l){var u=n?t:t&&t.prototype;u&&(o(u,c)||a(u,c,{configurable:!0,value:e}),l&&!r&&i(u,"toString",s))}},494:(t,e,n)=>{var r=n(8496),a={}.hasOwnProperty;t.exports=Object.hasOwn||function(t,e){return a.call(r(t),e)}},504:(t,e,n)=>{"use strict";var r=n(9637);t.exports=r},551:()=>{},572:(t,e,n)=>{"use strict";var r=n(1105),a=n(1218);r({target:"RegExp",proto:!0,forced:/./.exec!==a},{exec:a})},579:(t,e,n)=>{"use strict";t.exports=n(1153)},607:(t,e,n)=>{"use strict";var r=n(3570),a=n(8331),i=n(1964),o=n(6929),s=n(5099),c=TypeError,l=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",f="writable";e.f=r?i?function(t,e,n){if(o(t),e=s(e),o(n),"function"===typeof t&&"prototype"===e&&"value"in n&&f in n&&!n[f]){var r=u(t,e);r&&r[f]&&(t[e]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:h in n?n[h]:r[h],writable:!1})}return l(t,e,n)}:l:function(t,e,n){if(o(t),e=s(e),o(n),a)try{return l(t,e,n)}catch(r){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},624:(t,e,n)=>{"use strict";var r=n(7800),a=n(1034);r({target:"Array",stat:!0,forced:!n(4382)(function(t){Array.from(t)})},{from:a})},629:t=>{var e=0,n=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++e+n).toString(36)}},697:(t,e,n)=>{t.exports=n(3086)},705:t=>{t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},766:(t,e,n)=>{"use strict";var r=n(3943);n(5403),t.exports=r},793:t=>{t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},819:t=>{"use strict";var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?n:e)(r)}},844:(t,e,n)=>{"use strict";var r=n(8445);t.exports=function(t,e){var n=[][t];return!!n&&r(function(){n.call(null,e||function(){return 1},1)})}},855:(t,e,n)=>{"use strict";n(3005)("asyncDispose")},875:(t,e,n)=>{"use strict";var r=n(8472);t.exports=r},877:(t,e,n)=>{"use strict";var r=n(3239).forEach,a=n(844)("forEach");t.exports=a?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},899:(t,e,n)=>{var r=n(6680);t.exports=function(t){return"object"===typeof t?null!==t:r(t)}},974:(t,e,n)=>{"use strict";var r=n(1363),a=n(3258),i=Array.prototype;t.exports=function(t){var e=t.push;return t===i||r(i,t)&&e===i.push?a:e}},1034:(t,e,n)=>{"use strict";var r=n(1566),a=n(2203),i=n(5231),o=n(2217),s=n(6015),c=n(1187),l=n(5612),u=n(4794),h=n(2771),d=n(6586),f=Array;t.exports=function(t){var e=i(t),n=c(this),p=arguments.length,m=p>1?arguments[1]:void 0,g=void 0!==m;g&&(m=r(m,p>2?arguments[2]:void 0));var y,v,b,w,x,k,_=d(e),S=0;if(!_||this===f&&s(_))for(y=l(e),v=n?new this(y):f(y);y>S;S++)k=g?m(e[S],S):e[S],u(v,S,k);else for(v=n?new this:[],x=(w=h(e,_)).next;!(b=a(x,w)).done;S++)k=g?o(w,m,[b.value,S],!0):b.value,u(v,S,k);return v.length=S,v}},1099:(t,e,n)=>{"use strict";var r=n(4702),a=Object.defineProperty;t.exports=function(t,e){try{a(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},1105:(t,e,n)=>{var r=n(1500),a=n(2820).f,i=n(2540),o=n(5345),s=n(4419),c=n(5901),l=n(5125);t.exports=function(t,e){var n,u,h,d,f,p=t.target,m=t.global,g=t.stat;if(n=m?r:g?r[p]||s(p,{}):(r[p]||{}).prototype)for(u in e){if(d=e[u],h=t.noTargetGet?(f=a(n,u))&&f.value:n[u],!l(m?u:p+(g?".":"#")+u,t.forced)&&void 0!==h){if(typeof d===typeof h)continue;c(d,h)}(t.sham||h&&h.sham)&&i(d,"sham",!0),o(n,u,d,t)}}},1126:(t,e,n)=>{var r=n(8466),a=n(8210);(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.18.3",mode:r?"pure":"global",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})},1137:(t,e,n)=>{var r=n(9846);t.exports=!r(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},1143:(t,e,n)=>{var r=n(3028)(Object.keys,Object);t.exports=r},1153:(t,e,n)=>{"use strict";var r=n(5043),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(t,e,n){var r,i={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==e.key&&(l=""+e.key),void 0!==e.ref&&(u=e.ref),e)o.call(e,r)&&!c.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===i[r]&&(i[r]=e[r]);return{$$typeof:a,type:t,key:l,ref:u,props:i,_owner:s.current}}e.Fragment=i,e.jsx=l,e.jsxs=l},1178:(t,e,n)=>{var r=n(1137),a=n(9846),i=n(8738);t.exports=!r&&!a(function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a})},1187:(t,e,n)=>{"use strict";var r=n(8366),a=n(8445),i=n(9607),o=n(8061),s=n(5749),c=n(9880),l=function(){},u=s("Reflect","construct"),h=/^\s*(?:class|function)\b/,d=r(h.exec),f=!h.test(l),p=function(t){if(!i(t))return!1;try{return u(l,[],t),!0}catch(e){return!1}},m=function(t){if(!i(t))return!1;switch(o(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!d(h,c(t))}catch(e){return!0}};m.sham=!0,t.exports=!u||a(function(){var t;return p(p.call)||!p(Object)||!p(function(){t=!0})||t})?m:p},1192:(t,e,n)=>{"use strict";var r=n(8083),a=String,i=TypeError;t.exports=function(t){if(r(t))return t;throw new i("Can't set "+a(t)+" as a prototype")}},1218:(t,e,n)=>{"use strict";var r=n(2174),a=n(8280),i=n(4023),o=n(1126),s=n(9845),c=n(5650).get,l=n(5184),u=n(9757),h=RegExp.prototype.exec,d=o("native-string-replace",String.prototype.replace),f=h,p=function(){var t=/a/,e=/b*/g;return h.call(t,"a"),h.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),m=i.UNSUPPORTED_Y||i.BROKEN_CARET,g=void 0!==/()??/.exec("")[1];(p||g||m||l||u)&&(f=function(t){var e,n,i,o,l,u,y,v=this,b=c(v),w=r(t),x=b.raw;if(x)return x.lastIndex=v.lastIndex,e=f.call(x,w),v.lastIndex=x.lastIndex,e;var k=b.groups,_=m&&v.sticky,S=a.call(v),T=v.source,I=0,E=w;if(_&&(-1===(S=S.replace("y","")).indexOf("g")&&(S+="g"),E=w.slice(v.lastIndex),v.lastIndex>0&&(!v.multiline||v.multiline&&"\n"!==w.charAt(v.lastIndex-1))&&(T="(?: "+T+")",E=" "+E,I++),n=new RegExp("^(?:"+T+")",S)),g&&(n=new RegExp("^"+T+"$(?!\\s)",S)),p&&(i=v.lastIndex),o=h.call(_?n:v,E),_?o?(o.input=o.input.slice(I),o[0]=o[0].slice(I),o.index=v.lastIndex,v.lastIndex+=o[0].length):v.lastIndex=0:p&&o&&(v.lastIndex=v.global?o.index+o[0].length:i),g&&o&&o.length>1&&d.call(o[0],n,function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(o[l]=void 0)}),o&&k)for(o.groups=u=s(null),l=0;l<k.length;l++)u[(y=k[l])[0]]=o[y[1]];return o}),t.exports=f},1234:()=>{},1249:()=>{},1268:(t,e,n)=>{var r=n(5428),a=n(7574),i=n(6832),o=i&&i.isTypedArray,s=o?a(o):r;t.exports=s},1306:()=>{},1334:(t,e,n)=>{var r=n(1755);t.exports=r("document","documentElement")},1338:(t,e,n)=>{"use strict";var r=n(1363),a=n(5510),i=Array.prototype;t.exports=function(t){var e=t.slice;return t===i||r(i,t)&&e===i.slice?a:e}},1340:(t,e,n)=>{var r=n(3211);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},1348:(t,e,n)=>{"use strict";var r=n(7555),a=n(8420),i=n(5612),o=function(t){return function(e,n,o){var s=r(e),c=i(s);if(0===c)return!t&&-1;var l,u=a(o,c);if(t&&n!==n){for(;c>u;)if((l=s[u++])!==l)return!0}else for(;c>u;u++)if((t||u in s)&&s[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},1353:(t,e,n)=>{"use strict";n(3005)("metadataKey")},1363:(t,e,n)=>{"use strict";var r=n(8366);t.exports=r({}.isPrototypeOf)},1393:(t,e,n)=>{t.exports=n(9721)},1416:(t,e,n)=>{"use strict";var r=n(4721),a=Math.min;t.exports=function(t){var e=r(t);return e>0?a(e,9007199254740991):0}},1426:(t,e,n)=>{"use strict";var r=n(7800),a=n(4071),i=n(307),o=n(6381),s=n(9203),c=n(2398),l=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{keyFor:function(t){if(!i(t))throw new TypeError(o(t)+" is not a symbol");if(a(l,t))return l[t]}})},1437:t=>{var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},1446:(t,e,n)=>{"use strict";var r=n(7555),a=n(6107),i=n(6891),o=n(1543),s=n(607).f,c=n(3234),l=n(8843),u=n(2545),h=n(3570),d="Array Iterator",f=o.set,p=o.getterFor(d);t.exports=c(Array,"Array",function(t,e){f(this,{type:d,target:r(t),index:0,kind:e})},function(){var t=p(this),e=t.target,n=t.index++;if(!e||n>=e.length)return t.target=null,l(void 0,!0);switch(t.kind){case"keys":return l(n,!1);case"values":return l(e[n],!1)}return l([n,e[n]],!1)},"values");var m=i.Arguments=i.Array;if(a("keys"),a("values"),a("entries"),!u&&h&&"values"!==m.name)try{s(m,"name",{value:"values"})}catch(g){}},1452:(t,e,n)=>{var r=n(6502),a=n(8116);t.exports=function(t){var e=r(t,"string");return a(e)?e:String(e)}},1497:(t,e,n)=>{"use strict";var r=n(3218);function a(){}function i(){}i.resetWarningCache=a,t.exports=function(){function t(t,e,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},1500:(t,e,n)=>{var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},1543:(t,e,n)=>{"use strict";var r,a,i,o=n(3816),s=n(4702),c=n(5900),l=n(9825),u=n(4071),h=n(8531),d=n(6045),f=n(6663),p="Object already initialized",m=s.TypeError,g=s.WeakMap;if(o||h.state){var y=h.state||(h.state=new g);y.get=y.get,y.has=y.has,y.set=y.set,r=function(t,e){if(y.has(t))throw new m(p);return e.facade=t,y.set(t,e),e},a=function(t){return y.get(t)||{}},i=function(t){return y.has(t)}}else{var v=d("state");f[v]=!0,r=function(t,e){if(u(t,v))throw new m(p);return e.facade=t,l(t,v,e),e},a=function(t){return u(t,v)?t[v]:{}},i=function(t){return u(t,v)}}t.exports={set:r,get:a,has:i,enforce:function(t){return i(t)?a(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=a(e)).type!==t)throw new m("Incompatible receiver, "+t+" required");return n}}}},1566:(t,e,n)=>{"use strict";var r=n(4774),a=n(4508),i=n(7886),o=r(r.bind);t.exports=function(t,e){return a(t),void 0===e?t:i?o(t,e):function(){return t.apply(e,arguments)}}},1629:(t,e,n)=>{var r=n(6913),a=n(6686);t.exports=function(t){if(!a(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},1663:(t,e,n)=>{var r=n(3148),a=Math.min;t.exports=function(t){return t>0?a(r(t),9007199254740991):0}},1691:(t,e,n)=>{t.exports=n(7939)},1700:(t,e,n)=>{"use strict";n(3005)("unscopables")},1714:(t,e,n)=>{var r=n(1340);t.exports=function(t,e){var n=this.__data__,a=r(n,t);return a<0?(++this.size,n.push([t,e])):n[a][1]=e,this}},1731:(t,e,n)=>{"use strict";var r=n(3570),a=n(1964),i=n(607),o=n(6929),s=n(7555),c=n(3734);e.f=r&&!a?Object.defineProperties:function(t,e){o(t);for(var n,r=s(e),a=c(e),l=a.length,u=0;l>u;)i.f(t,n=a[u++],r[n]);return t}},1755:(t,e,n)=>{var r=n(1500),a=n(6680);t.exports=function(t,e){return arguments.length<2?(n=r[t],a(n)?n:void 0):r[t]&&r[t][e];var n}},1760:(t,e,n)=>{"use strict";n(6162);var r=n(8118);t.exports=r("Array","filter")},1762:(t,e,n)=>{"use strict";n(8869),n(2193)},1773:(t,e,n)=>{"use strict";var r=n(3570),a=n(5334),i=TypeError,o=Object.getOwnPropertyDescriptor,s=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=s?function(t,e){if(a(t)&&!o(t,"length").writable)throw new i("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},1786:(t,e,n)=>{"use strict";n(6756);var r=n(8118);t.exports=r("Array","concat")},1811:(t,e,n)=>{"use strict";n(3005)("split")},1816:(t,e,n)=>{"use strict";var r=n(6381),a=TypeError;t.exports=function(t,e){if(!delete t[e])throw new a("Cannot delete property "+r(e)+" of "+r(t))}},1839:(t,e,n)=>{"use strict";var r=n(6209);t.exports=r},1844:(t,e,n)=>{"use strict";n(9746);var r=n(8118);t.exports=r("Array","indexOf")},1898:(t,e,n)=>{"use strict";var r=n(8061),a=n(4071),i=n(1363),o=n(5232);n(1306);var s=Array.prototype,c={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var e=t.forEach;return t===s||i(s,t)&&e===s.forEach||a(c,r(t))?o:e}},1903:(t,e,n)=>{"use strict";var r=n(8445),a=n(4205),i=n(5145),o=a("species");t.exports=function(t){return i>=51||!r(function(){var e=[];return(e.constructor={})[o]=function(){return{foo:1}},1!==e[t](Boolean).foo})}},1925:(t,e,n)=>{"use strict";var r=n(4702),a=n(5900),i=r.document,o=a(i)&&a(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},1946:(t,e,n)=>{var r=n(1340);t.exports=function(t){return r(this.__data__,t)>-1}},1964:(t,e,n)=>{"use strict";var r=n(3570),a=n(8445);t.exports=r&&a(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},2013:(t,e,n)=>{"use strict";var r=n(3756);t.exports=r},2038:(t,e,n)=>{"use strict";var r=n(2221);t.exports=r},2070:(t,e,n)=>{var r=n(7937)(n(6552),"Set");t.exports=r},2074:t=>{t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},2133:(t,e,n)=>{var r=n(7253);t.exports=function(t,e){var n=t[e];return null==n?void 0:r(n)}},2154:(t,e,n)=>{var r=n(5575),a=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return a.call(e,t)?e[t]:void 0}},2174:(t,e,n)=>{var r=n(4666);t.exports=function(t){if("Symbol"===r(t))throw TypeError("Cannot convert a Symbol value to a string");return String(t)}},2193:(t,e,n)=>{"use strict";var r=n(7800),a=n(4702),i=n(4102)(a.setTimeout,!0);r({global:!0,bind:!0,forced:a.setTimeout!==i},{setTimeout:i})},2202:(t,e,n)=>{"use strict";var r=n(8366),a=r({}.toString),i=r("".slice);t.exports=function(t){return i(a(t),8,-1)}},2203:(t,e,n)=>{"use strict";var r=n(7886),a=Function.prototype.call;t.exports=r?a.bind(a):function(){return a.apply(a,arguments)}},2217:(t,e,n)=>{"use strict";var r=n(6929),a=n(4941);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(o){a(t,"throw",o)}}},2221:(t,e,n)=>{"use strict";var r=n(4468);t.exports=r},2224:(t,e,n)=>{"use strict";var r=n(7800),a=n(5749),i=n(4071),o=n(8777),s=n(9203),c=n(2398),l=s("string-to-symbol-registry"),u=s("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!c},{for:function(t){var e=o(t);if(i(l,e))return l[e];var n=a("Symbol")(e);return l[e]=n,u[n]=e,n}})},2306:(t,e,n)=>{"use strict";var r=n(2625);function a(){}function i(){}i.resetWarningCache=a,t.exports=function(){function t(t,e,n,a,i,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:i,resetWarningCache:a};return n.PropTypes=n,n}},2315:(t,e,n)=>{"use strict";n(3005)("replace")},2320:(t,e,n)=>{"use strict";n(3005)("matchAll")},2324:(t,e,n)=>{var r=n(1755),a=n(329),i=n(8232),o=n(4121);t.exports=r("Reflect","ownKeys")||function(t){var e=a.f(o(t)),n=i.f;return n?e.concat(n(t)):e}},2372:(t,e,n)=>{"use strict";var r=n(4095);t.exports=r},2377:(t,e,n)=>{var r,a,i=n(1500),o=n(5177),s=i.process,c=i.Deno,l=s&&s.versions||c&&c.version,u=l&&l.v8;u?a=(r=u.split("."))[0]<4?1:r[0]+r[1]:o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(a=r[1]),t.exports=a&&+a},2398:(t,e,n)=>{"use strict";var r=n(6521);t.exports=r&&!!Symbol.for&&!!Symbol.keyFor},2400:(t,e,n)=>{"use strict";var r=n(7800),a=n(3570),i=n(9085),o=n(7555),s=n(7965),c=n(4794);r({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(t){for(var e,n,r=o(t),a=s.f,l=i(r),u={},h=0;l.length>h;)void 0!==(n=a(r,e=l[h++]))&&c(u,e,n);return u}})},2405:(t,e,n)=>{var r=n(2377),a=n(9846);t.exports=!!Object.getOwnPropertySymbols&&!a(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41})},2430:function(t,e,n){var r;!function(a,i,o){var s,c=256,l=o.pow(c,6),u=o.pow(2,52),h=2*u,d=255;function f(t,e,n){var r=[],d=y(g((e=1==e?{entropy:!0}:e||{}).entropy?[t,v(i)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(c):(t=new Uint8Array(c),(a.crypto||a.msCrypto).getRandomValues(t)),v(t)}catch(r){var e=a.navigator,n=e&&e.plugins;return[+new Date,a,n,a.screen,v(i)]}}():t,3),r),f=new p(r),b=function(){for(var t=f.g(6),e=l,n=0;t<u;)t=(t+n)*c,e*=c,n=f.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return b.int32=function(){return 0|f.g(4)},b.quick=function(){return f.g(4)/4294967296},b.double=b,y(v(f.S),i),(e.pass||n||function(t,e,n,r){return r&&(r.S&&m(r,f),t.state=function(){return m(f,{})}),n?(o.random=t,e):t})(b,d,"global"in e?e.global:this==o,e.state)}function p(t){var e,n=t.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(t=[n++]);a<c;)o[a]=a++;for(a=0;a<c;a++)o[a]=o[i=d&i+t[a%n]+(e=o[a])],o[i]=e;(r.g=function(t){for(var e,n=0,a=r.i,i=r.j,o=r.S;t--;)e=o[a=d&a+1],n=n*c+o[d&(o[a]=o[i=d&i+e])+(o[i]=e)];return r.i=a,r.j=i,n})(c)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){var n,r=[],a=typeof t;if(e&&"object"==a)for(n in t)try{r.push(g(t[n],e-1))}catch(i){}return r.length?r:"string"==a?t:t+"\0"}function y(t,e){for(var n,r=t+"",a=0;a<r.length;)e[d&a]=d&(n^=19*e[d&a])+r.charCodeAt(a++);return v(e)}function v(t){return String.fromCharCode.apply(0,t)}if(y(o.random(),i),t.exports){t.exports=f;try{s=n(1234)}catch(b){}}else void 0===(r=function(){return f}.call(e,n,e,t))||(t.exports=r)}("undefined"!==typeof self?self:this,[],Math)},2531:(t,e,n)=>{"use strict";var r=n(5749),a=n(3005),i=n(473);a("toStringTag"),i(r("Symbol"),"Symbol")},2540:(t,e,n)=>{var r=n(1137),a=n(358),i=n(7823);t.exports=r?function(t,e,n){return a.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},2545:t=>{"use strict";t.exports=!0},2582:t=>{"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},2587:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},2622:(t,e,n)=>{var r=n(705);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},2625:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},2662:(t,e,n)=>{var r=n(5575);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},2668:t=>{var e="undefined"!==typeof window?window:self;t.exports=e.crypto||e.msCrypto},2721:t=>{"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2727:(t,e,n)=>{"use strict";n(6599);var r=n(5313);t.exports=r.Date.now},2730:(t,e,n)=>{"use strict";var r=n(5043),a=n(8853);function i(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function c(t,e){l(t,e),l(t+"Capture",e)}function l(t,e){for(s[t]=e,t=0;t<e.length;t++)o.add(e[t])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(t,e,n,r,a,i,o){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){g[t]=new m(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];g[e]=new m(e,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){g[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){g[t]=new m(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){g[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){g[t]=new m(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){g[t]=new m(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){g[t]=new m(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){g[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(t){return t[1].toUpperCase()}function b(t,e,n,r){var a=g.hasOwnProperty(e)?g[e]:null;(null!==a?0!==a.type:r||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,r){if(null===e||"undefined"===typeof e||function(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,a,r)&&(n=null),r||null===a?function(t){return!!h.call(p,t)||!h.call(f,t)&&(d.test(t)?p[t]=!0:(f[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=null===n?3!==a.type&&"":n:(e=a.attributeName,r=a.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(y,v);g[e]=new m(e,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(y,v);g[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(y,v);g[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){g[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)});var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),k=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),E=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function F(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=M&&t[M]||t["@@iterator"])?t:null}var P,L=Object.assign;function z(t){if(void 0===P)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);P=e&&e[1]||""}return"\n"+P+t}var B=!1;function j(t,e){if(!t||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&"string"===typeof l.stack){for(var a=l.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var c="\n"+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}}while(1<=o&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?z(t):""}function U(t){switch(t.tag){case 5:return z(t.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return t=j(t.type,!1);case 11:return t=j(t.type.render,!1);case 1:return t=j(t.type,!0);default:return""}}function V(t){if(null==t)return null;if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case _:return"Fragment";case k:return"Portal";case T:return"Profiler";case S:return"StrictMode";case C:return"Suspense";case A:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case E:return(t.displayName||"Context")+".Consumer";case I:return(t._context.displayName||"Context")+".Provider";case N:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case R:return null!==(e=t.displayName||null)?e:V(t.type)||"Memo";case O:e=t._payload,t=t._init;try{return V(t(e))}catch(n){}}return null}function W(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(e);case 8:return e===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e}return null}function G(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function H(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function q(t){t._valueTracker||(t._valueTracker=function(t){var e=H(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(t){r=""+t,i.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function K(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=H(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function X(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Y(t,e){var n=e.checked;return L({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function Q(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=G(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function J(t,e){null!=(e=e.checked)&&b(t,"checked",e,!1)}function $(t,e){J(t,e);var n=G(e.value),r=e.type;if(null!=n)"number"===r?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===r||"reset"===r)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,G(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function Z(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!("submit"!==r&&"reset"!==r||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&X(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,r){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+G(n),e=null,a=0;a<t.length;a++){if(t[a].value===n)return t[a].selected=!0,void(r&&(t[a].defaultSelected=!0));null!==e||t[a].disabled||(e=t[a])}null!==e&&(e.selected=!0)}}function rt(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(i(91));return L({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function at(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(i(92));if(et(n)){if(1<n.length)throw Error(i(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:G(n)}}function it(t,e){var n=G(e.value),r=G(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=r&&(t.defaultValue=""+r)}function ot(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function st(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ct(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?st(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var lt,ut,ht=(ut=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((lt=lt||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=lt.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,r){MSApp.execUnsafeLocalFunction(function(){return ut(t,e)})}:ut);function dt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pt=["Webkit","ms","Moz","O"];function mt(t,e,n){return null==e||"boolean"===typeof e||""===e?"":n||"number"!==typeof e||0===e||ft.hasOwnProperty(t)&&ft[t]?(""+e).trim():e+"px"}function gt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=mt(n,e[n],r);"float"===n&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}Object.keys(ft).forEach(function(t){pt.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ft[e]=ft[t]})});var yt=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vt(t,e){if(e){if(yt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(i(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(i(60));if("object"!==typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=e.style&&"object"!==typeof e.style)throw Error(i(62))}}function bt(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wt=null;function xt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var kt=null,_t=null,St=null;function Tt(t){if(t=ba(t)){if("function"!==typeof kt)throw Error(i(280));var e=t.stateNode;e&&(e=xa(e),kt(t.stateNode,t.type,e))}}function It(t){_t?St?St.push(t):St=[t]:_t=t}function Et(){if(_t){var t=_t,e=St;if(St=_t=null,Tt(t),e)for(t=0;t<e.length;t++)Tt(e[t])}}function Nt(t,e){return t(e)}function Ct(){}var At=!1;function Rt(t,e,n){if(At)return t(e,n);At=!0;try{return Nt(t,e,n)}finally{At=!1,(null!==_t||null!==St)&&(Ct(),Et())}}function Ot(t,e){var n=t.stateNode;if(null===n)return null;var r=xa(n);if(null===r)return null;n=r[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!r;break t;default:t=!1}if(t)return null;if(n&&"function"!==typeof n)throw Error(i(231,e,typeof n));return n}var Dt=!1;if(u)try{var Mt={};Object.defineProperty(Mt,"passive",{get:function(){Dt=!0}}),window.addEventListener("test",Mt,Mt),window.removeEventListener("test",Mt,Mt)}catch(ut){Dt=!1}function Ft(t,e,n,r,a,i,o,s,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(u){this.onError(u)}}var Pt=!1,Lt=null,zt=!1,Bt=null,jt={onError:function(t){Pt=!0,Lt=t}};function Ut(t,e,n,r,a,i,o,s,c){Pt=!1,Lt=null,Ft.apply(jt,arguments)}function Vt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Wt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function Gt(t){if(Vt(t)!==t)throw Error(i(188))}function Ht(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Vt(t)))throw Error(i(188));return e!==t?null:t}for(var n=t,r=e;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Gt(a),t;if(o===r)return Gt(a),e;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,c=a.child;c;){if(c===n){s=!0,n=a,r=o;break}if(c===r){s=!0,r=a,n=o;break}c=c.sibling}if(!s){for(c=o.child;c;){if(c===n){s=!0,n=o,r=a;break}if(c===r){s=!0,r=o,n=a;break}c=c.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?t:e}(t))?qt(t):null}function qt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=qt(t);if(null!==e)return e;t=t.sibling}return null}var Kt=a.unstable_scheduleCallback,Xt=a.unstable_cancelCallback,Yt=a.unstable_shouldYield,Qt=a.unstable_requestPaint,Jt=a.unstable_now,$t=a.unstable_getCurrentPriorityLevel,Zt=a.unstable_ImmediatePriority,te=a.unstable_UserBlockingPriority,ee=a.unstable_NormalPriority,ne=a.unstable_LowPriority,re=a.unstable_IdlePriority,ae=null,ie=null;var oe=Math.clz32?Math.clz32:function(t){return t>>>=0,0===t?32:31-(se(t)/ce|0)|0},se=Math.log,ce=Math.LN2;var le=64,ue=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function de(t,e){var n=t.pendingLanes;if(0===n)return 0;var r=0,a=t.suspendedLanes,i=t.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=he(s):0!==(i&=o)&&(r=he(i))}else 0!==(o=n&~a)?r=he(o):0!==i&&(r=he(i));if(0===r)return 0;if(0!==e&&e!==r&&0===(e&a)&&((a=r&-r)>=(i=e&-e)||16===a&&0!==(4194240&i)))return e;if(0!==(4&r)&&(r|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=r;0<e;)a=1<<(n=31-oe(e)),r|=t[n],e&=~a;return r}function fe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function pe(t){return 0!==(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function me(){var t=le;return 0===(4194240&(le<<=1))&&(le=64),t}function ge(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ye(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-oe(e)]=n}function ve(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-oe(n),a=1<<r;a&e|t[r]&e&&(t[r]|=e),n&=~a}}var be=0;function we(t){return 1<(t&=-t)?4<t?0!==(268435455&t)?16:536870912:4:1}var xe,ke,_e,Se,Te,Ie=!1,Ee=[],Ne=null,Ce=null,Ae=null,Re=new Map,Oe=new Map,De=[],Me="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fe(t,e){switch(t){case"focusin":case"focusout":Ne=null;break;case"dragenter":case"dragleave":Ce=null;break;case"mouseover":case"mouseout":Ae=null;break;case"pointerover":case"pointerout":Re.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oe.delete(e.pointerId)}}function Pe(t,e,n,r,a,i){return null===t||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==e&&(null!==(e=ba(e))&&ke(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,null!==a&&-1===e.indexOf(a)&&e.push(a),t)}function Le(t){var e=va(t.target);if(null!==e){var n=Vt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Wt(n)))return t.blockedOn=e,void Te(t.priority,function(){_e(n)})}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function ze(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ye(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=ba(n))&&ke(e),t.blockedOn=n,!1;var r=new(n=t.nativeEvent).constructor(n.type,n);wt=r,n.target.dispatchEvent(r),wt=null,e.shift()}return!0}function Be(t,e,n){ze(t)&&n.delete(e)}function je(){Ie=!1,null!==Ne&&ze(Ne)&&(Ne=null),null!==Ce&&ze(Ce)&&(Ce=null),null!==Ae&&ze(Ae)&&(Ae=null),Re.forEach(Be),Oe.forEach(Be)}function Ue(t,e){t.blockedOn===e&&(t.blockedOn=null,Ie||(Ie=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,je)))}function Ve(t){function e(e){return Ue(e,t)}if(0<Ee.length){Ue(Ee[0],t);for(var n=1;n<Ee.length;n++){var r=Ee[n];r.blockedOn===t&&(r.blockedOn=null)}}for(null!==Ne&&Ue(Ne,t),null!==Ce&&Ue(Ce,t),null!==Ae&&Ue(Ae,t),Re.forEach(e),Oe.forEach(e),n=0;n<De.length;n++)(r=De[n]).blockedOn===t&&(r.blockedOn=null);for(;0<De.length&&null===(n=De[0]).blockedOn;)Le(n),null===n.blockedOn&&De.shift()}var We=w.ReactCurrentBatchConfig,Ge=!0;function He(t,e,n,r){var a=be,i=We.transition;We.transition=null;try{be=1,Ke(t,e,n,r)}finally{be=a,We.transition=i}}function qe(t,e,n,r){var a=be,i=We.transition;We.transition=null;try{be=4,Ke(t,e,n,r)}finally{be=a,We.transition=i}}function Ke(t,e,n,r){if(Ge){var a=Ye(t,e,n,r);if(null===a)Gr(t,e,r,Xe,n),Fe(t,r);else if(function(t,e,n,r,a){switch(e){case"focusin":return Ne=Pe(Ne,t,e,n,r,a),!0;case"dragenter":return Ce=Pe(Ce,t,e,n,r,a),!0;case"mouseover":return Ae=Pe(Ae,t,e,n,r,a),!0;case"pointerover":var i=a.pointerId;return Re.set(i,Pe(Re.get(i)||null,t,e,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Oe.set(i,Pe(Oe.get(i)||null,t,e,n,r,a)),!0}return!1}(a,t,e,n,r))r.stopPropagation();else if(Fe(t,r),4&e&&-1<Me.indexOf(t)){for(;null!==a;){var i=ba(a);if(null!==i&&xe(i),null===(i=Ye(t,e,n,r))&&Gr(t,e,r,Xe,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Gr(t,e,r,null,n)}}var Xe=null;function Ye(t,e,n,r){if(Xe=null,null!==(t=va(t=xt(r))))if(null===(e=Vt(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Wt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xe=t,null}function Qe(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($t()){case Zt:return 1;case te:return 4;case ee:case ne:return 16;case re:return 536870912;default:return 16}default:return 16}}var Je=null,$e=null,Ze=null;function tn(){if(Ze)return Ze;var t,e,n=$e,r=n.length,a="value"in Je?Je.value:Je.textContent,i=a.length;for(t=0;t<r&&n[t]===a[t];t++);var o=r-t;for(e=1;e<=o&&n[r-e]===a[i-e];e++);return Ze=a.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function an(t){function e(e,n,r,a,i){for(var o in this._reactName=e,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,t)t.hasOwnProperty(o)&&(e=t[o],this[o]=e?e(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var on,sn,cn,ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(ln),hn=L({},ln,{view:0,detail:0}),dn=an(hn),fn=L({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cn&&(cn&&"mousemove"===t.type?(on=t.screenX-cn.screenX,sn=t.screenY-cn.screenY):sn=on=0,cn=t),on)},movementY:function(t){return"movementY"in t?t.movementY:sn}}),pn=an(fn),mn=an(L({},fn,{dataTransfer:0})),gn=an(L({},hn,{relatedTarget:0})),yn=an(L({},ln,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=L({},ln,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bn=an(vn),wn=an(L({},ln,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=_n[t])&&!!e[t]}function Tn(){return Sn}var In=L({},hn,{key:function(t){if(t.key){var e=xn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?kn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),En=an(In),Nn=an(L({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=an(L({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),An=an(L({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=L({},fn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),On=an(Rn),Dn=[9,13,27,32],Mn=u&&"CompositionEvent"in window,Fn=null;u&&"documentMode"in document&&(Fn=document.documentMode);var Pn=u&&"TextEvent"in window&&!Fn,Ln=u&&(!Mn||Fn&&8<Fn&&11>=Fn),zn=String.fromCharCode(32),Bn=!1;function jn(t,e){switch(t){case"keyup":return-1!==Dn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Vn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Wn[t.type]:"textarea"===e}function Hn(t,e,n,r){It(r),0<(e=qr(e,"onChange")).length&&(n=new un("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var qn=null,Kn=null;function Xn(t){zr(t,0)}function Yn(t){if(K(wa(t)))return t}function Qn(t,e){if("change"===t)return e}var Jn=!1;if(u){var $n;if(u){var Zn="oninput"in document;if(!Zn){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),Zn="function"===typeof tr.oninput}$n=Zn}else $n=!1;Jn=$n&&(!document.documentMode||9<document.documentMode)}function er(){qn&&(qn.detachEvent("onpropertychange",nr),Kn=qn=null)}function nr(t){if("value"===t.propertyName&&Yn(Kn)){var e=[];Hn(e,Kn,t,xt(t)),Rt(Xn,e)}}function rr(t,e,n){"focusin"===t?(er(),Kn=n,(qn=e).attachEvent("onpropertychange",nr)):"focusout"===t&&er()}function ar(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Yn(Kn)}function ir(t,e){if("click"===t)return Yn(e)}function or(t,e){if("input"===t||"change"===t)return Yn(e)}var sr="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function cr(t,e){if(sr(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!h.call(e,a)||!sr(t[a],e[a]))return!1}return!0}function lr(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ur(t,e){var n,r=lr(t);for(t=0;r;){if(3===r.nodeType){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}t:{for(;r;){if(r.nextSibling){r=r.nextSibling;break t}r=r.parentNode}r=void 0}r=lr(r)}}function hr(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hr(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function dr(){for(var t=window,e=X();e instanceof t.HTMLIFrameElement;){try{var n="string"===typeof e.contentWindow.location.href}catch(r){n=!1}if(!n)break;e=X((t=e.contentWindow).document)}return e}function fr(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function pr(t){var e=dr(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(e=r.start,void 0===(t=r.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!t.extend&&i>r&&(a=r,r=i,i=a),a=ur(n,i);var o=ur(n,r);a&&o&&(1!==t.rangeCount||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&((e=e.createRange()).setStart(a.node,a.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,br=!1;function wr(t,e,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==X(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&cr(vr,r)||(vr=r,0<(r=qr(yr,"onSelect")).length&&(e=new un("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=gr)))}function xr(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var kr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},_r={},Sr={};function Tr(t){if(_r[t])return _r[t];if(!kr[t])return t;var e,n=kr[t];for(e in n)if(n.hasOwnProperty(e)&&e in Sr)return _r[t]=n[e];return t}u&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Ir=Tr("animationend"),Er=Tr("animationiteration"),Nr=Tr("animationstart"),Cr=Tr("transitionend"),Ar=new Map,Rr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(t,e){Ar.set(t,e),c(e,[t])}for(var Dr=0;Dr<Rr.length;Dr++){var Mr=Rr[Dr];Or(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Or(Ir,"onAnimationEnd"),Or(Er,"onAnimationIteration"),Or(Nr,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Cr,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fr));function Lr(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,r,a,o,s,c,l){if(Ut.apply(this,arguments),Pt){if(!Pt)throw Error(i(198));var u=Lt;Pt=!1,Lt=null,zt||(zt=!0,Bt=u)}}(r,e,void 0,t),t.currentTarget=null}function zr(t,e){e=0!==(4&e);for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;t:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var s=r[o],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==i&&a.isPropagationStopped())break t;Lr(a,s,l),i=c}else for(o=0;o<r.length;o++){if(c=(s=r[o]).instance,l=s.currentTarget,s=s.listener,c!==i&&a.isPropagationStopped())break t;Lr(a,s,l),i=c}}}if(zt)throw t=Bt,zt=!1,Bt=null,t}function Br(t,e){var n=e[ma];void 0===n&&(n=e[ma]=new Set);var r=t+"__bubble";n.has(r)||(Wr(e,t,2,!1),n.add(r))}function jr(t,e,n){var r=0;e&&(r|=4),Wr(n,t,r,e)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Vr(t){if(!t[Ur]){t[Ur]=!0,o.forEach(function(e){"selectionchange"!==e&&(Pr.has(e)||jr(e,!1,t),jr(e,!0,t))});var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Ur]||(e[Ur]=!0,jr("selectionchange",!1,e))}}function Wr(t,e,n,r){switch(Qe(e)){case 1:var a=He;break;case 4:a=qe;break;default:a=Ke}n=a.bind(null,e,n,t),a=void 0,!Dt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(a=!0),r?void 0!==a?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):void 0!==a?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function Gr(t,e,n,r,a){var i=r;if(0===(1&e)&&0===(2&e)&&null!==r)t:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var c=o.tag;if((3===c||4===c)&&((c=o.stateNode.containerInfo)===a||8===c.nodeType&&c.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=va(s)))return;if(5===(c=o.tag)||6===c){r=i=o;continue t}s=s.parentNode}}r=r.return}Rt(function(){var r=i,a=xt(n),o=[];t:{var s=Ar.get(t);if(void 0!==s){var c=un,l=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":c=En;break;case"focusin":l="focus",c=gn;break;case"focusout":l="blur",c=gn;break;case"beforeblur":case"afterblur":c=gn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Cn;break;case Ir:case Er:case Nr:c=yn;break;case Cr:c=An;break;case"scroll":c=dn;break;case"wheel":c=On;break;case"copy":case"cut":case"paste":c=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Nn}var u=0!==(4&e),h=!u&&"scroll"===t,d=u?null!==s?s+"Capture":null:s;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Ot(p,d))&&u.push(Hr(p,m,f)))),h)break;p=p.return}0<u.length&&(s=new c(s,l,null,n,a),o.push({event:s,listeners:u}))}}if(0===(7&e)){if(c="mouseout"===t||"pointerout"===t,(!(s="mouseover"===t||"pointerover"===t)||n===wt||!(l=n.relatedTarget||n.fromElement)||!va(l)&&!l[pa])&&(c||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?va(l):null)&&(l!==(h=Vt(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(u=Nn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==c?s:wa(c),f=null==l?s:wa(l),(s=new u(m,p+"leave",c,n,a)).target=h,s.relatedTarget=f,m=null,va(a)===r&&((u=new u(d,p+"enter",l,n,a)).target=f,u.relatedTarget=h,m=u),h=m,c&&l)t:{for(d=l,p=0,f=u=c;f;f=Kr(f))p++;for(f=0,m=d;m;m=Kr(m))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)d=Kr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break t;u=Kr(u),d=Kr(d)}u=null}else u=null;null!==c&&Xr(o,s,c,u,!1),null!==l&&null!==h&&Xr(o,h,l,u,!0)}if("select"===(c=(s=r?wa(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var g=Qn;else if(Gn(s))if(Jn)g=or;else{g=ar;var y=rr}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ir);switch(g&&(g=g(t,r))?Hn(o,g,n,a):(y&&y(t,s,r),"focusout"===t&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&tt(s,"number",s.value)),y=r?wa(r):window,t){case"focusin":(Gn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(o,n,a);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(o,n,a)}var v;if(Mn)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else Vn?jn(t,n)&&(b="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(v=tn()):($e="value"in(Je=a)?Je.value:Je.textContent,Vn=!0)),0<(y=qr(r,b)).length&&(b=new wn(b,t,null,n,a),o.push({event:b,listeners:y}),v?b.data=v:null!==(v=Un(n))&&(b.data=v))),(v=Pn?function(t,e){switch(t){case"compositionend":return Un(e);case"keypress":return 32!==e.which?null:(Bn=!0,zn);case"textInput":return(t=e.data)===zn&&Bn?null:t;default:return null}}(t,n):function(t,e){if(Vn)return"compositionend"===t||!Mn&&jn(t,e)?(t=tn(),Ze=$e=Je=null,Vn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ln&&"ko"!==e.locale?null:e.data}}(t,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(a=new wn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=v))}zr(o,e)})}function Hr(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qr(t,e){for(var n=e+"Capture",r=[];null!==t;){var a=t,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Ot(t,n))&&r.unshift(Hr(t,i,a)),null!=(i=Ot(t,e))&&r.push(Hr(t,i,a))),t=t.return}return r}function Kr(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Xr(t,e,n,r,a){for(var i=e._reactName,o=[];null!==n&&n!==r;){var s=n,c=s.alternate,l=s.stateNode;if(null!==c&&c===r)break;5===s.tag&&null!==l&&(s=l,a?null!=(c=Ot(n,i))&&o.unshift(Hr(n,c,s)):a||null!=(c=Ot(n,i))&&o.push(Hr(n,c,s))),n=n.return}0!==o.length&&t.push({event:e,listeners:o})}var Yr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function Jr(t){return("string"===typeof t?t:""+t).replace(Yr,"\n").replace(Qr,"")}function $r(t,e,n){if(e=Jr(e),Jr(t)!==e&&n)throw Error(i(425))}function Zr(){}var ta=null,ea=null;function na(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(t){return ia.resolve(null).then(t).catch(sa)}:ra;function sa(t){setTimeout(function(){throw t})}function ca(t,e){var n=e,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return t.removeChild(a),void Ve(e);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ve(e)}function la(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function ua(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var ha=Math.random().toString(36).slice(2),da="__reactFiber$"+ha,fa="__reactProps$"+ha,pa="__reactContainer$"+ha,ma="__reactEvents$"+ha,ga="__reactListeners$"+ha,ya="__reactHandles$"+ha;function va(t){var e=t[da];if(e)return e;for(var n=t.parentNode;n;){if(e=n[pa]||n[da]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=ua(t);null!==t;){if(n=t[da])return n;t=ua(t)}return e}n=(t=n).parentNode}return null}function ba(t){return!(t=t[da]||t[pa])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function wa(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(i(33))}function xa(t){return t[fa]||null}var ka=[],_a=-1;function Sa(t){return{current:t}}function Ta(t){0>_a||(t.current=ka[_a],ka[_a]=null,_a--)}function Ia(t,e){_a++,ka[_a]=t.current,t.current=e}var Ea={},Na=Sa(Ea),Ca=Sa(!1),Aa=Ea;function Ra(t,e){var n=t.type.contextTypes;if(!n)return Ea;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=e[a];return r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Oa(t){return null!==(t=t.childContextTypes)&&void 0!==t}function Da(){Ta(Ca),Ta(Na)}function Ma(t,e,n){if(Na.current!==Ea)throw Error(i(168));Ia(Na,e),Ia(Ca,n)}function Fa(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in e))throw Error(i(108,W(t)||"Unknown",a));return L({},n,r)}function Pa(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ea,Aa=Na.current,Ia(Na,t),Ia(Ca,Ca.current),!0}function La(t,e,n){var r=t.stateNode;if(!r)throw Error(i(169));n?(t=Fa(t,e,Aa),r.__reactInternalMemoizedMergedChildContext=t,Ta(Ca),Ta(Na),Ia(Na,t)):Ta(Ca),Ia(Ca,n)}var za=null,Ba=!1,ja=!1;function Ua(t){null===za?za=[t]:za.push(t)}function Va(){if(!ja&&null!==za){ja=!0;var t=0,e=be;try{var n=za;for(be=1;t<n.length;t++){var r=n[t];do{r=r(!0)}while(null!==r)}za=null,Ba=!1}catch(a){throw null!==za&&(za=za.slice(t+1)),Kt(Zt,Va),a}finally{be=e,ja=!1}}return null}var Wa=[],Ga=0,Ha=null,qa=0,Ka=[],Xa=0,Ya=null,Qa=1,Ja="";function $a(t,e){Wa[Ga++]=qa,Wa[Ga++]=Ha,Ha=t,qa=e}function Za(t,e,n){Ka[Xa++]=Qa,Ka[Xa++]=Ja,Ka[Xa++]=Ya,Ya=t;var r=Qa;t=Ja;var a=32-oe(r)-1;r&=~(1<<a),n+=1;var i=32-oe(e)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Qa=1<<32-oe(e)+a|n<<a|r,Ja=i+t}else Qa=1<<i|n<<a|r,Ja=t}function ti(t){null!==t.return&&($a(t,1),Za(t,1,0))}function ei(t){for(;t===Ha;)Ha=Wa[--Ga],Wa[Ga]=null,qa=Wa[--Ga],Wa[Ga]=null;for(;t===Ya;)Ya=Ka[--Xa],Ka[Xa]=null,Ja=Ka[--Xa],Ka[Xa]=null,Qa=Ka[--Xa],Ka[Xa]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(t,e){var n=Rl(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function si(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,ni=t,ri=la(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,ni=t,ri=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Ya?{id:Qa,overflow:Ja}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Rl(18,null,null,0)).stateNode=e,n.return=t,t.child=n,ni=t,ri=null,!0);default:return!1}}function ci(t){return 0!==(1&t.mode)&&0===(128&t.flags)}function li(t){if(ai){var e=ri;if(e){var n=e;if(!si(t,e)){if(ci(t))throw Error(i(418));e=la(n.nextSibling);var r=ni;e&&si(t,e)?oi(r,n):(t.flags=-4097&t.flags|2,ai=!1,ni=t)}}else{if(ci(t))throw Error(i(418));t.flags=-4097&t.flags|2,ai=!1,ni=t}}}function ui(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;ni=t}function hi(t){if(t!==ni)return!1;if(!ai)return ui(t),ai=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!na(t.type,t.memoizedProps)),e&&(e=ri)){if(ci(t))throw di(),Error(i(418));for(;e;)oi(t,e),e=la(e.nextSibling)}if(ui(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(i(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){ri=la(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}ri=null}}else ri=ni?la(t.stateNode.nextSibling):null;return!0}function di(){for(var t=ri;t;)t=la(t.nextSibling)}function fi(){ri=ni=null,ai=!1}function pi(t){null===ii?ii=[t]:ii.push(t)}var mi=w.ReactCurrentBatchConfig;function gi(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,t));var a=r,o=""+t;return null!==e&&null!==e.ref&&"function"===typeof e.ref&&e.ref._stringRef===o?e.ref:(e=function(t){var e=a.refs;null===t?delete e[o]:e[o]=t},e._stringRef=o,e)}if("string"!==typeof t)throw Error(i(284));if(!n._owner)throw Error(i(290,t))}return t}function yi(t,e){throw t=Object.prototype.toString.call(e),Error(i(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function vi(t){return(0,t._init)(t._payload)}function bi(t){function e(e,n){if(t){var r=e.deletions;null===r?(e.deletions=[n],e.flags|=16):r.push(n)}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function a(t,e){return(t=Dl(t,e)).index=0,t.sibling=null,t}function o(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index)<n?(e.flags|=2,n):r:(e.flags|=2,n):(e.flags|=1048576,n)}function s(e){return t&&null===e.alternate&&(e.flags|=2),e}function c(t,e,n,r){return null===e||6!==e.tag?((e=Ll(n,t.mode,r)).return=t,e):((e=a(e,n)).return=t,e)}function l(t,e,n,r){var i=n.type;return i===_?h(t,e,n.props.children,r,n.key):null!==e&&(e.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===O&&vi(i)===e.type)?((r=a(e,n.props)).ref=gi(t,e,n),r.return=t,r):((r=Ml(n.type,n.key,n.props,null,t.mode,r)).ref=gi(t,e,n),r.return=t,r)}function u(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=zl(n,t.mode,r)).return=t,e):((e=a(e,n.children||[])).return=t,e)}function h(t,e,n,r,i){return null===e||7!==e.tag?((e=Fl(n,t.mode,r,i)).return=t,e):((e=a(e,n)).return=t,e)}function d(t,e,n){if("string"===typeof e&&""!==e||"number"===typeof e)return(e=Ll(""+e,t.mode,n)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case x:return(n=Ml(e.type,e.key,e.props,null,t.mode,n)).ref=gi(t,null,e),n.return=t,n;case k:return(e=zl(e,t.mode,n)).return=t,e;case O:return d(t,(0,e._init)(e._payload),n)}if(et(e)||F(e))return(e=Fl(e,t.mode,n,null)).return=t,e;yi(t,e)}return null}function f(t,e,n,r){var a=null!==e?e.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:c(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===a?l(t,e,n,r):null;case k:return n.key===a?u(t,e,n,r):null;case O:return f(t,e,(a=n._init)(n._payload),r)}if(et(n)||F(n))return null!==a?null:h(t,e,n,r,null);yi(t,n)}return null}function p(t,e,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return c(e,t=t.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return l(e,t=t.get(null===r.key?n:r.key)||null,r,a);case k:return u(e,t=t.get(null===r.key?n:r.key)||null,r,a);case O:return p(t,e,n,(0,r._init)(r._payload),a)}if(et(r)||F(r))return h(e,t=t.get(n)||null,r,a,null);yi(e,r)}return null}function m(a,i,s,c){for(var l=null,u=null,h=i,m=i=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=f(a,h,s[m],c);if(null===y){null===h&&(h=g);break}t&&h&&null===y.alternate&&e(a,h),i=o(y,i,m),null===u?l=y:u.sibling=y,u=y,h=g}if(m===s.length)return n(a,h),ai&&$a(a,m),l;if(null===h){for(;m<s.length;m++)null!==(h=d(a,s[m],c))&&(i=o(h,i,m),null===u?l=h:u.sibling=h,u=h);return ai&&$a(a,m),l}for(h=r(a,h);m<s.length;m++)null!==(g=p(h,a,m,s[m],c))&&(t&&null!==g.alternate&&h.delete(null===g.key?m:g.key),i=o(g,i,m),null===u?l=g:u.sibling=g,u=g);return t&&h.forEach(function(t){return e(a,t)}),ai&&$a(a,m),l}function g(a,s,c,l){var u=F(c);if("function"!==typeof u)throw Error(i(150));if(null==(c=u.call(c)))throw Error(i(151));for(var h=u=null,m=s,g=s=0,y=null,v=c.next();null!==m&&!v.done;g++,v=c.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=f(a,m,v.value,l);if(null===b){null===m&&(m=y);break}t&&m&&null===b.alternate&&e(a,m),s=o(b,s,g),null===h?u=b:h.sibling=b,h=b,m=y}if(v.done)return n(a,m),ai&&$a(a,g),u;if(null===m){for(;!v.done;g++,v=c.next())null!==(v=d(a,v.value,l))&&(s=o(v,s,g),null===h?u=v:h.sibling=v,h=v);return ai&&$a(a,g),u}for(m=r(a,m);!v.done;g++,v=c.next())null!==(v=p(m,a,g,v.value,l))&&(t&&null!==v.alternate&&m.delete(null===v.key?g:v.key),s=o(v,s,g),null===h?u=v:h.sibling=v,h=v);return t&&m.forEach(function(t){return e(a,t)}),ai&&$a(a,g),u}return function t(r,i,o,c){if("object"===typeof o&&null!==o&&o.type===_&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:t:{for(var l=o.key,u=i;null!==u;){if(u.key===l){if((l=o.type)===_){if(7===u.tag){n(r,u.sibling),(i=a(u,o.props.children)).return=r,r=i;break t}}else if(u.elementType===l||"object"===typeof l&&null!==l&&l.$$typeof===O&&vi(l)===u.type){n(r,u.sibling),(i=a(u,o.props)).ref=gi(r,u,o),i.return=r,r=i;break t}n(r,u);break}e(r,u),u=u.sibling}o.type===_?((i=Fl(o.props.children,r.mode,c,o.key)).return=r,r=i):((c=Ml(o.type,o.key,o.props,null,r.mode,c)).ref=gi(r,i,o),c.return=r,r=c)}return s(r);case k:t:{for(u=o.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break t}n(r,i);break}e(r,i),i=i.sibling}(i=zl(o,r.mode,c)).return=r,r=i}return s(r);case O:return t(r,i,(u=o._init)(o._payload),c)}if(et(o))return m(r,i,o,c);if(F(o))return g(r,i,o,c);yi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Ll(o,r.mode,c)).return=r,r=i),s(r)):n(r,i)}}var wi=bi(!0),xi=bi(!1),ki=Sa(null),_i=null,Si=null,Ti=null;function Ii(){Ti=Si=_i=null}function Ei(t){var e=ki.current;Ta(ki),t._currentValue=e}function Ni(t,e,n){for(;null!==t;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==r&&(r.childLanes|=e)):null!==r&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ci(t,e){_i=t,Ti=Si=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!==(t.lanes&e)&&(bs=!0),t.firstContext=null)}function Ai(t){var e=t._currentValue;if(Ti!==t)if(t={context:t,memoizedValue:e,next:null},null===Si){if(null===_i)throw Error(i(308));Si=t,_i.dependencies={lanes:0,firstContext:t}}else Si=Si.next=t;return e}var Ri=null;function Oi(t){null===Ri?Ri=[t]:Ri.push(t)}function Di(t,e,n,r){var a=e.interleaved;return null===a?(n.next=n,Oi(e)):(n.next=a.next,a.next=n),e.interleaved=n,Mi(t,r)}function Mi(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Fi=!1;function Pi(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Li(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bi(t,e,n){var r=t.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nc)){var a=r.pending;return null===a?e.next=e:(e.next=a.next,a.next=e),r.pending=e,Mi(t,n)}return null===(a=r.interleaved)?(e.next=e,Oi(r)):(e.next=a.next,a.next=e),r.interleaved=e,Mi(t,n)}function ji(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194240&n))){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,ve(t,n)}}function Ui(t,e){var n=t.updateQueue,r=t.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=e:i=i.next=e}else a=i=e;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Vi(t,e,n,r){var a=t.updateQueue;Fi=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var c=s,l=c.next;c.next=null,null===o?i=l:o.next=l,o=c;var u=t.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===s?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(null!==i){var h=a.baseState;for(o=0,u=l=c=null,s=i;;){var d=s.lane,f=s.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});t:{var p=t,m=s;switch(d=e,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break t}h=p;break t;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break t;h=L({},h,d);break t;case 2:Fi=!0}}null!==s.callback&&0!==s.lane&&(t.flags|=64,null===(d=a.effects)?a.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(l=u=f,c=h):u=u.next=f,o|=d;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(d=s).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}if(null===u&&(c=h),a.baseState=c,a.firstBaseUpdate=l,a.lastBaseUpdate=u,null!==(e=a.shared.interleaved)){a=e;do{o|=a.lane,a=a.next}while(a!==e)}else null===i&&(a.shared.lanes=0);Pc|=o,t.lanes=o,t.memoizedState=h}}function Wi(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var r=t[e],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Gi={},Hi=Sa(Gi),qi=Sa(Gi),Ki=Sa(Gi);function Xi(t){if(t===Gi)throw Error(i(174));return t}function Yi(t,e){switch(Ia(Ki,e),Ia(qi,t),Ia(Hi,Gi),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ct(null,"");break;default:e=ct(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Ta(Hi),Ia(Hi,e)}function Qi(){Ta(Hi),Ta(qi),Ta(Ki)}function Ji(t){Xi(Ki.current);var e=Xi(Hi.current),n=ct(e,t.type);e!==n&&(Ia(qi,t),Ia(Hi,n))}function $i(t){qi.current===t&&(Ta(Hi),Ta(qi))}var Zi=Sa(0);function to(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var eo=[];function no(){for(var t=0;t<eo.length;t++)eo[t]._workInProgressVersionPrimary=null;eo.length=0}var ro=w.ReactCurrentDispatcher,ao=w.ReactCurrentBatchConfig,io=0,oo=null,so=null,co=null,lo=!1,uo=!1,ho=0,fo=0;function po(){throw Error(i(321))}function mo(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!sr(t[n],e[n]))return!1;return!0}function go(t,e,n,r,a,o){if(io=o,oo=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ro.current=null===t||null===t.memoizedState?Zo:ts,t=n(r,a),uo){o=0;do{if(uo=!1,ho=0,25<=o)throw Error(i(301));o+=1,co=so=null,e.updateQueue=null,ro.current=es,t=n(r,a)}while(uo)}if(ro.current=$o,e=null!==so&&null!==so.next,io=0,co=so=oo=null,lo=!1,e)throw Error(i(300));return t}function yo(){var t=0!==ho;return ho=0,t}function vo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===co?oo.memoizedState=co=t:co=co.next=t,co}function bo(){if(null===so){var t=oo.alternate;t=null!==t?t.memoizedState:null}else t=so.next;var e=null===co?oo.memoizedState:co.next;if(null!==e)co=e,so=t;else{if(null===t)throw Error(i(310));t={memoizedState:(so=t).memoizedState,baseState:so.baseState,baseQueue:so.baseQueue,queue:so.queue,next:null},null===co?oo.memoizedState=co=t:co=co.next=t}return co}function wo(t,e){return"function"===typeof e?e(t):e}function xo(t){var e=bo(),n=e.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=t;var r=so,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var c=s=null,l=null,u=o;do{var h=u.lane;if((io&h)===h)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=d,s=r):l=l.next=d,oo.lanes|=h,Pc|=h}u=u.next}while(null!==u&&u!==o);null===l?s=r:l.next=c,sr(r,e.memoizedState)||(bs=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,n.lastRenderedState=r}if(null!==(t=n.interleaved)){a=t;do{o=a.lane,oo.lanes|=o,Pc|=o,a=a.next}while(a!==t)}else null===a&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ko(t){var e=bo(),n=e.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,o=e.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=t(o,s.action),s=s.next}while(s!==a);sr(o,e.memoizedState)||(bs=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function _o(){}function So(t,e){var n=oo,r=bo(),a=e(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,bs=!0),r=r.queue,Po(Eo.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||null!==co&&1&co.memoizedState.tag){if(n.flags|=2048,Ro(9,Io.bind(null,n,r,a,e),void 0,null),null===Cc)throw Error(i(349));0!==(30&io)||To(n,e,a)}return a}function To(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=oo.updateQueue)?(e={lastEffect:null,stores:null},oo.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Io(t,e,n,r){e.value=n,e.getSnapshot=r,No(e)&&Co(t)}function Eo(t,e,n){return n(function(){No(e)&&Co(t)})}function No(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!sr(t,n)}catch(r){return!0}}function Co(t){var e=Mi(t,1);null!==e&&nl(e,t,1,-1)}function Ao(t){var e=vo();return"function"===typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:t},e.queue=t,t=t.dispatch=Xo.bind(null,oo,t),[e.memoizedState,t]}function Ro(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},null===(e=oo.updateQueue)?(e={lastEffect:null,stores:null},oo.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t),t}function Oo(){return bo().memoizedState}function Do(t,e,n,r){var a=vo();oo.flags|=t,a.memoizedState=Ro(1|e,n,void 0,void 0===r?null:r)}function Mo(t,e,n,r){var a=bo();r=void 0===r?null:r;var i=void 0;if(null!==so){var o=so.memoizedState;if(i=o.destroy,null!==r&&mo(r,o.deps))return void(a.memoizedState=Ro(e,n,i,r))}oo.flags|=t,a.memoizedState=Ro(1|e,n,i,r)}function Fo(t,e){return Do(8390656,8,t,e)}function Po(t,e){return Mo(2048,8,t,e)}function Lo(t,e){return Mo(4,2,t,e)}function zo(t,e){return Mo(4,4,t,e)}function Bo(t,e){return"function"===typeof e?(t=t(),e(t),function(){e(null)}):null!==e&&void 0!==e?(t=t(),e.current=t,function(){e.current=null}):void 0}function jo(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Mo(4,4,Bo.bind(null,e,t),n)}function Uo(){}function Vo(t,e){var n=bo();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&mo(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Wo(t,e){var n=bo();e=void 0===e?null:e;var r=n.memoizedState;return null!==r&&null!==e&&mo(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Go(t,e,n){return 0===(21&io)?(t.baseState&&(t.baseState=!1,bs=!0),t.memoizedState=n):(sr(n,e)||(n=me(),oo.lanes|=n,Pc|=n,t.baseState=!0),e)}function Ho(t,e){var n=be;be=0!==n&&4>n?n:4,t(!0);var r=ao.transition;ao.transition={};try{t(!1),e()}finally{be=n,ao.transition=r}}function qo(){return bo().memoizedState}function Ko(t,e,n){var r=el(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Yo(t))Qo(e,n);else if(null!==(n=Di(t,e,n,r))){nl(n,t,r,tl()),Jo(n,e,r)}}function Xo(t,e,n){var r=el(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yo(t))Qo(e,a);else{var i=t.alternate;if(0===t.lanes&&(null===i||0===i.lanes)&&null!==(i=e.lastRenderedReducer))try{var o=e.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var c=e.interleaved;return null===c?(a.next=a,Oi(e)):(a.next=c.next,c.next=a),void(e.interleaved=a)}}catch(l){}null!==(n=Di(t,e,a,r))&&(nl(n,t,r,a=tl()),Jo(n,e,r))}}function Yo(t){var e=t.alternate;return t===oo||null!==e&&e===oo}function Qo(t,e){uo=lo=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Jo(t,e,n){if(0!==(4194240&n)){var r=e.lanes;n|=r&=t.pendingLanes,e.lanes=n,ve(t,n)}}var $o={readContext:Ai,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},Zo={readContext:Ai,useCallback:function(t,e){return vo().memoizedState=[t,void 0===e?null:e],t},useContext:Ai,useEffect:Fo,useImperativeHandle:function(t,e,n){return n=null!==n&&void 0!==n?n.concat([t]):null,Do(4194308,4,Bo.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Do(4194308,4,t,e)},useInsertionEffect:function(t,e){return Do(4,2,t,e)},useMemo:function(t,e){var n=vo();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=vo();return e=void 0!==n?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Ko.bind(null,oo,t),[r.memoizedState,t]},useRef:function(t){return t={current:t},vo().memoizedState=t},useState:Ao,useDebugValue:Uo,useDeferredValue:function(t){return vo().memoizedState=t},useTransition:function(){var t=Ao(!1),e=t[0];return t=Ho.bind(null,t[1]),vo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=oo,a=vo();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=e(),null===Cc)throw Error(i(349));0!==(30&io)||To(r,e,n)}a.memoizedState=n;var o={value:n,getSnapshot:e};return a.queue=o,Fo(Eo.bind(null,r,o,t),[t]),r.flags|=2048,Ro(9,Io.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=vo(),e=Cc.identifierPrefix;if(ai){var n=Ja;e=":"+e+"R"+(n=(Qa&~(1<<32-oe(Qa)-1)).toString(32)+n),0<(n=ho++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=fo++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ts={readContext:Ai,useCallback:Vo,useContext:Ai,useEffect:Po,useImperativeHandle:jo,useInsertionEffect:Lo,useLayoutEffect:zo,useMemo:Wo,useReducer:xo,useRef:Oo,useState:function(){return xo(wo)},useDebugValue:Uo,useDeferredValue:function(t){return Go(bo(),so.memoizedState,t)},useTransition:function(){return[xo(wo)[0],bo().memoizedState]},useMutableSource:_o,useSyncExternalStore:So,useId:qo,unstable_isNewReconciler:!1},es={readContext:Ai,useCallback:Vo,useContext:Ai,useEffect:Po,useImperativeHandle:jo,useInsertionEffect:Lo,useLayoutEffect:zo,useMemo:Wo,useReducer:ko,useRef:Oo,useState:function(){return ko(wo)},useDebugValue:Uo,useDeferredValue:function(t){var e=bo();return null===so?e.memoizedState=t:Go(e,so.memoizedState,t)},useTransition:function(){return[ko(wo)[0],bo().memoizedState]},useMutableSource:_o,useSyncExternalStore:So,useId:qo,unstable_isNewReconciler:!1};function ns(t,e){if(t&&t.defaultProps){for(var n in e=L({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}function rs(t,e,n,r){n=null===(n=n(r,e=t.memoizedState))||void 0===n?e:L({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var as={isMounted:function(t){return!!(t=t._reactInternals)&&Vt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=tl(),a=el(t),i=zi(r,a);i.payload=e,void 0!==n&&null!==n&&(i.callback=n),null!==(e=Bi(t,i,a))&&(nl(e,t,a,r),ji(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=tl(),a=el(t),i=zi(r,a);i.tag=1,i.payload=e,void 0!==n&&null!==n&&(i.callback=n),null!==(e=Bi(t,i,a))&&(nl(e,t,a,r),ji(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tl(),r=el(t),a=zi(n,r);a.tag=2,void 0!==e&&null!==e&&(a.callback=e),null!==(e=Bi(t,a,r))&&(nl(e,t,r,n),ji(e,t,r))}};function is(t,e,n,r,a,i,o){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(r,i,o):!e.prototype||!e.prototype.isPureReactComponent||(!cr(n,r)||!cr(a,i))}function os(t,e,n){var r=!1,a=Ea,i=e.contextType;return"object"===typeof i&&null!==i?i=Ai(i):(a=Oa(e)?Aa:Na.current,i=(r=null!==(r=e.contextTypes)&&void 0!==r)?Ra(t,a):Ea),e=new e(n,i),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=as,t.stateNode=e,e._reactInternals=t,r&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function ss(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&as.enqueueReplaceState(e,e.state,null)}function cs(t,e,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},Pi(t);var i=e.contextType;"object"===typeof i&&null!==i?a.context=Ai(i):(i=Oa(e)?Aa:Na.current,a.context=Ra(t,i)),a.state=t.memoizedState,"function"===typeof(i=e.getDerivedStateFromProps)&&(rs(t,e,i,n),a.state=t.memoizedState),"function"===typeof e.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(e=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),e!==a.state&&as.enqueueReplaceState(a,a.state,null),Vi(t,n,a,r),a.state=t.memoizedState),"function"===typeof a.componentDidMount&&(t.flags|=4194308)}function ls(t,e){try{var n="",r=e;do{n+=U(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:t,source:e,stack:a,digest:null}}function us(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function hs(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ds="function"===typeof WeakMap?WeakMap:Map;function fs(t,e,n){(n=zi(-1,n)).tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Gc||(Gc=!0,Hc=r),hs(0,e)},n}function ps(t,e,n){(n=zi(-1,n)).tag=3;var r=t.type.getDerivedStateFromError;if("function"===typeof r){var a=e.value;n.payload=function(){return r(a)},n.callback=function(){hs(0,e)}}var i=t.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){hs(0,e),"function"!==typeof r&&(null===qc?qc=new Set([this]):qc.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function ms(t,e,n){var r=t.pingCache;if(null===r){r=t.pingCache=new ds;var a=new Set;r.set(e,a)}else void 0===(a=r.get(e))&&(a=new Set,r.set(e,a));a.has(n)||(a.add(n),t=Tl.bind(null,t,e,n),e.then(t,t))}function gs(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function ys(t,e,n,r,a){return 0===(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=zi(-1,1)).tag=2,Bi(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=a,t)}var vs=w.ReactCurrentOwner,bs=!1;function ws(t,e,n,r){e.child=null===t?xi(e,null,n,r):wi(e,t.child,n,r)}function xs(t,e,n,r,a){n=n.render;var i=e.ref;return Ci(e,a),r=go(t,e,n,r,i,a),n=yo(),null===t||bs?(ai&&n&&ti(e),e.flags|=1,ws(t,e,r,a),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Gs(t,e,a))}function ks(t,e,n,r,a){if(null===t){var i=n.type;return"function"!==typeof i||Ol(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Ml(n.type,null,r,e,e.mode,a)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=i,_s(t,e,i,r,a))}if(i=t.child,0===(t.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(o,r)&&t.ref===e.ref)return Gs(t,e,a)}return e.flags|=1,(t=Dl(i,r)).ref=e.ref,t.return=e,e.child=t}function _s(t,e,n,r,a){if(null!==t){var i=t.memoizedProps;if(cr(i,r)&&t.ref===e.ref){if(bs=!1,e.pendingProps=r=i,0===(t.lanes&a))return e.lanes=t.lanes,Gs(t,e,a);0!==(131072&t.flags)&&(bs=!0)}}return Is(t,e,n,r,a)}function Ss(t,e,n){var r=e.pendingProps,a=r.children,i=null!==t?t.memoizedState:null;if("hidden"===r.mode)if(0===(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ia(Dc,Oc),Oc|=n;else{if(0===(1073741824&n))return t=null!==i?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ia(Dc,Oc),Oc|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ia(Dc,Oc),Oc|=r}else null!==i?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ia(Dc,Oc),Oc|=r;return ws(t,e,a,n),e.child}function Ts(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Is(t,e,n,r,a){var i=Oa(n)?Aa:Na.current;return i=Ra(e,i),Ci(e,a),n=go(t,e,n,r,i,a),r=yo(),null===t||bs?(ai&&r&&ti(e),e.flags|=1,ws(t,e,n,a),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Gs(t,e,a))}function Es(t,e,n,r,a){if(Oa(n)){var i=!0;Pa(e)}else i=!1;if(Ci(e,a),null===e.stateNode)Ws(t,e),os(e,n,r),cs(e,n,r,a),r=!0;else if(null===t){var o=e.stateNode,s=e.memoizedProps;o.props=s;var c=o.context,l=n.contextType;"object"===typeof l&&null!==l?l=Ai(l):l=Ra(e,l=Oa(n)?Aa:Na.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||c!==l)&&ss(e,o,r,l),Fi=!1;var d=e.memoizedState;o.state=d,Vi(e,r,o,a),c=e.memoizedState,s!==r||d!==c||Ca.current||Fi?("function"===typeof u&&(rs(e,n,u,r),c=e.memoizedState),(s=Fi||is(e,n,s,r,d,c,l))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(e.flags|=4194308)):("function"===typeof o.componentDidMount&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=l,r=s):("function"===typeof o.componentDidMount&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Li(t,e),s=e.memoizedProps,l=e.type===e.elementType?s:ns(e.type,s),o.props=l,h=e.pendingProps,d=o.context,"object"===typeof(c=n.contextType)&&null!==c?c=Ai(c):c=Ra(e,c=Oa(n)?Aa:Na.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==h||d!==c)&&ss(e,o,r,c),Fi=!1,d=e.memoizedState,o.state=d,Vi(e,r,o,a);var p=e.memoizedState;s!==h||d!==p||Ca.current||Fi?("function"===typeof f&&(rs(e,n,f,r),p=e.memoizedState),(l=Fi||is(e,n,l,r,d,p,c)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof o.componentDidUpdate&&(e.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=c,r=l):("function"!==typeof o.componentDidUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return Ns(t,e,n,r,i,a)}function Ns(t,e,n,r,a,i){Ts(t,e);var o=0!==(128&e.flags);if(!r&&!o)return a&&La(e,n,!1),Gs(t,e,i);r=e.stateNode,vs.current=e;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return e.flags|=1,null!==t&&o?(e.child=wi(e,t.child,null,i),e.child=wi(e,null,s,i)):ws(t,e,s,i),e.memoizedState=r.state,a&&La(e,n,!0),e.child}function Cs(t){var e=t.stateNode;e.pendingContext?Ma(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Ma(0,e.context,!1),Yi(t,e.containerInfo)}function As(t,e,n,r,a){return fi(),pi(a),e.flags|=256,ws(t,e,n,r),e.child}var Rs,Os,Ds,Ms,Fs={dehydrated:null,treeContext:null,retryLane:0};function Ps(t){return{baseLanes:t,cachePool:null,transitions:null}}function Ls(t,e,n){var r,a=e.pendingProps,o=Zi.current,s=!1,c=0!==(128&e.flags);if((r=c)||(r=(null===t||null!==t.memoizedState)&&0!==(2&o)),r?(s=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(o|=1),Ia(Zi,1&o),null===t)return li(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0===(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(c=a.children,t=a.fallback,s?(a=e.mode,s=e.child,c={mode:"hidden",children:c},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=c):s=Pl(c,a,0,null),t=Fl(t,a,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ps(n),e.memoizedState=Fs,t):zs(e,c));if(null!==(o=t.memoizedState)&&null!==(r=o.dehydrated))return function(t,e,n,r,a,o,s){if(n)return 256&e.flags?(e.flags&=-257,Bs(t,e,s,r=us(Error(i(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(o=r.fallback,a=e.mode,r=Pl({mode:"visible",children:r.children},a,0,null),(o=Fl(o,a,s,null)).flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,0!==(1&e.mode)&&wi(e,t.child,null,s),e.child.memoizedState=Ps(s),e.memoizedState=Fs,o);if(0===(1&e.mode))return Bs(t,e,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var c=r.dgst;return r=c,Bs(t,e,s,r=us(o=Error(i(419)),r,void 0))}if(c=0!==(s&t.childLanes),bs||c){if(null!==(r=Cc)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Mi(t,a),nl(r,t,a,-1))}return ml(),Bs(t,e,s,r=us(Error(i(421))))}return"$?"===a.data?(e.flags|=128,e.child=t.child,e=El.bind(null,t),a._reactRetry=e,null):(t=o.treeContext,ri=la(a.nextSibling),ni=e,ai=!0,ii=null,null!==t&&(Ka[Xa++]=Qa,Ka[Xa++]=Ja,Ka[Xa++]=Ya,Qa=t.id,Ja=t.overflow,Ya=e),e=zs(e,r.children),e.flags|=4096,e)}(t,e,c,a,r,o,n);if(s){s=a.fallback,c=e.mode,r=(o=t.child).sibling;var l={mode:"hidden",children:a.children};return 0===(1&c)&&e.child!==o?((a=e.child).childLanes=0,a.pendingProps=l,e.deletions=null):(a=Dl(o,l)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Dl(r,s):(s=Fl(s,c,n,null)).flags|=2,s.return=e,a.return=e,a.sibling=s,e.child=a,a=s,s=e.child,c=null===(c=t.child.memoizedState)?Ps(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=t.childLanes&~n,e.memoizedState=Fs,a}return t=(s=t.child).sibling,a=Dl(s,{mode:"visible",children:a.children}),0===(1&e.mode)&&(a.lanes=n),a.return=e,a.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=a,e.memoizedState=null,a}function zs(t,e){return(e=Pl({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Bs(t,e,n,r){return null!==r&&pi(r),wi(e,t.child,null,n),(t=zs(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function js(t,e,n){t.lanes|=e;var r=t.alternate;null!==r&&(r.lanes|=e),Ni(t.return,e,n)}function Us(t,e,n,r,a){var i=t.memoizedState;null===i?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Vs(t,e,n){var r=e.pendingProps,a=r.revealOrder,i=r.tail;if(ws(t,e,r.children,n),0!==(2&(r=Zi.current)))r=1&r|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&js(t,n,e);else if(19===t.tag)js(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ia(Zi,r),0===(1&e.mode))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;null!==n;)null!==(t=n.alternate)&&null===to(t)&&(a=n),n=n.sibling;null===(n=a)?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),Us(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;null!==a;){if(null!==(t=a.alternate)&&null===to(t)){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}Us(e,!0,n,null,i);break;case"together":Us(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ws(t,e){0===(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gs(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Pc|=e.lanes,0===(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(i(153));if(null!==e.child){for(n=Dl(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Dl(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Hs(t,e){if(!ai)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?e||null===t.tail?t.tail=null:t.tail.sibling=null:r.sibling=null}}function qs(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,r=0;if(e)for(var a=t.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=t,a=a.sibling;else for(a=t.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Ks(t,e,n){var r=e.pendingProps;switch(ei(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(e),null;case 1:case 17:return Oa(e.type)&&Da(),qs(e),null;case 3:return r=e.stateNode,Qi(),Ta(Ca),Ta(Na),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==t&&null!==t.child||(hi(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==ii&&(ol(ii),ii=null))),Os(t,e),qs(e),null;case 5:$i(e);var a=Xi(Ki.current);if(n=e.type,null!==t&&null!=e.stateNode)Ds(t,e,n,r,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(null===e.stateNode)throw Error(i(166));return qs(e),null}if(t=Xi(Hi.current),hi(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[da]=e,r[fa]=o,t=0!==(1&e.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(a=0;a<Fr.length;a++)Br(Fr[a],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":Q(r,o),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Br("invalid",r);break;case"textarea":at(r,o),Br("invalid",r)}for(var c in vt(n,o),a=null,o)if(o.hasOwnProperty(c)){var l=o[c];"children"===c?"string"===typeof l?r.textContent!==l&&(!0!==o.suppressHydrationWarning&&$r(r.textContent,l,t),a=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==o.suppressHydrationWarning&&$r(r.textContent,l,t),a=["children",""+l]):s.hasOwnProperty(c)&&null!=l&&"onScroll"===c&&Br("scroll",r)}switch(n){case"input":q(r),Z(r,o,!0);break;case"textarea":q(r),ot(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=a,e.updateQueue=r,null!==r&&(e.flags|=4)}else{c=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=st(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=c.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"===typeof r.is?t=c.createElement(n,{is:r.is}):(t=c.createElement(n),"select"===n&&(c=t,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):t=c.createElementNS(t,n),t[da]=e,t[fa]=r,Rs(t,e,!1,!1),e.stateNode=t;t:{switch(c=bt(n,r),n){case"dialog":Br("cancel",t),Br("close",t),a=r;break;case"iframe":case"object":case"embed":Br("load",t),a=r;break;case"video":case"audio":for(a=0;a<Fr.length;a++)Br(Fr[a],t);a=r;break;case"source":Br("error",t),a=r;break;case"img":case"image":case"link":Br("error",t),Br("load",t),a=r;break;case"details":Br("toggle",t),a=r;break;case"input":Q(t,r),a=Y(t,r),Br("invalid",t);break;case"option":default:a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),Br("invalid",t);break;case"textarea":at(t,r),a=rt(t,r),Br("invalid",t)}for(o in vt(n,a),l=a)if(l.hasOwnProperty(o)){var u=l[o];"style"===o?gt(t,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&ht(t,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&dt(t,u):"number"===typeof u&&dt(t,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Br("scroll",t):null!=u&&b(t,o,u,c))}switch(n){case"input":q(t),Z(t,r,!1);break;case"textarea":q(t),ot(t);break;case"option":null!=r.value&&t.setAttribute("value",""+G(r.value));break;case"select":t.multiple=!!r.multiple,null!=(o=r.value)?nt(t,!!r.multiple,o,!1):null!=r.defaultValue&&nt(t,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(t.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break t;case"img":r=!0;break t;default:r=!1}}r&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return qs(e),null;case 6:if(t&&null!=e.stateNode)Ms(t,e,t.memoizedProps,r);else{if("string"!==typeof r&&null===e.stateNode)throw Error(i(166));if(n=Xi(Ki.current),Xi(Hi.current),hi(e)){if(r=e.stateNode,n=e.memoizedProps,r[da]=e,(o=r.nodeValue!==n)&&null!==(t=ni))switch(t.tag){case 3:$r(r.nodeValue,n,0!==(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&t.mode))}o&&(e.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[da]=e,e.stateNode=r}return qs(e),null;case 13:if(Ta(Zi),r=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&e.mode)&&0===(128&e.flags))di(),fi(),e.flags|=98560,o=!1;else if(o=hi(e),null!==r&&null!==r.dehydrated){if(null===t){if(!o)throw Error(i(318));if(!(o=null!==(o=e.memoizedState)?o.dehydrated:null))throw Error(i(317));o[da]=e}else fi(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;qs(e),o=!1}else null!==ii&&(ol(ii),ii=null),o=!0;if(!o)return 65536&e.flags?e:null}return 0!==(128&e.flags)?(e.lanes=n,e):((r=null!==r)!==(null!==t&&null!==t.memoizedState)&&r&&(e.child.flags|=8192,0!==(1&e.mode)&&(null===t||0!==(1&Zi.current)?0===Mc&&(Mc=3):ml())),null!==e.updateQueue&&(e.flags|=4),qs(e),null);case 4:return Qi(),Os(t,e),null===t&&Vr(e.stateNode.containerInfo),qs(e),null;case 10:return Ei(e.type._context),qs(e),null;case 19:if(Ta(Zi),null===(o=e.memoizedState))return qs(e),null;if(r=0!==(128&e.flags),null===(c=o.rendering))if(r)Hs(o,!1);else{if(0!==Mc||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(c=to(t))){for(e.flags|=128,Hs(o,!1),null!==(r=c.updateQueue)&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;null!==n;)t=r,(o=n).flags&=14680066,null===(c=o.alternate)?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,t=c.dependencies,o.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ia(Zi,1&Zi.current|2),e.child}t=t.sibling}null!==o.tail&&Jt()>Vc&&(e.flags|=128,r=!0,Hs(o,!1),e.lanes=4194304)}else{if(!r)if(null!==(t=to(c))){if(e.flags|=128,r=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Hs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!c.alternate&&!ai)return qs(e),null}else 2*Jt()-o.renderingStartTime>Vc&&1073741824!==n&&(e.flags|=128,r=!0,Hs(o,!1),e.lanes=4194304);o.isBackwards?(c.sibling=e.child,e.child=c):(null!==(n=o.last)?n.sibling=c:e.child=c,o.last=c)}return null!==o.tail?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Jt(),e.sibling=null,n=Zi.current,Ia(Zi,r?1&n|2:1&n),e):(qs(e),null);case 22:case 23:return hl(),r=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==r&&(e.flags|=8192),r&&0!==(1&e.mode)?0!==(1073741824&Oc)&&(qs(e),6&e.subtreeFlags&&(e.flags|=8192)):qs(e),null;case 24:case 25:return null}throw Error(i(156,e.tag))}function Xs(t,e){switch(ei(e),e.tag){case 1:return Oa(e.type)&&Da(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Qi(),Ta(Ca),Ta(Na),no(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 5:return $i(e),null;case 13:if(Ta(Zi),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(i(340));fi()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Ta(Zi),null;case 4:return Qi(),null;case 10:return Ei(e.type._context),null;case 22:case 23:return hl(),null;default:return null}}Rs=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Os=function(){},Ds=function(t,e,n,r){var a=t.memoizedProps;if(a!==r){t=e.stateNode,Xi(Hi.current);var i,o=null;switch(n){case"input":a=Y(t,a),r=Y(t,r),o=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),o=[];break;case"textarea":a=rt(t,a),r=rt(t,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(t.onclick=Zr)}for(u in vt(n,r),n=null,a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var c=a[u];for(i in c)c.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(c=null!=a?a[u]:void 0,r.hasOwnProperty(u)&&l!==c&&(null!=l||null!=c))if("style"===u)if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(o=o||[]).push(u,l)):"children"===u?"string"!==typeof l&&"number"!==typeof l||(o=o||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&Br("scroll",t),o||c===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}},Ms=function(t,e,n,r){n!==r&&(e.flags|=4)};var Ys=!1,Qs=!1,Js="function"===typeof WeakSet?WeakSet:Set,$s=null;function Zs(t,e){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sl(t,e,r)}else n.current=null}function tc(t,e,n){try{n()}catch(r){Sl(t,e,r)}}var ec=!1;function nc(t,e,n){var r=e.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,void 0!==i&&tc(e,n,i)}a=a.next}while(a!==r)}}function rc(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ac(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"===typeof e?e(t):e.current=t}}function ic(t){var e=t.alternate;null!==e&&(t.alternate=null,ic(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&(delete e[da],delete e[fa],delete e[ma],delete e[ga],delete e[ya])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function oc(t){return 5===t.tag||3===t.tag||4===t.tag}function sc(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||oc(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function cc(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!==(n=n._reactRootContainer)&&void 0!==n||null!==e.onclick||(e.onclick=Zr));else if(4!==r&&null!==(t=t.child))for(cc(t,e,n),t=t.sibling;null!==t;)cc(t,e,n),t=t.sibling}function lc(t,e,n){var r=t.tag;if(5===r||6===r)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==r&&null!==(t=t.child))for(lc(t,e,n),t=t.sibling;null!==t;)lc(t,e,n),t=t.sibling}var uc=null,hc=!1;function dc(t,e,n){for(n=n.child;null!==n;)fc(t,e,n),n=n.sibling}function fc(t,e,n){if(ie&&"function"===typeof ie.onCommitFiberUnmount)try{ie.onCommitFiberUnmount(ae,n)}catch(s){}switch(n.tag){case 5:Qs||Zs(n,e);case 6:var r=uc,a=hc;uc=null,dc(t,e,n),hc=a,null!==(uc=r)&&(hc?(t=uc,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):uc.removeChild(n.stateNode));break;case 18:null!==uc&&(hc?(t=uc,n=n.stateNode,8===t.nodeType?ca(t.parentNode,n):1===t.nodeType&&ca(t,n),Ve(t)):ca(uc,n.stateNode));break;case 4:r=uc,a=hc,uc=n.stateNode.containerInfo,hc=!0,dc(t,e,n),uc=r,hc=a;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&tc(n,e,o),a=a.next}while(a!==r)}dc(t,e,n);break;case 1:if(!Qs&&(Zs(n,e),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Sl(n,e,s)}dc(t,e,n);break;case 21:dc(t,e,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,dc(t,e,n),Qs=r):dc(t,e,n);break;default:dc(t,e,n)}}function pc(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Js),e.forEach(function(e){var r=Nl.bind(null,t,e);n.has(e)||(n.add(e),e.then(r,r))})}}function mc(t,e){var n=e.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=t,s=e,c=s;t:for(;null!==c;){switch(c.tag){case 5:uc=c.stateNode,hc=!1;break t;case 3:case 4:uc=c.stateNode.containerInfo,hc=!0;break t}c=c.return}if(null===uc)throw Error(i(160));fc(o,s,a),uc=null,hc=!1;var l=a.alternate;null!==l&&(l.return=null),a.return=null}catch(u){Sl(a,e,u)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)gc(e,t),e=e.sibling}function gc(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(mc(e,t),yc(t),4&r){try{nc(3,t,t.return),rc(3,t)}catch(g){Sl(t,t.return,g)}try{nc(5,t,t.return)}catch(g){Sl(t,t.return,g)}}break;case 1:mc(e,t),yc(t),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(mc(e,t),yc(t),512&r&&null!==n&&Zs(n,n.return),32&t.flags){var a=t.stateNode;try{dt(a,"")}catch(g){Sl(t,t.return,g)}}if(4&r&&null!=(a=t.stateNode)){var o=t.memoizedProps,s=null!==n?n.memoizedProps:o,c=t.type,l=t.updateQueue;if(t.updateQueue=null,null!==l)try{"input"===c&&"radio"===o.type&&null!=o.name&&J(a,o),bt(c,s);var u=bt(c,o);for(s=0;s<l.length;s+=2){var h=l[s],d=l[s+1];"style"===h?gt(a,d):"dangerouslySetInnerHTML"===h?ht(a,d):"children"===h?dt(a,d):b(a,h,d,u)}switch(c){case"input":$(a,o);break;case"textarea":it(a,o);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?nt(a,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?nt(a,!!o.multiple,o.defaultValue,!0):nt(a,!!o.multiple,o.multiple?[]:"",!1))}a[fa]=o}catch(g){Sl(t,t.return,g)}}break;case 6:if(mc(e,t),yc(t),4&r){if(null===t.stateNode)throw Error(i(162));a=t.stateNode,o=t.memoizedProps;try{a.nodeValue=o}catch(g){Sl(t,t.return,g)}}break;case 3:if(mc(e,t),yc(t),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ve(e.containerInfo)}catch(g){Sl(t,t.return,g)}break;case 4:default:mc(e,t),yc(t);break;case 13:mc(e,t),yc(t),8192&(a=t.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Uc=Jt())),4&r&&pc(t);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&t.mode?(Qs=(u=Qs)||h,mc(e,t),Qs=u):mc(e,t),yc(t),8192&r){if(u=null!==t.memoizedState,(t.stateNode.isHidden=u)&&!h&&0!==(1&t.mode))for($s=t,h=t.child;null!==h;){for(d=$s=h;null!==$s;){switch(p=(f=$s).child,f.tag){case 0:case 11:case 14:case 15:nc(4,f,f.return);break;case 1:Zs(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(g){Sl(r,n,g)}}break;case 5:Zs(f,f.return);break;case 22:if(null!==f.memoizedState){xc(d);continue}}null!==p?(p.return=f,$s=p):xc(d)}h=h.sibling}t:for(h=null,d=t;;){if(5===d.tag){if(null===h){h=d;try{a=d.stateNode,u?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(c=d.stateNode,s=void 0!==(l=d.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null,c.style.display=mt("display",s))}catch(g){Sl(t,t.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Sl(t,t.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===t)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===t)break t;for(;null===d.sibling;){if(null===d.return||d.return===t)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:mc(e,t),yc(t),4&r&&pc(t);case 21:}}function yc(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(oc(n)){var r=n;break t}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(dt(a,""),r.flags&=-33),lc(t,sc(t),a);break;case 3:case 4:var o=r.stateNode.containerInfo;cc(t,sc(t),o);break;default:throw Error(i(161))}}catch(s){Sl(t,t.return,s)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function vc(t,e,n){$s=t,bc(t,e,n)}function bc(t,e,n){for(var r=0!==(1&t.mode);null!==$s;){var a=$s,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Ys;if(!o){var s=a.alternate,c=null!==s&&null!==s.memoizedState||Qs;s=Ys;var l=Qs;if(Ys=o,(Qs=c)&&!l)for($s=a;null!==$s;)c=(o=$s).child,22===o.tag&&null!==o.memoizedState?kc(a):null!==c?(c.return=o,$s=c):kc(a);for(;null!==i;)$s=i,bc(i,e,n),i=i.sibling;$s=a,Ys=s,Qs=l}wc(t)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,$s=i):wc(t)}}function wc(t){for(;null!==$s;){var e=$s;if(0!==(8772&e.flags)){var n=e.alternate;try{if(0!==(8772&e.flags))switch(e.tag){case 0:case 11:case 15:Qs||rc(5,e);break;case 1:var r=e.stateNode;if(4&e.flags&&!Qs)if(null===n)r.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:ns(e.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;null!==o&&Wi(e,o,r);break;case 3:var s=e.updateQueue;if(null!==s){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Wi(e,s,n)}break;case 5:var c=e.stateNode;if(null===n&&4&e.flags){n=c;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var u=e.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Ve(d)}}}break;default:throw Error(i(163))}Qs||512&e.flags&&ac(e)}catch(f){Sl(e,e.return,f)}}if(e===t){$s=null;break}if(null!==(n=e.sibling)){n.return=e.return,$s=n;break}$s=e.return}}function xc(t){for(;null!==$s;){var e=$s;if(e===t){$s=null;break}var n=e.sibling;if(null!==n){n.return=e.return,$s=n;break}$s=e.return}}function kc(t){for(;null!==$s;){var e=$s;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{rc(4,e)}catch(c){Sl(e,n,c)}break;case 1:var r=e.stateNode;if("function"===typeof r.componentDidMount){var a=e.return;try{r.componentDidMount()}catch(c){Sl(e,a,c)}}var i=e.return;try{ac(e)}catch(c){Sl(e,i,c)}break;case 5:var o=e.return;try{ac(e)}catch(c){Sl(e,o,c)}}}catch(c){Sl(e,e.return,c)}if(e===t){$s=null;break}var s=e.sibling;if(null!==s){s.return=e.return,$s=s;break}$s=e.return}}var _c,Sc=Math.ceil,Tc=w.ReactCurrentDispatcher,Ic=w.ReactCurrentOwner,Ec=w.ReactCurrentBatchConfig,Nc=0,Cc=null,Ac=null,Rc=0,Oc=0,Dc=Sa(0),Mc=0,Fc=null,Pc=0,Lc=0,zc=0,Bc=null,jc=null,Uc=0,Vc=1/0,Wc=null,Gc=!1,Hc=null,qc=null,Kc=!1,Xc=null,Yc=0,Qc=0,Jc=null,$c=-1,Zc=0;function tl(){return 0!==(6&Nc)?Jt():-1!==$c?$c:$c=Jt()}function el(t){return 0===(1&t.mode)?1:0!==(2&Nc)&&0!==Rc?Rc&-Rc:null!==mi.transition?(0===Zc&&(Zc=me()),Zc):0!==(t=be)?t:t=void 0===(t=window.event)?16:Qe(t.type)}function nl(t,e,n,r){if(50<Qc)throw Qc=0,Jc=null,Error(i(185));ye(t,n,r),0!==(2&Nc)&&t===Cc||(t===Cc&&(0===(2&Nc)&&(Lc|=n),4===Mc&&sl(t,Rc)),rl(t,r),1===n&&0===Nc&&0===(1&e.mode)&&(Vc=Jt()+500,Ba&&Va()))}function rl(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-oe(i),s=1<<o,c=a[o];-1===c?0!==(s&n)&&0===(s&r)||(a[o]=fe(s,e)):c<=e&&(t.expiredLanes|=s),i&=~s}}(t,e);var r=de(t,t===Cc?Rc:0);if(0===r)null!==n&&Xt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(null!=n&&Xt(n),1===e)0===t.tag?function(t){Ba=!0,Ua(t)}(cl.bind(null,t)):Ua(cl.bind(null,t)),oa(function(){0===(6&Nc)&&Va()}),n=null;else{switch(we(r)){case 1:n=Zt;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=re}n=Cl(n,al.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function al(t,e){if($c=-1,Zc=0,0!==(6&Nc))throw Error(i(327));var n=t.callbackNode;if(kl()&&t.callbackNode!==n)return null;var r=de(t,t===Cc?Rc:0);if(0===r)return null;if(0!==(30&r)||0!==(r&t.expiredLanes)||e)e=gl(t,r);else{e=r;var a=Nc;Nc|=2;var o=pl();for(Cc===t&&Rc===e||(Wc=null,Vc=Jt()+500,dl(t,e));;)try{vl();break}catch(c){fl(t,c)}Ii(),Tc.current=o,Nc=a,null!==Ac?e=0:(Cc=null,Rc=0,e=Mc)}if(0!==e){if(2===e&&(0!==(a=pe(t))&&(r=a,e=il(t,a))),1===e)throw n=Fc,dl(t,0),sl(t,r),rl(t,Jt()),n;if(6===e)sl(t,r);else{if(a=t.current.alternate,0===(30&r)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(a)&&(2===(e=gl(t,r))&&(0!==(o=pe(t))&&(r=o,e=il(t,o))),1===e))throw n=Fc,dl(t,0),sl(t,r),rl(t,Jt()),n;switch(t.finishedWork=a,t.finishedLanes=r,e){case 0:case 1:throw Error(i(345));case 2:case 5:xl(t,jc,Wc);break;case 3:if(sl(t,r),(130023424&r)===r&&10<(e=Uc+500-Jt())){if(0!==de(t,0))break;if(((a=t.suspendedLanes)&r)!==r){tl(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=ra(xl.bind(null,t,jc,Wc),e);break}xl(t,jc,Wc);break;case 4:if(sl(t,r),(4194240&r)===r)break;for(e=t.eventTimes,a=-1;0<r;){var s=31-oe(r);o=1<<s,(s=e[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Jt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Sc(r/1960))-r)){t.timeoutHandle=ra(xl.bind(null,t,jc,Wc),r);break}xl(t,jc,Wc);break;default:throw Error(i(329))}}}return rl(t,Jt()),t.callbackNode===n?al.bind(null,t):null}function il(t,e){var n=Bc;return t.current.memoizedState.isDehydrated&&(dl(t,e).flags|=256),2!==(t=gl(t,e))&&(e=jc,jc=n,null!==e&&ol(e)),t}function ol(t){null===jc?jc=t:jc.push.apply(jc,t)}function sl(t,e){for(e&=~zc,e&=~Lc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-oe(e),r=1<<n;t[n]=-1,e&=~r}}function cl(t){if(0!==(6&Nc))throw Error(i(327));kl();var e=de(t,0);if(0===(1&e))return rl(t,Jt()),null;var n=gl(t,e);if(0!==t.tag&&2===n){var r=pe(t);0!==r&&(e=r,n=il(t,r))}if(1===n)throw n=Fc,dl(t,0),sl(t,e),rl(t,Jt()),n;if(6===n)throw Error(i(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xl(t,jc,Wc),rl(t,Jt()),null}function ll(t,e){var n=Nc;Nc|=1;try{return t(e)}finally{0===(Nc=n)&&(Vc=Jt()+500,Ba&&Va())}}function ul(t){null!==Xc&&0===Xc.tag&&0===(6&Nc)&&kl();var e=Nc;Nc|=1;var n=Ec.transition,r=be;try{if(Ec.transition=null,be=1,t)return t()}finally{be=r,Ec.transition=n,0===(6&(Nc=e))&&Va()}}function hl(){Oc=Dc.current,Ta(Dc)}function dl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,aa(n)),null!==Ac)for(n=Ac.return;null!==n;){var r=n;switch(ei(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Da();break;case 3:Qi(),Ta(Ca),Ta(Na),no();break;case 5:$i(r);break;case 4:Qi();break;case 13:case 19:Ta(Zi);break;case 10:Ei(r.type._context);break;case 22:case 23:hl()}n=n.return}if(Cc=t,Ac=t=Dl(t.current,null),Rc=Oc=e,Mc=0,Fc=null,zc=Lc=Pc=0,jc=Bc=null,null!==Ri){for(e=0;e<Ri.length;e++)if(null!==(r=(n=Ri[e]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}Ri=null}return t}function fl(t,e){for(;;){var n=Ac;try{if(Ii(),ro.current=$o,lo){for(var r=oo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}lo=!1}if(io=0,co=so=oo=null,uo=!1,ho=0,Ic.current=null,null===n||null===n.return){Mc=1,Fc=e,Ac=null;break}t:{var o=t,s=n.return,c=n,l=e;if(e=Rc,c.flags|=32768,null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=l,h=c,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=gs(s);if(null!==p){p.flags&=-257,ys(p,s,c,0,e),1&p.mode&&ms(o,u,e),l=u;var m=(e=p).updateQueue;if(null===m){var g=new Set;g.add(l),e.updateQueue=g}else m.add(l);break t}if(0===(1&e)){ms(o,u,e),ml();break t}l=Error(i(426))}else if(ai&&1&c.mode){var y=gs(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ys(y,s,c,0,e),pi(ls(l,c));break t}}o=l=ls(l,c),4!==Mc&&(Mc=2),null===Bc?Bc=[o]:Bc.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e,Ui(o,fs(0,l,e));break t;case 1:c=l;var v=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qc||!qc.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e,Ui(o,ps(o,c,e));break t}}o=o.return}while(null!==o)}wl(n)}catch(w){e=w,Ac===n&&null!==n&&(Ac=n=n.return);continue}break}}function pl(){var t=Tc.current;return Tc.current=$o,null===t?$o:t}function ml(){0!==Mc&&3!==Mc&&2!==Mc||(Mc=4),null===Cc||0===(268435455&Pc)&&0===(268435455&Lc)||sl(Cc,Rc)}function gl(t,e){var n=Nc;Nc|=2;var r=pl();for(Cc===t&&Rc===e||(Wc=null,dl(t,e));;)try{yl();break}catch(a){fl(t,a)}if(Ii(),Nc=n,Tc.current=r,null!==Ac)throw Error(i(261));return Cc=null,Rc=0,Mc}function yl(){for(;null!==Ac;)bl(Ac)}function vl(){for(;null!==Ac&&!Yt();)bl(Ac)}function bl(t){var e=_c(t.alternate,t,Oc);t.memoizedProps=t.pendingProps,null===e?wl(t):Ac=e,Ic.current=null}function wl(t){var e=t;do{var n=e.alternate;if(t=e.return,0===(32768&e.flags)){if(null!==(n=Ks(n,e,Oc)))return void(Ac=n)}else{if(null!==(n=Xs(n,e)))return n.flags&=32767,void(Ac=n);if(null===t)return Mc=6,void(Ac=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Ac=e);Ac=e=t}while(null!==e);0===Mc&&(Mc=5)}function xl(t,e,n){var r=be,a=Ec.transition;try{Ec.transition=null,be=1,function(t,e,n,r){do{kl()}while(null!==Xc);if(0!==(6&Nc))throw Error(i(327));n=t.finishedWork;var a=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(i(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-oe(n),i=1<<a;e[a]=0,r[a]=-1,t[a]=-1,n&=~i}}(t,o),t===Cc&&(Ac=Cc=null,Rc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kc||(Kc=!0,Cl(ee,function(){return kl(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Ec.transition,Ec.transition=null;var s=be;be=1;var c=Nc;Nc|=4,Ic.current=null,function(t,e){if(ta=Ge,fr(t=dr())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var r=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(x){n=null;break t}var s=0,c=-1,l=-1,u=0,h=0,d=t,f=null;e:for(;;){for(var p;d!==n||0!==a&&3!==d.nodeType||(c=s+a),d!==o||0!==r&&3!==d.nodeType||(l=s+r),3===d.nodeType&&(s+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===t)break e;if(f===n&&++u===a&&(c=s),f===o&&++h===r&&(l=s),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ea={focusedElem:t,selectionRange:n},Ge=!1,$s=e;null!==$s;)if(t=(e=$s).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,$s=t;else for(;null!==$s;){e=$s;try{var m=e.alternate;if(0!==(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=e.stateNode,b=v.getSnapshotBeforeUpdate(e.elementType===e.type?g:ns(e.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=e.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(x){Sl(e,e.return,x)}if(null!==(t=e.sibling)){t.return=e.return,$s=t;break}$s=e.return}m=ec,ec=!1}(t,n),gc(n,t),pr(ea),Ge=!!ta,ea=ta=null,t.current=n,vc(n,t,a),Qt(),Nc=c,be=s,Ec.transition=o}else t.current=n;if(Kc&&(Kc=!1,Xc=t,Yc=a),o=t.pendingLanes,0===o&&(qc=null),function(t){if(ie&&"function"===typeof ie.onCommitFiberRoot)try{ie.onCommitFiberRoot(ae,t,void 0,128===(128&t.current.flags))}catch(e){}}(n.stateNode),rl(t,Jt()),null!==e)for(r=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Gc)throw Gc=!1,t=Hc,Hc=null,t;0!==(1&Yc)&&0!==t.tag&&kl(),o=t.pendingLanes,0!==(1&o)?t===Jc?Qc++:(Qc=0,Jc=t):Qc=0,Va()}(t,e,n,r)}finally{Ec.transition=a,be=r}return null}function kl(){if(null!==Xc){var t=we(Yc),e=Ec.transition,n=be;try{if(Ec.transition=null,be=16>t?16:t,null===Xc)var r=!1;else{if(t=Xc,Xc=null,Yc=0,0!==(6&Nc))throw Error(i(331));var a=Nc;for(Nc|=4,$s=t.current;null!==$s;){var o=$s,s=o.child;if(0!==(16&$s.flags)){var c=o.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for($s=u;null!==$s;){var h=$s;switch(h.tag){case 0:case 11:case 15:nc(8,h,o)}var d=h.child;if(null!==d)d.return=h,$s=d;else for(;null!==$s;){var f=(h=$s).sibling,p=h.return;if(ic(h),h===u){$s=null;break}if(null!==f){f.return=p,$s=f;break}$s=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}$s=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,$s=s;else t:for(;null!==$s;){if(0!==(2048&(o=$s).flags))switch(o.tag){case 0:case 11:case 15:nc(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,$s=v;break t}$s=o.return}}var b=t.current;for($s=b;null!==$s;){var w=(s=$s).child;if(0!==(2064&s.subtreeFlags)&&null!==w)w.return=s,$s=w;else t:for(s=b;null!==$s;){if(0!==(2048&(c=$s).flags))try{switch(c.tag){case 0:case 11:case 15:rc(9,c)}}catch(k){Sl(c,c.return,k)}if(c===s){$s=null;break t}var x=c.sibling;if(null!==x){x.return=c.return,$s=x;break t}$s=c.return}}if(Nc=a,Va(),ie&&"function"===typeof ie.onPostCommitFiberRoot)try{ie.onPostCommitFiberRoot(ae,t)}catch(k){}r=!0}return r}finally{be=n,Ec.transition=e}}return!1}function _l(t,e,n){t=Bi(t,e=fs(0,e=ls(n,e),1),1),e=tl(),null!==t&&(ye(t,1,e),rl(t,e))}function Sl(t,e,n){if(3===t.tag)_l(t,t,n);else for(;null!==e;){if(3===e.tag){_l(e,t,n);break}if(1===e.tag){var r=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qc||!qc.has(r))){e=Bi(e,t=ps(e,t=ls(n,t),1),1),t=tl(),null!==e&&(ye(e,1,t),rl(e,t));break}}e=e.return}}function Tl(t,e,n){var r=t.pingCache;null!==r&&r.delete(e),e=tl(),t.pingedLanes|=t.suspendedLanes&n,Cc===t&&(Rc&n)===n&&(4===Mc||3===Mc&&(130023424&Rc)===Rc&&500>Jt()-Uc?dl(t,0):zc|=n),rl(t,e)}function Il(t,e){0===e&&(0===(1&t.mode)?e=1:(e=ue,0===(130023424&(ue<<=1))&&(ue=4194304)));var n=tl();null!==(t=Mi(t,e))&&(ye(t,e,n),rl(t,n))}function El(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Il(t,n)}function Nl(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(e),Il(t,n)}function Cl(t,e){return Kt(t,e)}function Al(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rl(t,e,n,r){return new Al(t,e,n,r)}function Ol(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Dl(t,e){var n=t.alternate;return null===n?((n=Rl(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ml(t,e,n,r,a,o){var s=2;if(r=t,"function"===typeof t)Ol(t)&&(s=1);else if("string"===typeof t)s=5;else t:switch(t){case _:return Fl(n.children,a,o,e);case S:s=8,a|=8;break;case T:return(t=Rl(12,n,e,2|a)).elementType=T,t.lanes=o,t;case C:return(t=Rl(13,n,e,a)).elementType=C,t.lanes=o,t;case A:return(t=Rl(19,n,e,a)).elementType=A,t.lanes=o,t;case D:return Pl(n,a,o,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case I:s=10;break t;case E:s=9;break t;case N:s=11;break t;case R:s=14;break t;case O:s=16,r=null;break t}throw Error(i(130,null==t?t:typeof t,""))}return(e=Rl(s,n,e,a)).elementType=t,e.type=r,e.lanes=o,e}function Fl(t,e,n,r){return(t=Rl(7,t,r,e)).lanes=n,t}function Pl(t,e,n,r){return(t=Rl(22,t,r,e)).elementType=D,t.lanes=n,t.stateNode={isHidden:!1},t}function Ll(t,e,n){return(t=Rl(6,t,null,e)).lanes=n,t}function zl(t,e,n){return(e=Rl(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Bl(t,e,n,r,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function jl(t,e,n,r,a,i,o,s,c){return t=new Bl(t,e,n,s,c),1===e?(e=1,!0===i&&(e|=8)):e=0,i=Rl(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pi(i),t}function Ul(t){if(!t)return Ea;t:{if(Vt(t=t._reactInternals)!==t||1!==t.tag)throw Error(i(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Oa(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(i(171))}if(1===t.tag){var n=t.type;if(Oa(n))return Fa(t,n,e)}return e}function Vl(t,e,n,r,a,i,o,s,c){return(t=jl(n,r,!0,t,0,i,0,s,c)).context=Ul(null),n=t.current,(i=zi(r=tl(),a=el(n))).callback=void 0!==e&&null!==e?e:null,Bi(n,i,a),t.current.lanes=a,ye(t,a,r),rl(t,r),t}function Wl(t,e,n,r){var a=e.current,i=tl(),o=el(a);return n=Ul(n),null===e.context?e.context=n:e.pendingContext=n,(e=zi(i,o)).payload={element:t},null!==(r=void 0===r?null:r)&&(e.callback=r),null!==(t=Bi(a,e,o))&&(nl(t,a,o,i),ji(t,a,o)),o}function Gl(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Hl(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function ql(t,e){Hl(t,e),(t=t.alternate)&&Hl(t,e)}_c=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Ca.current)bs=!0;else{if(0===(t.lanes&n)&&0===(128&e.flags))return bs=!1,function(t,e,n){switch(e.tag){case 3:Cs(e),fi();break;case 5:Ji(e);break;case 1:Oa(e.type)&&Pa(e);break;case 4:Yi(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;Ia(ki,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=e.memoizedState))return null!==r.dehydrated?(Ia(Zi,1&Zi.current),e.flags|=128,null):0!==(n&e.child.childLanes)?Ls(t,e,n):(Ia(Zi,1&Zi.current),null!==(t=Gs(t,e,n))?t.sibling:null);Ia(Zi,1&Zi.current);break;case 19:if(r=0!==(n&e.childLanes),0!==(128&t.flags)){if(r)return Vs(t,e,n);e.flags|=128}if(null!==(a=e.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ia(Zi,Zi.current),r)break;return null;case 22:case 23:return e.lanes=0,Ss(t,e,n)}return Gs(t,e,n)}(t,e,n);bs=0!==(131072&t.flags)}else bs=!1,ai&&0!==(1048576&e.flags)&&Za(e,qa,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ws(t,e),t=e.pendingProps;var a=Ra(e,Na.current);Ci(e,n),a=go(null,e,r,t,a,n);var o=yo();return e.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Oa(r)?(o=!0,Pa(e)):o=!1,e.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Pi(e),a.updater=as,e.stateNode=a,a._reactInternals=e,cs(e,r,t,n),e=Ns(null,e,r,!0,o,n)):(e.tag=0,ai&&o&&ti(e),ws(null,e,a,n),e=e.child),e;case 16:r=e.elementType;t:{switch(Ws(t,e),t=e.pendingProps,r=(a=r._init)(r._payload),e.type=r,a=e.tag=function(t){if("function"===typeof t)return Ol(t)?1:0;if(void 0!==t&&null!==t){if((t=t.$$typeof)===N)return 11;if(t===R)return 14}return 2}(r),t=ns(r,t),a){case 0:e=Is(null,e,r,t,n);break t;case 1:e=Es(null,e,r,t,n);break t;case 11:e=xs(null,e,r,t,n);break t;case 14:e=ks(null,e,r,ns(r.type,t),n);break t}throw Error(i(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,Is(t,e,r,a=e.elementType===r?a:ns(r,a),n);case 1:return r=e.type,a=e.pendingProps,Es(t,e,r,a=e.elementType===r?a:ns(r,a),n);case 3:t:{if(Cs(e),null===t)throw Error(i(387));r=e.pendingProps,a=(o=e.memoizedState).element,Li(t,e),Vi(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,256&e.flags){e=As(t,e,r,n,a=ls(Error(i(423)),e));break t}if(r!==a){e=As(t,e,r,n,a=ls(Error(i(424)),e));break t}for(ri=la(e.stateNode.containerInfo.firstChild),ni=e,ai=!0,ii=null,n=xi(e,null,r,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===a){e=Gs(t,e,n);break t}ws(t,e,r,n)}e=e.child}return e;case 5:return Ji(e),null===t&&li(e),r=e.type,a=e.pendingProps,o=null!==t?t.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(e.flags|=32),Ts(t,e),ws(t,e,s,n),e.child;case 6:return null===t&&li(e),null;case 13:return Ls(t,e,n);case 4:return Yi(e,e.stateNode.containerInfo),r=e.pendingProps,null===t?e.child=wi(e,null,r,n):ws(t,e,r,n),e.child;case 11:return r=e.type,a=e.pendingProps,xs(t,e,r,a=e.elementType===r?a:ns(r,a),n);case 7:return ws(t,e,e.pendingProps,n),e.child;case 8:case 12:return ws(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(r=e.type._context,a=e.pendingProps,o=e.memoizedProps,s=a.value,Ia(ki,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!Ca.current){e=Gs(t,e,n);break t}}else for(null!==(o=e.child)&&(o.return=e);null!==o;){var c=o.dependencies;if(null!==c){s=o.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===o.tag){(l=zi(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ni(o.return,n,e),c.lanes|=n;break}l=l.next}}else if(10===o.tag)s=o.type===e.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Ni(s,n,e),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===e){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ws(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,Ci(e,n),r=r(a=Ai(a)),e.flags|=1,ws(t,e,r,n),e.child;case 14:return a=ns(r=e.type,e.pendingProps),ks(t,e,r,a=ns(r.type,a),n);case 15:return _s(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:ns(r,a),Ws(t,e),e.tag=1,Oa(r)?(t=!0,Pa(e)):t=!1,Ci(e,n),os(e,r,a),cs(e,r,a,n),Ns(null,e,r,!0,t,n);case 19:return Vs(t,e,n);case 22:return Ss(t,e,n)}throw Error(i(156,e.tag))};var Kl="function"===typeof reportError?reportError:function(t){console.error(t)};function Xl(t){this._internalRoot=t}function Yl(t){this._internalRoot=t}function Ql(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Jl(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function $l(){}function Zl(t,e,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var t=Gl(o);s.call(t)}}Wl(e,o,t,a)}else o=function(t,e,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var t=Gl(o);i.call(t)}}var o=Vl(e,r,t,0,null,!1,0,"",$l);return t._reactRootContainer=o,t[pa]=o.current,Vr(8===t.nodeType?t.parentNode:t),ul(),o}for(;a=t.lastChild;)t.removeChild(a);if("function"===typeof r){var s=r;r=function(){var t=Gl(c);s.call(t)}}var c=jl(t,0,!1,null,0,!1,0,"",$l);return t._reactRootContainer=c,t[pa]=c.current,Vr(8===t.nodeType?t.parentNode:t),ul(function(){Wl(e,c,n,r)}),c}(n,e,t,a,r);return Gl(o)}Yl.prototype.render=Xl.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(i(409));Wl(t,e,null,null)},Yl.prototype.unmount=Xl.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;ul(function(){Wl(null,t,null,null)}),e[pa]=null}},Yl.prototype.unstable_scheduleHydration=function(t){if(t){var e=Se();t={blockedOn:null,target:t,priority:e};for(var n=0;n<De.length&&0!==e&&e<De[n].priority;n++);De.splice(n,0,t),0===n&&Le(t)}},xe=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(ve(e,1|n),rl(e,Jt()),0===(6&Nc)&&(Vc=Jt()+500,Va()))}break;case 13:ul(function(){var e=Mi(t,1);if(null!==e){var n=tl();nl(e,t,1,n)}}),ql(t,1)}},ke=function(t){if(13===t.tag){var e=Mi(t,134217728);if(null!==e)nl(e,t,134217728,tl());ql(t,134217728)}},_e=function(t){if(13===t.tag){var e=el(t),n=Mi(t,e);if(null!==n)nl(n,t,e,tl());ql(t,e)}},Se=function(){return be},Te=function(t,e){var n=be;try{return be=t,e()}finally{be=n}},kt=function(t,e,n){switch(e){case"input":if($(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var a=xa(r);if(!a)throw Error(i(90));K(r),$(r,a)}}}break;case"textarea":it(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},Nt=ll,Ct=ul;var tu={usingClientEntryPoint:!1,Events:[ba,wa,xa,It,Et,ll]},eu={findFiberByHostInstance:va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Ht(t))?null:t.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{ae=ru.inject(nu),ie=ru}catch(ut){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Ql(e))throw Error(i(200));return function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!Ql(t))throw Error(i(299));var n=!1,r="",a=Kl;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(r=e.identifierPrefix),void 0!==e.onRecoverableError&&(a=e.onRecoverableError)),e=jl(t,1,!1,null,0,n,0,r,a),t[pa]=e.current,Vr(8===t.nodeType?t.parentNode:t),new Xl(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(i(188));throw t=Object.keys(t).join(","),Error(i(268,t))}return t=null===(t=Ht(e))?null:t.stateNode},e.flushSync=function(t){return ul(t)},e.hydrate=function(t,e,n){if(!Jl(e))throw Error(i(200));return Zl(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!Ql(t))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Kl;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),e=Vl(e,null,t,1,null!=n?n:null,a,0,o,s),t[pa]=e.current,Vr(t),r)for(t=0;t<r.length;t++)a=(a=(n=r[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new Yl(e)},e.render=function(t,e,n){if(!Jl(e))throw Error(i(200));return Zl(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Jl(t))throw Error(i(40));return!!t._reactRootContainer&&(ul(function(){Zl(null,null,t,!1,function(){t._reactRootContainer=null,t[pa]=null})}),!0)},e.unstable_batchedUpdates=ll,e.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Jl(n))throw Error(i(200));if(null==t||void 0===t._reactInternals)throw Error(i(38));return Zl(t,e,n,!1,r)},e.version="18.3.1-next-f1338f8080-20240426"},2742:(t,e,n)=>{"use strict";var r=n(2727);t.exports=r},2761:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},2771:(t,e,n)=>{"use strict";var r=n(2203),a=n(4508),i=n(6929),o=n(6381),s=n(6586),c=TypeError;t.exports=function(t,e){var n=arguments.length<2?s(t):e;if(a(n))return i(r(n,t));throw new c(o(t)+" is not iterable")}},2777:(t,e,n)=>{var r=n(5193),a=n(2761),i=Object.prototype,o=i.hasOwnProperty,s=i.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(t){return a(t)&&o.call(t,"callee")&&!s.call(t,"callee")};t.exports=c},2820:(t,e,n)=>{var r=n(1137),a=n(7892),i=n(7823),o=n(9168),s=n(1452),c=n(494),l=n(1178),u=Object.getOwnPropertyDescriptor;e.f=r?u:function(t,e){if(t=o(t),e=s(e),l)try{return u(t,e)}catch(n){}if(c(t,e))return i(!a.f.call(t,e),t[e])}},2929:(t,e,n)=>{var r=n(6552).Uint8Array;t.exports=r},3005:(t,e,n)=>{"use strict";var r=n(5313),a=n(4071),i=n(6249),o=n(607).f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});a(e,t)||o(e,t,{value:i.f(t)})}},3017:(t,e,n)=>{var r=n(6680),a=n(8210),i=Function.toString;r(a.inspectSource)||(a.inspectSource=function(t){return i.call(t)}),t.exports=a.inspectSource},3028:t=>{t.exports=function(t,e){return function(n){return t(e(n))}}},3086:(t,e,n)=>{"use strict";var r=n(5534);t.exports=r},3148:t=>{var e=Math.ceil,n=Math.floor;t.exports=function(t){var r=+t;return r!==r||0===r?0:(r>0?n:e)(r)}},3204:(t,e,n)=>{var r=n(3343),a=n(2777),i=n(4052),o=n(4543),s=n(9194),c=n(1268),l=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=i(t),u=!n&&a(t),h=!n&&!u&&o(t),d=!n&&!u&&!h&&c(t),f=n||u||h||d,p=f?r(t.length,String):[],m=p.length;for(var g in t)!e&&!l.call(t,g)||f&&("length"==g||h&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,m))||p.push(g);return p}},3211:t=>{t.exports=function(t,e){return t===e||t!==t&&e!==e}},3212:(t,e,n)=>{"use strict";var r=n(4607);t.exports=r},3218:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},3220:(t,e,n)=>{"use strict";var r=n(607);t.exports=function(t,e,n){return r.f(t,e,n)}},3226:(t,e,n)=>{"use strict";n(4814),n(5530);var r=n(6249);t.exports=r.f("toPrimitive")},3234:(t,e,n)=>{"use strict";var r=n(7800),a=n(2203),i=n(2545),o=n(228),s=n(9607),c=n(5388),l=n(4433),u=n(9645),h=n(473),d=n(9825),f=n(5718),p=n(4205),m=n(6891),g=n(5039),y=o.PROPER,v=o.CONFIGURABLE,b=g.IteratorPrototype,w=g.BUGGY_SAFARI_ITERATORS,x=p("iterator"),k="keys",_="values",S="entries",T=function(){return this};t.exports=function(t,e,n,o,p,g,I){c(n,e,o);var E,N,C,A=function(t){if(t===p&&F)return F;if(!w&&t&&t in D)return D[t];switch(t){case k:case _:case S:return function(){return new n(this,t)}}return function(){return new n(this)}},R=e+" Iterator",O=!1,D=t.prototype,M=D[x]||D["@@iterator"]||p&&D[p],F=!w&&M||A(p),P="Array"===e&&D.entries||M;if(P&&(E=l(P.call(new t)))!==Object.prototype&&E.next&&(i||l(E)===b||(u?u(E,b):s(E[x])||f(E,x,T)),h(E,R,!0,!0),i&&(m[R]=T)),y&&p===_&&M&&M.name!==_&&(!i&&v?d(D,"name",_):(O=!0,F=function(){return a(M,this)})),p)if(N={values:A(_),keys:g?F:A(k),entries:A(S)},I)for(C in N)(w||O||!(C in D))&&f(D,C,N[C]);else r({target:e,proto:!0,forced:w||O},N);return i&&!I||D[x]===F||f(D,x,F,{name:p}),m[e]=F,N}},3239:(t,e,n)=>{"use strict";var r=n(1566),a=n(8366),i=n(8365),o=n(5231),s=n(5612),c=n(7403),l=a([].push),u=function(t){var e=1===t,n=2===t,a=3===t,u=4===t,h=6===t,d=7===t,f=5===t||h;return function(p,m,g,y){for(var v,b,w=o(p),x=i(w),k=s(x),_=r(m,g),S=0,T=y||c,I=e?T(p,k):n||d?T(p,0):void 0;k>S;S++)if((f||S in x)&&(b=_(v=x[S],S,w),t))if(e)I[S]=b;else if(b)switch(t){case 3:return!0;case 5:return v;case 6:return S;case 2:l(I,v)}else switch(t){case 4:return!1;case 7:l(I,v)}return h?-1:a||u?u:I}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},3255:(t,e,n)=>{"use strict";n(1762);var r=n(5313);t.exports=r.setInterval},3258:(t,e,n)=>{"use strict";n(6280);var r=n(8118);t.exports=r("Array","push")},3273:(t,e,n)=>{"use strict";var r=n(4702).navigator,a=r&&r.userAgent;t.exports=a?String(a):""},3334:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},3343:t=>{t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},3345:t=>{t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},3366:(t,e,n)=>{"use strict";n(3918),n(624);var r=n(5313);t.exports=r.Array.from},3440:(t,e,n)=>{var r=n(6552)["__core-js_shared__"];t.exports=r},3499:(t,e,n)=>{"use strict";var r=n(3366);t.exports=r},3559:(t,e,n)=>{"use strict";var r=n(7800),a=n(3570),i=n(607).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==i,sham:!a},{defineProperty:i})},3570:(t,e,n)=>{"use strict";var r=n(8445);t.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},3595:(t,e,n)=>{"use strict";var r=n(5334),a=n(1187),i=n(5900),o=n(4205)("species"),s=Array;t.exports=function(t){var e;return r(t)&&(e=t.constructor,(a(e)&&(e===s||r(e.prototype))||i(e)&&null===(e=e[o]))&&(e=void 0)),void 0===e?s:e}},3609:(t,e,n)=>{var r=n(1663);t.exports=function(t){return r(t.length)}},3657:(t,e,n)=>{"use strict";var r=n(766);n(6591),n(9844),n(153),n(9215),t.exports=r},3668:(t,e,n)=>{var r=n(8902),a=n(2587),i=n(8114);t.exports=function(t,e,n,o,s,c){var l=1&n,u=t.length,h=e.length;if(u!=h&&!(l&&h>u))return!1;var d=c.get(t),f=c.get(e);if(d&&f)return d==e&&f==t;var p=-1,m=!0,g=2&n?new r:void 0;for(c.set(t,e),c.set(e,t);++p<u;){var y=t[p],v=e[p];if(o)var b=l?o(v,y,p,e,t,c):o(y,v,p,t,e,c);if(void 0!==b){if(b)continue;m=!1;break}if(g){if(!a(e,function(t,e){if(!i(g,e)&&(y===t||s(y,t,n,o,c)))return g.push(e)})){m=!1;break}}else if(y!==v&&!s(y,v,n,o,c)){m=!1;break}}return c.delete(t),c.delete(e),m}},3684:(t,e,n)=>{"use strict";var r=n(2203),a=n(5749),i=n(4205),o=n(5718);t.exports=function(){var t=a("Symbol"),e=t&&t.prototype,n=e&&e.valueOf,s=i("toPrimitive");e&&!e[s]&&o(e,s,function(t){return r(n,this)},{arity:1})}},3713:(t,e,n)=>{var r=n(6140),a=n(1143),i=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return a(t);var e=[];for(var n in Object(t))i.call(t,n)&&"constructor"!=n&&e.push(n);return e}},3719:(t,e,n)=>{"use strict";n(3559);var r=n(5313).Object,a=t.exports=function(t,e,n){return r.defineProperty(t,e,n)};r.defineProperty.sham&&(a.sham=!0)},3734:(t,e,n)=>{"use strict";var r=n(9482),a=n(2721);t.exports=Object.keys||function(t){return r(t,a)}},3756:(t,e,n)=>{"use strict";var r=n(3499);t.exports=r},3816:(t,e,n)=>{"use strict";var r=n(4702),a=n(9607),i=r.WeakMap;t.exports=a(i)&&/native code/.test(String(i))},3841:(t,e,n)=>{var r=n(9168),a=n(6071),i=n(3609),o=function(t){return function(e,n,o){var s,c=r(e),l=i(c),u=a(o,l);if(t&&n!=n){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((t||u in c)&&c[u]===n)return t||u||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},3883:(t,e,n)=>{var r=n(6680),a=n(899);t.exports=function(t,e){var n,i;if("string"===e&&r(n=t.toString)&&!a(i=n.call(t)))return i;if(r(n=t.valueOf)&&!a(i=n.call(t)))return i;if("string"!==e&&r(n=t.toString)&&!a(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},3892:t=>{t.exports=function(t){return this.__data__.has(t)}},3918:(t,e,n)=>{"use strict";var r=n(4413).charAt,a=n(8777),i=n(1543),o=n(3234),s=n(8843),c="String Iterator",l=i.set,u=i.getterFor(c);o(String,"String",function(t){l(this,{type:c,string:a(t),index:0})},function(){var t,e=u(this),n=e.string,a=e.index;return a>=n.length?s(void 0,!0):(t=r(n,a),e.index+=t.length,s(t,!1))})},3930:(t,e,n)=>{t.exports=n(4402)},3943:(t,e,n)=>{"use strict";n(6756),n(6665),n(8237),n(855),n(9278),n(1249),n(302),n(6967),n(6178),n(5102),n(7921),n(2320),n(2315),n(9719),n(4717),n(1811),n(5530),n(2531),n(1700),n(4093),n(9073),n(7101);var r=n(5313);t.exports=r.Symbol},4e3:(t,e,n)=>{var r=n(3148),a=n(2174),i=n(3345),o=function(t){return function(e,n){var o,s,c=a(i(e)),l=r(n),u=c.length;return l<0||l>=u?t?"":void 0:(o=c.charCodeAt(l))<55296||o>56319||l+1===u||(s=c.charCodeAt(l+1))<56320||s>57343?t?c.charAt(l):o:t?c.slice(l,l+2):s-56320+(o-55296<<10)+65536}};t.exports={codeAt:o(!1),charAt:o(!0)}},4007:(t,e,n)=>{"use strict";n(3005)("observable")},4023:(t,e,n)=>{var r=n(9846),a=n(1500).RegExp;e.UNSUPPORTED_Y=r(function(){var t=a("a","y");return t.lastIndex=2,null!=t.exec("abcd")}),e.BROKEN_CARET=r(function(){var t=a("^r","gy");return t.lastIndex=2,null!=t.exec("str")})},4044:(t,e,n)=>{"use strict";n(7800)({target:"Math",stat:!0},{sign:n(4864)})},4052:t=>{var e=Array.isArray;t.exports=e},4071:(t,e,n)=>{"use strict";var r=n(8366),a=n(5231),i=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return i(a(t),e)}},4078:(t,e,n)=>{"use strict";var r=n(1363),a=n(1786),i=Array.prototype;t.exports=function(t){var e=t.concat;return t===i||r(i,t)&&e===i.concat?a:e}},4093:(t,e,n)=>{"use strict";var r=n(4702);n(473)(r.JSON,"JSON",!0)},4095:(t,e,n)=>{"use strict";var r=n(5686);t.exports=r},4102:(t,e,n)=>{"use strict";var r=n(4702),a=n(375),i=n(9607),o=n(8885),s=n(3273),c=n(78),l=n(8006),u=r.Function,h=/MSIE .\./.test(s)||"BUN"===o&&function(){var t=r.Bun.version.split(".");return t.length<3||"0"===t[0]&&(t[1]<3||"3"===t[1]&&"0"===t[2])}();t.exports=function(t,e){var n=e?2:1;return h?function(r,o){var s=l(arguments.length,1)>n,h=i(r)?r:u(r),d=s?c(arguments,n):[],f=s?function(){a(h,this,d)}:h;return e?t(f,o):t(f)}:t}},4110:(t,e,n)=>{"use strict";var r=n(7800),a=n(5231),i=n(3734);r({target:"Object",stat:!0,forced:n(8445)(function(){i(1)})},{keys:function(t){return i(a(t))}})},4121:(t,e,n)=>{var r=n(899);t.exports=function(t){if(r(t))return t;throw TypeError(String(t)+" is not an object")}},4136:(t,e,n)=>{"use strict";var r=n(2202),a=n(7555),i=n(6434).f,o=n(78),s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"Window"===r(t)?function(t){try{return i(t)}catch(e){return o(s)}}(t):i(a(t))}},4160:t=>{t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}},4177:function(t,e){var n,r,a;r=[t],n=function(t){"use strict";function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var a={order:2,precision:2,period:null};function i(t,e){var n=[],r=[];t.forEach(function(t,a){null!==t[1]&&(r.push(t),n.push(e[a]))});var a=r.reduce(function(t,e){return t+e[1]},0)/r.length,i=r.reduce(function(t,e){var n=e[1]-a;return t+n*n},0);return 1-r.reduce(function(t,e,r){var a=n[r],i=e[1]-a[1];return t+i*i},0)/i}function o(t,e){for(var n=t,r=t.length-1,a=[e],i=0;i<r;i++){for(var o=i,s=i+1;s<r;s++)Math.abs(n[i][s])>Math.abs(n[i][o])&&(o=s);for(var c=i;c<r+1;c++){var l=n[c][i];n[c][i]=n[c][o],n[c][o]=l}for(var u=i+1;u<r;u++)for(var h=r;h>=i;h--)n[h][u]-=n[h][i]*n[i][u]/n[i][i]}for(var d=r-1;d>=0;d--){for(var f=0,p=d+1;p<r;p++)f+=n[p][d]*a[p];a[d]=(n[r][d]-f)/n[d][d]}return a}function s(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var c={linear:function(t,e){for(var n=[0,0,0,0,0],r=0,a=0;a<t.length;a++)null!==t[a][1]&&(r++,n[0]+=t[a][0],n[1]+=t[a][1],n[2]+=t[a][0]*t[a][0],n[3]+=t[a][0]*t[a][1],n[4]+=t[a][1]*t[a][1]);var o=r*n[2]-n[0]*n[0],c=r*n[3]-n[0]*n[1],l=0===o?0:s(c/o,e.precision),u=s(n[1]/r-l*n[0]/r,e.precision),h=function(t){return[s(t,e.precision),s(l*t+u,e.precision)]},d=t.map(function(t){return h(t[0])});return{points:d,predict:h,equation:[l,u],r2:s(i(t,d),e.precision),string:0===u?"y = "+l+"x":"y = "+l+"x + "+u}},exponential:function(t,e){for(var n=[0,0,0,0,0,0],r=0;r<t.length;r++)null!==t[r][1]&&(n[0]+=t[r][0],n[1]+=t[r][1],n[2]+=t[r][0]*t[r][0]*t[r][1],n[3]+=t[r][1]*Math.log(t[r][1]),n[4]+=t[r][0]*t[r][1]*Math.log(t[r][1]),n[5]+=t[r][0]*t[r][1]);var a=n[1]*n[2]-n[5]*n[5],o=Math.exp((n[2]*n[3]-n[5]*n[4])/a),c=(n[1]*n[4]-n[5]*n[3])/a,l=s(o,e.precision),u=s(c,e.precision),h=function(t){return[s(t,e.precision),s(l*Math.exp(u*t),e.precision)]},d=t.map(function(t){return h(t[0])});return{points:d,predict:h,equation:[l,u],string:"y = "+l+"e^("+u+"x)",r2:s(i(t,d),e.precision)}},logarithmic:function(t,e){for(var n=[0,0,0,0],r=t.length,a=0;a<r;a++)null!==t[a][1]&&(n[0]+=Math.log(t[a][0]),n[1]+=t[a][1]*Math.log(t[a][0]),n[2]+=t[a][1],n[3]+=Math.pow(Math.log(t[a][0]),2));var o=s((r*n[1]-n[2]*n[0])/(r*n[3]-n[0]*n[0]),e.precision),c=s((n[2]-o*n[0])/r,e.precision),l=function(t){return[s(t,e.precision),s(s(c+o*Math.log(t),e.precision),e.precision)]},u=t.map(function(t){return l(t[0])});return{points:u,predict:l,equation:[c,o],string:"y = "+c+" + "+o+" ln(x)",r2:s(i(t,u),e.precision)}},power:function(t,e){for(var n=[0,0,0,0,0],r=t.length,a=0;a<r;a++)null!==t[a][1]&&(n[0]+=Math.log(t[a][0]),n[1]+=Math.log(t[a][1])*Math.log(t[a][0]),n[2]+=Math.log(t[a][1]),n[3]+=Math.pow(Math.log(t[a][0]),2));var o=(r*n[1]-n[0]*n[2])/(r*n[3]-Math.pow(n[0],2)),c=(n[2]-o*n[0])/r,l=s(Math.exp(c),e.precision),u=s(o,e.precision),h=function(t){return[s(t,e.precision),s(s(l*Math.pow(t,u),e.precision),e.precision)]},d=t.map(function(t){return h(t[0])});return{points:d,predict:h,equation:[l,u],string:"y = "+l+"x^"+u,r2:s(i(t,d),e.precision)}},polynomial:function(t,e){for(var n=[],a=[],c=0,l=0,u=t.length,h=e.order+1,d=0;d<h;d++){for(var f=0;f<u;f++)null!==t[f][1]&&(c+=Math.pow(t[f][0],d)*t[f][1]);n.push(c),c=0;for(var p=[],m=0;m<h;m++){for(var g=0;g<u;g++)null!==t[g][1]&&(l+=Math.pow(t[g][0],d+m));p.push(l),l=0}a.push(p)}a.push(n);for(var y=o(a,h).map(function(t){return s(t,e.precision)}),v=function(t){return[s(t,e.precision),s(y.reduce(function(e,n,r){return e+n*Math.pow(t,r)},0),e.precision)]},b=t.map(function(t){return v(t[0])}),w="y = ",x=y.length-1;x>=0;x--)w+=x>1?y[x]+"x^"+x+" + ":1===x?y[x]+"x + ":y[x];return{string:w,points:b,predict:v,equation:[].concat(r(y)).reverse(),r2:s(i(t,b),e.precision)}}};function l(){var t=function(t,r){return n({_round:s},t,e({},r,function(t,e){return c[r](t,n({},a,e))}))};return Object.keys(c).reduce(t,{})}t.exports=l()},void 0===(a="function"===typeof n?n.apply(e,r):n)||(t.exports=a)},4185:(t,e,n)=>{"use strict";var r=n(974);t.exports=r},4190:(t,e,n)=>{var r=n(1340);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},4202:(t,e)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}function v(){}function b(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=y.prototype;var w=b.prototype=new v;w.constructor=b,m(w,y.prototype),w.isPureReactComponent=!0;var x=Array.isArray,k=Object.prototype.hasOwnProperty,_={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function T(t,e,r){var a,i={},o=null,s=null;if(null!=e)for(a in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(o=""+e.key),e)k.call(e,a)&&!S.hasOwnProperty(a)&&(i[a]=e[a]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(a in c=t.defaultProps)void 0===i[a]&&(i[a]=c[a]);return{$$typeof:n,type:t,key:o,ref:s,props:i,_owner:_.current}}function I(t){return"object"===typeof t&&null!==t&&t.$$typeof===n}var E=/\/+/g;function N(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(t){return e[t]})}(""+t.key):e.toString(36)}function C(t,e,a,i,o){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var c=!1;if(null===t)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case n:case r:c=!0}}if(c)return o=o(c=t),t=""===i?"."+N(c,0):i,x(o)?(a="",null!=t&&(a=t.replace(E,"$&/")+"/"),C(o,e,a,"",function(t){return t})):null!=o&&(I(o)&&(o=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(o,a+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+t)),e.push(o)),1;if(c=0,i=""===i?".":i+":",x(t))for(var l=0;l<t.length;l++){var u=i+N(s=t[l],l);c+=C(s,e,a,u,o)}else if(u=function(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"===typeof u)for(t=u.call(t),l=0;!(s=t.next()).done;)c+=C(s=s.value,e,a,u=i+N(s,l++),o);else if("object"===s)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return c}function A(t,e,n){if(null==t)return t;var r=[],a=0;return C(t,r,"","",function(t){return e.call(n,t,a++)}),r}function R(t){if(-1===t._status){var e=t._result;(e=e()).then(function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)},function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)}),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var O={current:null},D={transition:null},M={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:D,ReactCurrentOwner:_};function F(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:A,forEach:function(t,e,n){A(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return A(t,function(){e++}),e},toArray:function(t){return A(t,function(t){return t})||[]},only:function(t){if(!I(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=a,e.Profiler=o,e.PureComponent=b,e.StrictMode=i,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,e.act=F,e.cloneElement=function(t,e,r){if(null===t||void 0===t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var a=m({},t.props),i=t.key,o=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,s=_.current),void 0!==e.key&&(i=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(l in e)k.call(e,l)&&!S.hasOwnProperty(l)&&(a[l]=void 0===e[l]&&void 0!==c?c[l]:e[l])}var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}return{$$typeof:n,type:t.type,key:i,ref:o,props:a,_owner:s}},e.createContext=function(t){return(t={$$typeof:c,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:t},t.Consumer=t},e.createElement=T,e.createFactory=function(t){var e=T.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:l,render:t}},e.isValidElement=I,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:R}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=D.transition;D.transition={};try{t()}finally{D.transition=e}},e.unstable_act=F,e.useCallback=function(t,e){return O.current.useCallback(t,e)},e.useContext=function(t){return O.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return O.current.useDeferredValue(t)},e.useEffect=function(t,e){return O.current.useEffect(t,e)},e.useId=function(){return O.current.useId()},e.useImperativeHandle=function(t,e,n){return O.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return O.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return O.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return O.current.useMemo(t,e)},e.useReducer=function(t,e,n){return O.current.useReducer(t,e,n)},e.useRef=function(t){return O.current.useRef(t)},e.useState=function(t){return O.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return O.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return O.current.useTransition()},e.version="18.3.1"},4205:(t,e,n)=>{"use strict";var r=n(4702),a=n(9203),i=n(4071),o=n(6094),s=n(6521),c=n(4482),l=r.Symbol,u=a("wks"),h=c?l.for||l:l&&l.withoutSetter||o;t.exports=function(t){return i(u,t)||(u[t]=s&&i(l,t)?l[t]:h("Symbol."+t)),u[t]}},4224:(t,e,n)=>{"use strict";var r=n(1839);t.exports=r},4245:(t,e,n)=>{var r=n(2405);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},4262:(t,e,n)=>{var r=n(8895),a=n(4052);t.exports=function(t,e,n){var i=e(t);return a(t)?i:r(i,n(t))}},4300:(t,e,n)=>{"use strict";var r=n(6779),a=TypeError;t.exports=function(t){if(r(t))throw new a("Can't call method on "+t);return t}},4334:(t,e,n)=>{var r=n(7359),a=n(7066),i=n(9016),o=n(9538),s=n(6288),c=n(5262),l=n(2430);l.alea=r,l.xor128=a,l.xorwow=i,l.xorshift7=o,l.xor4096=s,l.tychei=c,t.exports=l},4382:(t,e,n)=>{"use strict";var r=n(4205)("iterator"),a=!1;try{var i=0,o={next:function(){return{done:!!i++}},return:function(){a=!0}};o[r]=function(){return this},Array.from(o,function(){throw 2})}catch(s){}t.exports=function(t,e){try{if(!e&&!a)return!1}catch(s){return!1}var n=!1;try{var i={};i[r]=function(){return{next:function(){return{done:n=!0}}}},t(i)}catch(s){}return n}},4391:(t,e,n)=>{"use strict";var r=n(7950);e.createRoot=r.createRoot,e.hydrateRoot=r.hydrateRoot},4402:(t,e,n)=>{"use strict";var r=n(3719);t.exports=r},4403:(t,e,n)=>{"use strict";var r=n(8366),a=n(5334),i=n(9607),o=n(2202),s=n(8777),c=r([].push);t.exports=function(t){if(i(t))return t;if(a(t)){for(var e=t.length,n=[],r=0;r<e;r++){var l=t[r];"string"==typeof l?c(n,l):"number"!=typeof l&&"Number"!==o(l)&&"String"!==o(l)||c(n,s(l))}var u=n.length,h=!0;return function(t,e){if(h)return h=!1,e;if(a(this))return e;for(var r=0;r<u;r++)if(n[r]===t)return e}}}},4413:(t,e,n)=>{"use strict";var r=n(8366),a=n(4721),i=n(8777),o=n(4300),s=r("".charAt),c=r("".charCodeAt),l=r("".slice),u=function(t){return function(e,n){var r,u,h=i(o(e)),d=a(n),f=h.length;return d<0||d>=f?t?"":void 0:(r=c(h,d))<55296||r>56319||d+1===f||(u=c(h,d+1))<56320||u>57343?t?s(h,d):r:t?l(h,d,d+2):u-56320+(r-55296<<10)+65536}};t.exports={codeAt:u(!1),charAt:u(!0)}},4419:(t,e,n)=>{var r=n(1500);t.exports=function(t,e){try{Object.defineProperty(r,t,{value:e,configurable:!0,writable:!0})}catch(n){r[t]=e}return e}},4423:(t,e,n)=>{t.exports=function t(e,n,r){function a(o,s){if(!n[o]){if(!e[o]){if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return a(n||t)},l,l.exports,t,e,n,r)}return n[o].exports}for(var i=void 0,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(t,e,r){(function(t){"use strict";var n,r,a=t.MutationObserver||t.WebKitMutationObserver;if(a){var i=0,o=new a(u),s=t.document.createTextNode("");o.observe(s,{characterData:!0}),n=function(){s.data=i=++i%2}}else if(t.setImmediate||"undefined"===typeof t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var c=new t.MessageChannel;c.port1.onmessage=u,n=function(){c.port2.postMessage(0)}}var l=[];function u(){var t,e;r=!0;for(var n=l.length;n;){for(e=l,l=[],t=-1;++t<n;)e[t]();n=l.length}r=!1}function h(t){1!==l.push(t)||r||n()}e.exports=h}).call(this,"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var r=t(1);function a(){}var i={},o=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function l(t){if("function"!==typeof t)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,t!==a&&f(this,t)}function u(t,e,n){this.promise=t,"function"===typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"===typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function h(t,e,n){r(function(){var r;try{r=e(n)}catch(a){return i.reject(t,a)}r===t?i.reject(t,new TypeError("Cannot resolve promise with itself")):i.resolve(t,r)})}function d(t){var e=t&&t.then;if(t&&("object"===typeof t||"function"===typeof t)&&"function"===typeof e)return function(){e.apply(t,arguments)}}function f(t,e){var n=!1;function r(e){n||(n=!0,i.reject(t,e))}function a(e){n||(n=!0,i.resolve(t,e))}function o(){e(a,r)}var s=p(o);"error"===s.status&&r(s.value)}function p(t,e){var n={};try{n.value=t(e),n.status="success"}catch(r){n.status="error",n.value=r}return n}function m(t){return t instanceof this?t:i.resolve(new this(a),t)}function g(t){var e=new this(a);return i.reject(e,t)}function y(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var o=new Array(n),s=0,c=-1,l=new this(a);++c<n;)u(t[c],c);return l;function u(t,a){function c(t){o[a]=t,++s!==n||r||(r=!0,i.resolve(l,o))}e.resolve(t).then(c,function(t){r||(r=!0,i.reject(l,t))})}}function v(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var o=-1,s=new this(a);++o<n;)c(t[o]);return s;function c(t){e.resolve(t).then(function(t){r||(r=!0,i.resolve(s,t))},function(t){r||(r=!0,i.reject(s,t))})}}e.exports=l,l.prototype.catch=function(t){return this.then(null,t)},l.prototype.then=function(t,e){if("function"!==typeof t&&this.state===s||"function"!==typeof e&&this.state===o)return this;var n=new this.constructor(a);return this.state!==c?h(n,this.state===s?t:e,this.outcome):this.queue.push(new u(n,t,e)),n},u.prototype.callFulfilled=function(t){i.resolve(this.promise,t)},u.prototype.otherCallFulfilled=function(t){h(this.promise,this.onFulfilled,t)},u.prototype.callRejected=function(t){i.reject(this.promise,t)},u.prototype.otherCallRejected=function(t){h(this.promise,this.onRejected,t)},i.resolve=function(t,e){var n=p(d,e);if("error"===n.status)return i.reject(t,n.value);var r=n.value;if(r)f(t,r);else{t.state=s,t.outcome=e;for(var a=-1,o=t.queue.length;++a<o;)t.queue[a].callFulfilled(e)}return t},i.reject=function(t,e){t.state=o,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},l.resolve=m,l.reject=g,l.all=y,l.race=v},{1:1}],3:[function(t,e,r){(function(e){"use strict";"function"!==typeof e.Promise&&(e.Promise=t(2))}).call(this,"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(){try{if("undefined"!==typeof indexedDB)return indexedDB;if("undefined"!==typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!==typeof mozIndexedDB)return mozIndexedDB;if("undefined"!==typeof OIndexedDB)return OIndexedDB;if("undefined"!==typeof msIndexedDB)return msIndexedDB}catch(t){return}}var o=i();function s(){try{if(!o)return!1;var t="undefined"!==typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"===typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!==typeof indexedDB&&"undefined"!==typeof IDBKeyRange}catch(n){return!1}}function c(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(a){if("TypeError"!==a.name)throw a;for(var n=new("undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)n.append(t[r]);return n.getBlob(e.type)}}"undefined"===typeof Promise&&t(3);var l=Promise;function u(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function h(t,e,n){"function"===typeof e&&t.then(e),"function"===typeof n&&t.catch(n)}function d(t){return"string"!==typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function f(){if(arguments.length&&"function"===typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var p="local-forage-detect-blob-support",m=void 0,g={},y=Object.prototype.toString,v="readonly",b="readwrite";function w(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),a=0;a<e;a++)r[a]=t.charCodeAt(a);return n}function x(t){return new l(function(e){var n=t.transaction(p,b),r=c([""]);n.objectStore(p).put(r,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}function k(t){return"boolean"===typeof m?l.resolve(m):x(t).then(function(t){return m=t})}function _(t){var e=g[t.name],n={};n.promise=new l(function(t,e){n.resolve=t,n.reject=e}),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then(function(){return n.promise}):e.dbReady=n.promise}function S(t){var e=g[t.name].deferredOperations.pop();if(e)return e.resolve(),e.promise}function T(t,e){var n=g[t.name].deferredOperations.pop();if(n)return n.reject(e),n.promise}function I(t,e){return new l(function(n,r){if(g[t.name]=g[t.name]||P(),t.db){if(!e)return n(t.db);_(t),t.db.close()}var a=[t.name];e&&a.push(t.version);var i=o.open.apply(o,a);e&&(i.onupgradeneeded=function(e){var n=i.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(p)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),i.onerror=function(t){t.preventDefault(),r(i.error)},i.onsuccess=function(){n(i.result),S(t)}})}function E(t){return I(t,!1)}function N(t){return I(t,!0)}function C(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version<t.db.version,a=t.version>t.db.version;if(r&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),a||n){if(n){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}function A(t){return new l(function(e,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:t.type})},r.readAsBinaryString(t)})}function R(t){return c([w(atob(t.data))],{type:t.type})}function O(t){return t&&t.__local_forage_encoded_blob}function D(t){var e=this,n=e._initReady().then(function(){var t=g[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return h(n,t,t),n}function M(t){_(t);for(var e=g[t.name],n=e.forages,r=0;r<n.length;r++){var a=n[r];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return t.db=null,E(t).then(function(e){return t.db=e,C(t)?N(t):e}).then(function(r){t.db=e.db=r;for(var a=0;a<n.length;a++)n[a]._dbInfo.db=r}).catch(function(e){throw T(t,e),e})}function F(t,e,n,r){void 0===r&&(r=1);try{var a=t.db.transaction(t.storeName,e);n(null,a)}catch(i){if(r>0&&(!t.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return l.resolve().then(function(){if(!t.db||"NotFoundError"===i.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),N(t)}).then(function(){return M(t).then(function(){F(t,e,n,r-1)})}).catch(n);n(i)}}function P(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function L(t){var e=this,n={db:null};if(t)for(var r in t)n[r]=t[r];var a=g[n.name];a||(a=P(),g[n.name]=a),a.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=D);var i=[];function o(){return l.resolve()}for(var s=0;s<a.forages.length;s++){var c=a.forages[s];c!==e&&i.push(c._initReady().catch(o))}var u=a.forages.slice(0);return l.all(i).then(function(){return n.db=a.db,E(n)}).then(function(t){return n.db=t,C(n,e._defaultConfig.version)?N(n):t}).then(function(t){n.db=a.db=t,e._dbInfo=n;for(var r=0;r<u.length;r++){var i=u[r];i!==e&&(i._dbInfo.db=n.db,i._dbInfo.version=n.version)}})}function z(t,e){var n=this;t=d(t);var r=new l(function(e,r){n.ready().then(function(){F(n._dbInfo,v,function(a,i){if(a)return r(a);try{var o=i.objectStore(n._dbInfo.storeName).get(t);o.onsuccess=function(){var t=o.result;void 0===t&&(t=null),O(t)&&(t=R(t)),e(t)},o.onerror=function(){r(o.error)}}catch(s){r(s)}})}).catch(r)});return u(r,e),r}function B(t,e){var n=this,r=new l(function(e,r){n.ready().then(function(){F(n._dbInfo,v,function(a,i){if(a)return r(a);try{var o=i.objectStore(n._dbInfo.storeName).openCursor(),s=1;o.onsuccess=function(){var n=o.result;if(n){var r=n.value;O(r)&&(r=R(r));var a=t(r,n.key,s++);void 0!==a?e(a):n.continue()}else e()},o.onerror=function(){r(o.error)}}catch(c){r(c)}})}).catch(r)});return u(r,e),r}function j(t,e,n){var r=this;t=d(t);var a=new l(function(n,a){var i;r.ready().then(function(){return i=r._dbInfo,"[object Blob]"===y.call(e)?k(i.db).then(function(t){return t?e:A(e)}):e}).then(function(e){F(r._dbInfo,b,function(i,o){if(i)return a(i);try{var s=o.objectStore(r._dbInfo.storeName);null===e&&(e=void 0);var c=s.put(e,t);o.oncomplete=function(){void 0===e&&(e=null),n(e)},o.onabort=o.onerror=function(){var t=c.error?c.error:c.transaction.error;a(t)}}catch(l){a(l)}})}).catch(a)});return u(a,n),a}function U(t,e){var n=this;t=d(t);var r=new l(function(e,r){n.ready().then(function(){F(n._dbInfo,b,function(a,i){if(a)return r(a);try{var o=i.objectStore(n._dbInfo.storeName).delete(t);i.oncomplete=function(){e()},i.onerror=function(){r(o.error)},i.onabort=function(){var t=o.error?o.error:o.transaction.error;r(t)}}catch(s){r(s)}})}).catch(r)});return u(r,e),r}function V(t){var e=this,n=new l(function(t,n){e.ready().then(function(){F(e._dbInfo,b,function(r,a){if(r)return n(r);try{var i=a.objectStore(e._dbInfo.storeName).clear();a.oncomplete=function(){t()},a.onabort=a.onerror=function(){var t=i.error?i.error:i.transaction.error;n(t)}}catch(o){n(o)}})}).catch(n)});return u(n,t),n}function W(t){var e=this,n=new l(function(t,n){e.ready().then(function(){F(e._dbInfo,v,function(r,a){if(r)return n(r);try{var i=a.objectStore(e._dbInfo.storeName).count();i.onsuccess=function(){t(i.result)},i.onerror=function(){n(i.error)}}catch(o){n(o)}})}).catch(n)});return u(n,t),n}function G(t,e){var n=this,r=new l(function(e,r){t<0?e(null):n.ready().then(function(){F(n._dbInfo,v,function(a,i){if(a)return r(a);try{var o=i.objectStore(n._dbInfo.storeName),s=!1,c=o.openCursor();c.onsuccess=function(){var n=c.result;n?0===t||s?e(n.key):(s=!0,n.advance(t)):e(null)},c.onerror=function(){r(c.error)}}catch(l){r(l)}})}).catch(r)});return u(r,e),r}function H(t){var e=this,n=new l(function(t,n){e.ready().then(function(){F(e._dbInfo,v,function(r,a){if(r)return n(r);try{var i=a.objectStore(e._dbInfo.storeName).openCursor(),o=[];i.onsuccess=function(){var e=i.result;e?(o.push(e.key),e.continue()):t(o)},i.onerror=function(){n(i.error)}}catch(s){n(s)}})}).catch(n)});return u(n,t),n}function q(t,e){e=f.apply(this,arguments);var n=this.config();(t="function"!==typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,a=this;if(t.name){var i=t.name===n.name&&a._dbInfo.db?l.resolve(a._dbInfo.db):E(t).then(function(e){var n=g[t.name],r=n.forages;n.db=e;for(var a=0;a<r.length;a++)r[a]._dbInfo.db=e;return e});r=t.storeName?i.then(function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;_(t);var r=g[t.name],a=r.forages;e.close();for(var i=0;i<a.length;i++){var s=a[i];s._dbInfo.db=null,s._dbInfo.version=n}var c=new l(function(e,r){var a=o.open(t.name,n);a.onerror=function(t){a.result.close(),r(t)},a.onupgradeneeded=function(){a.result.deleteObjectStore(t.storeName)},a.onsuccess=function(){var t=a.result;t.close(),e(t)}});return c.then(function(t){r.db=t;for(var e=0;e<a.length;e++){var n=a[e];n._dbInfo.db=t,S(n._dbInfo)}}).catch(function(e){throw(T(t,e)||l.resolve()).catch(function(){}),e})}}):i.then(function(e){_(t);var n=g[t.name],r=n.forages;e.close();for(var a=0;a<r.length;a++)r[a]._dbInfo.db=null;var i=new l(function(e,n){var r=o.deleteDatabase(t.name);r.onerror=r.onblocked=function(t){var e=r.result;e&&e.close(),n(t)},r.onsuccess=function(){var t=r.result;t&&t.close(),e(t)}});return i.then(function(t){n.db=t;for(var e=0;e<r.length;e++)S(r[e]._dbInfo)}).catch(function(e){throw(T(t,e)||l.resolve()).catch(function(){}),e})})}else r=l.reject("Invalid arguments");return u(r,e),r}var K={_driver:"asyncStorage",_initStorage:L,_support:s(),iterate:B,getItem:z,setItem:j,removeItem:U,clear:V,length:W,key:G,keys:H,dropInstance:q};function X(){return"function"===typeof openDatabase}var Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Q="~~local_forage_type~",J=/^~~local_forage_type~([^~]+)~/,$="__lfsc__:",Z=$.length,tt="arbf",et="blob",nt="si08",rt="ui08",at="uic8",it="si16",ot="si32",st="ur16",ct="ui32",lt="fl32",ut="fl64",ht=Z+tt.length,dt=Object.prototype.toString;function ft(t){var e,n,r,a,i,o=.75*t.length,s=t.length,c=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);var l=new ArrayBuffer(o),u=new Uint8Array(l);for(e=0;e<s;e+=4)n=Y.indexOf(t[e]),r=Y.indexOf(t[e+1]),a=Y.indexOf(t[e+2]),i=Y.indexOf(t[e+3]),u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|a>>2,u[c++]=(3&a)<<6|63&i;return l}function pt(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=Y[n[e]>>2],r+=Y[(3&n[e])<<4|n[e+1]>>4],r+=Y[(15&n[e+1])<<2|n[e+2]>>6],r+=Y[63&n[e+2]];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function mt(t,e){var n="";if(t&&(n=dt.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===dt.call(t.buffer))){var r,a=$;t instanceof ArrayBuffer?(r=t,a+=tt):(r=t.buffer,"[object Int8Array]"===n?a+=nt:"[object Uint8Array]"===n?a+=rt:"[object Uint8ClampedArray]"===n?a+=at:"[object Int16Array]"===n?a+=it:"[object Uint16Array]"===n?a+=st:"[object Int32Array]"===n?a+=ot:"[object Uint32Array]"===n?a+=ct:"[object Float32Array]"===n?a+=lt:"[object Float64Array]"===n?a+=ut:e(new Error("Failed to get type for BinaryArray"))),e(a+pt(r))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=Q+t.type+"~"+pt(this.result);e($+et+n)},i.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(o){console.error("Couldn't convert value into a JSON string: ",t),e(null,o)}}function gt(t){if(t.substring(0,Z)!==$)return JSON.parse(t);var e,n=t.substring(ht),r=t.substring(Z,ht);if(r===et&&J.test(n)){var a=n.match(J);e=a[1],n=n.substring(a[0].length)}var i=ft(n);switch(r){case tt:return i;case et:return c([i],{type:e});case nt:return new Int8Array(i);case rt:return new Uint8Array(i);case at:return new Uint8ClampedArray(i);case it:return new Int16Array(i);case st:return new Uint16Array(i);case ot:return new Int32Array(i);case ct:return new Uint32Array(i);case lt:return new Float32Array(i);case ut:return new Float64Array(i);default:throw new Error("Unkown type: "+r)}}var yt={serialize:mt,deserialize:gt,stringToBuffer:ft,bufferToString:pt};function vt(t,e,n,r){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function bt(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!==typeof t[r]?t[r].toString():t[r];var a=new l(function(t,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(a){return r(a)}n.db.transaction(function(a){vt(a,n,function(){e._dbInfo=n,t()},function(t,e){r(e)})},r)});return n.serializer=yt,a}function wt(t,e,n,r,a,i){t.executeSql(n,r,a,function(t,o){o.code===o.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],function(t,s){s.rows.length?i(t,o):vt(t,e,function(){t.executeSql(n,r,a,i)},i)},i):i(t,o)},i)}function xt(t,e){var n=this;t=d(t);var r=new l(function(e,r){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(n){wt(n,a,"SELECT * FROM "+a.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=a.serializer.deserialize(r)),e(r)},function(t,e){r(e)})})}).catch(r)});return u(r,e),r}function kt(t,e){var n=this,r=new l(function(e,r){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(n){wt(n,a,"SELECT * FROM "+a.storeName,[],function(n,r){for(var i=r.rows,o=i.length,s=0;s<o;s++){var c=i.item(s),l=c.value;if(l&&(l=a.serializer.deserialize(l)),void 0!==(l=t(l,c.key,s+1)))return void e(l)}e()},function(t,e){r(e)})})}).catch(r)});return u(r,e),r}function _t(t,e,n,r){var a=this;t=d(t);var i=new l(function(i,o){a.ready().then(function(){void 0===e&&(e=null);var s=e,c=a._dbInfo;c.serializer.serialize(e,function(e,l){l?o(l):c.db.transaction(function(n){wt(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[t,e],function(){i(s)},function(t,e){o(e)})},function(e){if(e.code===e.QUOTA_ERR){if(r>0)return void i(_t.apply(a,[t,s,n,r-1]));o(e)}})})}).catch(o)});return u(i,n),i}function St(t,e,n){return _t.apply(this,[t,e,n,1])}function Tt(t,e){var n=this;t=d(t);var r=new l(function(e,r){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(n){wt(n,a,"DELETE FROM "+a.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){r(e)})})}).catch(r)});return u(r,e),r}function It(t){var e=this,n=new l(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){wt(e,r,"DELETE FROM "+r.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return u(n,t),n}function Et(t){var e=this,n=new l(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){wt(e,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(e,n){var r=n.rows.item(0).c;t(r)},function(t,e){n(e)})})}).catch(n)});return u(n,t),n}function Nt(t,e){var n=this,r=new l(function(e,r){n.ready().then(function(){var a=n._dbInfo;a.db.transaction(function(n){wt(n,a,"SELECT key FROM "+a.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)},function(t,e){r(e)})})}).catch(r)});return u(r,e),r}function Ct(t){var e=this,n=new l(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){wt(e,r,"SELECT key FROM "+r.storeName,[],function(e,n){for(var r=[],a=0;a<n.rows.length;a++)r.push(n.rows.item(a).key);t(r)},function(t,e){n(e)})})}).catch(n)});return u(n,t),n}function At(t){return new l(function(e,n){t.transaction(function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,r){for(var a=[],i=0;i<r.rows.length;i++)a.push(r.rows.item(i).name);e({db:t,storeNames:a})},function(t,e){n(e)})},function(t){n(t)})})}function Rt(t,e){e=f.apply(this,arguments);var n=this.config();(t="function"!==typeof t&&t||{}).name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,a=this;return u(r=t.name?new l(function(e){var r;r=t.name===n.name?a._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:r,storeNames:[t.storeName]}):e(At(r))}).then(function(t){return new l(function(e,n){t.db.transaction(function(r){function a(t){return new l(function(e,n){r.executeSql("DROP TABLE IF EXISTS "+t,[],function(){e()},function(t,e){n(e)})})}for(var i=[],o=0,s=t.storeNames.length;o<s;o++)i.push(a(t.storeNames[o]));l.all(i).then(function(){e()}).catch(function(t){n(t)})},function(t){n(t)})})}):l.reject("Invalid arguments"),e),r}var Ot={_driver:"webSQLStorage",_initStorage:bt,_support:X(),iterate:kt,getItem:xt,setItem:St,removeItem:Tt,clear:It,length:Et,key:Nt,keys:Ct,dropInstance:Rt};function Dt(){try{return"undefined"!==typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}function Mt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function Ft(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(e){return!0}}function Pt(){return!Ft()||localStorage.length>0}function Lt(t){var e=this,n={};if(t)for(var r in t)n[r]=t[r];return n.keyPrefix=Mt(t,e._defaultConfig),Pt()?(e._dbInfo=n,n.serializer=yt,l.resolve()):l.reject()}function zt(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}});return u(n,t),n}function Bt(t,e){var n=this;t=d(t);var r=n.ready().then(function(){var e=n._dbInfo,r=localStorage.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r});return u(r,e),r}function jt(t,e){var n=this,r=n.ready().then(function(){for(var e=n._dbInfo,r=e.keyPrefix,a=r.length,i=localStorage.length,o=1,s=0;s<i;s++){var c=localStorage.key(s);if(0===c.indexOf(r)){var l=localStorage.getItem(c);if(l&&(l=e.serializer.deserialize(l)),void 0!==(l=t(l,c.substring(a),o++)))return l}}});return u(r,e),r}function Ut(t,e){var n=this,r=n.ready().then(function(){var e,r=n._dbInfo;try{e=localStorage.key(t)}catch(a){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e});return u(r,e),r}function Vt(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=localStorage.length,r=[],a=0;a<n;a++){var i=localStorage.key(a);0===i.indexOf(t.keyPrefix)&&r.push(i.substring(t.keyPrefix.length))}return r});return u(n,t),n}function Wt(t){var e=this.keys().then(function(t){return t.length});return u(e,t),e}function Gt(t,e){var n=this;t=d(t);var r=n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return u(r,e),r}function Ht(t,e,n){var r=this;t=d(t);var a=r.ready().then(function(){void 0===e&&(e=null);var n=e;return new l(function(a,i){var o=r._dbInfo;o.serializer.serialize(e,function(e,r){if(r)i(r);else try{localStorage.setItem(o.keyPrefix+t,e),a(n)}catch(s){"QuotaExceededError"!==s.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==s.name||i(s),i(s)}})})});return u(a,n),a}function qt(t,e){if(e=f.apply(this,arguments),!(t="function"!==typeof t&&t||{}).name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var r,a=this;return r=t.name?new l(function(e){t.storeName?e(Mt(t,a._defaultConfig)):e(t.name+"/")}).then(function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}}):l.reject("Invalid arguments"),u(r,e),r}var Kt={_driver:"localStorageWrapper",_initStorage:Lt,_support:Dt(),iterate:jt,getItem:Bt,setItem:Ht,removeItem:Gt,clear:zt,length:Wt,key:Ut,keys:Vt,dropInstance:qt},Xt=function(t,e){return t===e||"number"===typeof t&&"number"===typeof e&&isNaN(t)&&isNaN(e)},Yt=function(t,e){for(var n=t.length,r=0;r<n;){if(Xt(t[r],e))return!0;r++}return!1},Qt=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Jt={},$t={},Zt={INDEXEDDB:K,WEBSQL:Ot,LOCALSTORAGE:Kt},te=[Zt.INDEXEDDB._driver,Zt.WEBSQL._driver,Zt.LOCALSTORAGE._driver],ee=["dropInstance"],ne=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ee),re={description:"",driver:te.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ae(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function ie(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(Qt(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var oe=function(){function t(e){for(var n in a(this,t),Zt)if(Zt.hasOwnProperty(n)){var r=Zt[n],i=r._driver;this[n]=i,Jt[i]||this.defineDriver(r)}this._defaultConfig=ie({},re),this._config=ie({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===("undefined"===typeof t?"undefined":r(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!==typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"===typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new l(function(e,n){try{var r=t._driver,a=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(a);for(var i=ne.concat("_initStorage"),o=0,s=i.length;o<s;o++){var c=i[o];if((!Yt(ee,c)||t[c])&&"function"!==typeof t[c])return void n(a)}var h=function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=l.reject(e);return u(n,arguments[arguments.length-1]),n}},n=0,r=ee.length;n<r;n++){var a=ee[n];t[a]||(t[a]=e(a))}};h();var d=function(n){Jt[r]&&console.info("Redefining LocalForage driver: "+r),Jt[r]=t,$t[r]=n,e()};"_support"in t?t._support&&"function"===typeof t._support?t._support().then(d,n):d(!!t._support):d(!0)}catch(f){n(f)}});return h(r,e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var r=Jt[t]?l.resolve(Jt[t]):l.reject(new Error("Driver not found."));return h(r,e,n),r},t.prototype.getSerializer=function(t){var e=l.resolve(yt);return h(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return h(n,t,t),n},t.prototype.setDriver=function(t,e,n){var r=this;Qt(t)||(t=[t]);var a=this._getSupportedDrivers(t);function i(){r._config.driver=r.driver()}function o(t){return r._extend(t),i(),r._ready=r._initStorage(r._config),r._ready}function s(t){return function(){var e=0;function n(){for(;e<t.length;){var a=t[e];return e++,r._dbInfo=null,r._ready=null,r.getDriver(a).then(o).catch(n)}i();var s=new Error("No available storage method found.");return r._driverSet=l.reject(s),r._driverSet}return n()}}var c=null!==this._driverSet?this._driverSet.catch(function(){return l.resolve()}):l.resolve();return this._driverSet=c.then(function(){var t=a[0];return r._dbInfo=null,r._ready=null,r.getDriver(t).then(function(t){r._driver=t._driver,i(),r._wrapLibraryMethodsWithReady(),r._initDriver=s(a)})}).catch(function(){i();var t=new Error("No available storage method found.");return r._driverSet=l.reject(t),r._driverSet}),h(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!$t[t]},t.prototype._extend=function(t){ie(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var a=t[n];this.supports(a)&&e.push(a)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ne.length;t<e;t++)ae(this,ne[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),se=new oe;e.exports=se},{3:3}]},{},[4])(4)},4433:(t,e,n)=>{"use strict";var r=n(4071),a=n(9607),i=n(5231),o=n(6045),s=n(4837),c=o("IE_PROTO"),l=Object,u=l.prototype;t.exports=s?l.getPrototypeOf:function(t){var e=i(t);if(r(e,c))return e[c];var n=e.constructor;return a(n)&&e instanceof n?n.prototype:e instanceof l?u:null}},4468:(t,e,n)=>{"use strict";var r=n(8743);n(5403),t.exports=r},4482:(t,e,n)=>{"use strict";var r=n(6521);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},4508:(t,e,n)=>{"use strict";var r=n(9607),a=n(6381),i=TypeError;t.exports=function(t){if(r(t))return t;throw new i(a(t)+" is not a function")}},4530:()=>{},4543:(t,e,n)=>{t=n.nmd(t);var r=n(6552),a=n(14),i=e&&!e.nodeType&&e,o=i&&t&&!t.nodeType&&t,s=o&&o.exports===i?r.Buffer:void 0,c=(s?s.isBuffer:void 0)||a;t.exports=c},4545:(t,e,n)=>{var r=n(7160);t.exports=function(){this.__data__=new r,this.size=0}},4552:(t,e,n)=>{var r=n(9812),a=Object.prototype,i=a.hasOwnProperty,o=a.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=i.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(c){}var a=o.call(t);return r&&(e?t[s]=n:delete t[s]),a}},4582:(t,e,n)=>{"use strict";var r=n(8445),a=n(9607),i=/#|\.prototype\./,o=function(t,e){var n=c[s(t)];return n===u||n!==l&&(a(e)?r(e):!!e)},s=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},c=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";t.exports=o},4600:(t,e)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var i=typeof n;if("string"===i||"number"===i)t.push(n);else if(Array.isArray(n)){if(n.length){var o=a.apply(null,n);o&&t.push(o)}}else if("object"===i)if(n.toString===Object.prototype.toString)for(var s in n)r.call(n,s)&&n[s]&&t.push(s);else t.push(n.toString())}}return t.join(" ")}t.exports?(a.default=a,t.exports=a):void 0===(n=function(){return a}.apply(e,[]))||(t.exports=n)}()},4606:(t,e,n)=>{"use strict";var r={};r[n(4205)("toStringTag")]="z",t.exports="[object z]"===String(r)},4607:(t,e,n)=>{"use strict";n(8237);var r=n(5313);t.exports=r.Object.getOwnPropertySymbols},4657:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},4662:(t,e,n)=>{"use strict";var r,a=n(6929),i=n(1731),o=n(2721),s=n(6663),c=n(9855),l=n(1925),u=n(6045),h="prototype",d="script",f=u("IE_PROTO"),p=function(){},m=function(t){return"<"+d+">"+t+"</"+d+">"},g=function(t){t.write(m("")),t.close();var e=t.parentWindow.Object;return t=null,e},y=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}y="undefined"!=typeof document?document.domain&&r?g(r):function(){var t,e=l("iframe"),n="java"+d+":";return e.style.display="none",c.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(m("document.F=Object")),t.close(),t.F}():g(r);for(var t=o.length;t--;)delete y[h][o[t]];return y()};s[f]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(p[h]=a(t),n=new p,p[h]=null,n[f]=t):n=y(),void 0===e?n:i.f(n,e)}},4666:(t,e,n)=>{var r=n(5037),a=n(6680),i=n(1437),o=n(6582)("toStringTag"),s="Arguments"==i(function(){return arguments}());t.exports=r?i:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=Object(t),o))?n:s?i(e):"Object"==(r=i(e))&&a(e.callee)?"Arguments":r}},4675:(t,e,n)=>{var r=n(1137),a=n(494),i=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,s=a(i,"name"),c=s&&"something"===function(){}.name,l=s&&(!r||r&&o(i,"name").configurable);t.exports={EXISTS:s,PROPER:c,CONFIGURABLE:l}},4702:function(t,e,n){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},4705:(t,e,n)=>{t.exports=function(t){if(!t)return Math.random;var e=Math.pow(2,32),n=new Uint32Array(1);return function(){return t.getRandomValues(n)[0]/e}}(n(2668))},4713:(t,e,n)=>{"use strict";var r;e.A=void 0;var a=((r=n(9483))&&r.__esModule?r:{default:r}).default;e.A=a},4717:(t,e,n)=>{"use strict";n(3005)("species")},4721:(t,e,n)=>{"use strict";var r=n(819);t.exports=function(t){var e=+t;return e!==e||0===e?0:r(e)}},4774:(t,e,n)=>{"use strict";var r=n(2202),a=n(8366);t.exports=function(t){if("Function"===r(t))return a(t)}},4794:(t,e,n)=>{"use strict";var r=n(3570),a=n(607),i=n(2582);t.exports=function(t,e,n){r?a.f(t,e,i(0,n)):t[e]=n}},4814:()=>{},4816:(t,e,n)=>{var r=n(7251),a=n(7159),i=n(8057),o=n(9394),s=n(6874);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=a,c.prototype.get=i,c.prototype.has=o,c.prototype.set=s,t.exports=c},4823:(t,e,n)=>{"use strict";var r=n(6188);t.exports=r},4837:(t,e,n)=>{"use strict";var r=n(8445);t.exports=!r(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})},4864:t=>{"use strict";t.exports=Math.sign||function(t){var e=+t;return 0===e||e!==e?e:e<0?-1:1}},4941:(t,e,n)=>{"use strict";var r=n(2203),a=n(6929),i=n(5480);t.exports=function(t,e,n){var o,s;a(t);try{if(!(o=i(t,"return"))){if("throw"===e)throw n;return n}o=r(o,t)}catch(c){s=!0,o=c}if("throw"===e)throw n;if(s)throw o;return a(o),n}},4968:(t,e,n)=>{"use strict";n(5243);var r=n(5313).Object,a=t.exports=function(t,e){return r.defineProperties(t,e)};r.defineProperties.sham&&(a.sham=!0)},5037:(t,e,n)=>{var r={};r[n(6582)("toStringTag")]="z",t.exports="[object z]"===String(r)},5039:(t,e,n)=>{"use strict";var r,a,i,o=n(8445),s=n(9607),c=n(5900),l=n(4662),u=n(4433),h=n(5718),d=n(4205),f=n(2545),p=d("iterator"),m=!1;[].keys&&("next"in(i=[].keys())?(a=u(u(i)))!==Object.prototype&&(r=a):m=!0),!c(r)||o(function(){var t={};return r[p].call(t)!==t})?r={}:f&&(r=l(r)),s(r[p])||h(r,p,function(){return this}),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:m}},5043:(t,e,n)=>{"use strict";t.exports=n(4202)},5051:t=>{t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},5060:(t,e,n)=>{"use strict";n(7800)({target:"Symbol",stat:!0},{isRegisteredSymbol:n(7220)})},5099:(t,e,n)=>{"use strict";var r=n(5703),a=n(307);t.exports=function(t){var e=r(t,"string");return a(e)?e:e+""}},5102:(t,e,n)=>{"use strict";n(3005)("iterator")},5110:(t,e,n)=>{t.exports=n(5569)},5118:(t,e,n)=>{"use strict";n(3005)("customMatcher")},5125:(t,e,n)=>{var r=n(9846),a=n(6680),i=/#|\.prototype\./,o=function(t,e){var n=c[s(t)];return n==u||n!=l&&(a(e)?r(e):!!e)},s=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},c=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";t.exports=o},5145:(t,e,n)=>{"use strict";var r,a,i=n(4702),o=n(3273),s=i.process,c=i.Deno,l=s&&s.versions||c&&c.version,u=l&&l.v8;u&&(a=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!a&&o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(a=+r[1]),t.exports=a},5173:(t,e,n)=>{t.exports=n(1497)()},5177:(t,e,n)=>{var r=n(1755);t.exports=r("navigator","userAgent")||""},5184:(t,e,n)=>{var r=n(9846),a=n(1500).RegExp;t.exports=r(function(){var t=a(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)})},5193:(t,e,n)=>{var r=n(6913),a=n(2761);t.exports=function(t){return a(t)&&"[object Arguments]"==r(t)}},5204:(t,e,n)=>{var r=n(7937)(n(6552),"Map");t.exports=r},5207:(t,e,n)=>{"use strict";n(1762);var r=n(5313);t.exports=r.setTimeout},5231:(t,e,n)=>{"use strict";var r=n(4300),a=Object;t.exports=function(t){return a(r(t))}},5232:(t,e,n)=>{"use strict";var r=n(9077);t.exports=r},5243:(t,e,n)=>{"use strict";var r=n(7800),a=n(3570),i=n(1731).f;r({target:"Object",stat:!0,forced:Object.defineProperties!==i,sham:!a},{defineProperties:i})},5262:function(t,e,n){var r;!function(t,a){function i(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,a=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^a,e.a=a-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function s(t,e){var n=new i(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(e,n,e,a))||(a.exports=r):this.tychei=s}(0,t=n.nmd(t),n.amdD)},5290:t=>{t.exports=function(t){try{return String(t)}catch(e){return"Object"}}},5309:(t,e,n)=>{var r=n(5655),a=n(3334);t.exports=Object.keys||function(t){return r(t,a)}},5313:t=>{"use strict";t.exports={}},5334:(t,e,n)=>{"use strict";var r=n(2202);t.exports=Array.isArray||function(t){return"Array"===r(t)}},5345:(t,e,n)=>{var r=n(1500),a=n(6680),i=n(494),o=n(2540),s=n(4419),c=n(3017),l=n(5650),u=n(4675).CONFIGURABLE,h=l.get,d=l.enforce,f=String(String).split("String");(t.exports=function(t,e,n,c){var l,h=!!c&&!!c.unsafe,p=!!c&&!!c.enumerable,m=!!c&&!!c.noTargetGet,g=c&&void 0!==c.name?c.name:e;a(n)&&("Symbol("===String(g).slice(0,7)&&(g="["+String(g).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!i(n,"name")||u&&n.name!==g)&&o(n,"name",g),(l=d(n)).source||(l.source=f.join("string"==typeof g?g:""))),t!==r?(h?!m&&t[e]&&(p=!0):delete t[e],p?t[e]=n:o(t,e,n)):p?t[e]=n:s(e,n)})(Function.prototype,"toString",function(){return a(this)&&h(this).source||c(this)})},5387:(t,e,n)=>{var r=n(7937)(n(6552),"Promise");t.exports=r},5388:(t,e,n)=>{"use strict";var r=n(5039).IteratorPrototype,a=n(4662),i=n(2582),o=n(473),s=n(6891),c=function(){return this};t.exports=function(t,e,n,l){var u=e+" Iterator";return t.prototype=a(r,{next:i(+!l,n)}),o(t,u,!1,!0),s[u]=c,t}},5403:(t,e,n)=>{"use strict";n(1446);var r=n(9502),a=n(4702),i=n(473),o=n(6891);for(var s in r)i(a[s],s),o[s]=o.Array},5428:(t,e,n)=>{var r=n(6913),a=n(6173),i=n(2761),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&a(t.length)&&!!o[r(t)]}},5461:(t,e,n)=>{"use strict";var r=n(7800),a=n(8445),i=n(7555),o=n(7965).f,s=n(3570);r({target:"Object",stat:!0,forced:!s||a(function(){o(1)}),sham:!s},{getOwnPropertyDescriptor:function(t,e){return o(i(t),e)}})},5468:(t,e,n)=>{"use strict";var r=n(5949);t.exports=r},5480:(t,e,n)=>{"use strict";var r=n(4508),a=n(6779);t.exports=function(t,e){var n=t[e];return a(n)?void 0:r(n)}},5510:(t,e,n)=>{"use strict";n(8436);var r=n(8118);t.exports=r("Array","slice")},5530:(t,e,n)=>{"use strict";var r=n(3005),a=n(3684);r("toPrimitive"),a()},5534:(t,e,n)=>{"use strict";n(4110);var r=n(5313);t.exports=r.Object.keys},5538:(t,e,n)=>{var r=n(7160),a=n(4545),i=n(793),o=n(7760),s=n(3892),c=n(6788);function l(t){var e=this.__data__=new r(t);this.size=e.size}l.prototype.clear=a,l.prototype.delete=i,l.prototype.get=o,l.prototype.has=s,l.prototype.set=c,t.exports=l},5569:(t,e,n)=>{"use strict";var r=n(4968);t.exports=r},5575:(t,e,n)=>{var r=n(7937)(Object,"create");t.exports=r},5583:(t,e,n)=>{"use strict";var r=n(9200);t.exports=r},5612:(t,e,n)=>{"use strict";var r=n(1416);t.exports=function(t){return r(t.length)}},5650:(t,e,n)=>{var r,a,i,o=n(9418),s=n(1500),c=n(899),l=n(2540),u=n(494),h=n(8210),d=n(9828),f=n(6856),p="Object already initialized",m=s.WeakMap;if(o||h.state){var g=h.state||(h.state=new m),y=g.get,v=g.has,b=g.set;r=function(t,e){if(v.call(g,t))throw new TypeError(p);return e.facade=t,b.call(g,t,e),e},a=function(t){return y.call(g,t)||{}},i=function(t){return v.call(g,t)}}else{var w=d("state");f[w]=!0,r=function(t,e){if(u(t,w))throw new TypeError(p);return e.facade=t,l(t,w,e),e},a=function(t){return u(t,w)?t[w]:{}},i=function(t){return u(t,w)}}t.exports={set:r,get:a,has:i,enforce:function(t){return i(t)?a(t):r(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=a(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}}}},5655:(t,e,n)=>{var r=n(494),a=n(9168),i=n(3841).indexOf,o=n(6856);t.exports=function(t,e){var n,s=a(t),c=0,l=[];for(n in s)!r(o,n)&&r(s,n)&&l.push(n);for(;e.length>c;)r(s,n=e[c++])&&(~i(l,n)||l.push(n));return l}},5686:(t,e,n)=>{"use strict";n(7944);var r=n(5313);t.exports=r.Array.isArray},5703:(t,e,n)=>{"use strict";var r=n(2203),a=n(5900),i=n(307),o=n(5480),s=n(6152),c=n(4205),l=TypeError,u=c("toPrimitive");t.exports=function(t,e){if(!a(t)||i(t))return t;var n,c=o(t,u);if(c){if(void 0===e&&(e="default"),n=r(c,t,e),!a(n)||i(n))return n;throw new l("Can't convert object to primitive value")}return void 0===e&&(e="number"),s(t,e)}},5718:(t,e,n)=>{"use strict";var r=n(9825);t.exports=function(t,e,n,a){return a&&a.enumerable?t[e]=n:r(t,e,n),t}},5729:(t,e,n)=>{"use strict";var r=n(3226);t.exports=r},5749:(t,e,n)=>{"use strict";var r=n(5313),a=n(4702),i=n(9607),o=function(t){return i(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t])||o(a[t]):r[t]&&r[t][e]||a[t]&&a[t][e]}},5752:(t,e,n)=>{var r=n(9395),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,i,o,s){var c=1&n,l=r(t),u=l.length;if(u!=r(e).length&&!c)return!1;for(var h=u;h--;){var d=l[h];if(!(c?d in e:a.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var m=!0;s.set(t,e),s.set(e,t);for(var g=c;++h<u;){var y=t[d=l[h]],v=e[d];if(i)var b=c?i(v,y,d,e,t,s):i(y,v,d,t,e,s);if(!(void 0===b?y===v||o(y,v,n,i,s):b)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var w=t.constructor,x=e.constructor;w==x||!("constructor"in t)||!("constructor"in e)||"function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x||(m=!1)}return s.delete(t),s.delete(e),m}},5760:(t,e,n)=>{"use strict";function r(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function a(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function i(t){let e,n,i;function s(t,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(a<i){if(0!==e(r,r))return i;do{const e=a+i>>>1;n(t[e],r)<0?a=e+1:i=e}while(a<i)}return a}return 2!==t.length?(e=r,n=(e,n)=>r(t(e),n),i=(e,n)=>t(e)-n):(e=t===r||t===a?t:o,n=t,i=t),{left:s,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=s(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return r>n&&i(t[r-1],e)>-i(t[r],e)?r-1:r},right:function(t,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(a<i){if(0!==e(r,r))return i;do{const e=a+i>>>1;n(t[e],r)<=0?a=e+1:i=e}while(a<i)}return a}}}function o(){return 0}function s(t){return null===t?NaN:+t}n.r(e),n.d(e,{Adder:()=>C,Delaunay:()=>cc,FormatSpecifier:()=>Eu,InternMap:()=>O,InternSet:()=>D,Node:()=>ng,Path:()=>So,Voronoi:()=>nc,ZoomTransform:()=>dI,active:()=>fi,arc:()=>Q_,area:()=>aS,areaRadial:()=>fS,ascending:()=>r,autoType:()=>Vc,axisBottom:()=>be,axisLeft:()=>we,axisRight:()=>ve,axisTop:()=>ye,bin:()=>ft,bisect:()=>d,bisectCenter:()=>h,bisectLeft:()=>u,bisectRight:()=>l,bisector:()=>i,blob:()=>Rl,blur:()=>f,blur2:()=>p,blurImage:()=>m,brush:()=>Vi,brushSelection:()=>Bi,brushX:()=>ji,brushY:()=>Ui,buffer:()=>Dl,chord:()=>po,chordDirected:()=>go,chordTranspose:()=>mo,cluster:()=>Ym,color:()=>dr,contourDensity:()=>Ds,contours:()=>Ts,count:()=>w,create:()=>S_,creator:()=>En,cross:()=>S,csv:()=>zl,csvFormat:()=>Cc,csvFormatBody:()=>Ac,csvFormatRow:()=>Oc,csvFormatRows:()=>Rc,csvFormatValue:()=>Dc,csvParse:()=>Ec,csvParseRows:()=>Nc,cubehelix:()=>ms,cumsum:()=>T,curveBasis:()=>rT,curveBasisClosed:()=>iT,curveBasisOpen:()=>sT,curveBumpX:()=>yS,curveBumpY:()=>vS,curveBundle:()=>lT,curveCardinal:()=>dT,curveCardinalClosed:()=>pT,curveCardinalOpen:()=>gT,curveCatmullRom:()=>bT,curveCatmullRomClosed:()=>xT,curveCatmullRomOpen:()=>_T,curveLinear:()=>tS,curveLinearClosed:()=>TT,curveMonotoneX:()=>DT,curveMonotoneY:()=>MT,curveNatural:()=>LT,curveStep:()=>BT,curveStepAfter:()=>UT,curveStepBefore:()=>jT,descending:()=>a,deviation:()=>E,difference:()=>Jt,disjoint:()=>$t,dispatch:()=>Ie,drag:()=>mc,dragDisable:()=>qn,dragEnable:()=>Kn,dsv:()=>Ll,dsvFormat:()=>Tc,easeBack:()=>Tl,easeBackIn:()=>_l,easeBackInOut:()=>Tl,easeBackOut:()=>Sl,easeBounce:()=>wl,easeBounceIn:()=>bl,easeBounceInOut:()=>xl,easeBounceOut:()=>wl,easeCircle:()=>cl,easeCircleIn:()=>ol,easeCircleInOut:()=>cl,easeCircleOut:()=>sl,easeCubic:()=>li,easeCubicIn:()=>si,easeCubicInOut:()=>li,easeCubicOut:()=>ci,easeElastic:()=>Nl,easeElasticIn:()=>El,easeElasticInOut:()=>Cl,easeElasticOut:()=>Nl,easeExp:()=>il,easeExpIn:()=>rl,easeExpInOut:()=>il,easeExpOut:()=>al,easeLinear:()=>Gc,easePoly:()=>Qc,easePolyIn:()=>Xc,easePolyInOut:()=>Qc,easePolyOut:()=>Yc,easeQuad:()=>Kc,easeQuadIn:()=>Hc,easeQuadInOut:()=>Kc,easeQuadOut:()=>qc,easeSin:()=>el,easeSinIn:()=>Zc,easeSinInOut:()=>el,easeSinOut:()=>tl,every:()=>Ht,extent:()=>N,fcumsum:()=>R,filter:()=>Kt,flatGroup:()=>V,flatRollup:()=>W,forceCenter:()=>Kl,forceCollide:()=>ou,forceLink:()=>lu,forceManyBody:()=>vu,forceRadial:()=>bu,forceSimulation:()=>yu,forceX:()=>wu,forceY:()=>xu,format:()=>Ou,formatDefaultLocale:()=>Lu,formatLocale:()=>Pu,formatPrefix:()=>Du,formatSpecifier:()=>Iu,fsum:()=>A,geoAlbers:()=>um,geoAlbersUsa:()=>hm,geoArea:()=>Uh,geoAzimuthalEqualArea:()=>mm,geoAzimuthalEqualAreaRaw:()=>pm,geoAzimuthalEquidistant:()=>ym,geoAzimuthalEquidistantRaw:()=>gm,geoBounds:()=>kd,geoCentroid:()=>Md,geoCircle:()=>Hd,geoClipAntimeridian:()=>nf,geoClipCircle:()=>rf,geoClipExtent:()=>df,geoClipRectangle:()=>hf,geoConicConformal:()=>_m,geoConicConformalRaw:()=>km,geoConicEqualArea:()=>lm,geoConicEqualAreaRaw:()=>cm,geoConicEquidistant:()=>Em,geoConicEquidistantRaw:()=>Im,geoContains:()=>Cf,geoDistance:()=>wf,geoEqualEarth:()=>Mm,geoEqualEarthRaw:()=>Dm,geoEquirectangular:()=>Tm,geoEquirectangularRaw:()=>Sm,geoGnomonic:()=>Pm,geoGnomonicRaw:()=>Fm,geoGraticule:()=>Of,geoGraticule10:()=>Df,geoIdentity:()=>Lm,geoInterpolate:()=>Mf,geoLength:()=>yf,geoMercator:()=>bm,geoMercatorRaw:()=>vm,geoNaturalEarth1:()=>Bm,geoNaturalEarth1Raw:()=>zm,geoOrthographic:()=>Um,geoOrthographicRaw:()=>jm,geoPath:()=>Hp,geoProjection:()=>im,geoProjectionMutator:()=>om,geoRotation:()=>Vd,geoStereographic:()=>Wm,geoStereographicRaw:()=>Vm,geoStream:()=>yh,geoTransform:()=>qp,geoTransverseMercator:()=>Hm,geoTransverseMercatorRaw:()=>Gm,gray:()=>Yo,greatest:()=>wt,greatestIndex:()=>Lt,group:()=>B,groupSort:()=>tt,groups:()=>j,hcl:()=>as,hierarchy:()=>Jm,histogram:()=>ft,hsl:()=>Tr,html:()=>Hl,image:()=>jl,index:()=>q,indexes:()=>K,interpolate:()=>$r,interpolateArray:()=>Gr,interpolateBasis:()=>Rr,interpolateBasisClosed:()=>Or,interpolateBlues:()=>Jk,interpolateBrBG:()=>lk,interpolateBuGn:()=>Ek,interpolateBuPu:()=>Ck,interpolateCividis:()=>c_,interpolateCool:()=>h_,interpolateCubehelix:()=>gy,interpolateCubehelixDefault:()=>l_,interpolateCubehelixLong:()=>yy,interpolateDate:()=>qr,interpolateDiscrete:()=>ry,interpolateGnBu:()=>Rk,interpolateGreens:()=>Zk,interpolateGreys:()=>e_,interpolateHcl:()=>fy,interpolateHclLong:()=>py,interpolateHsl:()=>ly,interpolateHslLong:()=>uy,interpolateHue:()=>ay,interpolateInferno:()=>k_,interpolateLab:()=>hy,interpolateMagma:()=>x_,interpolateNumber:()=>Kr,interpolateNumberArray:()=>Vr,interpolateObject:()=>Xr,interpolateOrRd:()=>Dk,interpolateOranges:()=>s_,interpolatePRGn:()=>hk,interpolatePiYG:()=>fk,interpolatePlasma:()=>__,interpolatePuBu:()=>Lk,interpolatePuBuGn:()=>Fk,interpolatePuOr:()=>mk,interpolatePuRd:()=>Bk,interpolatePurples:()=>r_,interpolateRainbow:()=>f_,interpolateRdBu:()=>yk,interpolateRdGy:()=>bk,interpolateRdPu:()=>Uk,interpolateRdYlBu:()=>xk,interpolateRdYlGn:()=>_k,interpolateReds:()=>i_,interpolateRgb:()=>zr,interpolateRgbBasis:()=>jr,interpolateRgbBasisClosed:()=>Ur,interpolateRound:()=>iy,interpolateSinebow:()=>y_,interpolateSpectral:()=>Tk,interpolateString:()=>Jr,interpolateTransformCss:()=>Pa,interpolateTransformSvg:()=>La,interpolateTurbo:()=>v_,interpolateViridis:()=>w_,interpolateWarm:()=>u_,interpolateYlGn:()=>Hk,interpolateYlGnBu:()=>Wk,interpolateYlOrBr:()=>Kk,interpolateYlOrRd:()=>Yk,interpolateZoom:()=>sy,interrupt:()=>Aa,intersection:()=>Zt,interval:()=>lI,isoFormat:()=>oI,isoParse:()=>cI,json:()=>Vl,lab:()=>Qo,lch:()=>rs,least:()=>Ft,leastIndex:()=>Pt,line:()=>rS,lineRadial:()=>dS,link:()=>kS,linkHorizontal:()=>_S,linkRadial:()=>TS,linkVertical:()=>SS,local:()=>I_,map:()=>Xt,matcher:()=>Oe,max:()=>pt,maxIndex:()=>mt,mean:()=>It,median:()=>Et,medianIndex:()=>Nt,merge:()=>Ct,min:()=>gt,minIndex:()=>yt,mode:()=>At,namespace:()=>Ke,namespaces:()=>qe,nice:()=>ht,now:()=>ha,pack:()=>Eg,packEnclose:()=>hg,packSiblings:()=>Tg,pairs:()=>Rt,partition:()=>Dg,path:()=>To,pathRound:()=>Io,permute:()=>Q,pie:()=>sS,piecewise:()=>vy,pointRadial:()=>pS,pointer:()=>ta,pointers:()=>N_,polygonArea:()=>wy,polygonCentroid:()=>xy,polygonContains:()=>Iy,polygonHull:()=>Ty,polygonLength:()=>Ey,precisionFixed:()=>zu,precisionPrefix:()=>Bu,precisionRound:()=>ju,quadtree:()=>$l,quantile:()=>xt,quantileIndex:()=>_t,quantileSorted:()=>kt,quantize:()=>by,quickselect:()=>vt,radialArea:()=>fS,radialLine:()=>dS,randomBates:()=>My,randomBernoulli:()=>Ly,randomBeta:()=>jy,randomBinomial:()=>Uy,randomCauchy:()=>Wy,randomExponential:()=>Fy,randomGamma:()=>By,randomGeometric:()=>zy,randomInt:()=>Ay,randomIrwinHall:()=>Dy,randomLcg:()=>Yy,randomLogNormal:()=>Oy,randomLogistic:()=>Gy,randomNormal:()=>Ry,randomPareto:()=>Py,randomPoisson:()=>Hy,randomUniform:()=>Cy,randomWeibull:()=>Vy,range:()=>Dt,rank:()=>Mt,reduce:()=>Yt,reverse:()=>Qt,rgb:()=>gr,ribbon:()=>Lo,ribbonArrow:()=>zo,rollup:()=>G,rollups:()=>H,scaleBand:()=>tv,scaleDiverging:()=>Gx,scaleDivergingLog:()=>Hx,scaleDivergingPow:()=>Kx,scaleDivergingSqrt:()=>Xx,scaleDivergingSymlog:()=>qx,scaleIdentity:()=>mv,scaleImplicit:()=>$y,scaleLinear:()=>pv,scaleLog:()=>Sv,scaleOrdinal:()=>Zy,scalePoint:()=>nv,scalePow:()=>Dv,scaleQuantile:()=>Lv,scaleQuantize:()=>zv,scaleRadial:()=>Pv,scaleSequential:()=>Lx,scaleSequentialLog:()=>zx,scaleSequentialPow:()=>jx,scaleSequentialQuantile:()=>Vx,scaleSequentialSqrt:()=>Ux,scaleSequentialSymlog:()=>Bx,scaleSqrt:()=>Mv,scaleSymlog:()=>Nv,scaleThreshold:()=>Bv,scaleTime:()=>Dx,scaleUtc:()=>Mx,scan:()=>zt,schemeAccent:()=>Jx,schemeBlues:()=>Qk,schemeBrBG:()=>ck,schemeBuGn:()=>Ik,schemeBuPu:()=>Nk,schemeCategory10:()=>Qx,schemeDark2:()=>$x,schemeGnBu:()=>Ak,schemeGreens:()=>$k,schemeGreys:()=>t_,schemeObservable10:()=>Zx,schemeOrRd:()=>Ok,schemeOranges:()=>o_,schemePRGn:()=>uk,schemePaired:()=>tk,schemePastel1:()=>ek,schemePastel2:()=>nk,schemePiYG:()=>dk,schemePuBu:()=>Pk,schemePuBuGn:()=>Mk,schemePuOr:()=>pk,schemePuRd:()=>zk,schemePurples:()=>n_,schemeRdBu:()=>gk,schemeRdGy:()=>vk,schemeRdPu:()=>jk,schemeRdYlBu:()=>wk,schemeRdYlGn:()=>kk,schemeReds:()=>a_,schemeSet1:()=>rk,schemeSet2:()=>ak,schemeSet3:()=>ik,schemeSpectral:()=>Sk,schemeTableau10:()=>ok,schemeYlGn:()=>Gk,schemeYlGnBu:()=>Vk,schemeYlOrBr:()=>qk,schemeYlOrRd:()=>Xk,select:()=>Un,selectAll:()=>C_,selection:()=>jn,selector:()=>Ne,selectorAll:()=>Re,shuffle:()=>Bt,shuffler:()=>jt,some:()=>qt,sort:()=>J,stack:()=>qT,stackOffsetDiverging:()=>XT,stackOffsetExpand:()=>KT,stackOffsetNone:()=>VT,stackOffsetSilhouette:()=>YT,stackOffsetWiggle:()=>QT,stackOrderAppearance:()=>JT,stackOrderAscending:()=>ZT,stackOrderDescending:()=>eI,stackOrderInsideOut:()=>nI,stackOrderNone:()=>WT,stackOrderReverse:()=>rI,stratify:()=>Bg,style:()=>an,subset:()=>re,sum:()=>Ut,superset:()=>ee,svg:()=>ql,symbol:()=>ZS,symbolAsterisk:()=>ES,symbolCircle:()=>NS,symbolCross:()=>CS,symbolDiamond:()=>OS,symbolDiamond2:()=>DS,symbolPlus:()=>MS,symbolSquare:()=>FS,symbolSquare2:()=>PS,symbolStar:()=>jS,symbolTimes:()=>QS,symbolTriangle:()=>VS,symbolTriangle2:()=>GS,symbolWye:()=>YS,symbolX:()=>QS,symbols:()=>JS,symbolsFill:()=>JS,symbolsStroke:()=>$S,text:()=>Fl,thresholdFreedmanDiaconis:()=>St,thresholdScott:()=>Tt,thresholdSturges:()=>dt,tickFormat:()=>dv,tickIncrement:()=>lt,tickStep:()=>ut,ticks:()=>ct,timeDay:()=>cb,timeDays:()=>lb,timeFormat:()=>cw,timeFormatDefaultLocale:()=>Cx,timeFormatLocale:()=>ow,timeFriday:()=>wb,timeFridays:()=>Eb,timeHour:()=>ab,timeHours:()=>ib,timeInterval:()=>Yv,timeMillisecond:()=>Qv,timeMilliseconds:()=>Jv,timeMinute:()=>tb,timeMinutes:()=>eb,timeMonday:()=>gb,timeMondays:()=>_b,timeMonth:()=>Gb,timeMonths:()=>Hb,timeParse:()=>lw,timeSaturday:()=>xb,timeSaturdays:()=>Nb,timeSecond:()=>$v,timeSeconds:()=>Zv,timeSunday:()=>mb,timeSundays:()=>kb,timeThursday:()=>bb,timeThursdays:()=>Ib,timeTickInterval:()=>nw,timeTicks:()=>ew,timeTuesday:()=>yb,timeTuesdays:()=>Sb,timeWednesday:()=>vb,timeWednesdays:()=>Tb,timeWeek:()=>mb,timeWeeks:()=>kb,timeYear:()=>Xb,timeYears:()=>Yb,timeout:()=>ba,timer:()=>pa,timerFlush:()=>ma,transition:()=>ai,transpose:()=>Vt,tree:()=>Xg,treemap:()=>Zg,treemapBinary:()=>ty,treemapDice:()=>Og,treemapResquarify:()=>ny,treemapSlice:()=>Yg,treemapSliceDice:()=>ey,treemapSquarify:()=>$g,tsv:()=>Bl,tsvFormat:()=>Lc,tsvFormatBody:()=>zc,tsvFormatRow:()=>jc,tsvFormatRows:()=>Bc,tsvFormatValue:()=>Uc,tsvParse:()=>Fc,tsvParseRows:()=>Pc,union:()=>ae,unixDay:()=>db,unixDays:()=>fb,utcDay:()=>ub,utcDays:()=>hb,utcFormat:()=>uw,utcFriday:()=>Fb,utcFridays:()=>Vb,utcHour:()=>ob,utcHours:()=>sb,utcMillisecond:()=>Qv,utcMilliseconds:()=>Jv,utcMinute:()=>nb,utcMinutes:()=>rb,utcMonday:()=>Rb,utcMondays:()=>zb,utcMonth:()=>qb,utcMonths:()=>Kb,utcParse:()=>hw,utcSaturday:()=>Pb,utcSaturdays:()=>Wb,utcSecond:()=>$v,utcSeconds:()=>Zv,utcSunday:()=>Ab,utcSundays:()=>Lb,utcThursday:()=>Mb,utcThursdays:()=>Ub,utcTickInterval:()=>tw,utcTicks:()=>Zb,utcTuesday:()=>Ob,utcTuesdays:()=>Bb,utcWednesday:()=>Db,utcWednesdays:()=>jb,utcWeek:()=>Ab,utcWeeks:()=>Lb,utcYear:()=>Qb,utcYears:()=>Jb,variance:()=>I,window:()=>tn,xml:()=>Gl,zip:()=>Gt,zoom:()=>_I,zoomIdentity:()=>fI,zoomTransform:()=>pI});const c=i(r),l=c.right,u=c.left,h=i(s).center,d=l;function f(t,e){if(!((e=+e)>=0))throw new RangeError("invalid r");let n=t.length;if(!((n=Math.floor(n))>=0))throw new RangeError("invalid length");if(!n||!e)return t;const r=b(e),a=t.slice();return r(t,a,0,n,1),r(a,t,0,n,1),r(t,a,0,n,1),t}const p=g(b),m=g(function(t){const e=b(t);return(t,n,r,a,i)=>{e(t,n,(r<<=2)+0,(a<<=2)+0,i<<=2),e(t,n,r+1,a+1,i),e(t,n,r+2,a+2,i),e(t,n,r+3,a+3,i)}});function g(t){return function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;if(!((n=+n)>=0))throw new RangeError("invalid rx");if(!((r=+r)>=0))throw new RangeError("invalid ry");let{data:a,width:i,height:o}=e;if(!((i=Math.floor(i))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(void 0!==o?o:a.length/i))>=0))throw new RangeError("invalid height");if(!i||!o||!n&&!r)return e;const s=n&&t(n),c=r&&t(r),l=a.slice();return s&&c?(y(s,l,a,i,o),y(s,a,l,i,o),y(s,l,a,i,o),v(c,a,l,i,o),v(c,l,a,i,o),v(c,a,l,i,o)):s?(y(s,a,l,i,o),y(s,l,a,i,o),y(s,a,l,i,o)):c&&(v(c,a,l,i,o),v(c,l,a,i,o),v(c,a,l,i,o)),e}}function y(t,e,n,r,a){for(let i=0,o=r*a;i<o;)t(e,n,i,i+=r,1)}function v(t,e,n,r,a){for(let i=0,o=r*a;i<r;++i)t(e,n,i,i+o,r)}function b(t){const e=Math.floor(t);if(e===t)return function(t){const e=2*t+1;return(n,r,a,i,o)=>{if(!((i-=o)>=a))return;let s=t*r[a];const c=o*t;for(let t=a,e=a+c;t<e;t+=o)s+=r[Math.min(i,t)];for(let t=a,l=i;t<=l;t+=o)s+=r[Math.min(i,t+c)],n[t]=s/e,s-=r[Math.max(a,t-c)]}}(t);const n=t-e,r=2*t+1;return(t,a,i,o,s)=>{if(!((o-=s)>=i))return;let c=e*a[i];const l=s*e,u=l+s;for(let e=i,n=i+l;e<n;e+=s)c+=a[Math.min(o,e)];for(let e=i,h=o;e<=h;e+=s)c+=a[Math.min(o,e+l)],t[e]=(c+n*(a[Math.max(i,e-u)]+a[Math.min(o,e+u)]))/r,c-=a[Math.max(i,e-l)]}}function w(t,e){let n=0;if(void 0===e)for(let r of t)null!=r&&(r=+r)>=r&&++n;else{let r=-1;for(let a of t)null!=(a=e(a,++r,t))&&(a=+a)>=a&&++n}return n}function x(t){return 0|t.length}function k(t){return!(t>0)}function _(t){return"object"!==typeof t||"length"in t?t:Array.from(t)}function S(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r="function"===typeof e[e.length-1]&&function(t){return e=>t(...e)}(e.pop()),a=(e=e.map(_)).map(x),i=e.length-1,o=new Array(i+1).fill(0),s=[];if(i<0||a.some(k))return s;for(;;){s.push(o.map((t,n)=>e[n][t]));let t=i;for(;++o[t]===a[t];){if(0===t)return r?s.map(r):s;o[t--]=0}}}function T(t,e){var n=0,r=0;return Float64Array.from(t,void 0===e?t=>n+=+t||0:a=>n+=+e(a,r++,t)||0)}function I(t,e){let n,r=0,a=0,i=0;if(void 0===e)for(let o of t)null!=o&&(o=+o)>=o&&(n=o-a,a+=n/++r,i+=n*(o-a));else{let o=-1;for(let s of t)null!=(s=e(s,++o,t))&&(s=+s)>=s&&(n=s-a,a+=n/++r,i+=n*(s-a))}if(r>1)return i/(r-1)}function E(t,e){const n=I(t,e);return n?Math.sqrt(n):n}function N(t,e){let n,r;if(void 0===e)for(const a of t)null!=a&&(void 0===n?a>=a&&(n=r=a):(n>a&&(n=a),r<a&&(r=a)));else{let a=-1;for(let i of t)null!=(i=e(i,++a,t))&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)))}return[n,r]}class C{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const a=e[r],i=t+a,o=Math.abs(t)<Math.abs(a)?t-(i-a):a-(i-t);o&&(e[n++]=o),t=i}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,a=this._n,i=0;if(a>0){for(i=t[--a];a>0&&(e=i,n=t[--a],i=e+n,r=n-(i-e),!r););a>0&&(r<0&&t[a-1]<0||r>0&&t[a-1]>0)&&(n=2*r,e=i+n,n==e-i&&(i=e))}return i}}function A(t,e){const n=new C;if(void 0===e)for(let r of t)(r=+r)&&n.add(r);else{let r=-1;for(let a of t)(a=+e(a,++r,t))&&n.add(a)}return+n}function R(t,e){const n=new C;let r=-1;return Float64Array.from(t,void 0===e?t=>n.add(+t||0):a=>n.add(+e(a,++r,t)||0))}class O extends Map{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[n,r]of t)this.set(n,r)}get(t){return super.get(M(this,t))}has(t){return super.has(M(this,t))}set(t,e){return super.set(F(this,t),e)}delete(t){return super.delete(P(this,t))}}class D extends Set{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const n of t)this.add(n)}has(t){return super.has(M(this,t))}add(t){return super.add(F(this,t))}delete(t){return super.delete(P(this,t))}}function M(t,e){let{_intern:n,_key:r}=t;const a=r(e);return n.has(a)?n.get(a):e}function F(t,e){let{_intern:n,_key:r}=t;const a=r(e);return n.has(a)?n.get(a):(n.set(a,e),e)}function P(t,e){let{_intern:n,_key:r}=t;const a=r(e);return n.has(a)&&(e=n.get(a),n.delete(a)),e}function L(t){return null!==t&&"object"===typeof t?t.valueOf():t}function z(t){return t}function B(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Y(t,z,z,n)}function j(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Y(t,Array.from,z,n)}function U(t,e){for(let n=1,r=e.length;n<r;++n)t=t.flatMap(t=>t.pop().map(e=>{let[n,r]=e;return[...t,n,r]}));return t}function V(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return U(j(t,...n),n)}function W(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return U(H(t,e,...r),r)}function G(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return Y(t,z,e,r)}function H(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return Y(t,Array.from,e,r)}function q(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Y(t,z,X,n)}function K(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Y(t,Array.from,X,n)}function X(t){if(1!==t.length)throw new Error("duplicate key");return t[0]}function Y(t,e,n,r){return function t(a,i){if(i>=r.length)return n(a);const o=new O,s=r[i++];let c=-1;for(const e of a){const t=s(e,++c,a),n=o.get(t);n?n.push(e):o.set(t,[e])}for(const[e,n]of o)o.set(e,t(n,i));return e(o)}(t,0)}function Q(t,e){return Array.from(e,e=>t[e])}function J(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if("function"!==typeof t[Symbol.iterator])throw new TypeError("values is not iterable");t=Array.from(t);let[a]=n;if(a&&2!==a.length||n.length>1){const e=Uint32Array.from(t,(t,e)=>e);return n.length>1?(n=n.map(e=>t.map(e)),e.sort((t,e)=>{for(const r of n){const n=Z(r[t],r[e]);if(n)return n}})):(a=t.map(a),e.sort((t,e)=>Z(a[t],a[e]))),Q(t,e)}return t.sort($(a))}function $(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;if(t===r)return Z;if("function"!==typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||0===r?r:(0===t(n,n))-(0===t(e,e))}}function Z(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}function tt(t,e,n){return(2!==e.length?J(G(t,e,n),(t,e)=>{let[n,a]=t,[i,o]=e;return r(a,o)||r(n,i)}):J(B(t,n),(t,n)=>{let[a,i]=t,[o,s]=n;return e(i,s)||r(a,o)})).map(t=>{let[e]=t;return e})}var et=Array.prototype,nt=et.slice;et.map;function rt(t){return()=>t}const at=Math.sqrt(50),it=Math.sqrt(10),ot=Math.sqrt(2);function st(t,e,n){const r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),i=r/Math.pow(10,a),o=i>=at?10:i>=it?5:i>=ot?2:1;let s,c,l;return a<0?(l=Math.pow(10,-a)/o,s=Math.round(t*l),c=Math.round(e*l),s/l<t&&++s,c/l>e&&--c,l=-l):(l=Math.pow(10,a)*o,s=Math.round(t/l),c=Math.round(e/l),s*l<t&&++s,c*l>e&&--c),c<s&&.5<=n&&n<2?st(t,e,2*n):[s,c,l]}function ct(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[a,i,o]=r?st(e,t,n):st(t,e,n);if(!(i>=a))return[];const s=i-a+1,c=new Array(s);if(r)if(o<0)for(let l=0;l<s;++l)c[l]=(i-l)/-o;else for(let l=0;l<s;++l)c[l]=(i-l)*o;else if(o<0)for(let l=0;l<s;++l)c[l]=(a+l)/-o;else for(let l=0;l<s;++l)c[l]=(a+l)*o;return c}function lt(t,e,n){return st(t=+t,e=+e,n=+n)[2]}function ut(t,e,n){n=+n;const r=(e=+e)<(t=+t),a=r?lt(e,t,n):lt(t,e,n);return(r?-1:1)*(a<0?1/-a:a)}function ht(t,e,n){let r;for(;;){const a=lt(t,e,n);if(a===r||0===a||!isFinite(a))return[t,e];a>0?(t=Math.floor(t/a)*a,e=Math.ceil(e/a)*a):a<0&&(t=Math.ceil(t*a)/a,e=Math.floor(e*a)/a),r=a}}function dt(t){return Math.max(1,Math.ceil(Math.log(w(t))/Math.LN2)+1)}function ft(){var t=z,e=N,n=dt;function r(r){Array.isArray(r)||(r=Array.from(r));var a,i,o,s=r.length,c=new Array(s);for(a=0;a<s;++a)c[a]=t(r[a],a,r);var l=e(c),u=l[0],h=l[1],f=n(c,u,h);if(!Array.isArray(f)){const t=h,n=+f;if(e===N&&([u,h]=ht(u,h,n)),(f=ct(u,h,n))[0]<=u&&(o=lt(u,h,n)),f[f.length-1]>=h)if(t>=h&&e===N){const t=lt(u,h,n);isFinite(t)&&(t>0?h=(Math.floor(h/t)+1)*t:t<0&&(h=(Math.ceil(h*-t)+1)/-t))}else f.pop()}for(var p=f.length,m=0,g=p;f[m]<=u;)++m;for(;f[g-1]>h;)--g;(m||g<p)&&(f=f.slice(m,g),p=g-m);var y,v=new Array(p+1);for(a=0;a<=p;++a)(y=v[a]=[]).x0=a>0?f[a-1]:u,y.x1=a<p?f[a]:h;if(isFinite(o)){if(o>0)for(a=0;a<s;++a)null!=(i=c[a])&&u<=i&&i<=h&&v[Math.min(p,Math.floor((i-u)/o))].push(r[a]);else if(o<0)for(a=0;a<s;++a)if(null!=(i=c[a])&&u<=i&&i<=h){const t=Math.floor((u-i)*o);v[Math.min(p,t+(f[t]<=i))].push(r[a])}}else for(a=0;a<s;++a)null!=(i=c[a])&&u<=i&&i<=h&&v[d(f,i,0,p)].push(r[a]);return v}return r.value=function(e){return arguments.length?(t="function"===typeof e?e:rt(e),r):t},r.domain=function(t){return arguments.length?(e="function"===typeof t?t:rt([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"===typeof t?t:rt(Array.isArray(t)?nt.call(t):t),r):n},r}function pt(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let a of t)null!=(a=e(a,++r,t))&&(n<a||void 0===n&&a>=a)&&(n=a)}return n}function mt(t,e){let n,r=-1,a=-1;if(void 0===e)for(const i of t)++a,null!=i&&(n<i||void 0===n&&i>=i)&&(n=i,r=a);else for(let i of t)null!=(i=e(i,++a,t))&&(n<i||void 0===n&&i>=i)&&(n=i,r=a);return r}function gt(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let a of t)null!=(a=e(a,++r,t))&&(n>a||void 0===n&&a>=a)&&(n=a)}return n}function yt(t,e){let n,r=-1,a=-1;if(void 0===e)for(const i of t)++a,null!=i&&(n>i||void 0===n&&i>=i)&&(n=i,r=a);else for(let i of t)null!=(i=e(i,++a,t))&&(n>i||void 0===n&&i>=i)&&(n=i,r=a);return r}function vt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,a=arguments.length>4?arguments[4]:void 0;if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(a=void 0===a?Z:$(a);r>n;){if(r-n>600){const i=r-n+1,o=e-n+1,s=Math.log(i),c=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*c*(i-c)/i)*(o-i/2<0?-1:1);vt(t,e,Math.max(n,Math.floor(e-o*c/i+l)),Math.min(r,Math.floor(e+(i-o)*c/i+l)),a)}const i=t[e];let o=n,s=r;for(bt(t,n,e),a(t[r],i)>0&&bt(t,n,r);o<s;){for(bt(t,o,s),++o,--s;a(t[o],i)<0;)++o;for(;a(t[s],i)>0;)--s}0===a(t[n],i)?bt(t,n,s):(++s,bt(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function bt(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function wt(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,a=!1;if(1===n.length){let i;for(const o of t){const t=n(o);(a?r(t,i)>0:0===r(t,t))&&(e=o,i=t,a=!0)}}else for(const r of t)(a?n(r,e)>0:0===n(r,r))&&(e=r,a=!0);return e}function xt(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n)),(r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return gt(t);if(e>=1)return pt(t);var r,a=(r-1)*e,i=Math.floor(a),o=pt(vt(t,i).subarray(0,i+1));return o+(gt(t.subarray(i+1))-o)*(a-i)}}function kt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s;if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,a=(r-1)*e,i=Math.floor(a),o=+n(t[i],i,t);return o+(+n(t[i+1],i+1,t)-o)*(a-i)}}function _t(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s;if(!isNaN(e=+e)){if(r=Float64Array.from(t,(e,r)=>s(n(t[r],r,t))),e<=0)return yt(r);if(e>=1)return mt(r);var r,a=Uint32Array.from(t,(t,e)=>e),i=r.length-1,o=Math.floor(i*e);return vt(a,o,0,i,(t,e)=>Z(r[t],r[e])),(o=wt(a.subarray(0,o+1),t=>r[t]))>=0?o:-1}}function St(t,e,n){const r=w(t),a=xt(t,.75)-xt(t,.25);return r&&a?Math.ceil((n-e)/(2*a*Math.pow(r,-1/3))):1}function Tt(t,e,n){const r=w(t),a=E(t);return r&&a?Math.ceil((n-e)*Math.cbrt(r)/(3.49*a)):1}function It(t,e){let n=0,r=0;if(void 0===e)for(let a of t)null!=a&&(a=+a)>=a&&(++n,r+=a);else{let a=-1;for(let i of t)null!=(i=e(i,++a,t))&&(i=+i)>=i&&(++n,r+=i)}if(n)return r/n}function Et(t,e){return xt(t,.5,e)}function Nt(t,e){return _t(t,.5,e)}function Ct(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function At(t,e){const n=new O;if(void 0===e)for(let i of t)null!=i&&i>=i&&n.set(i,(n.get(i)||0)+1);else{let r=-1;for(let a of t)null!=(a=e(a,++r,t))&&a>=a&&n.set(a,(n.get(a)||0)+1)}let r,a=0;for(const[i,o]of n)o>a&&(a=o,r=i);return r}function Rt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ot;const n=[];let r,a=!1;for(const i of t)a&&n.push(e(r,i)),r=i,a=!0;return n}function Ot(t,e){return[t,e]}function Dt(t,e,n){t=+t,e=+e,n=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((e-t)/n)),i=new Array(a);++r<a;)i[r]=t+r*n;return i}function Mt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;if("function"!==typeof t[Symbol.iterator])throw new TypeError("values is not iterable");let n=Array.from(t);const a=new Float64Array(n.length);2!==e.length&&(n=n.map(e),e=r);const i=(t,r)=>e(n[t],n[r]);let o,s;return(t=Uint32Array.from(n,(t,e)=>e)).sort(e===r?(t,e)=>Z(n[t],n[e]):$(i)),t.forEach((t,e)=>{const n=i(t,void 0===o?t:o);n>=0?((void 0===o||n>0)&&(o=t,s=e),a[t]=s):a[t]=NaN}),a}function Ft(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,a=!1;if(1===n.length){let i;for(const o of t){const t=n(o);(a?r(t,i)<0:0===r(t,t))&&(e=o,i=t,a=!0)}}else for(const r of t)(a?n(r,e)<0:0===n(r,r))&&(e=r,a=!0);return e}function Pt(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;if(1===n.length)return yt(t,n);let a=-1,i=-1;for(const r of t)++i,(a<0?0===n(r,r):n(r,e)<0)&&(e=r,a=i);return a}function Lt(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;if(1===n.length)return mt(t,n);let a=-1,i=-1;for(const r of t)++i,(a<0?0===n(r,r):n(r,e)>0)&&(e=r,a=i);return a}function zt(t,e){const n=Pt(t,e);return n<0?void 0:n}const Bt=jt(Math.random);function jt(t){return function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length)-(n=+n);for(;r;){const a=t()*r--|0,i=e[r+n];e[r+n]=e[a+n],e[a+n]=i}return e}}function Ut(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let a of t)(a=+e(a,++r,t))&&(n+=a)}return n}function Vt(t){if(!(a=t.length))return[];for(var e=-1,n=gt(t,Wt),r=new Array(n);++e<n;)for(var a,i=-1,o=r[e]=new Array(a);++i<a;)o[i]=t[i][e];return r}function Wt(t){return t.length}function Gt(){return Vt(arguments)}function Ht(t,e){if("function"!==typeof e)throw new TypeError("test is not a function");let n=-1;for(const r of t)if(!e(r,++n,t))return!1;return!0}function qt(t,e){if("function"!==typeof e)throw new TypeError("test is not a function");let n=-1;for(const r of t)if(e(r,++n,t))return!0;return!1}function Kt(t,e){if("function"!==typeof e)throw new TypeError("test is not a function");const n=[];let r=-1;for(const a of t)e(a,++r,t)&&n.push(a);return n}function Xt(t,e){if("function"!==typeof t[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!==typeof e)throw new TypeError("mapper is not a function");return Array.from(t,(n,r)=>e(n,r,t))}function Yt(t,e,n){if("function"!==typeof e)throw new TypeError("reducer is not a function");const r=t[Symbol.iterator]();let a,i,o=-1;if(arguments.length<3){if(({done:a,value:n}=r.next()),a)return;++o}for(;({done:a,value:i}=r.next()),!a;)n=e(n,i,++o,t);return n}function Qt(t){if("function"!==typeof t[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(t).reverse()}function Jt(t){t=new D(t);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const a of n)for(const e of a)t.delete(e);return t}function $t(t,e){const n=e[Symbol.iterator](),r=new D;for(const a of t){if(r.has(a))return!1;let t,e;for(;({value:t,done:e}=n.next())&&!e;){if(Object.is(a,t))return!1;r.add(t)}}return!0}function Zt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];t=new D(t),n=n.map(te);t:for(const a of t)for(const e of n)if(!e.has(a)){t.delete(a);continue t}return t}function te(t){return t instanceof D?t:new D(t)}function ee(t,e){const n=t[Symbol.iterator](),r=new Set;for(const a of e){const t=ne(a);if(r.has(t))continue;let e,i;for(;({value:e,done:i}=n.next());){if(i)return!1;const n=ne(e);if(r.add(n),Object.is(t,n))break}}return!0}function ne(t){return null!==t&&"object"===typeof t?t.valueOf():t}function re(t,e){return ee(e,t)}function ae(){const t=new D;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const a of n)for(const e of a)t.add(e);return t}function ie(t){return t}var oe=1,se=2,ce=3,le=4,ue=1e-6;function he(t){return"translate("+t+",0)"}function de(t){return"translate(0,"+t+")"}function fe(t){return e=>+t(e)}function pe(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function me(){return!this.__axis}function ge(t,e){var n=[],r=null,a=null,i=6,o=6,s=3,c="undefined"!==typeof window&&window.devicePixelRatio>1?0:.5,l=t===oe||t===le?-1:1,u=t===le||t===se?"x":"y",h=t===oe||t===ce?he:de;function d(d){var f=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,p=null==a?e.tickFormat?e.tickFormat.apply(e,n):ie:a,m=Math.max(i,0)+s,g=e.range(),y=+g[0]+c,v=+g[g.length-1]+c,b=(e.bandwidth?pe:fe)(e.copy(),c),w=d.selection?d.selection():d,x=w.selectAll(".domain").data([null]),k=w.selectAll(".tick").data(f,e).order(),_=k.exit(),S=k.enter().append("g").attr("class","tick"),T=k.select("line"),I=k.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),k=k.merge(S),T=T.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",l*i)),I=I.merge(S.append("text").attr("fill","currentColor").attr(u,l*m).attr("dy",t===oe?"0em":t===ce?"0.71em":"0.32em")),d!==w&&(x=x.transition(d),k=k.transition(d),T=T.transition(d),I=I.transition(d),_=_.transition(d).attr("opacity",ue).attr("transform",function(t){return isFinite(t=b(t))?h(t+c):this.getAttribute("transform")}),S.attr("opacity",ue).attr("transform",function(t){var e=this.parentNode.__axis;return h((e&&isFinite(e=e(t))?e:b(t))+c)})),_.remove(),x.attr("d",t===le||t===se?o?"M"+l*o+","+y+"H"+c+"V"+v+"H"+l*o:"M"+c+","+y+"V"+v:o?"M"+y+","+l*o+"V"+c+"H"+v+"V"+l*o:"M"+y+","+c+"H"+v),k.attr("opacity",1).attr("transform",function(t){return h(b(t)+c)}),T.attr(u+"2",l*i),I.attr(u,l*m).text(p),w.filter(me).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===se?"start":t===le?"end":"middle"),w.each(function(){this.__axis=b})}return d.scale=function(t){return arguments.length?(e=t,d):e},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),d):n.slice()},d.tickValues=function(t){return arguments.length?(r=null==t?null:Array.from(t),d):r&&r.slice()},d.tickFormat=function(t){return arguments.length?(a=t,d):a},d.tickSize=function(t){return arguments.length?(i=o=+t,d):i},d.tickSizeInner=function(t){return arguments.length?(i=+t,d):i},d.tickSizeOuter=function(t){return arguments.length?(o=+t,d):o},d.tickPadding=function(t){return arguments.length?(s=+t,d):s},d.offset=function(t){return arguments.length?(c=+t,d):c},d}function ye(t){return ge(oe,t)}function ve(t){return ge(se,t)}function be(t){return ge(ce,t)}function we(t){return ge(le,t)}var xe={value:()=>{}};function ke(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new _e(r)}function _e(t){this._=t}function Se(t,e){for(var n,r=0,a=t.length;r<a;++r)if((n=t[r]).name===e)return n.value}function Te(t,e,n){for(var r=0,a=t.length;r<a;++r)if(t[r].name===e){t[r]=xe,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}_e.prototype=ke.prototype={constructor:_e,on:function(t,e){var n,r,a=this._,i=(r=a,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=i[o]).type)a[n]=Te(a[n],t.name,e);else if(null==e)for(n in a)a[n]=Te(a[n],t.name,null);return this}for(;++o<s;)if((n=(t=i[o]).type)&&(n=Se(a[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new _e(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,n=(r=this._[t]).length;i<n;++i)r[i].value.apply(e,a)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],a=0,i=r.length;a<i;++a)r[a].value.apply(e,n)}};const Ie=ke;function Ee(){}function Ne(t){return null==t?Ee:function(){return this.querySelector(t)}}function Ce(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function Ae(){return[]}function Re(t){return null==t?Ae:function(){return this.querySelectorAll(t)}}function Oe(t){return function(){return this.matches(t)}}function De(t){return function(e){return e.matches(t)}}var Me=Array.prototype.find;function Fe(){return this.firstElementChild}var Pe=Array.prototype.filter;function Le(){return Array.from(this.children)}function ze(t){return new Array(t.length)}function Be(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function je(t,e,n,r,a,i){for(var o,s=0,c=e.length,l=i.length;s<l;++s)(o=e[s])?(o.__data__=i[s],r[s]=o):n[s]=new Be(t,i[s]);for(;s<c;++s)(o=e[s])&&(a[s]=o)}function Ue(t,e,n,r,a,i,o){var s,c,l,u=new Map,h=e.length,d=i.length,f=new Array(h);for(s=0;s<h;++s)(c=e[s])&&(f[s]=l=o.call(c,c.__data__,s,e)+"",u.has(l)?a[s]=c:u.set(l,c));for(s=0;s<d;++s)l=o.call(t,i[s],s,i)+"",(c=u.get(l))?(r[s]=c,c.__data__=i[s],u.delete(l)):n[s]=new Be(t,i[s]);for(s=0;s<h;++s)(c=e[s])&&u.get(f[s])===c&&(a[s]=c)}function Ve(t){return t.__data__}function We(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function Ge(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Be.prototype={constructor:Be,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var He="http://www.w3.org/1999/xhtml";const qe={svg:"http://www.w3.org/2000/svg",xhtml:He,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ke(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),qe.hasOwnProperty(e)?{space:qe[e],local:t}:t}function Xe(t){return function(){this.removeAttribute(t)}}function Ye(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Qe(t,e){return function(){this.setAttribute(t,e)}}function Je(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function $e(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Ze(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function tn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function en(t){return function(){this.style.removeProperty(t)}}function nn(t,e,n){return function(){this.style.setProperty(t,e,n)}}function rn(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function an(t,e){return t.style.getPropertyValue(e)||tn(t).getComputedStyle(t,null).getPropertyValue(e)}function on(t){return function(){delete this[t]}}function sn(t,e){return function(){this[t]=e}}function cn(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function ln(t){return t.trim().split(/^|\s+/)}function un(t){return t.classList||new hn(t)}function hn(t){this._node=t,this._names=ln(t.getAttribute("class")||"")}function dn(t,e){for(var n=un(t),r=-1,a=e.length;++r<a;)n.add(e[r])}function fn(t,e){for(var n=un(t),r=-1,a=e.length;++r<a;)n.remove(e[r])}function pn(t){return function(){dn(this,t)}}function mn(t){return function(){fn(this,t)}}function gn(t,e){return function(){(e.apply(this,arguments)?dn:fn)(this,t)}}function yn(){this.textContent=""}function vn(t){return function(){this.textContent=t}}function bn(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function wn(){this.innerHTML=""}function xn(t){return function(){this.innerHTML=t}}function kn(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function _n(){this.nextSibling&&this.parentNode.appendChild(this)}function Sn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Tn(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===He&&e.documentElement.namespaceURI===He?e.createElement(t):e.createElementNS(n,t)}}function In(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function En(t){var e=Ke(t);return(e.local?In:Tn)(e)}function Nn(){return null}function Cn(){var t=this.parentNode;t&&t.removeChild(this)}function An(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Rn(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function On(t){return function(){var e=this.__on;if(e){for(var n,r=0,a=-1,i=e.length;r<i;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++a]=n:this.removeEventListener(n.type,n.listener,n.options);++a?e.length=a:delete this.__on}}}function Dn(t,e,n){return function(){var r,a=this.__on,i=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(a)for(var o=0,s=a.length;o<s;++o)if((r=a[o]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),void(r.value=e);this.addEventListener(t.type,i,n),r={type:t.type,name:t.name,value:e,listener:i,options:n},a?a.push(r):this.__on=[r]}}function Mn(t,e,n){var r=tn(t),a=r.CustomEvent;"function"===typeof a?a=new a(e,n):(a=r.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),t.dispatchEvent(a)}function Fn(t,e){return function(){return Mn(this,t,e)}}function Pn(t,e){return function(){return Mn(this,t,e.apply(this,arguments))}}hn.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Ln=[null];function zn(t,e){this._groups=t,this._parents=e}function Bn(){return new zn([[document.documentElement]],Ln)}zn.prototype=Bn.prototype={constructor:zn,select:function(t){"function"!==typeof t&&(t=Ne(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i,o,s=e[a],c=s.length,l=r[a]=new Array(c),u=0;u<c;++u)(i=s[u])&&(o=t.call(i,i.__data__,u,s))&&("__data__"in i&&(o.__data__=i.__data__),l[u]=o);return new zn(r,this._parents)},selectAll:function(t){t="function"===typeof t?function(t){return function(){return Ce(t.apply(this,arguments))}}(t):Re(t);for(var e=this._groups,n=e.length,r=[],a=[],i=0;i<n;++i)for(var o,s=e[i],c=s.length,l=0;l<c;++l)(o=s[l])&&(r.push(t.call(o,o.__data__,l,s)),a.push(o));return new zn(r,a)},selectChild:function(t){return this.select(null==t?Fe:function(t){return function(){return Me.call(this.children,t)}}("function"===typeof t?t:De(t)))},selectChildren:function(t){return this.selectAll(null==t?Le:function(t){return function(){return Pe.call(this.children,t)}}("function"===typeof t?t:De(t)))},filter:function(t){"function"!==typeof t&&(t=Oe(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i,o=e[a],s=o.length,c=r[a]=[],l=0;l<s;++l)(i=o[l])&&t.call(i,i.__data__,l,o)&&c.push(i);return new zn(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Ve);var n=e?Ue:je,r=this._parents,a=this._groups;"function"!==typeof t&&(t=function(t){return function(){return t}}(t));for(var i=a.length,o=new Array(i),s=new Array(i),c=new Array(i),l=0;l<i;++l){var u=r[l],h=a[l],d=h.length,f=We(t.call(u,u&&u.__data__,l,r)),p=f.length,m=s[l]=new Array(p),g=o[l]=new Array(p);n(u,h,m,g,c[l]=new Array(d),f,e);for(var y,v,b=0,w=0;b<p;++b)if(y=m[b]){for(b>=w&&(w=b+1);!(v=g[w])&&++w<p;);y._next=v||null}}return(o=new zn(o,r))._enter=s,o._exit=c,o},enter:function(){return new zn(this._enter||this._groups.map(ze),this._parents)},exit:function(){return new zn(this._exit||this._groups.map(ze),this._parents)},join:function(t,e,n){var r=this.enter(),a=this,i=this.exit();return"function"===typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(a=e(a))&&(a=a.selection()),null==n?i.remove():n(i),r&&a?r.merge(a).order():a},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,a=n.length,i=r.length,o=Math.min(a,i),s=new Array(a),c=0;c<o;++c)for(var l,u=n[c],h=r[c],d=u.length,f=s[c]=new Array(d),p=0;p<d;++p)(l=u[p]||h[p])&&(f[p]=l);for(;c<a;++c)s[c]=n[c];return new zn(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,a=t[e],i=a.length-1,o=a[i];--i>=0;)(r=a[i])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Ge);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o,s=n[i],c=s.length,l=a[i]=new Array(c),u=0;u<c;++u)(o=s[u])&&(l[u]=o);l.sort(e)}return new zn(a,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var a,i=e[n],o=0,s=i.length;o<s;++o)(a=i[o])&&t.call(a,a.__data__,o,i);return this},attr:function(t,e){var n=Ke(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Ye:Xe:"function"===typeof e?n.local?Ze:$e:n.local?Je:Qe)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?en:"function"===typeof e?rn:nn)(t,e,null==n?"":n)):an(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?on:"function"===typeof e?cn:sn)(t,e)):this.node()[t]},classed:function(t,e){var n=ln(t+"");if(arguments.length<2){for(var r=un(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"===typeof e?gn:e?pn:mn)(n,e))},text:function(t){return arguments.length?this.each(null==t?yn:("function"===typeof t?bn:vn)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?wn:("function"===typeof t?kn:xn)(t)):this.node().innerHTML},raise:function(){return this.each(_n)},lower:function(){return this.each(Sn)},append:function(t){var e="function"===typeof t?t:En(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"===typeof t?t:En(t),r=null==e?Nn:"function"===typeof e?e:Ne(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(Cn)},clone:function(t){return this.select(t?Rn:An)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,a,i=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),o=i.length;if(!(arguments.length<2)){for(s=e?Dn:On,r=0;r<o;++r)this.each(s(i[r],e,n));return this}var s=this.node().__on;if(s)for(var c,l=0,u=s.length;l<u;++l)for(r=0,c=s[l];r<o;++r)if((a=i[r]).type===c.type&&a.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"===typeof e?Pn:Fn)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,a=t[e],i=0,o=a.length;i<o;++i)(r=a[i])&&(yield r)}};const jn=Bn;function Un(t){return"string"===typeof t?new zn([[document.querySelector(t)]],[document.documentElement]):new zn([[t]],Ln)}const Vn={passive:!1},Wn={capture:!0,passive:!1};function Gn(t){t.stopImmediatePropagation()}function Hn(t){t.preventDefault(),t.stopImmediatePropagation()}function qn(t){var e=t.document.documentElement,n=Un(t).on("dragstart.drag",Hn,Wn);"onselectstart"in e?n.on("selectstart.drag",Hn,Wn):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Kn(t,e){var n=t.document.documentElement,r=Un(t).on("dragstart.drag",null);e&&(r.on("click.drag",Hn,Wn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Xn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Yn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Qn(){}var Jn=.7,$n=1/Jn,Zn="\\s*([+-]?\\d+)\\s*",tr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",er="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",nr=/^#([0-9a-f]{3,8})$/,rr=new RegExp("^rgb\\(".concat(Zn,",").concat(Zn,",").concat(Zn,"\\)$")),ar=new RegExp("^rgb\\(".concat(er,",").concat(er,",").concat(er,"\\)$")),ir=new RegExp("^rgba\\(".concat(Zn,",").concat(Zn,",").concat(Zn,",").concat(tr,"\\)$")),or=new RegExp("^rgba\\(".concat(er,",").concat(er,",").concat(er,",").concat(tr,"\\)$")),sr=new RegExp("^hsl\\(".concat(tr,",").concat(er,",").concat(er,"\\)$")),cr=new RegExp("^hsla\\(".concat(tr,",").concat(er,",").concat(er,",").concat(tr,"\\)$")),lr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ur(){return this.rgb().formatHex()}function hr(){return this.rgb().formatRgb()}function dr(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=nr.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?fr(e):3===n?new yr(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?pr(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?pr(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=rr.exec(t))?new yr(e[1],e[2],e[3],1):(e=ar.exec(t))?new yr(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ir.exec(t))?pr(e[1],e[2],e[3],e[4]):(e=or.exec(t))?pr(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=sr.exec(t))?_r(e[1],e[2]/100,e[3]/100,1):(e=cr.exec(t))?_r(e[1],e[2]/100,e[3]/100,e[4]):lr.hasOwnProperty(t)?fr(lr[t]):"transparent"===t?new yr(NaN,NaN,NaN,0):null}function fr(t){return new yr(t>>16&255,t>>8&255,255&t,1)}function pr(t,e,n,r){return r<=0&&(t=e=n=NaN),new yr(t,e,n,r)}function mr(t){return t instanceof Qn||(t=dr(t)),t?new yr((t=t.rgb()).r,t.g,t.b,t.opacity):new yr}function gr(t,e,n,r){return 1===arguments.length?mr(t):new yr(t,e,n,null==r?1:r)}function yr(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function vr(){return"#".concat(kr(this.r)).concat(kr(this.g)).concat(kr(this.b))}function br(){const t=wr(this.opacity);return"".concat(1===t?"rgb(":"rgba(").concat(xr(this.r),", ").concat(xr(this.g),", ").concat(xr(this.b)).concat(1===t?")":", ".concat(t,")"))}function wr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function xr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function kr(t){return((t=xr(t))<16?"0":"")+t.toString(16)}function _r(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ir(t,e,n,r)}function Sr(t){if(t instanceof Ir)return new Ir(t.h,t.s,t.l,t.opacity);if(t instanceof Qn||(t=dr(t)),!t)return new Ir;if(t instanceof Ir)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),i=Math.max(e,n,r),o=NaN,s=i-a,c=(i+a)/2;return s?(o=e===i?(n-r)/s+6*(n<r):n===i?(r-e)/s+2:(e-n)/s+4,s/=c<.5?i+a:2-i-a,o*=60):s=c>0&&c<1?0:o,new Ir(o,s,c,t.opacity)}function Tr(t,e,n,r){return 1===arguments.length?Sr(t):new Ir(t,e,n,null==r?1:r)}function Ir(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Er(t){return(t=(t||0)%360)<0?t+360:t}function Nr(t){return Math.max(0,Math.min(1,t||0))}function Cr(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Ar(t,e,n,r,a){var i=t*t,o=i*t;return((1-3*t+3*i-o)*e+(4-6*i+3*o)*n+(1+3*t+3*i-3*o)*r+o*a)/6}function Rr(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),a=t[r],i=t[r+1],o=r>0?t[r-1]:2*a-i,s=r<e-1?t[r+2]:2*i-a;return Ar((n-r/e)*e,o,a,i,s)}}function Or(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),a=t[(r+e-1)%e],i=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return Ar((n-r/e)*e,a,i,o,s)}}Xn(Qn,dr,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ur,formatHex:ur,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Sr(this).formatHsl()},formatRgb:hr,toString:hr}),Xn(yr,gr,Yn(Qn,{brighter(t){return t=null==t?$n:Math.pow($n,t),new yr(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Jn:Math.pow(Jn,t),new yr(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new yr(xr(this.r),xr(this.g),xr(this.b),wr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:vr,formatHex:vr,formatHex8:function(){return"#".concat(kr(this.r)).concat(kr(this.g)).concat(kr(this.b)).concat(kr(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:br,toString:br})),Xn(Ir,Tr,Yn(Qn,{brighter(t){return t=null==t?$n:Math.pow($n,t),new Ir(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Jn:Math.pow(Jn,t),new Ir(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new yr(Cr(t>=240?t-240:t+120,a,r),Cr(t,a,r),Cr(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new Ir(Er(this.h),Nr(this.s),Nr(this.l),wr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=wr(this.opacity);return"".concat(1===t?"hsl(":"hsla(").concat(Er(this.h),", ").concat(100*Nr(this.s),"%, ").concat(100*Nr(this.l),"%").concat(1===t?")":", ".concat(t,")"))}}));const Dr=t=>()=>t;function Mr(t,e){return function(n){return t+n*e}}function Fr(t,e){var n=e-t;return n?Mr(t,n>180||n<-180?n-360*Math.round(n/360):n):Dr(isNaN(t)?e:t)}function Pr(t){return 1===(t=+t)?Lr:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Dr(isNaN(e)?n:e)}}function Lr(t,e){var n=e-t;return n?Mr(t,n):Dr(isNaN(t)?e:t)}const zr=function t(e){var n=Pr(e);function r(t,e){var r=n((t=gr(t)).r,(e=gr(e)).r),a=n(t.g,e.g),i=n(t.b,e.b),o=Lr(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=a(e),t.b=i(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function Br(t){return function(e){var n,r,a=e.length,i=new Array(a),o=new Array(a),s=new Array(a);for(n=0;n<a;++n)r=gr(e[n]),i[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return i=t(i),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=i(t),r.g=o(t),r.b=s(t),r+""}}}var jr=Br(Rr),Ur=Br(Or);function Vr(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,a=e.slice();return function(i){for(n=0;n<r;++n)a[n]=t[n]*(1-i)+e[n]*i;return a}}function Wr(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Gr(t,e){return(Wr(e)?Vr:Hr)(t,e)}function Hr(t,e){var n,r=e?e.length:0,a=t?Math.min(r,t.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=$r(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<a;++n)o[n]=i[n](t);return o}}function qr(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Kr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Xr(t,e){var n,r={},a={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=$r(t[n],e[n]):a[n]=e[n];return function(t){for(n in r)a[n]=r[n](t);return a}}var Yr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Qr=new RegExp(Yr.source,"g");function Jr(t,e){var n,r,a,i=Yr.lastIndex=Qr.lastIndex=0,o=-1,s=[],c=[];for(t+="",e+="";(n=Yr.exec(t))&&(r=Qr.exec(e));)(a=r.index)>i&&(a=e.slice(i,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Kr(n,r)})),i=Qr.lastIndex;return i<e.length&&(a=e.slice(i),s[o]?s[o]+=a:s[++o]=a),s.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,r=0;r<e;++r)s[(n=c[r]).i]=n.x(t);return s.join("")})}function $r(t,e){var n,r=typeof e;return null==e||"boolean"===r?Dr(e):("number"===r?Kr:"string"===r?(n=dr(e))?(e=n,zr):Jr:e instanceof dr?zr:e instanceof Date?qr:Wr(e)?Vr:Array.isArray(e)?Hr:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?Xr:Kr)(t,e)}function Zr(t){let e;for(;e=t.sourceEvent;)t=e;return t}function ta(t,e){if(t=Zr(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}}return[t.pageX,t.pageY]}var ea,na,ra=0,aa=0,ia=0,oa=0,sa=0,ca=0,la="object"===typeof performance&&performance.now?performance:Date,ua="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ha(){return sa||(ua(da),sa=la.now()+ca)}function da(){sa=0}function fa(){this._call=this._time=this._next=null}function pa(t,e,n){var r=new fa;return r.restart(t,e,n),r}function ma(){ha(),++ra;for(var t,e=ea;e;)(t=sa-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ra}function ga(){sa=(oa=la.now())+ca,ra=aa=0;try{ma()}finally{ra=0,function(){var t,e,n=ea,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:ea=e);na=t,va(r)}(),sa=0}}function ya(){var t=la.now(),e=t-oa;e>1e3&&(ca-=e,oa=t)}function va(t){ra||(aa&&(aa=clearTimeout(aa)),t-sa>24?(t<1/0&&(aa=setTimeout(ga,t-la.now()-ca)),ia&&(ia=clearInterval(ia))):(ia||(oa=la.now(),ia=setInterval(ya,1e3)),ra=1,ua(ga)))}function ba(t,e,n){var r=new fa;return e=null==e?0:+e,r.restart(n=>{r.stop(),t(n+e)},e,n),r}fa.prototype=pa.prototype={constructor:fa,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?ha():+n)+(null==e?0:+e),this._next||na===this||(na?na._next=this:ea=this,na=this),this._call=t,this._time=n,va()},stop:function(){this._call&&(this._call=null,this._time=1/0,va())}};var wa=Ie("start","end","cancel","interrupt"),xa=[],ka=1,_a=2,Sa=5,Ta=6;function Ia(t,e,n,r,a,i){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,a=t.__transition;function i(t){n.state=ka,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}function o(i){var l,u,h,d;if(n.state!==ka)return c();for(l in a)if((d=a[l]).name===n.name){if(3===d.state)return ba(o);4===d.state?(d.state=Ta,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete a[l]):+l<e&&(d.state=Ta,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete a[l])}if(ba(function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(i))}),n.state=_a,n.on.call("start",t,t.__data__,n.index,n.group),n.state===_a){for(n.state=3,r=new Array(h=n.tween.length),l=0,u=-1;l<h;++l)(d=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function s(e){for(var a=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(c),n.state=Sa,1),i=-1,o=r.length;++i<o;)r[i].call(t,a);n.state===Sa&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){for(var r in n.state=Ta,n.timer.stop(),delete a[e],a)return;delete t.__transition}a[e]=n,n.timer=pa(i,0,n.time)}(t,n,{name:e,index:r,group:a,on:wa,tween:xa,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:0})}function Ea(t,e){var n=Ca(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Na(t,e){var n=Ca(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Ca(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Aa(t,e){var n,r,a,i=t.__transition,o=!0;if(i){for(a in e=null==e?null:e+"",i)(n=i[a]).name===e?(r=n.state>_a&&n.state<Sa,n.state=Ta,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete i[a]):o=!1;o&&delete t.__transition}}var Ra,Oa=180/Math.PI,Da={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ma(t,e,n,r,a,i){var o,s,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(e,t)*Oa,skewX:Math.atan(c)*Oa,scaleX:o,scaleY:s}}function Fa(t,e,n,r){function a(t){return t.length?t.pop()+" ":""}return function(i,o){var s=[],c=[];return i=t(i),o=t(o),function(t,r,a,i,o,s){if(t!==a||r!==i){var c=o.push("translate(",null,e,null,n);s.push({i:c-4,x:Kr(t,a)},{i:c-2,x:Kr(r,i)})}else(a||i)&&o.push("translate("+a+e+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,s,c),function(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(a(n)+"rotate(",null,r)-2,x:Kr(t,e)})):e&&n.push(a(n)+"rotate("+e+r)}(i.rotate,o.rotate,s,c),function(t,e,n,i){t!==e?i.push({i:n.push(a(n)+"skewX(",null,r)-2,x:Kr(t,e)}):e&&n.push(a(n)+"skewX("+e+r)}(i.skewX,o.skewX,s,c),function(t,e,n,r,i,o){if(t!==n||e!==r){var s=i.push(a(i)+"scale(",null,",",null,")");o.push({i:s-4,x:Kr(t,n)},{i:s-2,x:Kr(e,r)})}else 1===n&&1===r||i.push(a(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,s,c),i=o=null,function(t){for(var e,n=-1,r=c.length;++n<r;)s[(e=c[n]).i]=e.x(t);return s.join("")}}}var Pa=Fa(function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Da:Ma(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),La=Fa(function(t){return null==t?Da:(Ra||(Ra=document.createElementNS("http://www.w3.org/2000/svg","g")),Ra.setAttribute("transform",t),(t=Ra.transform.baseVal.consolidate())?Ma((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Da)},", ",")",")");function za(t,e){var n,r;return function(){var a=Na(this,t),i=a.tween;if(i!==n)for(var o=0,s=(r=n=i).length;o<s;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}a.tween=r}}function Ba(t,e,n){var r,a;if("function"!==typeof n)throw new Error;return function(){var i=Na(this,t),o=i.tween;if(o!==r){a=(r=o).slice();for(var s={name:e,value:n},c=0,l=a.length;c<l;++c)if(a[c].name===e){a[c]=s;break}c===l&&a.push(s)}i.tween=a}}function ja(t,e,n){var r=t._id;return t.each(function(){var t=Na(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return Ca(t,r).value[e]}}function Ua(t,e){var n;return("number"===typeof e?Kr:e instanceof dr?zr:(n=dr(e))?(e=n,zr):Jr)(t,e)}function Va(t){return function(){this.removeAttribute(t)}}function Wa(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ga(t,e,n){var r,a,i=n+"";return function(){var o=this.getAttribute(t);return o===i?null:o===r?a:a=e(r=o,n)}}function Ha(t,e,n){var r,a,i=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?a:a=e(r=o,n)}}function qa(t,e,n){var r,a,i;return function(){var o,s,c=n(this);if(null!=c)return(o=this.getAttribute(t))===(s=c+"")?null:o===r&&s===a?i:(a=s,i=e(r=o,c));this.removeAttribute(t)}}function Ka(t,e,n){var r,a,i;return function(){var o,s,c=n(this);if(null!=c)return(o=this.getAttributeNS(t.space,t.local))===(s=c+"")?null:o===r&&s===a?i:(a=s,i=e(r=o,c));this.removeAttributeNS(t.space,t.local)}}function Xa(t,e){var n,r;function a(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,a)),n}return a._value=e,a}function Ya(t,e){var n,r;function a(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,a)),n}return a._value=e,a}function Qa(t,e){return function(){Ea(this,t).delay=+e.apply(this,arguments)}}function Ja(t,e){return e=+e,function(){Ea(this,t).delay=e}}function $a(t,e){return function(){Na(this,t).duration=+e.apply(this,arguments)}}function Za(t,e){return e=+e,function(){Na(this,t).duration=e}}var ti=jn.prototype.constructor;function ei(t){return function(){this.style.removeProperty(t)}}var ni=0;function ri(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function ai(t){return jn().transition(t)}function ii(){return++ni}var oi=jn.prototype;function si(t){return t*t*t}function ci(t){return--t*t*t+1}function li(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}ri.prototype=ai.prototype={constructor:ri,select:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=Ne(t));for(var r=this._groups,a=r.length,i=new Array(a),o=0;o<a;++o)for(var s,c,l=r[o],u=l.length,h=i[o]=new Array(u),d=0;d<u;++d)(s=l[d])&&(c=t.call(s,s.__data__,d,l))&&("__data__"in s&&(c.__data__=s.__data__),h[d]=c,Ia(h[d],e,n,d,h,Ca(s,n)));return new ri(i,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!==typeof t&&(t=Re(t));for(var r=this._groups,a=r.length,i=[],o=[],s=0;s<a;++s)for(var c,l=r[s],u=l.length,h=0;h<u;++h)if(c=l[h]){for(var d,f=t.call(c,c.__data__,h,l),p=Ca(c,n),m=0,g=f.length;m<g;++m)(d=f[m])&&Ia(d,e,n,m,f,p);i.push(f),o.push(c)}return new ri(i,o,e,n)},selectChild:oi.selectChild,selectChildren:oi.selectChildren,filter:function(t){"function"!==typeof t&&(t=Oe(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var i,o=e[a],s=o.length,c=r[a]=[],l=0;l<s;++l)(i=o[l])&&t.call(i,i.__data__,l,o)&&c.push(i);return new ri(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,a=n.length,i=Math.min(r,a),o=new Array(r),s=0;s<i;++s)for(var c,l=e[s],u=n[s],h=l.length,d=o[s]=new Array(h),f=0;f<h;++f)(c=l[f]||u[f])&&(d[f]=c);for(;s<r;++s)o[s]=e[s];return new ri(o,this._parents,this._name,this._id)},selection:function(){return new ti(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=ii(),r=this._groups,a=r.length,i=0;i<a;++i)for(var o,s=r[i],c=s.length,l=0;l<c;++l)if(o=s[l]){var u=Ca(o,e);Ia(o,t,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ri(r,this._parents,t,n)},call:oi.call,nodes:oi.nodes,node:oi.node,size:oi.size,empty:oi.empty,each:oi.each,on:function(t,e){var n=this._id;return arguments.length<2?Ca(this.node(),n).on.on(t):this.each(function(t,e,n){var r,a,i=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?Ea:Na;return function(){var o=i(this,t),s=o.on;s!==r&&(a=(r=s).copy()).on(e,n),o.on=a}}(n,t,e))},attr:function(t,e){var n=Ke(t),r="transform"===n?La:Ua;return this.attrTween(t,"function"===typeof e?(n.local?Ka:qa)(n,r,ja(this,"attr."+t,e)):null==e?(n.local?Wa:Va)(n):(n.local?Ha:Ga)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!==typeof e)throw new Error;var r=Ke(t);return this.tween(n,(r.local?Xa:Ya)(r,e))},style:function(t,e,n){var r="transform"===(t+="")?Pa:Ua;return null==e?this.styleTween(t,function(t,e){var n,r,a;return function(){var i=an(this,t),o=(this.style.removeProperty(t),an(this,t));return i===o?null:i===n&&o===r?a:a=e(n=i,r=o)}}(t,r)).on("end.style."+t,ei(t)):"function"===typeof e?this.styleTween(t,function(t,e,n){var r,a,i;return function(){var o=an(this,t),s=n(this),c=s+"";return null==s&&(this.style.removeProperty(t),c=s=an(this,t)),o===c?null:o===r&&c===a?i:(a=c,i=e(r=o,s))}}(t,r,ja(this,"style."+t,e))).each(function(t,e){var n,r,a,i,o="style."+e,s="end."+o;return function(){var c=Na(this,t),l=c.on,u=null==c.value[o]?i||(i=ei(e)):void 0;l===n&&a===u||(r=(n=l).copy()).on(s,a=u),c.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,a,i=n+"";return function(){var o=an(this,t);return o===i?null:o===r?a:a=e(r=o,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!==typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,a;function i(){var i=e.apply(this,arguments);return i!==a&&(r=(a=i)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,i,n)),r}return i._value=e,i}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"===typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ja(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!==typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,a=Ca(this.node(),n).tween,i=0,o=a.length;i<o;++i)if((r=a[i]).name===t)return r.value;return null}return this.each((null==e?za:Ba)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?Qa:Ja)(e,t)):Ca(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"===typeof t?$a:Za)(e,t)):Ca(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!==typeof e)throw new Error;return function(){Na(this,t).ease=e}}(e,t)):Ca(this.node(),e).ease},easeVarying:function(t){if("function"!==typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!==typeof n)throw new Error;Na(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,a=n.size();return new Promise(function(i,o){var s={value:o},c={value:function(){0===--a&&i()}};n.each(function(){var n=Na(this,r),a=n.on;a!==t&&((e=(t=a).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(c)),n.on=e}),0===a&&i()})},[Symbol.iterator]:oi[Symbol.iterator]};var ui={time:null,delay:0,duration:250,ease:li};function hi(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error("transition ".concat(e," not found"));return n}jn.prototype.interrupt=function(t){return this.each(function(){Aa(this,t)})},jn.prototype.transition=function(t){var e,n;t instanceof ri?(e=t._id,t=t._name):(e=ii(),(n=ui).time=ha(),t=null==t?null:t+"");for(var r=this._groups,a=r.length,i=0;i<a;++i)for(var o,s=r[i],c=s.length,l=0;l<c;++l)(o=s[l])&&Ia(o,t,e,l,s,n||hi(o,e));return new ri(r,this._parents,t,e)};var di=[null];function fi(t,e){var n,r,a=t.__transition;if(a)for(r in e=null==e?null:e+"",a)if((n=a[r]).state>ka&&n.name===e)return new ri([[t]],di,e,+r);return null}const pi=t=>()=>t;function mi(t,e){let{sourceEvent:n,target:r,selection:a,mode:i,dispatch:o}=e;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},selection:{value:a,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function gi(t){t.preventDefault(),t.stopImmediatePropagation()}var yi={name:"drag"},vi={name:"space"},bi={name:"handle"},wi={name:"center"};const{abs:xi,max:ki,min:_i}=Math;function Si(t){return[+t[0],+t[1]]}function Ti(t){return[Si(t[0]),Si(t[1])]}var Ii={name:"x",handles:["w","e"].map(Mi),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Ei={name:"y",handles:["n","s"].map(Mi),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Ni={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Mi),input:function(t){return null==t?null:Ti(t)},output:function(t){return t}},Ci={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ai={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Ri={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Oi={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Di={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Mi(t){return{type:t}}function Fi(t){return!t.ctrlKey&&!t.button}function Pi(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Li(){return navigator.maxTouchPoints||"ontouchstart"in this}function zi(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Bi(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function ji(){return Wi(Ii)}function Ui(){return Wi(Ei)}function Vi(){return Wi(Ni)}function Wi(t){var e,n=Pi,r=Fi,a=Li,i=!0,o=Ie("start","brush","end"),s=6;function c(e){var n=e.property("__brush",m).selectAll(".overlay").data([Mi("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Ci.overlay).merge(n).each(function(){var t=zi(this).extent;Un(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),e.selectAll(".selection").data([Mi("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Ci.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=e.selectAll(".handle").data(t.handles,function(t){return t.type});r.exit().remove(),r.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return Ci[t.type]}),e.each(l).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",d).filter(a).on("touchstart.brush",d).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function l(){var t=Un(this),e=zi(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?e[1][0]-s/2:e[0][0]-s/2}).attr("y",function(t){return"s"===t.type[0]?e[1][1]-s/2:e[0][1]-s/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+s:s}).attr("height",function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+s:s})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(t,e,n){var r=t.__brush.emitter;return!r||n&&r.clean?new h(t,e,n):r}function h(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function d(n){if((!e||n.touches)&&r.apply(this,arguments)){var a,o,s,c,h,d,f,p,m,g,y,v=this,b=n.target.__data__.type,w="selection"===(i&&n.metaKey?b="overlay":b)?yi:i&&n.altKey?wi:bi,x=t===Ei?null:Oi[b],k=t===Ii?null:Di[b],_=zi(v),S=_.extent,T=_.selection,I=S[0][0],E=S[0][1],N=S[1][0],C=S[1][1],A=0,R=0,O=x&&k&&i&&n.shiftKey,D=Array.from(n.touches||[n],t=>{const e=t.identifier;return(t=ta(t,v)).point0=t.slice(),t.identifier=e,t});Aa(v);var M=u(v,arguments,!0).beforestart();if("overlay"===b){T&&(m=!0);const e=[D[0],D[1]||D[0]];_.selection=T=[[a=t===Ei?I:_i(e[0][0],e[1][0]),s=t===Ii?E:_i(e[0][1],e[1][1])],[h=t===Ei?N:ki(e[0][0],e[1][0]),f=t===Ii?C:ki(e[0][1],e[1][1])]],D.length>1&&B(n)}else a=T[0][0],s=T[0][1],h=T[1][0],f=T[1][1];o=a,c=s,d=h,p=f;var F=Un(v).attr("pointer-events","none"),P=F.selectAll(".overlay").attr("cursor",Ci[b]);if(n.touches)M.moved=z,M.ended=j;else{var L=Un(n.view).on("mousemove.brush",z,!0).on("mouseup.brush",j,!0);i&&L.on("keydown.brush",function(t){switch(t.keyCode){case 16:O=x&&k;break;case 18:w===bi&&(x&&(h=d-A*x,a=o+A*x),k&&(f=p-R*k,s=c+R*k),w=wi,B(t));break;case 32:w!==bi&&w!==wi||(x<0?h=d-A:x>0&&(a=o-A),k<0?f=p-R:k>0&&(s=c-R),w=vi,P.attr("cursor",Ci.selection),B(t));break;default:return}gi(t)},!0).on("keyup.brush",function(t){switch(t.keyCode){case 16:O&&(g=y=O=!1,B(t));break;case 18:w===wi&&(x<0?h=d:x>0&&(a=o),k<0?f=p:k>0&&(s=c),w=bi,B(t));break;case 32:w===vi&&(t.altKey?(x&&(h=d-A*x,a=o+A*x),k&&(f=p-R*k,s=c+R*k),w=wi):(x<0?h=d:x>0&&(a=o),k<0?f=p:k>0&&(s=c),w=bi),P.attr("cursor",Ci[b]),B(t));break;default:return}gi(t)},!0),qn(n.view)}l.call(v),M.start(n,w.name)}function z(t){for(const e of t.changedTouches||[t])for(const t of D)t.identifier===e.identifier&&(t.cur=ta(e,v));if(O&&!g&&!y&&1===D.length){const t=D[0];xi(t.cur[0]-t[0])>xi(t.cur[1]-t[1])?y=!0:g=!0}for(const e of D)e.cur&&(e[0]=e.cur[0],e[1]=e.cur[1]);m=!0,gi(t),B(t)}function B(t){const e=D[0],n=e.point0;var r;switch(A=e[0]-n[0],R=e[1]-n[1],w){case vi:case yi:x&&(A=ki(I-a,_i(N-h,A)),o=a+A,d=h+A),k&&(R=ki(E-s,_i(C-f,R)),c=s+R,p=f+R);break;case bi:D[1]?(x&&(o=ki(I,_i(N,D[0][0])),d=ki(I,_i(N,D[1][0])),x=1),k&&(c=ki(E,_i(C,D[0][1])),p=ki(E,_i(C,D[1][1])),k=1)):(x<0?(A=ki(I-a,_i(N-a,A)),o=a+A,d=h):x>0&&(A=ki(I-h,_i(N-h,A)),o=a,d=h+A),k<0?(R=ki(E-s,_i(C-s,R)),c=s+R,p=f):k>0&&(R=ki(E-f,_i(C-f,R)),c=s,p=f+R));break;case wi:x&&(o=ki(I,_i(N,a-A*x)),d=ki(I,_i(N,h+A*x))),k&&(c=ki(E,_i(C,s-R*k)),p=ki(E,_i(C,f+R*k)))}d<o&&(x*=-1,r=a,a=h,h=r,r=o,o=d,d=r,b in Ai&&P.attr("cursor",Ci[b=Ai[b]])),p<c&&(k*=-1,r=s,s=f,f=r,r=c,c=p,p=r,b in Ri&&P.attr("cursor",Ci[b=Ri[b]])),_.selection&&(T=_.selection),g&&(o=T[0][0],d=T[1][0]),y&&(c=T[0][1],p=T[1][1]),T[0][0]===o&&T[0][1]===c&&T[1][0]===d&&T[1][1]===p||(_.selection=[[o,c],[d,p]],l.call(v),M.brush(t,w.name))}function j(t){if(function(t){t.stopImmediatePropagation()}(t),t.touches){if(t.touches.length)return;e&&clearTimeout(e),e=setTimeout(function(){e=null},500)}else Kn(t.view,m),L.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);F.attr("pointer-events","all"),P.attr("cursor",Ci.overlay),_.selection&&(T=_.selection),function(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}(T)&&(_.selection=null,l.call(v)),M.end(t,w.name)}}function f(t){u(this,arguments).moved(t)}function p(t){u(this,arguments).ended(t)}function m(){var e=this.__brush||{selection:null};return e.extent=Ti(n.apply(this,arguments)),e.dim=t,e}return c.move=function(e,n,r){e.tween?e.on("start.brush",function(t){u(this,arguments).beforestart().start(t)}).on("interrupt.brush end.brush",function(t){u(this,arguments).end(t)}).tween("brush",function(){var e=this,r=e.__brush,a=u(e,arguments),i=r.selection,o=t.input("function"===typeof n?n.apply(this,arguments):n,r.extent),s=$r(i,o);function c(t){r.selection=1===t&&null===o?null:s(t),l.call(e),a.brush()}return null!==i&&null!==o?c:c(1)}):e.each(function(){var e=this,a=arguments,i=e.__brush,o=t.input("function"===typeof n?n.apply(e,a):n,i.extent),s=u(e,a).beforestart();Aa(e),i.selection=null===o?null:o,l.call(e),s.start(r).brush(r).end(r)})},c.clear=function(t,e){c.move(t,null,e)},h.prototype={beforestart:function(){return 1===++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(t,e){return this.starting?(this.starting=!1,this.emit("start",t,e)):this.emit("brush",t),this},brush:function(t,e){return this.emit("brush",t,e),this},end:function(t,e){return 0===--this.active&&(delete this.state.emitter,this.emit("end",t,e)),this},emit:function(e,n,r){var a=Un(this.that).datum();o.call(e,this.that,new mi(e,{sourceEvent:n,target:c,selection:t.output(this.state.selection),mode:r,dispatch:o}),a)}},c.extent=function(t){return arguments.length?(n="function"===typeof t?t:pi(Ti(t)),c):n},c.filter=function(t){return arguments.length?(r="function"===typeof t?t:pi(!!t),c):r},c.touchable=function(t){return arguments.length?(a="function"===typeof t?t:pi(!!t),c):a},c.handleSize=function(t){return arguments.length?(s=+t,c):s},c.keyModifiers=function(t){return arguments.length?(i=!!t,c):i},c.on=function(){var t=o.on.apply(o,arguments);return t===o?c:t},c}var Gi,Hi,qi,Ki,Xi,Yi,Qi,Ji,$i,Zi,to,eo,no,ro,ao=Math.abs,io=Math.cos,oo=Math.sin,so=Math.PI,co=so/2,lo=2*so,uo=Math.max,ho=1e-12;function fo(t,e){return Array.from({length:e-t},(e,n)=>t+n)}function po(){return yo(!1,!1)}function mo(){return yo(!1,!0)}function go(){return yo(!0,!1)}function yo(t,e){var n=0,r=null,a=null,i=null;function o(o){var s,c=o.length,l=new Array(c),u=fo(0,c),h=new Array(c*c),d=new Array(c),f=0;o=Float64Array.from({length:c*c},e?(t,e)=>o[e%c][e/c|0]:(t,e)=>o[e/c|0][e%c]);for(let e=0;e<c;++e){let n=0;for(let r=0;r<c;++r)n+=o[e*c+r]+t*o[r*c+e];f+=l[e]=n}s=(f=uo(0,lo-n*c)/f)?n:lo/c;{let e=0;r&&u.sort((t,e)=>r(l[t],l[e]));for(const n of u){const r=e;if(t){const t=fo(1+~c,c).filter(t=>t<0?o[~t*c+n]:o[n*c+t]);a&&t.sort((t,e)=>a(t<0?-o[~t*c+n]:o[n*c+t],e<0?-o[~e*c+n]:o[n*c+e]));for(const r of t)if(r<0){(h[~r*c+n]||(h[~r*c+n]={source:null,target:null})).target={index:n,startAngle:e,endAngle:e+=o[~r*c+n]*f,value:o[~r*c+n]}}else{(h[n*c+r]||(h[n*c+r]={source:null,target:null})).source={index:n,startAngle:e,endAngle:e+=o[n*c+r]*f,value:o[n*c+r]}}d[n]={index:n,startAngle:r,endAngle:e,value:l[n]}}else{const t=fo(0,c).filter(t=>o[n*c+t]||o[t*c+n]);a&&t.sort((t,e)=>a(o[n*c+t],o[n*c+e]));for(const r of t){let t;if(n<r?(t=h[n*c+r]||(h[n*c+r]={source:null,target:null}),t.source={index:n,startAngle:e,endAngle:e+=o[n*c+r]*f,value:o[n*c+r]}):(t=h[r*c+n]||(h[r*c+n]={source:null,target:null}),t.target={index:n,startAngle:e,endAngle:e+=o[n*c+r]*f,value:o[n*c+r]},n===r&&(t.source=t.target)),t.source&&t.target&&t.source.value<t.target.value){const e=t.source;t.source=t.target,t.target=e}}d[n]={index:n,startAngle:r,endAngle:e,value:l[n]}}e+=s}}return(h=Object.values(h)).groups=d,i?h.sort(i):h}return o.padAngle=function(t){return arguments.length?(n=uo(0,t),o):n},o.sortGroups=function(t){return arguments.length?(r=t,o):r},o.sortSubgroups=function(t){return arguments.length?(a=t,o):a},o.sortChords=function(t){return arguments.length?(null==t?i=null:(e=t,i=function(t,n){return e(t.source.value+t.target.value,n.source.value+n.target.value)})._=t,o):i&&i._;var e},o}function vo(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}const bo=Math.PI,wo=2*bo,xo=1e-6,ko=wo-xo;function _o(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class So{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?_o:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error("invalid digits: ".concat(t));if(e>15)return _o;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append(Gi||(Gi=vo(["M",",",""])),this._x0=this._x1=+t,this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(Hi||(Hi=vo(["Z"]))))}lineTo(t,e){this._append(qi||(qi=vo(["L",",",""])),this._x1=+t,this._y1=+e)}quadraticCurveTo(t,e,n,r){this._append(Ki||(Ki=vo(["Q",",",",",",",""])),+t,+e,this._x1=+n,this._y1=+r)}bezierCurveTo(t,e,n,r,a,i){this._append(Xi||(Xi=vo(["C",",",",",",",",",",",""])),+t,+e,+n,+r,this._x1=+a,this._y1=+i)}arcTo(t,e,n,r,a){if(t=+t,e=+e,n=+n,r=+r,(a=+a)<0)throw new Error("negative radius: ".concat(a));let i=this._x1,o=this._y1,s=n-t,c=r-e,l=i-t,u=o-e,h=l*l+u*u;if(null===this._x1)this._append(Yi||(Yi=vo(["M",",",""])),this._x1=t,this._y1=e);else if(h>xo)if(Math.abs(u*s-c*l)>xo&&a){let d=n-i,f=r-o,p=s*s+c*c,m=d*d+f*f,g=Math.sqrt(p),y=Math.sqrt(h),v=a*Math.tan((bo-Math.acos((p+h-m)/(2*g*y)))/2),b=v/y,w=v/g;Math.abs(b-1)>xo&&this._append(Ji||(Ji=vo(["L",",",""])),t+b*l,e+b*u),this._append($i||($i=vo(["A",",",",0,0,",",",",",""])),a,a,+(u*d>l*f),this._x1=t+w*s,this._y1=e+w*c)}else this._append(Qi||(Qi=vo(["L",",",""])),this._x1=t,this._y1=e);else;}arc(t,e,n,r,a,i){if(t=+t,e=+e,i=!!i,(n=+n)<0)throw new Error("negative radius: ".concat(n));let o=n*Math.cos(r),s=n*Math.sin(r),c=t+o,l=e+s,u=1^i,h=i?r-a:a-r;null===this._x1?this._append(Zi||(Zi=vo(["M",",",""])),c,l):(Math.abs(this._x1-c)>xo||Math.abs(this._y1-l)>xo)&&this._append(to||(to=vo(["L",",",""])),c,l),n&&(h<0&&(h=h%wo+wo),h>ko?this._append(eo||(eo=vo(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,u,t-o,e-s,n,n,u,this._x1=c,this._y1=l):h>xo&&this._append(no||(no=vo(["A",",",",0,",",",",",",",""])),n,n,+(h>=bo),u,this._x1=t+n*Math.cos(a),this._y1=e+n*Math.sin(a)))}rect(t,e,n,r){this._append(ro||(ro=vo(["M",",","h","v","h","Z"])),this._x0=this._x1=+t,this._y0=this._y1=+e,n=+n,+r,-n)}toString(){return this._}}function To(){return new So}function Io(){return new So(+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:3))}To.prototype=So.prototype;var Eo=Array.prototype.slice;function No(t){return function(){return t}}function Co(t){return t.source}function Ao(t){return t.target}function Ro(t){return t.radius}function Oo(t){return t.startAngle}function Do(t){return t.endAngle}function Mo(){return 0}function Fo(){return 10}function Po(t){var e=Co,n=Ao,r=Ro,a=Ro,i=Oo,o=Do,s=Mo,c=null;function l(){var l,u=e.apply(this,arguments),h=n.apply(this,arguments),d=s.apply(this,arguments)/2,f=Eo.call(arguments),p=+r.apply(this,(f[0]=u,f)),m=i.apply(this,f)-co,g=o.apply(this,f)-co,y=+a.apply(this,(f[0]=h,f)),v=i.apply(this,f)-co,b=o.apply(this,f)-co;if(c||(c=l=To()),d>ho&&(ao(g-m)>2*d+ho?g>m?(m+=d,g-=d):(m-=d,g+=d):m=g=(m+g)/2,ao(b-v)>2*d+ho?b>v?(v+=d,b-=d):(v-=d,b+=d):v=b=(v+b)/2),c.moveTo(p*io(m),p*oo(m)),c.arc(0,0,p,m,g),m!==v||g!==b)if(t){var w=y-+t.apply(this,arguments),x=(v+b)/2;c.quadraticCurveTo(0,0,w*io(v),w*oo(v)),c.lineTo(y*io(x),y*oo(x)),c.lineTo(w*io(b),w*oo(b))}else c.quadraticCurveTo(0,0,y*io(v),y*oo(v)),c.arc(0,0,y,v,b);if(c.quadraticCurveTo(0,0,p*io(m),p*oo(m)),c.closePath(),l)return c=null,l+""||null}return t&&(l.headRadius=function(e){return arguments.length?(t="function"===typeof e?e:No(+e),l):t}),l.radius=function(t){return arguments.length?(r=a="function"===typeof t?t:No(+t),l):r},l.sourceRadius=function(t){return arguments.length?(r="function"===typeof t?t:No(+t),l):r},l.targetRadius=function(t){return arguments.length?(a="function"===typeof t?t:No(+t),l):a},l.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:No(+t),l):i},l.endAngle=function(t){return arguments.length?(o="function"===typeof t?t:No(+t),l):o},l.padAngle=function(t){return arguments.length?(s="function"===typeof t?t:No(+t),l):s},l.source=function(t){return arguments.length?(e=t,l):e},l.target=function(t){return arguments.length?(n=t,l):n},l.context=function(t){return arguments.length?(c=null==t?null:t,l):c},l}function Lo(){return Po()}function zo(){return Po(Fo)}const Bo=Math.PI/180,jo=180/Math.PI,Uo=.96422,Vo=1,Wo=.82521,Go=4/29,Ho=6/29,qo=3*Ho*Ho,Ko=Ho*Ho*Ho;function Xo(t){if(t instanceof Jo)return new Jo(t.l,t.a,t.b,t.opacity);if(t instanceof is)return os(t);t instanceof yr||(t=mr(t));var e,n,r=es(t.r),a=es(t.g),i=es(t.b),o=$o((.2225045*r+.7168786*a+.0606169*i)/Vo);return r===a&&a===i?e=n=o:(e=$o((.4360747*r+.3850649*a+.1430804*i)/Uo),n=$o((.0139322*r+.0971045*a+.7141733*i)/Wo)),new Jo(116*o-16,500*(e-o),200*(o-n),t.opacity)}function Yo(t,e){return new Jo(t,0,0,null==e?1:e)}function Qo(t,e,n,r){return 1===arguments.length?Xo(t):new Jo(t,e,n,null==r?1:r)}function Jo(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function $o(t){return t>Ko?Math.pow(t,1/3):t/qo+Go}function Zo(t){return t>Ho?t*t*t:qo*(t-Go)}function ts(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function es(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ns(t){if(t instanceof is)return new is(t.h,t.c,t.l,t.opacity);if(t instanceof Jo||(t=Xo(t)),0===t.a&&0===t.b)return new is(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*jo;return new is(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function rs(t,e,n,r){return 1===arguments.length?ns(t):new is(n,e,t,null==r?1:r)}function as(t,e,n,r){return 1===arguments.length?ns(t):new is(t,e,n,null==r?1:r)}function is(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function os(t){if(isNaN(t.h))return new Jo(t.l,0,0,t.opacity);var e=t.h*Bo;return new Jo(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Xn(Jo,Qo,Yn(Qn,{brighter(t){return new Jo(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new Jo(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new yr(ts(3.1338561*(e=Uo*Zo(e))-1.6168667*(t=Vo*Zo(t))-.4906146*(n=Wo*Zo(n))),ts(-.9787684*e+1.9161415*t+.033454*n),ts(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Xn(is,as,Yn(Qn,{brighter(t){return new is(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new is(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return os(this).rgb()}}));var ss=-.14861,cs=1.78277,ls=-.29227,us=-.90649,hs=1.97294,ds=hs*us,fs=hs*cs,ps=cs*ls-us*ss;function ms(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof gs)return new gs(t.h,t.s,t.l,t.opacity);t instanceof yr||(t=mr(t));var e=t.r/255,n=t.g/255,r=t.b/255,a=(ps*r+ds*e-fs*n)/(ps+ds-fs),i=r-a,o=(hs*(n-a)-ls*i)/us,s=Math.sqrt(o*o+i*i)/(hs*a*(1-a)),c=s?Math.atan2(o,i)*jo-120:NaN;return new gs(c<0?c+360:c,s,a,t.opacity)}(t):new gs(t,e,n,null==r?1:r)}function gs(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Xn(gs,ms,Yn(Qn,{brighter(t){return t=null==t?$n:Math.pow($n,t),new gs(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Jn:Math.pow(Jn,t),new gs(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*Bo,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),a=Math.sin(t);return new yr(255*(e+n*(ss*r+cs*a)),255*(e+n*(ls*r+us*a)),255*(e+n*(hs*r)),this.opacity)}}));var ys=Array.prototype.slice;function vs(t,e){return t-e}const bs=t=>()=>t;function ws(t,e){for(var n,r=-1,a=e.length;++r<a;)if(n=xs(t,e[r]))return n;return 0}function xs(t,e){for(var n=e[0],r=e[1],a=-1,i=0,o=t.length,s=o-1;i<o;s=i++){var c=t[i],l=c[0],u=c[1],h=t[s],d=h[0],f=h[1];if(ks(c,h,e))return 0;u>r!==f>r&&n<(d-l)*(r-u)/(f-u)+l&&(a=-a)}return a}function ks(t,e,n){var r,a,i,o;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(a=t[r=+(t[0]===e[0])],i=n[r],o=e[r],a<=i&&i<=o||o<=i&&i<=a)}function _s(){}var Ss=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Ts(){var t=1,e=1,n=dt,r=s;function a(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(vs);else{const n=N(t,Is);for(e=ct(...ht(n[0],n[1],e),e);e[e.length-1]>=n[1];)e.pop();for(;e[1]<n[0];)e.shift()}return e.map(e=>i(t,e))}function i(n,a){const i=null==a?NaN:+a;if(isNaN(i))throw new Error("invalid value: ".concat(a));var s=[],c=[];return function(n,r,a){var i,s,c,l,u,h,d=new Array,f=new Array;i=s=-1,l=Es(n[0],r),Ss[l<<1].forEach(p);for(;++i<t-1;)c=l,l=Es(n[i+1],r),Ss[c|l<<1].forEach(p);Ss[l|0].forEach(p);for(;++s<e-1;){for(i=-1,l=Es(n[s*t+t],r),u=Es(n[s*t],r),Ss[l<<1|u<<2].forEach(p);++i<t-1;)c=l,l=Es(n[s*t+t+i+1],r),h=u,u=Es(n[s*t+i+1],r),Ss[c|l<<1|u<<2|h<<3].forEach(p);Ss[l|u<<3].forEach(p)}i=-1,u=n[s*t]>=r,Ss[u<<2].forEach(p);for(;++i<t-1;)h=u,u=Es(n[s*t+i+1],r),Ss[u<<2|h<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+i,t[0][1]+s],c=[t[1][0]+i,t[1][1]+s],l=o(r),u=o(c);(e=f[l])?(n=d[u])?(delete f[e.end],delete d[n.start],e===n?(e.ring.push(c),a(e.ring)):d[e.start]=f[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete f[e.end],e.ring.push(c),f[e.end=u]=e):(e=d[u])?(n=f[l])?(delete d[e.start],delete f[n.end],e===n?(e.ring.push(c),a(e.ring)):d[n.start]=f[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[e.start],e.ring.unshift(r),d[e.start=l]=e):d[l]=f[u]={start:l,end:u,ring:[r,c]}}Ss[u<<3].forEach(p)}(n,i,function(t){r(t,n,i),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?s.push([t]):c.push(t)}),c.forEach(function(t){for(var e,n=0,r=s.length;n<r;++n)if(-1!==ws((e=s[n])[0],t))return void e.push(t)}),{type:"MultiPolygon",value:a,coordinates:s}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function s(n,r,a){n.forEach(function(n){var i=n[0],o=n[1],s=0|i,c=0|o,l=Ns(r[c*t+s]);i>0&&i<t&&s===i&&(n[0]=Cs(i,Ns(r[c*t+s-1]),l,a)),o>0&&o<e&&c===o&&(n[1]=Cs(o,Ns(r[(c-1)*t+s]),l,a))})}return a.contour=i,a.size=function(n){if(!arguments.length)return[t,e];var r=Math.floor(n[0]),i=Math.floor(n[1]);if(!(r>=0&&i>=0))throw new Error("invalid size");return t=r,e=i,a},a.thresholds=function(t){return arguments.length?(n="function"===typeof t?t:Array.isArray(t)?bs(ys.call(t)):bs(t),a):n},a.smooth=function(t){return arguments.length?(r=t?s:_s,a):r===s},a}function Is(t){return isFinite(t)?t:NaN}function Es(t,e){return null!=t&&+t>=e}function Ns(t){return null==t||isNaN(t=+t)?-1/0:t}function Cs(t,e,n,r){const a=r-e,i=n-e,o=isFinite(a)||isFinite(i)?a/i:Math.sign(a)/Math.sign(i);return isNaN(o)?t:t+o-.5}function As(t){return t[0]}function Rs(t){return t[1]}function Os(){return 1}function Ds(){var t=As,e=Rs,n=Os,r=960,a=500,i=20,o=2,s=3*i,c=r+2*s>>o,l=a+2*s>>o,u=bs(20);function h(r){var a=new Float32Array(c*l),u=Math.pow(2,-o),h=-1;for(const i of r){var d=(t(i,++h,r)+s)*u,f=(e(i,h,r)+s)*u,m=+n(i,h,r);if(m&&d>=0&&d<c&&f>=0&&f<l){var g=Math.floor(d),y=Math.floor(f),v=d-g-.5,b=f-y-.5;a[g+y*c]+=(1-v)*(1-b)*m,a[g+1+y*c]+=v*(1-b)*m,a[g+1+(y+1)*c]+=v*b*m,a[g+(y+1)*c]+=(1-v)*b*m}}return p({data:a,width:c,height:l},i*u),a}function d(t){var e=h(t),n=u(e),r=Math.pow(2,2*o);return Array.isArray(n)||(n=ct(Number.MIN_VALUE,pt(e)/r,n)),Ts().size([c,l]).thresholds(n.map(t=>t*r))(e).map((t,e)=>(t.value=+n[e],f(t)))}function f(t){return t.coordinates.forEach(m),t}function m(t){t.forEach(g)}function g(t){t.forEach(y)}function y(t){t[0]=t[0]*Math.pow(2,o)-s,t[1]=t[1]*Math.pow(2,o)-s}function v(){return c=r+2*(s=3*i)>>o,l=a+2*s>>o,d}return d.contours=function(t){var e=h(t),n=Ts().size([c,l]),r=Math.pow(2,2*o),a=t=>{t=+t;var a=f(n.contour(e,t*r));return a.value=t,a};return Object.defineProperty(a,"max",{get:()=>pt(e)/r}),a},d.x=function(e){return arguments.length?(t="function"===typeof e?e:bs(+e),d):t},d.y=function(t){return arguments.length?(e="function"===typeof t?t:bs(+t),d):e},d.weight=function(t){return arguments.length?(n="function"===typeof t?t:bs(+t),d):n},d.size=function(t){if(!arguments.length)return[r,a];var e=+t[0],n=+t[1];if(!(e>=0&&n>=0))throw new Error("invalid size");return r=e,a=n,v()},d.cellSize=function(t){if(!arguments.length)return 1<<o;if(!((t=+t)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(t)/Math.LN2),v()},d.thresholds=function(t){return arguments.length?(u="function"===typeof t?t:Array.isArray(t)?bs(ys.call(t)):bs(t),d):u},d.bandwidth=function(t){if(!arguments.length)return Math.sqrt(i*(i+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return i=(Math.sqrt(4*t*t+1)-1)/2,v()},d}const Ms=134217729;function Fs(t,e,n,r,a){let i,o,s,c,l=e[0],u=r[0],h=0,d=0;u>l===u>-l?(i=l,l=e[++h]):(i=u,u=r[++d]);let f=0;if(h<t&&d<n)for(u>l===u>-l?(o=l+i,s=i-(o-l),l=e[++h]):(o=u+i,s=i-(o-u),u=r[++d]),i=o,0!==s&&(a[f++]=s);h<t&&d<n;)u>l===u>-l?(o=i+l,c=o-i,s=i-(o-c)+(l-c),l=e[++h]):(o=i+u,c=o-i,s=i-(o-c)+(u-c),u=r[++d]),i=o,0!==s&&(a[f++]=s);for(;h<t;)o=i+l,c=o-i,s=i-(o-c)+(l-c),l=e[++h],i=o,0!==s&&(a[f++]=s);for(;d<n;)o=i+u,c=o-i,s=i-(o-c)+(u-c),u=r[++d],i=o,0!==s&&(a[f++]=s);return 0===i&&0!==f||(a[f++]=i),f}function Ps(t){return new Float64Array(t)}const Ls=Ps(4),zs=Ps(8),Bs=Ps(12),js=Ps(16),Us=Ps(4);function Vs(t,e,n,r,a,i){const o=(e-i)*(n-a),s=(t-a)*(r-i),c=o-s,l=Math.abs(o+s);return Math.abs(c)>=33306690738754716e-32*l?c:-function(t,e,n,r,a,i,o){let s,c,l,u,h,d,f,p,m,g,y,v,b,w,x,k,_,S;const T=t-a,I=n-a,E=e-i,N=r-i;w=T*N,d=Ms*T,f=d-(d-T),p=T-f,d=Ms*N,m=d-(d-N),g=N-m,x=p*g-(w-f*m-p*m-f*g),k=E*I,d=Ms*E,f=d-(d-E),p=E-f,d=Ms*I,m=d-(d-I),g=I-m,_=p*g-(k-f*m-p*m-f*g),y=x-_,h=x-y,Ls[0]=x-(y+h)+(h-_),v=w+y,h=v-w,b=w-(v-h)+(y-h),y=b-k,h=b-y,Ls[1]=b-(y+h)+(h-k),S=v+y,h=S-v,Ls[2]=v-(S-h)+(y-h),Ls[3]=S;let C=function(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}(4,Ls),A=22204460492503146e-32*o;if(C>=A||-C>=A)return C;if(h=t-T,s=t-(T+h)+(h-a),h=n-I,l=n-(I+h)+(h-a),h=e-E,c=e-(E+h)+(h-i),h=r-N,u=r-(N+h)+(h-i),0===s&&0===c&&0===l&&0===u)return C;if(A=11093356479670487e-47*o+33306690738754706e-32*Math.abs(C),C+=T*u+N*s-(E*l+I*c),C>=A||-C>=A)return C;w=s*N,d=Ms*s,f=d-(d-s),p=s-f,d=Ms*N,m=d-(d-N),g=N-m,x=p*g-(w-f*m-p*m-f*g),k=c*I,d=Ms*c,f=d-(d-c),p=c-f,d=Ms*I,m=d-(d-I),g=I-m,_=p*g-(k-f*m-p*m-f*g),y=x-_,h=x-y,Us[0]=x-(y+h)+(h-_),v=w+y,h=v-w,b=w-(v-h)+(y-h),y=b-k,h=b-y,Us[1]=b-(y+h)+(h-k),S=v+y,h=S-v,Us[2]=v-(S-h)+(y-h),Us[3]=S;const R=Fs(4,Ls,4,Us,zs);w=T*u,d=Ms*T,f=d-(d-T),p=T-f,d=Ms*u,m=d-(d-u),g=u-m,x=p*g-(w-f*m-p*m-f*g),k=E*l,d=Ms*E,f=d-(d-E),p=E-f,d=Ms*l,m=d-(d-l),g=l-m,_=p*g-(k-f*m-p*m-f*g),y=x-_,h=x-y,Us[0]=x-(y+h)+(h-_),v=w+y,h=v-w,b=w-(v-h)+(y-h),y=b-k,h=b-y,Us[1]=b-(y+h)+(h-k),S=v+y,h=S-v,Us[2]=v-(S-h)+(y-h),Us[3]=S;const O=Fs(R,zs,4,Us,Bs);w=s*u,d=Ms*s,f=d-(d-s),p=s-f,d=Ms*u,m=d-(d-u),g=u-m,x=p*g-(w-f*m-p*m-f*g),k=c*l,d=Ms*c,f=d-(d-c),p=c-f,d=Ms*l,m=d-(d-l),g=l-m,_=p*g-(k-f*m-p*m-f*g),y=x-_,h=x-y,Us[0]=x-(y+h)+(h-_),v=w+y,h=v-w,b=w-(v-h)+(y-h),y=b-k,h=b-y,Us[1]=b-(y+h)+(h-k),S=v+y,h=S-v,Us[2]=v-(S-h)+(y-h),Us[3]=S;const D=Fs(O,Bs,4,Us,js);return js[D-1]}(t,e,n,r,a,i,l)}Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(8),Ps(8),Ps(8),Ps(4),Ps(8),Ps(8),Ps(8),Ps(12);Ps(192),Ps(192);Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(8),Ps(8),Ps(8),Ps(8),Ps(8),Ps(8),Ps(8),Ps(8),Ps(8),Ps(4),Ps(4),Ps(4),Ps(8),Ps(16),Ps(16),Ps(16),Ps(32),Ps(32),Ps(48),Ps(64);Ps(1152),Ps(1152);Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(4),Ps(24),Ps(24),Ps(24),Ps(24),Ps(24),Ps(24),Ps(24),Ps(24),Ps(24),Ps(24),Ps(1152),Ps(1152),Ps(1152),Ps(1152),Ps(1152),Ps(2304),Ps(2304),Ps(3456),Ps(5760),Ps(8),Ps(8),Ps(8),Ps(16),Ps(24),Ps(48),Ps(48),Ps(96),Ps(192),Ps(384),Ps(384),Ps(384),Ps(768);Ps(96),Ps(96),Ps(96),Ps(1152);const Ws=Math.pow(2,-52),Gs=new Uint32Array(512);class Hs{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Js,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:$s;const r=t.length,a=new Float64Array(2*r);for(let i=0;i<r;i++){const r=t[i];a[2*i]=e(r),a[2*i+1]=n(r)}return new Hs(a)}constructor(t){const e=t.length>>1;if(e>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:a}=this,i=t.length>>1;let o=1/0,s=1/0,c=-1/0,l=-1/0;for(let S=0;S<i;S++){const e=t[2*S],n=t[2*S+1];e<o&&(o=e),n<s&&(s=n),e>c&&(c=e),n>l&&(l=n),this._ids[S]=S}const u=(o+c)/2,h=(s+l)/2;let d,f,p;for(let S=0,T=1/0;S<i;S++){const e=qs(u,h,t[2*S],t[2*S+1]);e<T&&(d=S,T=e)}const m=t[2*d],g=t[2*d+1];for(let S=0,T=1/0;S<i;S++){if(S===d)continue;const e=qs(m,g,t[2*S],t[2*S+1]);e<T&&e>0&&(f=S,T=e)}let y=t[2*f],v=t[2*f+1],b=1/0;for(let S=0;S<i;S++){if(S===d||S===f)continue;const e=Xs(m,g,y,v,t[2*S],t[2*S+1]);e<b&&(p=S,b=e)}let w=t[2*p],x=t[2*p+1];if(b===1/0){for(let r=0;r<i;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];Ys(this._ids,this._dists,0,i-1);const e=new Uint32Array(i);let n=0;for(let t=0,r=-1/0;t<i;t++){const a=this._ids[t],i=this._dists[a];i>r&&(e[n++]=a,r=i)}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Vs(m,g,y,v,w,x)<0){const t=f,e=y,n=v;f=p,y=w,v=x,p=t,w=e,x=n}const k=function(t,e,n,r,a,i){const o=n-t,s=r-e,c=a-t,l=i-e,u=o*o+s*s,h=c*c+l*l,d=.5/(o*l-s*c),f=t+(l*u-s*h)*d,p=e+(o*h-c*u)*d;return{x:f,y:p}}(m,g,y,v,w,x);this._cx=k.x,this._cy=k.y;for(let S=0;S<i;S++)this._dists[S]=qs(t[2*S],t[2*S+1],k.x,k.y);Ys(this._ids,this._dists,0,i-1),this._hullStart=d;let _=3;n[d]=e[p]=f,n[f]=e[d]=p,n[p]=e[f]=d,r[d]=0,r[f]=1,r[p]=2,a.fill(-1),a[this._hashKey(m,g)]=d,a[this._hashKey(y,v)]=f,a[this._hashKey(w,x)]=p,this.trianglesLen=0,this._addTriangle(d,f,p,-1,-1,-1);for(let S,T,I=0;I<this._ids.length;I++){const i=this._ids[I],o=t[2*i],s=t[2*i+1];if(I>0&&Math.abs(o-S)<=Ws&&Math.abs(s-T)<=Ws)continue;if(S=o,T=s,i===d||i===f||i===p)continue;let c=0;for(let t=0,e=this._hashKey(o,s);t<this._hashSize&&(c=a[(e+t)%this._hashSize],-1===c||c===n[c]);t++);c=e[c];let l,u=c;for(;l=n[u],Vs(o,s,t[2*u],t[2*u+1],t[2*l],t[2*l+1])>=0;)if(u=l,u===c){u=-1;break}if(-1===u)continue;let h=this._addTriangle(u,i,n[u],-1,-1,r[u]);r[i]=this._legalize(h+2),r[u]=h,_++;let m=n[u];for(;l=n[m],Vs(o,s,t[2*m],t[2*m+1],t[2*l],t[2*l+1])<0;)h=this._addTriangle(m,i,l,r[i],-1,r[m]),r[i]=this._legalize(h+2),n[m]=m,_--,m=l;if(u===c)for(;l=e[u],Vs(o,s,t[2*l],t[2*l+1],t[2*u],t[2*u+1])<0;)h=this._addTriangle(l,i,u,-1,r[u],r[l]),this._legalize(h+2),r[l]=h,n[u]=u,_--,u=l;this._hullStart=e[i]=u,n[u]=e[m]=i,n[i]=m,a[this._hashKey(o,s)]=i,a[this._hashKey(t[2*u],t[2*u+1])]=u}this.hull=new Uint32Array(_);for(let S=0,T=this._hullStart;S<_;S++)this.hull[S]=T,T=n[T];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let a=0,i=0;for(;;){const o=n[t],s=t-t%3;if(i=s+(t+2)%3,-1===o){if(0===a)break;t=Gs[--a];continue}const c=o-o%3,l=s+(t+1)%3,u=c+(o+2)%3,h=e[i],d=e[t],f=e[l],p=e[u];if(Ks(r[2*h],r[2*h+1],r[2*d],r[2*d+1],r[2*f],r[2*f+1],r[2*p],r[2*p+1])){e[t]=p,e[o]=h;const r=n[u];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===u){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(o,n[i]),this._link(i,u);const s=c+(o+1)%3;a<Gs.length&&(Gs[a++]=s)}else{if(0===a)break;t=Gs[--a]}}return i}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,a,i){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=e,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,a),this._link(o+2,i),this.trianglesLen+=3,o}}function qs(t,e,n,r){const a=t-n,i=e-r;return a*a+i*i}function Ks(t,e,n,r,a,i,o,s){const c=t-o,l=e-s,u=n-o,h=r-s,d=a-o,f=i-s,p=u*u+h*h,m=d*d+f*f;return c*(h*m-p*f)-l*(u*m-p*d)+(c*c+l*l)*(u*f-h*d)<0}function Xs(t,e,n,r,a,i){const o=n-t,s=r-e,c=a-t,l=i-e,u=o*o+s*s,h=c*c+l*l,d=.5/(o*l-s*c),f=(l*u-s*h)*d,p=(o*h-c*u)*d;return f*f+p*p}function Ys(t,e,n,r){if(r-n<=20)for(let a=n+1;a<=r;a++){const r=t[a],i=e[r];let o=a-1;for(;o>=n&&e[t[o]]>i;)t[o+1]=t[o--];t[o+1]=r}else{let a=n+1,i=r;Qs(t,n+r>>1,a),e[t[n]]>e[t[r]]&&Qs(t,n,r),e[t[a]]>e[t[r]]&&Qs(t,a,r),e[t[n]]>e[t[a]]&&Qs(t,n,a);const o=t[a],s=e[o];for(;;){do{a++}while(e[t[a]]<s);do{i--}while(e[t[i]]>s);if(i<a)break;Qs(t,a,i)}t[n+1]=t[i],t[i]=o,r-a+1>=i-n?(Ys(t,e,a,r),Ys(t,e,n,i-1)):(Ys(t,e,n,i-1),Ys(t,e,a,r))}}function Qs(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Js(t){return t[0]}function $s(t){return t[1]}const Zs=1e-6;class tc{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+="L".concat(this._x1=+t,",").concat(this._y1=+e)}arc(t,e,n){const r=(t=+t)+(n=+n),a=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(a):(Math.abs(this._x1-r)>Zs||Math.abs(this._y1-a)>Zs)&&(this._+="L"+r+","+a),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(t-n,",").concat(e,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=a))}rect(t,e,n,r){this._+="M".concat(this._x0=this._x1=+t,",").concat(this._y0=this._y1=+e,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}value(){return this._||null}}class ec{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class nc{constructor(t){let[e,n,r,a]=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500];if(!((r=+r)>=(e=+e))||!((a=+a)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=a,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this;let a,i;const o=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let p,m,g=0,y=0,v=n.length;g<v;g+=3,y+=2){const r=2*n[g],s=2*n[g+1],c=2*n[g+2],l=t[r],u=t[r+1],h=t[s],d=t[s+1],f=t[c],v=t[c+1],b=h-l,w=d-u,x=f-l,k=v-u,_=2*(b*k-w*x);if(Math.abs(_)<1e-9){if(void 0===a){a=i=0;for(const n of e)a+=t[2*n],i+=t[2*n+1];a/=e.length,i/=e.length}const n=1e9*Math.sign((a-l)*k-(i-u)*x);p=(l+f)/2-n*k,m=(u+v)/2+n*x}else{const t=1/_,e=b*b+w*w,n=x*x+k*k;p=l+(k*e-w*n)*t,m=u+(b*n-x*e)*t}o[y]=p,o[y+1]=m}let s,c,l,u=e[e.length-1],h=4*u,d=t[2*u],f=t[2*u+1];r.fill(0);for(let p=0;p<e.length;++p)u=e[p],s=h,c=d,l=f,h=4*u,d=t[2*u],f=t[2*u+1],r[s+2]=r[h]=l-f,r[s+3]=r[h+1]=d-c}render(t){const e=null==t?t=new tc:void 0,{delaunay:{halfedges:n,inedges:r,hull:a},circumcenters:i,vectors:o}=this;if(a.length<=1)return null;for(let l=0,u=n.length;l<u;++l){const e=n[l];if(e<l)continue;const r=2*Math.floor(l/3),a=2*Math.floor(e/3),o=i[r],s=i[r+1],c=i[a],u=i[a+1];this._renderSegment(o,s,c,u,t)}let s,c=a[a.length-1];for(let l=0;l<a.length;++l){s=c,c=a[l];const e=2*Math.floor(r[c]/3),n=i[e],u=i[e+1],h=4*s,d=this._project(n,u,o[h+2],o[h+3]);d&&this._renderSegment(n,u,d[0],d[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new tc:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new tc:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let a=r.length;for(;r[0]===r[a-2]&&r[1]===r[a-1]&&a>1;)a-=2;for(let i=2;i<a;i+=2)r[i]===r[i-2]&&r[i+1]===r[i-1]||e.lineTo(r[i],r[i+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new ec;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,a){let i;const o=this._regioncode(t,e),s=this._regioncode(n,r);0===o&&0===s?(a.moveTo(t,e),a.lineTo(n,r)):(i=this._clipSegment(t,e,n,r,o,s))&&(a.moveTo(i[0],i[1]),a.lineTo(i[2],i[3]))}contains(t,e,n){return(e=+e)===e&&(n=+n)===n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,a=e.length;r<a;r+=2)for(let i=0,o=t.length;i<o;i+=2)if(e[r]===t[i]&&e[r+1]===t[i+1]&&e[(r+2)%a]===t[(i+o-2)%o]&&e[(r+3)%a]===t[(i+o-1)%o]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:a}}=this,i=n[t];if(-1===i)return null;const o=[];let s=i;do{const n=Math.floor(s/3);if(o.push(e[2*n],e[2*n+1]),s=s%3===2?s-2:s+1,a[s]!==t)break;s=r[s]}while(s!==i&&-1!==s);return o}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return this._simplify(n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e))}_clipFinite(t,e){const n=e.length;let r,a,i,o,s=null,c=e[n-2],l=e[n-1],u=this._regioncode(c,l),h=0;for(let d=0;d<n;d+=2)if(r=c,a=l,c=e[d],l=e[d+1],i=u,u=this._regioncode(c,l),0===i&&0===u)o=h,h=0,s?s.push(c,l):s=[c,l];else{let e,n,d,f,p;if(0===i){if(null===(e=this._clipSegment(r,a,c,l,i,u)))continue;[n,d,f,p]=e}else{if(null===(e=this._clipSegment(c,l,r,a,u,i)))continue;[f,p,n,d]=e,o=h,h=this._edgecode(n,d),o&&h&&this._edge(t,o,h,s,s.length),s?s.push(n,d):s=[n,d]}o=h,h=this._edgecode(f,p),o&&h&&this._edge(t,o,h,s,s.length),s?s.push(f,p):s=[f,p]}if(s)o=h,h=this._edgecode(s[0],s[1]),o&&h&&this._edge(t,o,h,s,s.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(t,e,n,r,a,i){const o=a<i;for(o&&([t,e,n,r,a,i]=[n,r,t,e,i,a]);;){if(0===a&&0===i)return o?[n,r,t,e]:[t,e,n,r];if(a&i)return null;let s,c,l=a||i;8&l?(s=t+(n-t)*(this.ymax-e)/(r-e),c=this.ymax):4&l?(s=t+(n-t)*(this.ymin-e)/(r-e),c=this.ymin):2&l?(c=e+(r-e)*(this.xmax-t)/(n-t),s=this.xmax):(c=e+(r-e)*(this.xmin-t)/(n-t),s=this.xmin),a?(t=s,e=c,a=this._regioncode(t,e)):(n=s,r=c,i=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,a,i){let o,s=Array.from(e);if((o=this._project(s[0],s[1],n,r))&&s.unshift(o[0],o[1]),(o=this._project(s[s.length-2],s[s.length-1],a,i))&&s.push(o[0],o[1]),s=this._clipFinite(t,s))for(let c,l=0,u=s.length,h=this._edgecode(s[u-2],s[u-1]);l<u;l+=2)c=h,h=this._edgecode(s[l],s[l+1]),c&&h&&(l=this._edge(t,c,h,s,l),u=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,e,n,r,a){for(;e!==n;){let n,i;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,i=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,i=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,i=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,i=this.ymin}r[a]===n&&r[a+1]===i||!this.contains(t,n,i)||(r.splice(a,0,n,i),a+=2)}return a}_project(t,e,n,r){let a,i,o,s=1/0;if(r<0){if(e<=this.ymin)return null;(a=(this.ymin-e)/r)<s&&(o=this.ymin,i=t+(s=a)*n)}else if(r>0){if(e>=this.ymax)return null;(a=(this.ymax-e)/r)<s&&(o=this.ymax,i=t+(s=a)*n)}if(n>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/n)<s&&(i=this.xmax,o=e+(s=a)*r)}else if(n<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/n)<s&&(i=this.xmin,o=e+(s=a)*r)}return[i,o]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let e=0;e<t.length;e+=2){const n=(e+2)%t.length,r=(e+4)%t.length;(t[e]===t[n]&&t[n]===t[r]||t[e+1]===t[n+1]&&t[n+1]===t[r+1])&&(t.splice(n,2),e-=2)}t.length||(t=null)}return t}}const rc=2*Math.PI,ac=Math.pow;function ic(t){return t[0]}function oc(t){return t[1]}function sc(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class cc{static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ic,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:oc,r=arguments.length>3?arguments[3]:void 0;return new cc("length"in t?function(t,e,n,r){const a=t.length,i=new Float64Array(2*a);for(let o=0;o<a;++o){const a=t[o];i[2*o]=e.call(r,a,o,t),i[2*o+1]=n.call(r,a,o,t)}return i}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let a=0;for(const i of t)yield e.call(r,i,a,t),yield n.call(r,i,a,t),++a}(t,e,n,r)))}constructor(t){this._delaunator=new Hs(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const t=2*e[r],a=2*e[r+1],i=2*e[r+2];if((n[i]-n[t])*(n[a+1]-n[t+1])-(n[a]-n[t])*(n[i+1]-n[t+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},(t,e)=>e).sort((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]);const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],a=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let i=0,o=e.length/2;i<o;++i){const t=sc(e[2*i],e[2*i+1],a);e[2*i]=t[0],e[2*i+1]=t[1]}this._delaunator=new Hs(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,a=this.triangles=this._delaunator.triangles,i=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let s=0,c=n.length;s<c;++s){const t=a[s%3===2?s-2:s+1];-1!==n[s]&&-1!==i[t]||(i[t]=s)}for(let s=0,c=r.length;s<c;++s)o[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],i[r[0]]=1,2===r.length&&(i[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new nc(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:a,triangles:i,collinear:o}=this;if(o){const e=o.indexOf(t);return e>0&&(yield o[e-1]),void(e<o.length-1&&(yield o[e+1]))}const s=e[t];if(-1===s)return;let c=s,l=-1;do{if(yield l=i[c],c=c%3===2?c-2:c+1,i[c]!==t)return;if(c=a[c],-1===c){const e=n[(r[t]+1)%n.length];return void(e!==l&&(yield e))}}while(c!==s)}find(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((t=+t)!==t||(e=+e)!==e)return-1;const r=n;let a;for(;(a=this._step(n,t,e))>=0&&a!==n&&a!==r;)n=a;return a}_step(t,e,n){const{inedges:r,hull:a,_hullIndex:i,halfedges:o,triangles:s,points:c}=this;if(-1===r[t]||!c.length)return(t+1)%(c.length>>1);let l=t,u=ac(e-c[2*t],2)+ac(n-c[2*t+1],2);const h=r[t];let d=h;do{let r=s[d];const h=ac(e-c[2*r],2)+ac(n-c[2*r+1],2);if(h<u&&(u=h,l=r),d=d%3===2?d-2:d+1,s[d]!==t)break;if(d=o[d],-1===d){if(d=a[(i[t]+1)%a.length],d!==r&&ac(e-c[2*d],2)+ac(n-c[2*d+1],2)<u)return d;break}}while(d!==h);return l}render(t){const e=null==t?t=new tc:void 0,{points:n,halfedges:r,triangles:a}=this;for(let i=0,o=r.length;i<o;++i){const e=r[i];if(e<i)continue;const o=2*a[i],s=2*a[e];t.moveTo(n[o],n[o+1]),t.lineTo(n[s],n[s+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e){void 0!==e||t&&"function"===typeof t.moveTo||(e=t,t=null),e=void 0==e?2:+e;const n=null==t?t=new tc:void 0,{points:r}=this;for(let a=0,i=r.length;a<i;a+=2){const n=r[a],i=r[a+1];t.moveTo(n+e,i),t.arc(n,i,e,0,rc)}return n&&n.value()}renderHull(t){const e=null==t?t=new tc:void 0,{hull:n,points:r}=this,a=2*n[0],i=n.length;t.moveTo(r[a],r[a+1]);for(let o=1;o<i;++o){const e=2*n[o];t.lineTo(r[e],r[e+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new ec;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new tc:void 0,{points:r,triangles:a}=this,i=2*a[t*=3],o=2*a[t+1],s=2*a[t+2];return e.moveTo(r[i],r[i+1]),e.lineTo(r[o],r[o+1]),e.lineTo(r[s],r[s+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new ec;return this.renderTriangle(t,e),e.value()}}const lc=t=>()=>t;function uc(t,e){let{sourceEvent:n,subject:r,target:a,identifier:i,active:o,x:s,y:c,dx:l,dy:u,dispatch:h}=e;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:h}})}function hc(t){return!t.ctrlKey&&!t.button}function dc(){return this.parentNode}function fc(t,e){return null==e?{x:t.x,y:t.y}:e}function pc(){return navigator.maxTouchPoints||"ontouchstart"in this}function mc(){var t,e,n,r,a=hc,i=dc,o=fc,s=pc,c={},l=Ie("start","drag","end"),u=0,h=0;function d(t){t.on("mousedown.drag",f).filter(s).on("touchstart.drag",g).on("touchmove.drag",y,Vn).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(o,s){if(!r&&a.call(this,o,s)){var c=b(this,i.call(this,o,s),o,s,"mouse");c&&(Un(o.view).on("mousemove.drag",p,Wn).on("mouseup.drag",m,Wn),qn(o.view),Gn(o),n=!1,t=o.clientX,e=o.clientY,c("start",o))}}function p(r){if(Hn(r),!n){var a=r.clientX-t,i=r.clientY-e;n=a*a+i*i>h}c.mouse("drag",r)}function m(t){Un(t.view).on("mousemove.drag mouseup.drag",null),Kn(t.view,n),Hn(t),c.mouse("end",t)}function g(t,e){if(a.call(this,t,e)){var n,r,o=t.changedTouches,s=i.call(this,t,e),c=o.length;for(n=0;n<c;++n)(r=b(this,s,t,e,o[n].identifier,o[n]))&&(Gn(t),r("start",t,o[n]))}}function y(t){var e,n,r=t.changedTouches,a=r.length;for(e=0;e<a;++e)(n=c[r[e].identifier])&&(Hn(t),n("drag",t,r[e]))}function v(t){var e,n,a=t.changedTouches,i=a.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),e=0;e<i;++e)(n=c[a[e].identifier])&&(Gn(t),n("end",t,a[e]))}function b(t,e,n,r,a,i){var s,h,f,p=l.copy(),m=ta(i||n,e);if(null!=(f=o.call(t,new uc("beforestart",{sourceEvent:n,target:d,identifier:a,active:u,x:m[0],y:m[1],dx:0,dy:0,dispatch:p}),r)))return s=f.x-m[0]||0,h=f.y-m[1]||0,function n(i,o,l){var g,y=m;switch(i){case"start":c[a]=n,g=u++;break;case"end":delete c[a],--u;case"drag":m=ta(l||o,e),g=u}p.call(i,t,new uc(i,{sourceEvent:o,subject:f,target:d,identifier:a,active:g,x:m[0]+s,y:m[1]+h,dx:m[0]-y[0],dy:m[1]-y[1],dispatch:p}),r)}}return d.filter=function(t){return arguments.length?(a="function"===typeof t?t:lc(!!t),d):a},d.container=function(t){return arguments.length?(i="function"===typeof t?t:lc(t),d):i},d.subject=function(t){return arguments.length?(o="function"===typeof t?t:lc(t),d):o},d.touchable=function(t){return arguments.length?(s="function"===typeof t?t:lc(!!t),d):s},d.on=function(){var t=l.on.apply(l,arguments);return t===l?d:t},d.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,d):Math.sqrt(h)},d}uc.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var gc={},yc={},vc=34,bc=10,wc=13;function xc(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function kc(t){var e=Object.create(null),n=[];return t.forEach(function(t){for(var r in t)r in e||n.push(e[r]=r)}),n}function _c(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Sc(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),a=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+_c(-e,6):e>9999?"+"+_c(e,6):_c(e,4))+"-"+_c(t.getUTCMonth()+1,2)+"-"+_c(t.getUTCDate(),2)+(i?"T"+_c(n,2)+":"+_c(r,2)+":"+_c(a,2)+"."+_c(i,3)+"Z":a?"T"+_c(n,2)+":"+_c(r,2)+":"+_c(a,2)+"Z":r||n?"T"+_c(n,2)+":"+_c(r,2)+"Z":"")}function Tc(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,a=[],i=t.length,o=0,s=0,c=i<=0,l=!1;function u(){if(c)return yc;if(l)return l=!1,gc;var e,r,a=o;if(t.charCodeAt(a)===vc){for(;o++<i&&t.charCodeAt(o)!==vc||t.charCodeAt(++o)===vc;);return(e=o)>=i?c=!0:(r=t.charCodeAt(o++))===bc?l=!0:r===wc&&(l=!0,t.charCodeAt(o)===bc&&++o),t.slice(a+1,e-1).replace(/""/g,'"')}for(;o<i;){if((r=t.charCodeAt(e=o++))===bc)l=!0;else if(r===wc)l=!0,t.charCodeAt(o)===bc&&++o;else if(r!==n)continue;return t.slice(a,e)}return c=!0,t.slice(a,i)}for(t.charCodeAt(i-1)===bc&&--i,t.charCodeAt(i-1)===wc&&--i;(r=u())!==yc;){for(var h=[];r!==gc&&r!==yc;)h.push(r),r=u();e&&null==(h=e(h,s++))||a.push(h)}return a}function a(e,n){return e.map(function(e){return n.map(function(t){return o(e[t])}).join(t)})}function i(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?Sc(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,a,i=r(t,function(t,r){if(n)return n(t,r-1);a=t,n=e?function(t,e){var n=xc(t);return function(r,a){return e(n(r),a,t)}}(t,e):xc(t)});return i.columns=a||[],i},parseRows:r,format:function(e,n){return null==n&&(n=kc(e)),[n.map(o).join(t)].concat(a(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=kc(t)),a(t,e).join("\n")},formatRows:function(t){return t.map(i).join("\n")},formatRow:i,formatValue:o}}var Ic=Tc(","),Ec=Ic.parse,Nc=Ic.parseRows,Cc=Ic.format,Ac=Ic.formatBody,Rc=Ic.formatRows,Oc=Ic.formatRow,Dc=Ic.formatValue,Mc=Tc("\t"),Fc=Mc.parse,Pc=Mc.parseRows,Lc=Mc.format,zc=Mc.formatBody,Bc=Mc.formatRows,jc=Mc.formatRow,Uc=Mc.formatValue;function Vc(t){for(var e in t){var n,r,a=t[e].trim();if(a)if("true"===a)a=!0;else if("false"===a)a=!1;else if("NaN"===a)a=NaN;else if(isNaN(n=+a)){if(!(r=a.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Wc&&r[4]&&!r[7]&&(a=a.replace(/-/g,"/").replace(/T/," ")),a=new Date(a)}else a=n;else a=null;t[e]=a}return t}const Wc=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours(),Gc=t=>+t;function Hc(t){return t*t}function qc(t){return t*(2-t)}function Kc(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}var Xc=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),Yc=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),Qc=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),Jc=Math.PI,$c=Jc/2;function Zc(t){return 1===+t?1:1-Math.cos(t*$c)}function tl(t){return Math.sin(t*$c)}function el(t){return(1-Math.cos(Jc*t))/2}function nl(t){return 1.0009775171065494*(Math.pow(2,-10*t)-.0009765625)}function rl(t){return nl(1-+t)}function al(t){return 1-nl(t)}function il(t){return((t*=2)<=1?nl(1-t):2-nl(t-1))/2}function ol(t){return 1-Math.sqrt(1-t*t)}function sl(t){return Math.sqrt(1- --t*t)}function cl(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var ll=4/11,ul=6/11,hl=8/11,dl=3/4,fl=9/11,pl=10/11,ml=15/16,gl=21/22,yl=63/64,vl=1/ll/ll;function bl(t){return 1-wl(1-t)}function wl(t){return(t=+t)<ll?vl*t*t:t<hl?vl*(t-=ul)*t+dl:t<pl?vl*(t-=fl)*t+ml:vl*(t-=gl)*t+yl}function xl(t){return((t*=2)<=1?1-wl(1-t):wl(t-1)+1)/2}var kl=1.70158,_l=function t(e){function n(t){return(t=+t)*t*(e*(t-1)+t)}return e=+e,n.overshoot=t,n}(kl),Sl=function t(e){function n(t){return--t*t*((t+1)*e+t)+1}return e=+e,n.overshoot=t,n}(kl),Tl=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(kl),Il=2*Math.PI,El=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Il);function a(t){return e*nl(- --t)*Math.sin((r-t)/n)}return a.amplitude=function(e){return t(e,n*Il)},a.period=function(n){return t(e,n)},a}(1,.3),Nl=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Il);function a(t){return 1-e*nl(t=+t)*Math.sin((t+r)/n)}return a.amplitude=function(e){return t(e,n*Il)},a.period=function(n){return t(e,n)},a}(1,.3),Cl=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Il);function a(t){return((t=2*t-1)<0?e*nl(-t)*Math.sin((r-t)/n):2-e*nl(t)*Math.sin((r+t)/n))/2}return a.amplitude=function(e){return t(e,n*Il)},a.period=function(n){return t(e,n)},a}(1,.3);function Al(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function Rl(t,e){return fetch(t,e).then(Al)}function Ol(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}function Dl(t,e){return fetch(t,e).then(Ol)}function Ml(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Fl(t,e){return fetch(t,e).then(Ml)}function Pl(t){return function(e,n,r){return 2===arguments.length&&"function"===typeof n&&(r=n,n=void 0),Fl(e,n).then(function(e){return t(e,r)})}}function Ll(t,e,n,r){3===arguments.length&&"function"===typeof n&&(r=n,n=void 0);var a=Tc(t);return Fl(e,n).then(function(t){return a.parse(t,r)})}var zl=Pl(Ec),Bl=Pl(Fc);function jl(t,e){return new Promise(function(n,r){var a=new Image;for(var i in e)a[i]=e[i];a.onerror=r,a.onload=function(){n(a)},a.src=t})}function Ul(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function Vl(t,e){return fetch(t,e).then(Ul)}function Wl(t){return(e,n)=>Fl(e,n).then(e=>(new DOMParser).parseFromString(e,t))}const Gl=Wl("application/xml");var Hl=Wl("text/html"),ql=Wl("image/svg+xml");function Kl(t,e){var n,r=1;function a(){var a,i,o=n.length,s=0,c=0;for(a=0;a<o;++a)s+=(i=n[a]).x,c+=i.y;for(s=(s/o-t)*r,c=(c/o-e)*r,a=0;a<o;++a)(i=n[a]).x-=s,i.y-=c}return null==t&&(t=0),null==e&&(e=0),a.initialize=function(t){n=t},a.x=function(e){return arguments.length?(t=+e,a):t},a.y=function(t){return arguments.length?(e=+t,a):e},a.strength=function(t){return arguments.length?(r=+t,a):r},a}function Xl(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var a,i,o,s,c,l,u,h,d,f=t._root,p={data:r},m=t._x0,g=t._y0,y=t._x1,v=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((l=e>=(i=(m+y)/2))?m=i:y=i,(u=n>=(o=(g+v)/2))?g=o:v=o,a=f,!(f=f[h=u<<1|l]))return a[h]=p,t;if(s=+t._x.call(null,f.data),c=+t._y.call(null,f.data),e===s&&n===c)return p.next=f,a?a[h]=p:t._root=p,t;do{a=a?a[h]=new Array(4):t._root=new Array(4),(l=e>=(i=(m+y)/2))?m=i:y=i,(u=n>=(o=(g+v)/2))?g=o:v=o}while((h=u<<1|l)===(d=(c>=o)<<1|s>=i));return a[d]=f,a[h]=p,t}function Yl(t,e,n,r,a){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=a}function Ql(t){return t[0]}function Jl(t){return t[1]}function $l(t,e,n){var r=new Zl(null==e?Ql:e,null==n?Jl:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Zl(t,e,n,r,a,i){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=a,this._y1=i,this._root=void 0}function tu(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var eu=$l.prototype=Zl.prototype;function nu(t){return function(){return t}}function ru(t){return 1e-6*(t()-.5)}function au(t){return t.x+t.vx}function iu(t){return t.y+t.vy}function ou(t){var e,n,r,a=1,i=1;function o(){for(var t,o,c,l,u,h,d,f=e.length,p=0;p<i;++p)for(o=$l(e,au,iu).visitAfter(s),t=0;t<f;++t)c=e[t],h=n[c.index],d=h*h,l=c.x+c.vx,u=c.y+c.vy,o.visit(m);function m(t,e,n,i,o){var s=t.data,f=t.r,p=h+f;if(!s)return e>l+p||i<l-p||n>u+p||o<u-p;if(s.index>c.index){var m=l-s.x-s.vx,g=u-s.y-s.vy,y=m*m+g*g;y<p*p&&(0===m&&(y+=(m=ru(r))*m),0===g&&(y+=(g=ru(r))*g),y=(p-(y=Math.sqrt(y)))/y*a,c.vx+=(m*=y)*(p=(f*=f)/(d+f)),c.vy+=(g*=y)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function c(){if(e){var r,a,i=e.length;for(n=new Array(i),r=0;r<i;++r)a=e[r],n[a.index]=+t(a,r,e)}}return"function"!==typeof t&&(t=nu(null==t?1:+t)),o.initialize=function(t,n){e=t,r=n,c()},o.iterations=function(t){return arguments.length?(i=+t,o):i},o.strength=function(t){return arguments.length?(a=+t,o):a},o.radius=function(e){return arguments.length?(t="function"===typeof e?e:nu(+e),c(),o):t},o}function su(t){return t.index}function cu(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function lu(t){var e,n,r,a,i,o,s=su,c=function(t){return 1/Math.min(a[t.source.index],a[t.target.index])},l=nu(30),u=1;function h(r){for(var a=0,s=t.length;a<u;++a)for(var c,l,h,d,f,p,m,g=0;g<s;++g)l=(c=t[g]).source,d=(h=c.target).x+h.vx-l.x-l.vx||ru(o),f=h.y+h.vy-l.y-l.vy||ru(o),d*=p=((p=Math.sqrt(d*d+f*f))-n[g])/p*r*e[g],f*=p,h.vx-=d*(m=i[g]),h.vy-=f*m,l.vx+=d*(m=1-m),l.vy+=f*m}function d(){if(r){var o,c,l=r.length,u=t.length,h=new Map(r.map((t,e)=>[s(t,e,r),t]));for(o=0,a=new Array(l);o<u;++o)(c=t[o]).index=o,"object"!==typeof c.source&&(c.source=cu(h,c.source)),"object"!==typeof c.target&&(c.target=cu(h,c.target)),a[c.source.index]=(a[c.source.index]||0)+1,a[c.target.index]=(a[c.target.index]||0)+1;for(o=0,i=new Array(u);o<u;++o)c=t[o],i[o]=a[c.source.index]/(a[c.source.index]+a[c.target.index]);e=new Array(u),f(),n=new Array(u),p()}}function f(){if(r)for(var n=0,a=t.length;n<a;++n)e[n]=+c(t[n],n,t)}function p(){if(r)for(var e=0,a=t.length;e<a;++e)n[e]=+l(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){r=t,o=e,d()},h.links=function(e){return arguments.length?(t=e,d(),h):t},h.id=function(t){return arguments.length?(s=t,h):s},h.iterations=function(t){return arguments.length?(u=+t,h):u},h.strength=function(t){return arguments.length?(c="function"===typeof t?t:nu(+t),f(),h):c},h.distance=function(t){return arguments.length?(l="function"===typeof t?t:nu(+t),p(),h):l},h}eu.copy=function(){var t,e,n=new Zl(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=tu(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var a=0;a<4;++a)(e=r.source[a])&&(e.length?t.push({source:e,target:r.target[a]=new Array(4)}):r.target[a]=tu(e));return n},eu.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Xl(this.cover(e,n),e,n,t)},eu.addAll=function(t){var e,n,r,a,i=t.length,o=new Array(i),s=new Array(i),c=1/0,l=1/0,u=-1/0,h=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(o[n]=r,s[n]=a,r<c&&(c=r),r>u&&(u=r),a<l&&(l=a),a>h&&(h=a));if(c>u||l>h)return this;for(this.cover(c,l).cover(u,h),n=0;n<i;++n)Xl(this,o[n],s[n],t[n]);return this},eu.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,a=this._x1,i=this._y1;if(isNaN(n))a=(n=Math.floor(t))+1,i=(r=Math.floor(e))+1;else{for(var o,s,c=a-n||1,l=this._root;n>t||t>=a||r>e||e>=i;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=l,l=o,c*=2,s){case 0:a=n+c,i=r+c;break;case 1:n=a-c,i=r+c;break;case 2:a=n+c,r=i-c;break;case 3:n=a-c,r=i-c}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=a,this._y1=i,this},eu.data=function(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},eu.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},eu.find=function(t,e,n){var r,a,i,o,s,c,l,u=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],m=this._root;for(m&&p.push(new Yl(m,u,h,d,f)),null==n?n=1/0:(u=t-n,h=e-n,d=t+n,f=e+n,n*=n);c=p.pop();)if(!(!(m=c.node)||(a=c.x0)>d||(i=c.y0)>f||(o=c.x1)<u||(s=c.y1)<h))if(m.length){var g=(a+o)/2,y=(i+s)/2;p.push(new Yl(m[3],g,y,o,s),new Yl(m[2],a,y,g,s),new Yl(m[1],g,i,o,y),new Yl(m[0],a,i,g,y)),(l=(e>=y)<<1|t>=g)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-l],p[p.length-1-l]=c)}else{var v=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),w=v*v+b*b;if(w<n){var x=Math.sqrt(n=w);u=t-x,h=e-x,d=t+x,f=e+x,r=m.data}}return r},eu.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,a,i,o,s,c,l,u,h,d,f=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((l=i>=(s=(p+g)/2))?p=s:g=s,(u=o>=(c=(m+y)/2))?m=c:y=c,e=f,!(f=f[h=u<<1|l]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(a=f.next)&&delete f.next,r?(a?r.next=a:delete r.next,this):e?(a?e[h]=a:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=a,this)},eu.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},eu.root=function(){return this._root},eu.size=function(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},eu.visit=function(t){var e,n,r,a,i,o,s=[],c=this._root;for(c&&s.push(new Yl(c,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(c=e.node,r=e.x0,a=e.y0,i=e.x1,o=e.y1)&&c.length){var l=(r+i)/2,u=(a+o)/2;(n=c[3])&&s.push(new Yl(n,l,u,i,o)),(n=c[2])&&s.push(new Yl(n,r,u,l,o)),(n=c[1])&&s.push(new Yl(n,l,a,i,u)),(n=c[0])&&s.push(new Yl(n,r,a,l,u))}return this},eu.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new Yl(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var a=e.node;if(a.length){var i,o=e.x0,s=e.y0,c=e.x1,l=e.y1,u=(o+c)/2,h=(s+l)/2;(i=a[0])&&n.push(new Yl(i,o,s,u,h)),(i=a[1])&&n.push(new Yl(i,u,s,c,h)),(i=a[2])&&n.push(new Yl(i,o,h,u,l)),(i=a[3])&&n.push(new Yl(i,u,h,c,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},eu.x=function(t){return arguments.length?(this._x=t,this):this._x},eu.y=function(t){return arguments.length?(this._y=t,this):this._y};const uu=1664525,hu=1013904223,du=4294967296;function fu(t){return t.x}function pu(t){return t.y}var mu=10,gu=Math.PI*(3-Math.sqrt(5));function yu(t){var e,n=1,r=.001,a=1-Math.pow(r,1/300),i=0,o=.6,s=new Map,c=pa(h),l=Ie("tick","end"),u=function(){let t=1;return()=>(t=(uu*t+hu)%du)/du}();function h(){d(),l.call("tick",e),n<r&&(c.stop(),l.call("end",e))}function d(r){var c,l,u=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(i-n)*a,s.forEach(function(t){t(n)}),c=0;c<u;++c)null==(l=t[c]).fx?l.x+=l.vx*=o:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=o:(l.y=l.fy,l.vy=0);return e}function f(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var a=mu*Math.sqrt(.5+n),i=n*gu;e.x=a*Math.cos(i),e.y=a*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,u),e}return null==t&&(t=[]),f(),e={tick:d,restart:function(){return c.restart(h),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(a=+t,e):+a},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(u=t,s.forEach(p),e):u},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var a,i,o,s,c,l=0,u=t.length;for(null==r?r=1/0:r*=r,l=0;l<u;++l)(o=(a=e-(s=t[l]).x)*a+(i=n-s.y)*i)<r&&(c=s,r=o);return c},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}}function vu(){var t,e,n,r,a,i=nu(-30),o=1,s=1/0,c=.81;function l(n){var a,i=t.length,o=$l(t,fu,pu).visitAfter(h);for(r=n,a=0;a<i;++a)e=t[a],o.visit(d)}function u(){if(t){var e,n,r=t.length;for(a=new Array(r),e=0;e<r;++e)n=t[e],a[n.index]=+i(n,e,t)}}function h(t){var e,n,r,i,o,s=0,c=0;if(t.length){for(r=i=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,c+=n,r+=n*e.x,i+=n*e.y);t.x=r/c,t.y=i/c}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=a[e.data.index]}while(e=e.next)}t.value=s}function d(t,i,l,u){if(!t.value)return!0;var h=t.x-e.x,d=t.y-e.y,f=u-i,p=h*h+d*d;if(f*f/c<p)return p<s&&(0===h&&(p+=(h=ru(n))*h),0===d&&(p+=(d=ru(n))*d),p<o&&(p=Math.sqrt(o*p)),e.vx+=h*t.value*r/p,e.vy+=d*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===h&&(p+=(h=ru(n))*h),0===d&&(p+=(d=ru(n))*d),p<o&&(p=Math.sqrt(o*p)));do{t.data!==e&&(f=a[t.data.index]*r/p,e.vx+=h*f,e.vy+=d*f)}while(t=t.next)}}return l.initialize=function(e,r){t=e,n=r,u()},l.strength=function(t){return arguments.length?(i="function"===typeof t?t:nu(+t),u(),l):i},l.distanceMin=function(t){return arguments.length?(o=t*t,l):Math.sqrt(o)},l.distanceMax=function(t){return arguments.length?(s=t*t,l):Math.sqrt(s)},l.theta=function(t){return arguments.length?(c=t*t,l):Math.sqrt(c)},l}function bu(t,e,n){var r,a,i,o=nu(.1);function s(t){for(var o=0,s=r.length;o<s;++o){var c=r[o],l=c.x-e||1e-6,u=c.y-n||1e-6,h=Math.sqrt(l*l+u*u),d=(i[o]-h)*a[o]*t/h;c.vx+=l*d,c.vy+=u*d}}function c(){if(r){var e,n=r.length;for(a=new Array(n),i=new Array(n),e=0;e<n;++e)i[e]=+t(r[e],e,r),a[e]=isNaN(i[e])?0:+o(r[e],e,r)}}return"function"!==typeof t&&(t=nu(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){r=t,c()},s.strength=function(t){return arguments.length?(o="function"===typeof t?t:nu(+t),c(),s):o},s.radius=function(e){return arguments.length?(t="function"===typeof e?e:nu(+e),c(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s}function wu(t){var e,n,r,a=nu(.1);function i(t){for(var a,i=0,o=e.length;i<o;++i)(a=e[i]).vx+=(r[i]-a.x)*n[i]*t}function o(){if(e){var i,o=e.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+t(e[i],i,e))?0:+a(e[i],i,e)}}return"function"!==typeof t&&(t=nu(null==t?0:+t)),i.initialize=function(t){e=t,o()},i.strength=function(t){return arguments.length?(a="function"===typeof t?t:nu(+t),o(),i):a},i.x=function(e){return arguments.length?(t="function"===typeof e?e:nu(+e),o(),i):t},i}function xu(t){var e,n,r,a=nu(.1);function i(t){for(var a,i=0,o=e.length;i<o;++i)(a=e[i]).vy+=(r[i]-a.y)*n[i]*t}function o(){if(e){var i,o=e.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+t(e[i],i,e))?0:+a(e[i],i,e)}}return"function"!==typeof t&&(t=nu(null==t?0:+t)),i.initialize=function(t){e=t,o()},i.strength=function(t){return arguments.length?(a="function"===typeof t?t:nu(+t),o(),i):a},i.y=function(e){return arguments.length?(t="function"===typeof e?e:nu(+e),o(),i):t},i}function ku(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function _u(t){return(t=ku(Math.abs(t)))?t[1]:NaN}var Su,Tu=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Iu(t){if(!(e=Tu.exec(t)))throw new Error("invalid format: "+t);var e;return new Eu({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Eu(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Nu(t,e){var n=ku(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}Iu.prototype=Eu.prototype,Eu.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Cu={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Nu(100*t,e),r:Nu,s:function(t,e){var n=ku(t,e);if(!n)return t+"";var r=n[0],a=n[1],i=a-(Su=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+ku(t,Math.max(0,e+i-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Au(t){return t}var Ru,Ou,Du,Mu=Array.prototype.map,Fu=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Pu(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Au:(e=Mu.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var a=t.length,i=[],o=0,s=e[0],c=0;a>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),i.push(t.substring(a-=s,a+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return i.reverse().join(n)}),a=void 0===t.currency?"":t.currency[0]+"",i=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Au:function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(Mu.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"\u2212":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Iu(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):Cu[v]||(void 0===g&&(g=12),y=!0,v="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?a:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===d?i:/[%p]/.test(v)?c:"",x=Cu[v],k=/[defgprs%]/.test(v);function _(t){var a,i,c,d=b,_=w;if("c"===v)_=x(t)+_,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:x(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,a=-1;r<n;++r)switch(t[r]){case".":a=e=r;break;case"0":0===a&&(a=r),e=r;break;default:if(!+t[r])break t;a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(e+1):t}(t)),S&&0===+t&&"+"!==h&&(S=!1),d=(S?"("===h?h:l:"-"===h||"("===h?"":h)+d,_=("s"===v?Fu[8+Su/3]:"")+_+(S&&"("===h?")":""),k)for(a=-1,i=t.length;++a<i;)if(48>(c=t.charCodeAt(a))||c>57){_=(46===c?o+t.slice(a+1):t.slice(a))+_,t=t.slice(0,a);break}}m&&!f&&(t=r(t,1/0));var T=d.length+t.length+_.length,I=T<p?new Array(p-T+1).join(e):"";switch(m&&f&&(t=r(I+t,I.length?p-_.length:1/0),I=""),n){case"<":t=d+t+_+I;break;case"=":t=d+I+t+_;break;case"^":t=I.slice(0,T=I.length>>1)+d+t+_+I.slice(T);break;default:t=I+d+t+_}return s(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return t+""},_}return{format:h,formatPrefix:function(t,e){var n=h(((t=Iu(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(_u(e)/3))),a=Math.pow(10,-r),i=Fu[8+r/3];return function(t){return n(a*t)+i}}}}function Lu(t){return Ru=Pu(t),Ou=Ru.format,Du=Ru.formatPrefix,Ru}function zu(t){return Math.max(0,-_u(Math.abs(t)))}function Bu(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(_u(e)/3)))-_u(Math.abs(t)))}function ju(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,_u(e)-_u(t))+1}Lu({thousands:",",grouping:[3],currency:["$",""]});var Uu=1e-6,Vu=1e-12,Wu=Math.PI,Gu=Wu/2,Hu=Wu/4,qu=2*Wu,Ku=180/Wu,Xu=Wu/180,Yu=Math.abs,Qu=Math.atan,Ju=Math.atan2,$u=Math.cos,Zu=Math.ceil,th=Math.exp,eh=(Math.floor,Math.hypot),nh=Math.log,rh=Math.pow,ah=Math.sin,ih=Math.sign||function(t){return t>0?1:t<0?-1:0},oh=Math.sqrt,sh=Math.tan;function ch(t){return t>1?0:t<-1?Wu:Math.acos(t)}function lh(t){return t>1?Gu:t<-1?-Gu:Math.asin(t)}function uh(t){return(t=ah(t/2))*t}function hh(){}function dh(t,e){t&&ph.hasOwnProperty(t.type)&&ph[t.type](t,e)}var fh={Feature:function(t,e){dh(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,a=n.length;++r<a;)dh(n[r].geometry,e)}},ph={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){mh(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)mh(n[r],e,0)},Polygon:function(t,e){gh(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)gh(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,a=n.length;++r<a;)dh(n[r],e)}};function mh(t,e,n){var r,a=-1,i=t.length-n;for(e.lineStart();++a<i;)r=t[a],e.point(r[0],r[1],r[2]);e.lineEnd()}function gh(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)mh(t[n],e,1);e.polygonEnd()}function yh(t,e){t&&fh.hasOwnProperty(t.type)?fh[t.type](t,e):dh(t,e)}var vh,bh,wh,xh,kh,_h,Sh,Th,Ih,Eh,Nh,Ch,Ah,Rh,Oh,Dh,Mh=new C,Fh=new C,Ph={point:hh,lineStart:hh,lineEnd:hh,polygonStart:function(){Mh=new C,Ph.lineStart=Lh,Ph.lineEnd=zh},polygonEnd:function(){var t=+Mh;Fh.add(t<0?qu+t:t),this.lineStart=this.lineEnd=this.point=hh},sphere:function(){Fh.add(qu)}};function Lh(){Ph.point=Bh}function zh(){jh(vh,bh)}function Bh(t,e){Ph.point=jh,vh=t,bh=e,wh=t*=Xu,xh=$u(e=(e*=Xu)/2+Hu),kh=ah(e)}function jh(t,e){var n=(t*=Xu)-wh,r=n>=0?1:-1,a=r*n,i=$u(e=(e*=Xu)/2+Hu),o=ah(e),s=kh*o,c=xh*i+s*$u(a),l=s*r*ah(a);Mh.add(Ju(l,c)),wh=t,xh=i,kh=o}function Uh(t){return Fh=new C,yh(t,Ph),2*Fh}function Vh(t){return[Ju(t[1],t[0]),lh(t[2])]}function Wh(t){var e=t[0],n=t[1],r=$u(n);return[r*$u(e),r*ah(e),ah(n)]}function Gh(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Hh(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function qh(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Kh(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Xh(t){var e=oh(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var Yh,Qh,Jh,$h,Zh,td,ed,nd,rd,ad,id,od,sd,cd,ld,ud,hd={point:dd,lineStart:pd,lineEnd:md,polygonStart:function(){hd.point=gd,hd.lineStart=yd,hd.lineEnd=vd,Rh=new C,Ph.polygonStart()},polygonEnd:function(){Ph.polygonEnd(),hd.point=dd,hd.lineStart=pd,hd.lineEnd=md,Mh<0?(_h=-(Th=180),Sh=-(Ih=90)):Rh>Uu?Ih=90:Rh<-Uu&&(Sh=-90),Dh[0]=_h,Dh[1]=Th},sphere:function(){_h=-(Th=180),Sh=-(Ih=90)}};function dd(t,e){Oh.push(Dh=[_h=t,Th=t]),e<Sh&&(Sh=e),e>Ih&&(Ih=e)}function fd(t,e){var n=Wh([t*Xu,e*Xu]);if(Ah){var r=Hh(Ah,n),a=Hh([r[1],-r[0],0],r);Xh(a),a=Vh(a);var i,o=t-Eh,s=o>0?1:-1,c=a[0]*Ku*s,l=Yu(o)>180;l^(s*Eh<c&&c<s*t)?(i=a[1]*Ku)>Ih&&(Ih=i):l^(s*Eh<(c=(c+360)%360-180)&&c<s*t)?(i=-a[1]*Ku)<Sh&&(Sh=i):(e<Sh&&(Sh=e),e>Ih&&(Ih=e)),l?t<Eh?bd(_h,t)>bd(_h,Th)&&(Th=t):bd(t,Th)>bd(_h,Th)&&(_h=t):Th>=_h?(t<_h&&(_h=t),t>Th&&(Th=t)):t>Eh?bd(_h,t)>bd(_h,Th)&&(Th=t):bd(t,Th)>bd(_h,Th)&&(_h=t)}else Oh.push(Dh=[_h=t,Th=t]);e<Sh&&(Sh=e),e>Ih&&(Ih=e),Ah=n,Eh=t}function pd(){hd.point=fd}function md(){Dh[0]=_h,Dh[1]=Th,hd.point=dd,Ah=null}function gd(t,e){if(Ah){var n=t-Eh;Rh.add(Yu(n)>180?n+(n>0?360:-360):n)}else Nh=t,Ch=e;Ph.point(t,e),fd(t,e)}function yd(){Ph.lineStart()}function vd(){gd(Nh,Ch),Ph.lineEnd(),Yu(Rh)>Uu&&(_h=-(Th=180)),Dh[0]=_h,Dh[1]=Th,Ah=null}function bd(t,e){return(e-=t)<0?e+360:e}function wd(t,e){return t[0]-e[0]}function xd(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function kd(t){var e,n,r,a,i,o,s;if(Ih=Th=-(_h=Sh=1/0),Oh=[],yh(t,hd),n=Oh.length){for(Oh.sort(wd),e=1,i=[r=Oh[0]];e<n;++e)xd(r,(a=Oh[e])[0])||xd(r,a[1])?(bd(r[0],a[1])>bd(r[0],r[1])&&(r[1]=a[1]),bd(a[0],r[1])>bd(r[0],r[1])&&(r[0]=a[0])):i.push(r=a);for(o=-1/0,e=0,r=i[n=i.length-1];e<=n;r=a,++e)a=i[e],(s=bd(r[1],a[0]))>o&&(o=s,_h=a[0],Th=r[1])}return Oh=Dh=null,_h===1/0||Sh===1/0?[[NaN,NaN],[NaN,NaN]]:[[_h,Sh],[Th,Ih]]}var _d={sphere:hh,point:Sd,lineStart:Id,lineEnd:Cd,polygonStart:function(){_d.lineStart=Ad,_d.lineEnd=Rd},polygonEnd:function(){_d.lineStart=Id,_d.lineEnd=Cd}};function Sd(t,e){t*=Xu;var n=$u(e*=Xu);Td(n*$u(t),n*ah(t),ah(e))}function Td(t,e,n){++Yh,Jh+=(t-Jh)/Yh,$h+=(e-$h)/Yh,Zh+=(n-Zh)/Yh}function Id(){_d.point=Ed}function Ed(t,e){t*=Xu;var n=$u(e*=Xu);cd=n*$u(t),ld=n*ah(t),ud=ah(e),_d.point=Nd,Td(cd,ld,ud)}function Nd(t,e){t*=Xu;var n=$u(e*=Xu),r=n*$u(t),a=n*ah(t),i=ah(e),o=Ju(oh((o=ld*i-ud*a)*o+(o=ud*r-cd*i)*o+(o=cd*a-ld*r)*o),cd*r+ld*a+ud*i);Qh+=o,td+=o*(cd+(cd=r)),ed+=o*(ld+(ld=a)),nd+=o*(ud+(ud=i)),Td(cd,ld,ud)}function Cd(){_d.point=Sd}function Ad(){_d.point=Od}function Rd(){Dd(od,sd),_d.point=Sd}function Od(t,e){od=t,sd=e,t*=Xu,e*=Xu,_d.point=Dd;var n=$u(e);cd=n*$u(t),ld=n*ah(t),ud=ah(e),Td(cd,ld,ud)}function Dd(t,e){t*=Xu;var n=$u(e*=Xu),r=n*$u(t),a=n*ah(t),i=ah(e),o=ld*i-ud*a,s=ud*r-cd*i,c=cd*a-ld*r,l=eh(o,s,c),u=lh(l),h=l&&-u/l;rd.add(h*o),ad.add(h*s),id.add(h*c),Qh+=u,td+=u*(cd+(cd=r)),ed+=u*(ld+(ld=a)),nd+=u*(ud+(ud=i)),Td(cd,ld,ud)}function Md(t){Yh=Qh=Jh=$h=Zh=td=ed=nd=0,rd=new C,ad=new C,id=new C,yh(t,_d);var e=+rd,n=+ad,r=+id,a=eh(e,n,r);return a<Vu&&(e=td,n=ed,r=nd,Qh<Uu&&(e=Jh,n=$h,r=Zh),(a=eh(e,n,r))<Vu)?[NaN,NaN]:[Ju(n,e)*Ku,lh(r/a)*Ku]}function Fd(t){return function(){return t}}function Pd(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function Ld(t,e){return Yu(t)>Wu&&(t-=Math.round(t/qu)*qu),[t,e]}function zd(t,e,n){return(t%=qu)?e||n?Pd(jd(t),Ud(e,n)):jd(t):e||n?Ud(e,n):Ld}function Bd(t){return function(e,n){return Yu(e+=t)>Wu&&(e-=Math.round(e/qu)*qu),[e,n]}}function jd(t){var e=Bd(t);return e.invert=Bd(-t),e}function Ud(t,e){var n=$u(t),r=ah(t),a=$u(e),i=ah(e);function o(t,e){var o=$u(e),s=$u(t)*o,c=ah(t)*o,l=ah(e),u=l*n+s*r;return[Ju(c*a-u*i,s*n-l*r),lh(u*a+c*i)]}return o.invert=function(t,e){var o=$u(e),s=$u(t)*o,c=ah(t)*o,l=ah(e),u=l*a-c*i;return[Ju(c*a+l*i,s*n+u*r),lh(u*n-s*r)]},o}function Vd(t){function e(e){return(e=t(e[0]*Xu,e[1]*Xu))[0]*=Ku,e[1]*=Ku,e}return t=zd(t[0]*Xu,t[1]*Xu,t.length>2?t[2]*Xu:0),e.invert=function(e){return(e=t.invert(e[0]*Xu,e[1]*Xu))[0]*=Ku,e[1]*=Ku,e},e}function Wd(t,e,n,r,a,i){if(n){var o=$u(e),s=ah(e),c=r*n;null==a?(a=e+r*qu,i=e-c/2):(a=Gd(o,a),i=Gd(o,i),(r>0?a<i:a>i)&&(a+=r*qu));for(var l,u=a;r>0?u>i:u<i;u-=c)l=Vh([o,-s*$u(u),-s*ah(u)]),t.point(l[0],l[1])}}function Gd(t,e){(e=Wh(e))[0]-=t,Xh(e);var n=ch(-e[1]);return((-e[2]<0?-n:n)+qu-Uu)%qu}function Hd(){var t,e,n=Fd([0,0]),r=Fd(90),a=Fd(2),i={point:function(n,r){t.push(n=e(n,r)),n[0]*=Ku,n[1]*=Ku}};function o(){var o=n.apply(this,arguments),s=r.apply(this,arguments)*Xu,c=a.apply(this,arguments)*Xu;return t=[],e=zd(-o[0]*Xu,-o[1]*Xu,0).invert,Wd(i,s,c,1),o={type:"Polygon",coordinates:[t]},t=e=null,o}return o.center=function(t){return arguments.length?(n="function"===typeof t?t:Fd([+t[0],+t[1]]),o):n},o.radius=function(t){return arguments.length?(r="function"===typeof t?t:Fd(+t),o):r},o.precision=function(t){return arguments.length?(a="function"===typeof t?t:Fd(+t),o):a},o}function qd(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:hh,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Kd(t,e){return Yu(t[0]-e[0])<Uu&&Yu(t[1]-e[1])<Uu}function Xd(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Yd(t,e,n,r,a){var i,o,s=[],c=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(Kd(r,o)){if(!r[2]&&!o[2]){for(a.lineStart(),i=0;i<e;++i)a.point((r=t[i])[0],r[1]);return void a.lineEnd()}o[0]+=2*Uu}s.push(n=new Xd(r,t,null,!0)),c.push(n.o=new Xd(r,null,n,!1)),s.push(n=new Xd(o,t,null,!1)),c.push(n.o=new Xd(o,null,n,!0))}}),s.length){for(c.sort(e),Qd(s),Qd(c),i=0,o=c.length;i<o;++i)c[i].e=n=!n;for(var l,u,h=s[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;l=d.z,a.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(i=0,o=l.length;i<o;++i)a.point((u=l[i])[0],u[1]);else r(d.x,d.n.x,1,a);d=d.n}else{if(f)for(l=d.p.z,i=l.length-1;i>=0;--i)a.point((u=l[i])[0],u[1]);else r(d.x,d.p.x,-1,a);d=d.p}l=(d=d.o).z,f=!f}while(!d.v);a.lineEnd()}}}function Qd(t){if(e=t.length){for(var e,n,r=0,a=t[0];++r<e;)a.n=n=t[r],n.p=a,a=n;a.n=n=t[0],n.p=a}}function Jd(t){return Yu(t[0])<=Wu?t[0]:ih(t[0])*((Yu(t[0])+Wu)%qu-Wu)}function $d(t,e){var n=Jd(e),r=e[1],a=ah(r),i=[ah(n),-$u(n),0],o=0,s=0,c=new C;1===a?r=Gu+Uu:-1===a&&(r=-Gu-Uu);for(var l=0,u=t.length;l<u;++l)if(d=(h=t[l]).length)for(var h,d,f=h[d-1],p=Jd(f),m=f[1]/2+Hu,g=ah(m),y=$u(m),v=0;v<d;++v,p=w,g=k,y=_,f=b){var b=h[v],w=Jd(b),x=b[1]/2+Hu,k=ah(x),_=$u(x),S=w-p,T=S>=0?1:-1,I=T*S,E=I>Wu,N=g*k;if(c.add(Ju(N*T*ah(I),y*_+N*$u(I))),o+=E?S+T*qu:S,E^p>=n^w>=n){var A=Hh(Wh(f),Wh(b));Xh(A);var R=Hh(i,A);Xh(R);var O=(E^S>=0?-1:1)*lh(R[2]);(r>O||r===O&&(A[0]||A[1]))&&(s+=E^S>=0?1:-1)}}return(o<-Uu||o<Uu&&c<-Vu)^1&s}function Zd(t,e,n,r){return function(a){var i,o,s,c=e(a),l=qd(),u=e(l),h=!1,d={point:f,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,o=[],i=[]},polygonEnd:function(){d.point=f,d.lineStart=m,d.lineEnd=g,o=Ct(o);var t=$d(i,r);o.length?(h||(a.polygonStart(),h=!0),Yd(o,ef,t,n,a)):t&&(h||(a.polygonStart(),h=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),h&&(a.polygonEnd(),h=!1),o=i=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function f(e,n){t(e,n)&&a.point(e,n)}function p(t,e){c.point(t,e)}function m(){d.point=p,c.lineStart()}function g(){d.point=f,c.lineEnd()}function y(t,e){s.push([t,e]),u.point(t,e)}function v(){u.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),u.lineEnd();var t,e,n,r,c=u.clean(),d=l.result(),f=d.length;if(s.pop(),i.push(s),s=null,f)if(1&c){if((e=(n=d[0]).length-1)>0){for(h||(a.polygonStart(),h=!0),a.lineStart(),t=0;t<e;++t)a.point((r=n[t])[0],r[1]);a.lineEnd()}}else f>1&&2&c&&d.push(d.pop().concat(d.shift())),o.push(d.filter(tf))}return d}}function tf(t){return t.length>1}function ef(t,e){return((t=t.x)[0]<0?t[1]-Gu-Uu:Gu-t[1])-((e=e.x)[0]<0?e[1]-Gu-Uu:Gu-e[1])}Ld.invert=Ld;const nf=Zd(function(){return!0},function(t){var e,n=NaN,r=NaN,a=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(i,o){var s=i>0?Wu:-Wu,c=Yu(i-n);Yu(c-Wu)<Uu?(t.point(n,r=(r+o)/2>0?Gu:-Gu),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(i,r),e=0):a!==s&&c>=Wu&&(Yu(n-a)<Uu&&(n-=a*Uu),Yu(i-s)<Uu&&(i-=s*Uu),r=function(t,e,n,r){var a,i,o=ah(t-n);return Yu(o)>Uu?Qu((ah(e)*(i=$u(r))*ah(n)-ah(r)*(a=$u(e))*ah(t))/(a*i*o)):(e+r)/2}(n,r,i,o),t.point(a,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=i,r=o),a=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}},function(t,e,n,r){var a;if(null==t)a=n*Gu,r.point(-Wu,a),r.point(0,a),r.point(Wu,a),r.point(Wu,0),r.point(Wu,-a),r.point(0,-a),r.point(-Wu,-a),r.point(-Wu,0),r.point(-Wu,a);else if(Yu(t[0]-e[0])>Uu){var i=t[0]<e[0]?Wu:-Wu;a=n*i/2,r.point(-i,a),r.point(0,a),r.point(i,a)}else r.point(e[0],e[1])},[-Wu,-Gu]);function rf(t){var e=$u(t),n=2*Xu,r=e>0,a=Yu(e)>Uu;function i(t,n){return $u(t)*$u(n)>e}function o(t,n,r){var a=[1,0,0],i=Hh(Wh(t),Wh(n)),o=Gh(i,i),s=i[0],c=o-s*s;if(!c)return!r&&t;var l=e*o/c,u=-e*s/c,h=Hh(a,i),d=Kh(a,l);qh(d,Kh(i,u));var f=h,p=Gh(d,f),m=Gh(f,f),g=p*p-m*(Gh(d,d)-1);if(!(g<0)){var y=oh(g),v=Kh(f,(-p-y)/m);if(qh(v,d),v=Vh(v),!r)return v;var b,w=t[0],x=n[0],k=t[1],_=n[1];x<w&&(b=w,w=x,x=b);var S=x-w,T=Yu(S-Wu)<Uu;if(!T&&_<k&&(b=k,k=_,_=b),T||S<Uu?T?k+_>0^v[1]<(Yu(v[0]-w)<Uu?k:_):k<=v[1]&&v[1]<=_:S>Wu^(w<=v[0]&&v[0]<=x)){var I=Kh(f,(-p+y)/m);return qh(I,d),[v,Vh(I)]}}}function s(e,n){var a=r?t:Wu-t,i=0;return e<-a?i|=1:e>a&&(i|=2),n<-a?i|=4:n>a&&(i|=8),i}return Zd(i,function(t){var e,n,c,l,u;return{lineStart:function(){l=c=!1,u=1},point:function(h,d){var f,p=[h,d],m=i(h,d),g=r?m?0:s(h,d):m?s(h+(h<0?Wu:-Wu),d):0;if(!e&&(l=c=m)&&t.lineStart(),m!==c&&(!(f=o(e,p))||Kd(e,f)||Kd(p,f))&&(p[2]=1),m!==c)u=0,m?(t.lineStart(),f=o(p,e),t.point(f[0],f[1])):(f=o(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(a&&e&&r^m){var y;g&n||!(y=o(p,e,!0))||(u=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!m||e&&Kd(e,p)||t.point(p[0],p[1]),e=p,c=m,n=g},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return u|(l&&c)<<1}}},function(e,r,a,i){Wd(i,t,n,a,e,r)},r?[0,-t]:[-Wu,t-Wu])}var af,of,sf,cf,lf=1e9,uf=-lf;function hf(t,e,n,r){function a(a,i){return t<=a&&a<=n&&e<=i&&i<=r}function i(a,i,s,l){var u=0,h=0;if(null==a||(u=o(a,s))!==(h=o(i,s))||c(a,i)<0^s>0)do{l.point(0===u||3===u?t:n,u>1?r:e)}while((u=(u+s+4)%4)!==h);else l.point(i[0],i[1])}function o(r,a){return Yu(r[0]-t)<Uu?a>0?0:3:Yu(r[0]-n)<Uu?a>0?2:1:Yu(r[1]-e)<Uu?a>0?1:0:a>0?3:2}function s(t,e){return c(t.x,e.x)}function c(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var c,l,u,h,d,f,p,m,g,y,v,b=o,w=qd(),x={point:k,lineStart:function(){x.point=_,l&&l.push(u=[]);y=!0,g=!1,p=m=NaN},lineEnd:function(){c&&(_(h,d),f&&g&&w.rejoin(),c.push(w.result()));x.point=k,g&&b.lineEnd()},polygonStart:function(){b=w,c=[],l=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,a=l.length;n<a;++n)for(var i,o,s=l[n],c=1,u=s.length,h=s[0],d=h[0],f=h[1];c<u;++c)i=d,o=f,d=(h=s[c])[0],f=h[1],o<=r?f>r&&(d-i)*(r-o)>(f-o)*(t-i)&&++e:f<=r&&(d-i)*(r-o)<(f-o)*(t-i)&&--e;return e}(),n=v&&e,a=(c=Ct(c)).length;(n||a)&&(o.polygonStart(),n&&(o.lineStart(),i(null,null,1,o),o.lineEnd()),a&&Yd(c,s,e,i,o),o.polygonEnd());b=o,c=l=u=null}};function k(t,e){a(t,e)&&b.point(t,e)}function _(i,o){var s=a(i,o);if(l&&u.push([i,o]),y)h=i,d=o,f=s,y=!1,s&&(b.lineStart(),b.point(i,o));else if(s&&g)b.point(i,o);else{var c=[p=Math.max(uf,Math.min(lf,p)),m=Math.max(uf,Math.min(lf,m))],w=[i=Math.max(uf,Math.min(lf,i)),o=Math.max(uf,Math.min(lf,o))];!function(t,e,n,r,a,i){var o,s=t[0],c=t[1],l=0,u=1,h=e[0]-s,d=e[1]-c;if(o=n-s,h||!(o>0)){if(o/=h,h<0){if(o<l)return;o<u&&(u=o)}else if(h>0){if(o>u)return;o>l&&(l=o)}if(o=a-s,h||!(o<0)){if(o/=h,h<0){if(o>u)return;o>l&&(l=o)}else if(h>0){if(o<l)return;o<u&&(u=o)}if(o=r-c,d||!(o>0)){if(o/=d,d<0){if(o<l)return;o<u&&(u=o)}else if(d>0){if(o>u)return;o>l&&(l=o)}if(o=i-c,d||!(o<0)){if(o/=d,d<0){if(o>u)return;o>l&&(l=o)}else if(d>0){if(o<l)return;o<u&&(u=o)}return l>0&&(t[0]=s+l*h,t[1]=c+l*d),u<1&&(e[0]=s+u*h,e[1]=c+u*d),!0}}}}}(c,w,t,e,n,r)?s&&(b.lineStart(),b.point(i,o),v=!1):(g||(b.lineStart(),b.point(c[0],c[1])),b.point(w[0],w[1]),s||b.lineEnd(),v=!1)}p=i,m=o,g=s}return x}}function df(){var t,e,n,r=0,a=0,i=960,o=500;return n={stream:function(n){return t&&e===n?t:t=hf(r,a,i,o)(e=n)},extent:function(s){return arguments.length?(r=+s[0][0],a=+s[0][1],i=+s[1][0],o=+s[1][1],t=e=null,n):[[r,a],[i,o]]}}}var ff={sphere:hh,point:hh,lineStart:function(){ff.point=mf,ff.lineEnd=pf},lineEnd:hh,polygonStart:hh,polygonEnd:hh};function pf(){ff.point=ff.lineEnd=hh}function mf(t,e){of=t*=Xu,sf=ah(e*=Xu),cf=$u(e),ff.point=gf}function gf(t,e){t*=Xu;var n=ah(e*=Xu),r=$u(e),a=Yu(t-of),i=$u(a),o=r*ah(a),s=cf*n-sf*r*i,c=sf*n+cf*r*i;af.add(Ju(oh(o*o+s*s),c)),of=t,sf=n,cf=r}function yf(t){return af=new C,yh(t,ff),+af}var vf=[null,null],bf={type:"LineString",coordinates:vf};function wf(t,e){return vf[0]=t,vf[1]=e,yf(bf)}var xf={Feature:function(t,e){return _f(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,a=n.length;++r<a;)if(_f(n[r].geometry,e))return!0;return!1}},kf={Sphere:function(){return!0},Point:function(t,e){return Sf(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)if(Sf(n[r],e))return!0;return!1},LineString:function(t,e){return Tf(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)if(Tf(n[r],e))return!0;return!1},Polygon:function(t,e){return If(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)if(If(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,a=n.length;++r<a;)if(_f(n[r],e))return!0;return!1}};function _f(t,e){return!(!t||!kf.hasOwnProperty(t.type))&&kf[t.type](t,e)}function Sf(t,e){return 0===wf(t,e)}function Tf(t,e){for(var n,r,a,i=0,o=t.length;i<o;i++){if(0===(r=wf(t[i],e)))return!0;if(i>0&&(a=wf(t[i],t[i-1]))>0&&n<=a&&r<=a&&(n+r-a)*(1-Math.pow((n-r)/a,2))<Vu*a)return!0;n=r}return!1}function If(t,e){return!!$d(t.map(Ef),Nf(e))}function Ef(t){return(t=t.map(Nf)).pop(),t}function Nf(t){return[t[0]*Xu,t[1]*Xu]}function Cf(t,e){return(t&&xf.hasOwnProperty(t.type)?xf[t.type]:_f)(t,e)}function Af(t,e,n){var r=Dt(t,e-Uu,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function Rf(t,e,n){var r=Dt(t,e-Uu,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}function Of(){var t,e,n,r,a,i,o,s,c,l,u,h,d=10,f=d,p=90,m=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return Dt(Zu(r/p)*p,n,p).map(u).concat(Dt(Zu(s/m)*m,o,m).map(h)).concat(Dt(Zu(e/d)*d,t,d).filter(function(t){return Yu(t%p)>Uu}).map(c)).concat(Dt(Zu(i/f)*f,a,f).filter(function(t){return Yu(t%m)>Uu}).map(l))}return y.lines=function(){return v().map(function(t){return{type:"LineString",coordinates:t}})},y.outline=function(){return{type:"Polygon",coordinates:[u(r).concat(h(o).slice(1),u(n).reverse().slice(1),h(s).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],o=+t[1][1],r>n&&(t=r,r=n,n=t),s>o&&(t=s,s=o,o=t),y.precision(g)):[[r,s],[n,o]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],i=+n[0][1],a=+n[1][1],e>t&&(n=e,e=t,t=n),i>a&&(n=i,i=a,a=n),y.precision(g)):[[e,i],[t,a]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],m=+t[1],y):[p,m]},y.stepMinor=function(t){return arguments.length?(d=+t[0],f=+t[1],y):[d,f]},y.precision=function(d){return arguments.length?(g=+d,c=Af(i,a,90),l=Rf(e,t,g),u=Af(s,o,90),h=Rf(r,n,g),y):g},y.extentMajor([[-180,-90+Uu],[180,90-Uu]]).extentMinor([[-180,-80-Uu],[180,80+Uu]])}function Df(){return Of()()}function Mf(t,e){var n=t[0]*Xu,r=t[1]*Xu,a=e[0]*Xu,i=e[1]*Xu,o=$u(r),s=ah(r),c=$u(i),l=ah(i),u=o*$u(n),h=o*ah(n),d=c*$u(a),f=c*ah(a),p=2*lh(oh(uh(i-r)+o*c*uh(a-n))),m=ah(p),g=p?function(t){var e=ah(t*=p)/m,n=ah(p-t)/m,r=n*u+e*d,a=n*h+e*f,i=n*s+e*l;return[Ju(a,r)*Ku,Ju(i,oh(r*r+a*a))*Ku]}:function(){return[n*Ku,r*Ku]};return g.distance=p,g}const Ff=t=>t;var Pf,Lf,zf,Bf,jf=new C,Uf=new C,Vf={point:hh,lineStart:hh,lineEnd:hh,polygonStart:function(){Vf.lineStart=Wf,Vf.lineEnd=qf},polygonEnd:function(){Vf.lineStart=Vf.lineEnd=Vf.point=hh,jf.add(Yu(Uf)),Uf=new C},result:function(){var t=jf/2;return jf=new C,t}};function Wf(){Vf.point=Gf}function Gf(t,e){Vf.point=Hf,Pf=zf=t,Lf=Bf=e}function Hf(t,e){Uf.add(Bf*t-zf*e),zf=t,Bf=e}function qf(){Hf(Pf,Lf)}const Kf=Vf;var Xf=1/0,Yf=Xf,Qf=-Xf,Jf=Qf,$f={point:function(t,e){t<Xf&&(Xf=t);t>Qf&&(Qf=t);e<Yf&&(Yf=e);e>Jf&&(Jf=e)},lineStart:hh,lineEnd:hh,polygonStart:hh,polygonEnd:hh,result:function(){var t=[[Xf,Yf],[Qf,Jf]];return Qf=Jf=-(Yf=Xf=1/0),t}};const Zf=$f;var tp,ep,np,rp,ap=0,ip=0,op=0,sp=0,cp=0,lp=0,up=0,hp=0,dp=0,fp={point:pp,lineStart:mp,lineEnd:vp,polygonStart:function(){fp.lineStart=bp,fp.lineEnd=wp},polygonEnd:function(){fp.point=pp,fp.lineStart=mp,fp.lineEnd=vp},result:function(){var t=dp?[up/dp,hp/dp]:lp?[sp/lp,cp/lp]:op?[ap/op,ip/op]:[NaN,NaN];return ap=ip=op=sp=cp=lp=up=hp=dp=0,t}};function pp(t,e){ap+=t,ip+=e,++op}function mp(){fp.point=gp}function gp(t,e){fp.point=yp,pp(np=t,rp=e)}function yp(t,e){var n=t-np,r=e-rp,a=oh(n*n+r*r);sp+=a*(np+t)/2,cp+=a*(rp+e)/2,lp+=a,pp(np=t,rp=e)}function vp(){fp.point=pp}function bp(){fp.point=xp}function wp(){kp(tp,ep)}function xp(t,e){fp.point=kp,pp(tp=np=t,ep=rp=e)}function kp(t,e){var n=t-np,r=e-rp,a=oh(n*n+r*r);sp+=a*(np+t)/2,cp+=a*(rp+e)/2,lp+=a,up+=(a=rp*t-np*e)*(np+t),hp+=a*(rp+e),dp+=3*a,pp(np=t,rp=e)}const _p=fp;function Sp(t){this._context=t}Sp.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,qu)}},result:hh};var Tp,Ip,Ep,Np,Cp,Ap=new C,Rp={point:hh,lineStart:function(){Rp.point=Op},lineEnd:function(){Tp&&Dp(Ip,Ep),Rp.point=hh},polygonStart:function(){Tp=!0},polygonEnd:function(){Tp=null},result:function(){var t=+Ap;return Ap=new C,t}};function Op(t,e){Rp.point=Dp,Ip=Np=t,Ep=Cp=e}function Dp(t,e){Np-=t,Cp-=e,Ap.add(oh(Np*Np+Cp*Cp)),Np=t,Cp=e}const Mp=Rp;var Fp,Pp,Lp,zp;let Bp,jp,Up,Vp;class Wp{constructor(t){this._append=null==t?Gp:function(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));if(e>15)return Gp;if(e!==Bp){const t=10**e;Bp=e,jp=function(e){let n=1;this._+=e[0];for(const r=e.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+e[n]}}return jp}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append(Fp||(Fp=vo(["M",",",""])),t,e),this._point=1;break;case 1:this._append(Pp||(Pp=vo(["L",",",""])),t,e);break;default:if(this._append(Lp||(Lp=vo(["M",",",""])),t,e),this._radius!==Up||this._append!==jp){const t=this._radius,e=this._;this._="",this._append(zp||(zp=vo(["m0,","a",","," 0 1,1 0,","a",","," 0 1,1 0,","z"])),t,t,t,-2*t,t,t,2*t),Up=t,jp=this._append,Vp=this._,this._=e}this._+=Vp}}result(){const t=this._;return this._="",t.length?t:null}}function Gp(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Hp(t,e){let n,r,a=3,i=4.5;function o(t){return t&&("function"===typeof i&&r.pointRadius(+i.apply(this,arguments)),yh(t,n(r))),r.result()}return o.area=function(t){return yh(t,n(Kf)),Kf.result()},o.measure=function(t){return yh(t,n(Mp)),Mp.result()},o.bounds=function(t){return yh(t,n(Zf)),Zf.result()},o.centroid=function(t){return yh(t,n(_p)),_p.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,Ff):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new Wp(a)):new Sp(e=t),"function"!==typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"===typeof t?t:(r.pointRadius(+t),+t),o):i},o.digits=function(t){if(!arguments.length)return a;if(null==t)a=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError("invalid digits: ".concat(t));a=e}return null===e&&(r=new Wp(a)),o},o.projection(t).digits(a).context(e)}function qp(t){return{stream:Kp(t)}}function Kp(t){return function(e){var n=new Xp;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Xp(){}function Yp(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),yh(n,t.stream(Zf)),e(Zf.result()),null!=r&&t.clipExtent(r),t}function Qp(t,e,n){return Yp(t,function(n){var r=e[1][0]-e[0][0],a=e[1][1]-e[0][1],i=Math.min(r/(n[1][0]-n[0][0]),a/(n[1][1]-n[0][1])),o=+e[0][0]+(r-i*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(a-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,s])},n)}function Jp(t,e,n){return Qp(t,[[0,0],e],n)}function $p(t,e,n){return Yp(t,function(n){var r=+e,a=r/(n[1][0]-n[0][0]),i=(r-a*(n[1][0]+n[0][0]))/2,o=-a*n[0][1];t.scale(150*a).translate([i,o])},n)}function Zp(t,e,n){return Yp(t,function(n){var r=+e,a=r/(n[1][1]-n[0][1]),i=-a*n[0][0],o=(r-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([i,o])},n)}Xp.prototype={constructor:Xp,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var tm=16,em=$u(30*Xu);function nm(t,e){return+e?function(t,e){function n(r,a,i,o,s,c,l,u,h,d,f,p,m,g){var y=l-r,v=u-a,b=y*y+v*v;if(b>4*e&&m--){var w=o+d,x=s+f,k=c+p,_=oh(w*w+x*x+k*k),S=lh(k/=_),T=Yu(Yu(k)-1)<Uu||Yu(i-h)<Uu?(i+h)/2:Ju(x,w),I=t(T,S),E=I[0],N=I[1],C=E-r,A=N-a,R=v*C-y*A;(R*R/b>e||Yu((y*C+v*A)/b-.5)>.3||o*d+s*f+c*p<em)&&(n(r,a,i,o,s,c,E,N,T,w/=_,x/=_,k,m,g),g.point(E,N),n(E,N,T,w,x,k,l,u,h,d,f,p,m,g))}}return function(e){var r,a,i,o,s,c,l,u,h,d,f,p,m={point:g,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),m.lineStart=w},polygonEnd:function(){e.polygonEnd(),m.lineStart=y}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){u=NaN,m.point=v,e.lineStart()}function v(r,a){var i=Wh([r,a]),o=t(r,a);n(u,h,l,d,f,p,u=o[0],h=o[1],l=r,d=i[0],f=i[1],p=i[2],tm,e),e.point(u,h)}function b(){m.point=g,e.lineEnd()}function w(){y(),m.point=x,m.lineEnd=k}function x(t,e){v(r=t,e),a=u,i=h,o=d,s=f,c=p,m.point=v}function k(){n(u,h,l,d,f,p,a,i,r,o,s,c,tm,e),m.lineEnd=b,b()}return m}}(t,e):function(t){return Kp({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var rm=Kp({point:function(t,e){this.stream.point(t*Xu,e*Xu)}});function am(t,e,n,r,a,i){if(!i)return function(t,e,n,r,a){function i(i,o){return[e+t*(i*=r),n-t*(o*=a)]}return i.invert=function(i,o){return[(i-e)/t*r,(n-o)/t*a]},i}(t,e,n,r,a);var o=$u(i),s=ah(i),c=o*t,l=s*t,u=o/t,h=s/t,d=(s*n-o*e)/t,f=(s*e+o*n)/t;function p(t,i){return[c*(t*=r)-l*(i*=a)+e,n-l*t-c*i]}return p.invert=function(t,e){return[r*(u*t-h*e+d),a*(f-h*t-u*e)]},p}function im(t){return om(function(){return t})()}function om(t){var e,n,r,a,i,o,s,c,l,u,h=150,d=480,f=250,p=0,m=0,g=0,y=0,v=0,b=0,w=1,x=1,k=null,_=nf,S=null,T=Ff,I=.5;function E(t){return c(t[0]*Xu,t[1]*Xu)}function N(t){return(t=c.invert(t[0],t[1]))&&[t[0]*Ku,t[1]*Ku]}function C(){var t=am(h,0,0,w,x,b).apply(null,e(p,m)),r=am(h,d-t[0],f-t[1],w,x,b);return n=zd(g,y,v),s=Pd(e,r),c=Pd(n,s),o=nm(s,I),A()}function A(){return l=u=null,E}return E.stream=function(t){return l&&u===t?l:l=rm(function(t){return Kp({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(_(o(T(u=t)))))},E.preclip=function(t){return arguments.length?(_=t,k=void 0,A()):_},E.postclip=function(t){return arguments.length?(T=t,S=r=a=i=null,A()):T},E.clipAngle=function(t){return arguments.length?(_=+t?rf(k=t*Xu):(k=null,nf),A()):k*Ku},E.clipExtent=function(t){return arguments.length?(T=null==t?(S=r=a=i=null,Ff):hf(S=+t[0][0],r=+t[0][1],a=+t[1][0],i=+t[1][1]),A()):null==S?null:[[S,r],[a,i]]},E.scale=function(t){return arguments.length?(h=+t,C()):h},E.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],C()):[d,f]},E.center=function(t){return arguments.length?(p=t[0]%360*Xu,m=t[1]%360*Xu,C()):[p*Ku,m*Ku]},E.rotate=function(t){return arguments.length?(g=t[0]%360*Xu,y=t[1]%360*Xu,v=t.length>2?t[2]%360*Xu:0,C()):[g*Ku,y*Ku,v*Ku]},E.angle=function(t){return arguments.length?(b=t%360*Xu,C()):b*Ku},E.reflectX=function(t){return arguments.length?(w=t?-1:1,C()):w<0},E.reflectY=function(t){return arguments.length?(x=t?-1:1,C()):x<0},E.precision=function(t){return arguments.length?(o=nm(s,I=t*t),A()):oh(I)},E.fitExtent=function(t,e){return Qp(E,t,e)},E.fitSize=function(t,e){return Jp(E,t,e)},E.fitWidth=function(t,e){return $p(E,t,e)},E.fitHeight=function(t,e){return Zp(E,t,e)},function(){return e=t.apply(this,arguments),E.invert=e.invert&&N,C()}}function sm(t){var e=0,n=Wu/3,r=om(t),a=r(e,n);return a.parallels=function(t){return arguments.length?r(e=t[0]*Xu,n=t[1]*Xu):[e*Ku,n*Ku]},a}function cm(t,e){var n=ah(t),r=(n+ah(e))/2;if(Yu(r)<Uu)return function(t){var e=$u(t);function n(t,n){return[t*e,ah(n)/e]}return n.invert=function(t,n){return[t/e,lh(n*e)]},n}(t);var a=1+n*(2*r-n),i=oh(a)/r;function o(t,e){var n=oh(a-2*r*ah(e))/r;return[n*ah(t*=r),i-n*$u(t)]}return o.invert=function(t,e){var n=i-e,o=Ju(t,Yu(n))*ih(n);return n*r<0&&(o-=Wu*ih(t)*ih(n)),[o/r,lh((a-(t*t+n*n)*r*r)/(2*r))]},o}function lm(){return sm(cm).scale(155.424).center([0,33.6442])}function um(){return lm().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function hm(){var t,e,n,r,a,i,o=um(),s=lm().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=lm().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,e){i=[t,e]}};function u(t){var e=t[0],o=t[1];return i=null,n.point(e,o),i||(r.point(e,o),i)||(a.point(e,o),i)}function h(){return t=e=null,u}return u.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,a=(t[1]-n[1])/e;return(a>=.12&&a<.234&&r>=-.425&&r<-.214?s:a>=.166&&a<.234&&r>=-.214&&r<-.115?c:o).invert(t)},u.stream=function(n){return t&&e===n?t:t=function(t){var e=t.length;return{point:function(n,r){for(var a=-1;++a<e;)t[a].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}([o.stream(e=n),s.stream(n),c.stream(n)])},u.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),c.precision(t),h()):o.precision()},u.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),c.scale(t),u.translate(o.translate())):o.scale()},u.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),i=+t[0],u=+t[1];return n=o.translate(t).clipExtent([[i-.455*e,u-.238*e],[i+.455*e,u+.238*e]]).stream(l),r=s.translate([i-.307*e,u+.201*e]).clipExtent([[i-.425*e+Uu,u+.12*e+Uu],[i-.214*e-Uu,u+.234*e-Uu]]).stream(l),a=c.translate([i-.205*e,u+.212*e]).clipExtent([[i-.214*e+Uu,u+.166*e+Uu],[i-.115*e-Uu,u+.234*e-Uu]]).stream(l),h()},u.fitExtent=function(t,e){return Qp(u,t,e)},u.fitSize=function(t,e){return Jp(u,t,e)},u.fitWidth=function(t,e){return $p(u,t,e)},u.fitHeight=function(t,e){return Zp(u,t,e)},u.scale(1070)}function dm(t){return function(e,n){var r=$u(e),a=$u(n),i=t(r*a);return i===1/0?[2,0]:[i*a*ah(e),i*ah(n)]}}function fm(t){return function(e,n){var r=oh(e*e+n*n),a=t(r),i=ah(a),o=$u(a);return[Ju(e*i,r*o),lh(r&&n*i/r)]}}var pm=dm(function(t){return oh(2/(1+t))});function mm(){return im(pm).scale(124.75).clipAngle(179.999)}pm.invert=fm(function(t){return 2*lh(t/2)});var gm=dm(function(t){return(t=ch(t))&&t/ah(t)});function ym(){return im(gm).scale(79.4188).clipAngle(179.999)}function vm(t,e){return[t,nh(sh((Gu+e)/2))]}function bm(){return wm(vm).scale(961/qu)}function wm(t){var e,n,r,a=im(t),i=a.center,o=a.scale,s=a.translate,c=a.clipExtent,l=null;function u(){var i=Wu*o(),s=a(Vd(a.rotate()).invert([0,0]));return c(null==l?[[s[0]-i,s[1]-i],[s[0]+i,s[1]+i]]:t===vm?[[Math.max(s[0]-i,l),e],[Math.min(s[0]+i,n),r]]:[[l,Math.max(s[1]-i,e)],[n,Math.min(s[1]+i,r)]])}return a.scale=function(t){return arguments.length?(o(t),u()):o()},a.translate=function(t){return arguments.length?(s(t),u()):s()},a.center=function(t){return arguments.length?(i(t),u()):i()},a.clipExtent=function(t){return arguments.length?(null==t?l=e=n=r=null:(l=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),u()):null==l?null:[[l,e],[n,r]]},u()}function xm(t){return sh((Gu+t)/2)}function km(t,e){var n=$u(t),r=t===e?ah(t):nh(n/$u(e))/nh(xm(e)/xm(t)),a=n*rh(xm(t),r)/r;if(!r)return vm;function i(t,e){a>0?e<-Gu+Uu&&(e=-Gu+Uu):e>Gu-Uu&&(e=Gu-Uu);var n=a/rh(xm(e),r);return[n*ah(r*t),a-n*$u(r*t)]}return i.invert=function(t,e){var n=a-e,i=ih(r)*oh(t*t+n*n),o=Ju(t,Yu(n))*ih(n);return n*r<0&&(o-=Wu*ih(t)*ih(n)),[o/r,2*Qu(rh(a/i,1/r))-Gu]},i}function _m(){return sm(km).scale(109.5).parallels([30,30])}function Sm(t,e){return[t,e]}function Tm(){return im(Sm).scale(152.63)}function Im(t,e){var n=$u(t),r=t===e?ah(t):(n-$u(e))/(e-t),a=n/r+t;if(Yu(r)<Uu)return Sm;function i(t,e){var n=a-e,i=r*t;return[n*ah(i),a-n*$u(i)]}return i.invert=function(t,e){var n=a-e,i=Ju(t,Yu(n))*ih(n);return n*r<0&&(i-=Wu*ih(t)*ih(n)),[i/r,a-ih(r)*oh(t*t+n*n)]},i}function Em(){return sm(Im).scale(131.154).center([0,13.9389])}gm.invert=fm(function(t){return t}),vm.invert=function(t,e){return[t,2*Qu(th(e))-Gu]},Sm.invert=Sm;var Nm=1.340264,Cm=-.081106,Am=893e-6,Rm=.003796,Om=oh(3)/2;function Dm(t,e){var n=lh(Om*ah(e)),r=n*n,a=r*r*r;return[t*$u(n)/(Om*(Nm+3*Cm*r+a*(7*Am+9*Rm*r))),n*(Nm+Cm*r+a*(Am+Rm*r))]}function Mm(){return im(Dm).scale(177.158)}function Fm(t,e){var n=$u(e),r=$u(t)*n;return[n*ah(t)/r,ah(e)/r]}function Pm(){return im(Fm).scale(144.049).clipAngle(60)}function Lm(){var t,e,n,r,a,i,o,s=1,c=0,l=0,u=1,h=1,d=0,f=null,p=1,m=1,g=Kp({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=Ff;function v(){return p=s*u,m=s*h,i=o=null,b}function b(n){var r=n[0]*p,a=n[1]*m;if(d){var i=a*t-r*e;r=r*t+a*e,a=i}return[r+c,a+l]}return b.invert=function(n){var r=n[0]-c,a=n[1]-l;if(d){var i=a*t+r*e;r=r*t-a*e,a=i}return[r/p,a/m]},b.stream=function(t){return i&&o===t?i:i=g(y(o=t))},b.postclip=function(t){return arguments.length?(y=t,f=n=r=a=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(f=n=r=a=null,Ff):hf(f=+t[0][0],n=+t[0][1],r=+t[1][0],a=+t[1][1]),v()):null==f?null:[[f,n],[r,a]]},b.scale=function(t){return arguments.length?(s=+t,v()):s},b.translate=function(t){return arguments.length?(c=+t[0],l=+t[1],v()):[c,l]},b.angle=function(n){return arguments.length?(e=ah(d=n%360*Xu),t=$u(d),v()):d*Ku},b.reflectX=function(t){return arguments.length?(u=t?-1:1,v()):u<0},b.reflectY=function(t){return arguments.length?(h=t?-1:1,v()):h<0},b.fitExtent=function(t,e){return Qp(b,t,e)},b.fitSize=function(t,e){return Jp(b,t,e)},b.fitWidth=function(t,e){return $p(b,t,e)},b.fitHeight=function(t,e){return Zp(b,t,e)},b}function zm(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function Bm(){return im(zm).scale(175.295)}function jm(t,e){return[$u(e)*ah(t),ah(e)]}function Um(){return im(jm).scale(249.5).clipAngle(90+Uu)}function Vm(t,e){var n=$u(e),r=1+$u(t)*n;return[n*ah(t)/r,ah(e)/r]}function Wm(){return im(Vm).scale(250).clipAngle(142)}function Gm(t,e){return[nh(sh((Gu+e)/2)),-t]}function Hm(){var t=wm(Gm),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}function qm(t,e){return t.parent===e.parent?1:2}function Km(t,e){return t+e.x}function Xm(t,e){return Math.max(t,e.y)}function Ym(){var t=qm,e=1,n=1,r=!1;function a(a){var i,o=0;a.eachAfter(function(e){var n=e.children;n?(e.x=function(t){return t.reduce(Km,0)/t.length}(n),e.y=function(t){return 1+t.reduce(Xm,0)}(n)):(e.x=i?o+=t(e,i):0,e.y=0,i=e)});var s=function(t){for(var e;e=t.children;)t=e[0];return t}(a),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(a),l=s.x-t(s,c)/2,u=c.x+t(c,s)/2;return a.eachAfter(r?function(t){t.x=(t.x-a.x)*e,t.y=(a.y-t.y)*n}:function(t){t.x=(t.x-l)/(u-l)*e,t.y=(1-(a.y?t.y/a.y:1))*n})}return a.separation=function(e){return arguments.length?(t=e,a):t},a.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],a):r?null:[e,n]},a.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],a):r?[e,n]:null},a}function Qm(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function Jm(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=Zm)):void 0===e&&(e=$m);for(var n,r,a,i,o,s=new ng(t),c=[s];n=c.pop();)if((a=e(n.data))&&(o=(a=Array.from(a)).length))for(n.children=a,i=o-1;i>=0;--i)c.push(r=a[i]=new ng(a[i])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(eg)}function $m(t){return t.children}function Zm(t){return Array.isArray(t)?t[1]:null}function tg(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function eg(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function ng(t){this.data=t,this.depth=this.height=0,this.parent=null}function rg(t){return null==t?null:ag(t)}function ag(t){if("function"!==typeof t)throw new Error;return t}function ig(){return 0}function og(t){return function(){return t}}Dm.invert=function(t,e){for(var n,r=e,a=r*r,i=a*a*a,o=0;o<12&&(i=(a=(r-=n=(r*(Nm+Cm*a+i*(Am+Rm*a))-e)/(Nm+3*Cm*a+i*(7*Am+9*Rm*a)))*r)*a*a,!(Yu(n)<Vu));++o);return[Om*t*(Nm+3*Cm*a+i*(7*Am+9*Rm*a))/$u(r),lh(ah(r)/Om)]},Fm.invert=fm(Qu),zm.invert=function(t,e){var n,r=e,a=25;do{var i=r*r,o=i*i;r-=n=(r*(1.007226+i*(.015085+o*(.028874*i-.044475-.005916*o)))-e)/(1.007226+i*(.045255+o*(.259866*i-.311325-.005916*11*o)))}while(Yu(n)>Uu&&--a>0);return[t/(.8707+(i=r*r)*(i*(i*i*i*(.003971-.001529*i)-.013791)-.131979)),r]},jm.invert=fm(lh),Vm.invert=fm(function(t){return 2*Qu(t)}),Gm.invert=function(t,e){return[-e,2*Qu(th(t))-Gu]},ng.prototype=Jm.prototype={constructor:ng,count:function(){return this.eachAfter(Qm)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,a,i=this,o=[i],s=[],c=-1;i=o.pop();)if(s.push(i),n=i.children)for(r=0,a=n.length;r<a;++r)o.push(n[r]);for(;i=s.pop();)t.call(e,i,++c,this);return this},eachBefore:function(t,e){for(var n,r,a=this,i=[a],o=-1;a=i.pop();)if(t.call(e,a,++o,this),n=a.children)for(r=n.length-1;r>=0;--r)i.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,a=r&&r.length;--a>=0;)n+=r[a].value;e.value=n})},sort:function(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),a=null;t=n.pop(),e=r.pop();for(;t===e;)a=t,t=n.pop(),e=r.pop();return a}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var a=r.length;t!==n;)r.splice(a,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t},links:function(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e},copy:function(){return Jm(this).eachBefore(tg)},[Symbol.iterator]:function*(){var t,e,n,r,a=this,i=[a];do{for(t=i.reverse(),i=[];a=t.pop();)if(yield a,e=a.children)for(n=0,r=e.length;n<r;++n)i.push(e[n])}while(i.length)}};const sg=1664525,cg=1013904223,lg=4294967296;function ug(){let t=1;return()=>(t=(sg*t+cg)%lg)/lg}function hg(t){return dg(t,ug())}function dg(t,e){for(var n,r,a=0,i=(t=function(t,e){let n,r,a=t.length;for(;a;)r=e()*a--|0,n=t[a],t[a]=t[r],t[r]=n;return t}(Array.from(t),e)).length,o=[];a<i;)n=t[a],r&&mg(r,n)?++a:(r=yg(o=fg(o,n)),a=0);return r}function fg(t,e){var n,r;if(gg(e,t))return[e];for(n=0;n<t.length;++n)if(pg(e,t[n])&&gg(vg(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(pg(vg(t[n],t[r]),e)&&pg(vg(t[n],e),t[r])&&pg(vg(t[r],e),t[n])&&gg(bg(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function pg(t,e){var n=t.r-e.r,r=e.x-t.x,a=e.y-t.y;return n<0||n*n<r*r+a*a}function mg(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,a=e.y-t.y;return n>0&&n*n>r*r+a*a}function gg(t,e){for(var n=0;n<e.length;++n)if(!mg(t,e[n]))return!1;return!0}function yg(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return vg(t[0],t[1]);case 3:return bg(t[0],t[1],t[2])}}function vg(t,e){var n=t.x,r=t.y,a=t.r,i=e.x,o=e.y,s=e.r,c=i-n,l=o-r,u=s-a,h=Math.sqrt(c*c+l*l);return{x:(n+i+c/h*u)/2,y:(r+o+l/h*u)/2,r:(h+a+s)/2}}function bg(t,e,n){var r=t.x,a=t.y,i=t.r,o=e.x,s=e.y,c=e.r,l=n.x,u=n.y,h=n.r,d=r-o,f=r-l,p=a-s,m=a-u,g=c-i,y=h-i,v=r*r+a*a-i*i,b=v-o*o-s*s+c*c,w=v-l*l-u*u+h*h,x=f*p-d*m,k=(p*w-m*b)/(2*x)-r,_=(m*g-p*y)/x,S=(f*b-d*w)/(2*x)-a,T=(d*y-f*g)/x,I=_*_+T*T-1,E=2*(i+k*_+S*T),N=k*k+S*S-i*i,C=-(Math.abs(I)>1e-6?(E+Math.sqrt(E*E-4*I*N))/(2*I):N/E);return{x:r+k+_*C,y:a+S+T*C,r:C}}function wg(t,e,n){var r,a,i,o,s=t.x-e.x,c=t.y-e.y,l=s*s+c*c;l?(a=e.r+n.r,a*=a,o=t.r+n.r,a>(o*=o)?(r=(l+o-a)/(2*l),i=Math.sqrt(Math.max(0,o/l-r*r)),n.x=t.x-r*s-i*c,n.y=t.y-r*c+i*s):(r=(l+a-o)/(2*l),i=Math.sqrt(Math.max(0,a/l-r*r)),n.x=e.x+r*s-i*c,n.y=e.y+r*c+i*s)):(n.x=e.x+n.r,n.y=e.y)}function xg(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,a=e.y-t.y;return n>0&&n*n>r*r+a*a}function kg(t){var e=t._,n=t.next._,r=e.r+n.r,a=(e.x*n.r+n.x*e.r)/r,i=(e.y*n.r+n.y*e.r)/r;return a*a+i*i}function _g(t){this._=t,this.next=null,this.previous=null}function Sg(t,e){if(!(i=(t=function(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var n,r,a,i,o,s,c,l,u,h,d;if((n=t[0]).x=0,n.y=0,!(i>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(i>2))return n.r+r.r;wg(r,n,a=t[2]),n=new _g(n),r=new _g(r),a=new _g(a),n.next=a.previous=r,r.next=n.previous=a,a.next=r.previous=n;t:for(c=3;c<i;++c){wg(n._,r._,a=t[c]),a=new _g(a),l=r.next,u=n.previous,h=r._.r,d=n._.r;do{if(h<=d){if(xg(l._,a._)){r=l,n.next=r,r.previous=n,--c;continue t}h+=l._.r,l=l.next}else{if(xg(u._,a._)){(n=u).next=r,r.previous=n,--c;continue t}d+=u._.r,u=u.previous}}while(l!==u.next);for(a.previous=n,a.next=r,n.next=r.previous=r=a,o=kg(n);(a=a.next)!==r;)(s=kg(a))<o&&(n=a,o=s);r=n.next}for(n=[r._],a=r;(a=a.next)!==r;)n.push(a._);for(a=dg(n,e),c=0;c<i;++c)(n=t[c]).x-=a.x,n.y-=a.y;return a.r}function Tg(t){return Sg(t,ug()),t}function Ig(t){return Math.sqrt(t.value)}function Eg(){var t=null,e=1,n=1,r=ig;function a(a){const i=ug();return a.x=e/2,a.y=n/2,t?a.eachBefore(Ng(t)).eachAfter(Cg(r,.5,i)).eachBefore(Ag(1)):a.eachBefore(Ng(Ig)).eachAfter(Cg(ig,1,i)).eachAfter(Cg(r,a.r/Math.min(e,n),i)).eachBefore(Ag(Math.min(e,n)/(2*a.r))),a}return a.radius=function(e){return arguments.length?(t=rg(e),a):t},a.size=function(t){return arguments.length?(e=+t[0],n=+t[1],a):[e,n]},a.padding=function(t){return arguments.length?(r="function"===typeof t?t:og(+t),a):r},a}function Ng(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Cg(t,e,n){return function(r){if(a=r.children){var a,i,o,s=a.length,c=t(r)*e||0;if(c)for(i=0;i<s;++i)a[i].r+=c;if(o=Sg(a,n),c)for(i=0;i<s;++i)a[i].r-=c;r.r=o+c}}}function Ag(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function Rg(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Og(t,e,n,r,a){for(var i,o=t.children,s=-1,c=o.length,l=t.value&&(r-e)/t.value;++s<c;)(i=o[s]).y0=n,i.y1=a,i.x0=e,i.x1=e+=i.value*l}function Dg(){var t=1,e=1,n=0,r=!1;function a(a){var i=a.height+1;return a.x0=a.y0=n,a.x1=t,a.y1=e/i,a.eachBefore(function(t,e){return function(r){r.children&&Og(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var a=r.x0,i=r.y0,o=r.x1-n,s=r.y1-n;o<a&&(a=o=(a+o)/2),s<i&&(i=s=(i+s)/2),r.x0=a,r.y0=i,r.x1=o,r.y1=s}}(e,i)),r&&a.eachBefore(Rg),a}return a.round=function(t){return arguments.length?(r=!!t,a):r},a.size=function(n){return arguments.length?(t=+n[0],e=+n[1],a):[t,e]},a.padding=function(t){return arguments.length?(n=+t,a):n},a}var Mg={depth:-1},Fg={},Pg={};function Lg(t){return t.id}function zg(t){return t.parentId}function Bg(){var t,e=Lg,n=zg;function r(r){var a,i,o,s,c,l,u,h,d=Array.from(r),f=e,p=n,m=new Map;if(null!=t){const e=d.map((e,n)=>function(t){t="".concat(t);let e=t.length;Ug(t,e-1)&&!Ug(t,e-2)&&(t=t.slice(0,-1));return"/"===t[0]?t:"/".concat(t)}(t(e,n,r))),n=e.map(jg),a=new Set(e).add("");for(const t of n)a.has(t)||(a.add(t),e.push(t),n.push(jg(t)),d.push(Pg));f=(t,n)=>e[n],p=(t,e)=>n[e]}for(o=0,a=d.length;o<a;++o)i=d[o],l=d[o]=new ng(i),null!=(u=f(i,o,r))&&(u+="")&&(h=l.id=u,m.set(h,m.has(h)?Fg:l)),null!=(u=p(i,o,r))&&(u+="")&&(l.parent=u);for(o=0;o<a;++o)if(u=(l=d[o]).parent){if(!(c=m.get(u)))throw new Error("missing: "+u);if(c===Fg)throw new Error("ambiguous: "+u);c.children?c.children.push(l):c.children=[l],l.parent=c}else{if(s)throw new Error("multiple roots");s=l}if(!s)throw new Error("no root");if(null!=t){for(;s.data===Pg&&1===s.children.length;)s=s.children[0],--a;for(let t=d.length-1;t>=0&&(l=d[t]).data===Pg;--t)l.data=null}if(s.parent=Mg,s.eachBefore(function(t){t.depth=t.parent.depth+1,--a}).eachBefore(eg),s.parent=null,a>0)throw new Error("cycle");return s}return r.id=function(t){return arguments.length?(e=rg(t),r):e},r.parentId=function(t){return arguments.length?(n=rg(t),r):n},r.path=function(e){return arguments.length?(t=rg(e),r):t},r}function jg(t){let e=t.length;if(e<2)return"";for(;--e>1&&!Ug(t,e););return t.slice(0,e)}function Ug(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0===(1&n))return!0}return!1}function Vg(t,e){return t.parent===e.parent?1:2}function Wg(t){var e=t.children;return e?e[0]:t.t}function Gg(t){var e=t.children;return e?e[e.length-1]:t.t}function Hg(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function qg(t,e,n){return t.a.parent===e.parent?t.a:n}function Kg(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function Xg(){var t=Vg,e=1,n=1,r=null;function a(a){var c=function(t){for(var e,n,r,a,i,o=new Kg(t,0),s=[o];e=s.pop();)if(r=e._.children)for(e.children=new Array(i=r.length),a=i-1;a>=0;--a)s.push(n=e.children[a]=new Kg(r[a],a)),n.parent=e;return(o.parent=new Kg(null,0)).children=[o],o}(a);if(c.eachAfter(i),c.parent.m=-c.z,c.eachBefore(o),r)a.eachBefore(s);else{var l=a,u=a,h=a;a.eachBefore(function(t){t.x<l.x&&(l=t),t.x>u.x&&(u=t),t.depth>h.depth&&(h=t)});var d=l===u?1:t(l,u)/2,f=d-l.x,p=e/(u.x+d+f),m=n/(h.depth||1);a.eachBefore(function(t){t.x=(t.x+f)*p,t.y=t.depth*m})}return a}function i(e){var n=e.children,r=e.parent.children,a=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,a=t.children,i=a.length;--i>=0;)(e=a[i]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var i=(n[0].z+n[n.length-1].z)/2;a?(e.z=a.z+t(e._,a._),e.m=e.z-i):e.z=i}else a&&(e.z=a.z+t(e._,a._));e.parent.A=function(e,n,r){if(n){for(var a,i=e,o=e,s=n,c=i.parent.children[0],l=i.m,u=o.m,h=s.m,d=c.m;s=Gg(s),i=Wg(i),s&&i;)c=Wg(c),(o=Gg(o)).a=e,(a=s.z+h-i.z-l+t(s._,i._))>0&&(Hg(qg(s,e,r),e,a),l+=a,u+=a),h+=s.m,l+=i.m,d+=c.m,u+=o.m;s&&!Gg(o)&&(o.t=s,o.m+=h-u),i&&!Wg(c)&&(c.t=i,c.m+=l-d,r=e)}return r}(e,a,e.parent.A||r[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return a.separation=function(e){return arguments.length?(t=e,a):t},a.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],a):r?null:[e,n]},a.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],a):r?[e,n]:null},a}function Yg(t,e,n,r,a){for(var i,o=t.children,s=-1,c=o.length,l=t.value&&(a-n)/t.value;++s<c;)(i=o[s]).x0=e,i.x1=r,i.y0=n,i.y1=n+=i.value*l}Kg.prototype=Object.create(ng.prototype);var Qg=(1+Math.sqrt(5))/2;function Jg(t,e,n,r,a,i){for(var o,s,c,l,u,h,d,f,p,m,g,y=[],v=e.children,b=0,w=0,x=v.length,k=e.value;b<x;){c=a-n,l=i-r;do{u=v[w++].value}while(!u&&w<x);for(h=d=u,g=u*u*(m=Math.max(l/c,c/l)/(k*t)),p=Math.max(d/g,g/h);w<x;++w){if(u+=s=v[w].value,s<h&&(h=s),s>d&&(d=s),g=u*u*m,(f=Math.max(d/g,g/h))>p){u-=s;break}p=f}y.push(o={value:u,dice:c<l,children:v.slice(b,w)}),o.dice?Og(o,n,r,a,k?r+=l*u/k:i):Yg(o,n,r,k?n+=c*u/k:a,i),k-=u,b=w}return y}const $g=function t(e){function n(t,n,r,a,i){Jg(e,t,n,r,a,i)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Qg);function Zg(){var t=$g,e=!1,n=1,r=1,a=[0],i=ig,o=ig,s=ig,c=ig,l=ig;function u(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),a=[0],e&&t.eachBefore(Rg),t}function h(e){var n=a[e.depth],r=e.x0+n,u=e.y0+n,h=e.x1-n,d=e.y1-n;h<r&&(r=h=(r+h)/2),d<u&&(u=d=(u+d)/2),e.x0=r,e.y0=u,e.x1=h,e.y1=d,e.children&&(n=a[e.depth+1]=i(e)/2,r+=l(e)-n,u+=o(e)-n,(h-=s(e)-n)<r&&(r=h=(r+h)/2),(d-=c(e)-n)<u&&(u=d=(u+d)/2),t(e,r,u,h,d))}return u.round=function(t){return arguments.length?(e=!!t,u):e},u.size=function(t){return arguments.length?(n=+t[0],r=+t[1],u):[n,r]},u.tile=function(e){return arguments.length?(t=ag(e),u):t},u.padding=function(t){return arguments.length?u.paddingInner(t).paddingOuter(t):u.paddingInner()},u.paddingInner=function(t){return arguments.length?(i="function"===typeof t?t:og(+t),u):i},u.paddingOuter=function(t){return arguments.length?u.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):u.paddingTop()},u.paddingTop=function(t){return arguments.length?(o="function"===typeof t?t:og(+t),u):o},u.paddingRight=function(t){return arguments.length?(s="function"===typeof t?t:og(+t),u):s},u.paddingBottom=function(t){return arguments.length?(c="function"===typeof t?t:og(+t),u):c},u.paddingLeft=function(t){return arguments.length?(l="function"===typeof t?t:og(+t),u):l},u}function ty(t,e,n,r,a){var i,o,s=t.children,c=s.length,l=new Array(c+1);for(l[0]=o=i=0;i<c;++i)l[i+1]=o+=s[i].value;!function t(e,n,r,a,i,o,c){if(e>=n-1){var u=s[e];return u.x0=a,u.y0=i,u.x1=o,void(u.y1=c)}var h=l[e],d=r/2+h,f=e+1,p=n-1;for(;f<p;){var m=f+p>>>1;l[m]<d?f=m+1:p=m}d-l[f-1]<l[f]-d&&e+1<f&&--f;var g=l[f]-h,y=r-g;if(o-a>c-i){var v=r?(a*y+o*g)/r:o;t(e,f,g,a,i,v,c),t(f,n,y,v,i,o,c)}else{var b=r?(i*y+c*g)/r:c;t(e,f,g,a,i,o,b),t(f,n,y,a,b,o,c)}}(0,c,t.value,e,n,r,a)}function ey(t,e,n,r,a){(1&t.depth?Yg:Og)(t,e,n,r,a)}const ny=function t(e){function n(t,n,r,a,i){if((o=t._squarify)&&o.ratio===e)for(var o,s,c,l,u,h=-1,d=o.length,f=t.value;++h<d;){for(c=(s=o[h]).children,l=s.value=0,u=c.length;l<u;++l)s.value+=c[l].value;s.dice?Og(s,n,r,a,f?r+=(i-r)*s.value/f:i):Yg(s,n,r,f?n+=(a-n)*s.value/f:a,i),f-=s.value}else t._squarify=o=Jg(e,t,n,r,a,i),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Qg);function ry(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function ay(t,e){var n=Fr(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}function iy(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function oy(t){return((t=Math.exp(t))+1/t)/2}const sy=function t(e,n,r){function a(t,a){var i,o,s=t[0],c=t[1],l=t[2],u=a[0],h=a[1],d=a[2],f=u-s,p=h-c,m=f*f+p*p;if(m<1e-12)o=Math.log(d/l)/e,i=function(t){return[s+t*f,c+t*p,l*Math.exp(e*t*o)]};else{var g=Math.sqrt(m),y=(d*d-l*l+r*m)/(2*l*n*g),v=(d*d-l*l-r*m)/(2*d*n*g),b=Math.log(Math.sqrt(y*y+1)-y),w=Math.log(Math.sqrt(v*v+1)-v);o=(w-b)/e,i=function(t){var r=t*o,a=oy(b),i=l/(n*g)*(a*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[s+i*f,c+i*p,l*a/oy(e*r+b)]}}return i.duration=1e3*o*e/Math.SQRT2,i}return a.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},a}(Math.SQRT2,2,4);function cy(t){return function(e,n){var r=t((e=Tr(e)).h,(n=Tr(n)).h),a=Lr(e.s,n.s),i=Lr(e.l,n.l),o=Lr(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=a(t),e.l=i(t),e.opacity=o(t),e+""}}}const ly=cy(Fr);var uy=cy(Lr);function hy(t,e){var n=Lr((t=Qo(t)).l,(e=Qo(e)).l),r=Lr(t.a,e.a),a=Lr(t.b,e.b),i=Lr(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=a(e),t.opacity=i(e),t+""}}function dy(t){return function(e,n){var r=t((e=as(e)).h,(n=as(n)).h),a=Lr(e.c,n.c),i=Lr(e.l,n.l),o=Lr(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=a(t),e.l=i(t),e.opacity=o(t),e+""}}}const fy=dy(Fr);var py=dy(Lr);function my(t){return function e(n){function r(e,r){var a=t((e=ms(e)).h,(r=ms(r)).h),i=Lr(e.s,r.s),o=Lr(e.l,r.l),s=Lr(e.opacity,r.opacity);return function(t){return e.h=a(t),e.s=i(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}const gy=my(Fr);var yy=my(Lr);function vy(t,e){void 0===e&&(e=t,t=$r);for(var n=0,r=e.length-1,a=e[0],i=new Array(r<0?0:r);n<r;)i[n]=t(a,a=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return i[e](t-e)}}function by(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function wy(t){for(var e,n=-1,r=t.length,a=t[r-1],i=0;++n<r;)e=a,a=t[n],i+=e[1]*a[0]-e[0]*a[1];return i/2}function xy(t){for(var e,n,r=-1,a=t.length,i=0,o=0,s=t[a-1],c=0;++r<a;)e=s,s=t[r],c+=n=e[0]*s[1]-s[0]*e[1],i+=(e[0]+s[0])*n,o+=(e[1]+s[1])*n;return[i/(c*=3),o/c]}function ky(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function _y(t,e){return t[0]-e[0]||t[1]-e[1]}function Sy(t){const e=t.length,n=[0,1];let r,a=2;for(r=2;r<e;++r){for(;a>1&&ky(t[n[a-2]],t[n[a-1]],t[r])<=0;)--a;n[a++]=r}return n.slice(0,a)}function Ty(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),a=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(_y),e=0;e<n;++e)a[e]=[r[e][0],-r[e][1]];var i=Sy(r),o=Sy(a),s=o[0]===i[0],c=o[o.length-1]===i[i.length-1],l=[];for(e=i.length-1;e>=0;--e)l.push(t[r[i[e]][2]]);for(e=+s;e<o.length-c;++e)l.push(t[r[o[e]][2]]);return l}function Iy(t,e){for(var n,r,a=t.length,i=t[a-1],o=e[0],s=e[1],c=i[0],l=i[1],u=!1,h=0;h<a;++h)n=(i=t[h])[0],(r=i[1])>s!==l>s&&o<(c-n)*(s-r)/(l-r)+n&&(u=!u),c=n,l=r;return u}function Ey(t){for(var e,n,r=-1,a=t.length,i=t[a-1],o=i[0],s=i[1],c=0;++r<a;)e=o,n=s,e-=o=(i=t[r])[0],n-=s=i[1],c+=Math.hypot(e,n);return c}const Ny=Math.random,Cy=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(Ny),Ay=function t(e){function n(t,n){return arguments.length<2&&(n=t,t=0),t=Math.floor(t),n=Math.floor(n)-t,function(){return Math.floor(e()*n+t)}}return n.source=t,n}(Ny),Ry=function t(e){function n(t,n){var r,a;return t=null==t?0:+t,n=null==n?1:+n,function(){var i;if(null!=r)i=r,r=null;else do{r=2*e()-1,i=2*e()-1,a=r*r+i*i}while(!a||a>1);return t+n*i*Math.sqrt(-2*Math.log(a)/a)}}return n.source=t,n}(Ny),Oy=function t(e){var n=Ry.source(e);function r(){var t=n.apply(this,arguments);return function(){return Math.exp(t())}}return r.source=t,r}(Ny),Dy=function t(e){function n(t){return(t=+t)<=0?()=>0:function(){for(var n=0,r=t;r>1;--r)n+=e();return n+r*e()}}return n.source=t,n}(Ny),My=function t(e){var n=Dy.source(e);function r(t){if(0===(t=+t))return e;var r=n(t);return function(){return r()/t}}return r.source=t,r}(Ny),Fy=function t(e){function n(t){return function(){return-Math.log1p(-e())/t}}return n.source=t,n}(Ny),Py=function t(e){function n(t){if((t=+t)<0)throw new RangeError("invalid alpha");return t=1/-t,function(){return Math.pow(1-e(),t)}}return n.source=t,n}(Ny),Ly=function t(e){function n(t){if((t=+t)<0||t>1)throw new RangeError("invalid p");return function(){return Math.floor(e()+t)}}return n.source=t,n}(Ny),zy=function t(e){function n(t){if((t=+t)<0||t>1)throw new RangeError("invalid p");return 0===t?()=>1/0:1===t?()=>1:(t=Math.log1p(-t),function(){return 1+Math.floor(Math.log1p(-e())/t)})}return n.source=t,n}(Ny),By=function t(e){var n=Ry.source(e)();function r(t,r){if((t=+t)<0)throw new RangeError("invalid k");if(0===t)return()=>0;if(r=null==r?1:+r,1===t)return()=>-Math.log1p(-e())*r;var a=(t<1?t+1:t)-1/3,i=1/(3*Math.sqrt(a)),o=t<1?()=>Math.pow(e(),1/t):()=>1;return function(){do{do{var t=n(),s=1+i*t}while(s<=0);s*=s*s;var c=1-e()}while(c>=1-.0331*t*t*t*t&&Math.log(c)>=.5*t*t+a*(1-s+Math.log(s)));return a*s*o()*r}}return r.source=t,r}(Ny),jy=function t(e){var n=By.source(e);function r(t,e){var r=n(t),a=n(e);return function(){var t=r();return 0===t?0:t/(t+a())}}return r.source=t,r}(Ny),Uy=function t(e){var n=zy.source(e),r=jy.source(e);function a(t,e){return t=+t,(e=+e)>=1?()=>t:e<=0?()=>0:function(){for(var a=0,i=t,o=e;i*o>16&&i*(1-o)>16;){var s=Math.floor((i+1)*o),c=r(s,i-s+1)();c<=o?(a+=s,i-=s,o=(o-c)/(1-c)):(i=s-1,o/=c)}for(var l=o<.5,u=n(l?o:1-o),h=u(),d=0;h<=i;++d)h+=u();return a+(l?d:i-d)}}return a.source=t,a}(Ny),Vy=function t(e){function n(t,n,r){var a;return 0===(t=+t)?a=t=>-Math.log(t):(t=1/t,a=e=>Math.pow(e,t)),n=null==n?0:+n,r=null==r?1:+r,function(){return n+r*a(-Math.log1p(-e()))}}return n.source=t,n}(Ny),Wy=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,function(){return t+n*Math.tan(Math.PI*e())}}return n.source=t,n}(Ny),Gy=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,function(){var r=e();return t+n*Math.log(r/(1-r))}}return n.source=t,n}(Ny),Hy=function t(e){var n=By.source(e),r=Uy.source(e);function a(t){return function(){for(var a=0,i=t;i>16;){var o=Math.floor(.875*i),s=n(o)();if(s>i)return a+r(o-1,i/s)();a+=o,i-=s}for(var c=-Math.log1p(-e()),l=0;c<=i;++l)c-=Math.log1p(-e());return a+l}}return a.source=t,a}(Ny),qy=1664525,Ky=1013904223,Xy=1/4294967296;function Yy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Math.random(),e=0|(0<=t&&t<1?t/Xy:Math.abs(t));return()=>(e=qy*e+Ky|0,Xy*(e>>>0))}function Qy(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Jy(t,e){switch(arguments.length){case 0:break;case 1:"function"===typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"===typeof e?this.interpolator(e):this.range(e)}return this}const $y=Symbol("implicit");function Zy(){var t=new O,e=[],n=[],r=$y;function a(a){let i=t.get(a);if(void 0===i){if(r!==$y)return r;t.set(a,i=e.push(a)-1)}return n[i%n.length]}return a.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new O;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return a},a.range=function(t){return arguments.length?(n=Array.from(t),a):n.slice()},a.unknown=function(t){return arguments.length?(r=t,a):r},a.copy=function(){return Zy(e,n).unknown(r)},Qy.apply(a,arguments),a}function tv(){var t,e,n=Zy().unknown(void 0),r=n.domain,a=n.range,i=0,o=1,s=!1,c=0,l=0,u=.5;function h(){var n=r().length,h=o<i,d=h?o:i,f=h?i:o;t=(f-d)/Math.max(1,n-c+2*l),s&&(t=Math.floor(t)),d+=(f-d-t*(n-c))*u,e=t*(1-c),s&&(d=Math.round(d),e=Math.round(e));var p=Dt(n).map(function(e){return d+t*e});return a(h?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),h()):r()},n.range=function(t){return arguments.length?([i,o]=t,i=+i,o=+o,h()):[i,o]},n.rangeRound=function(t){return[i,o]=t,i=+i,o=+o,s=!0,h()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(s=!!t,h()):s},n.padding=function(t){return arguments.length?(c=Math.min(1,l=+t),h()):c},n.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),h()):c},n.paddingOuter=function(t){return arguments.length?(l=+t,h()):l},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),h()):u},n.copy=function(){return tv(r(),[i,o]).round(s).paddingInner(c).paddingOuter(l).align(u)},Qy.apply(h(),arguments)}function ev(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return ev(e())},t}function nv(){return ev(tv.apply(null,arguments).paddingInner(1))}function rv(t){return+t}var av=[0,1];function iv(t){return t}function ov(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function sv(t,e,n){var r=t[0],a=t[1],i=e[0],o=e[1];return a<r?(r=ov(a,r),i=n(o,i)):(r=ov(r,a),i=n(i,o)),function(t){return i(r(t))}}function cv(t,e,n){var r=Math.min(t.length,e.length)-1,a=new Array(r),i=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)a[o]=ov(t[o],t[o+1]),i[o]=n(e[o],e[o+1]);return function(e){var n=d(t,e,1,r)-1;return i[n](a[n](e))}}function lv(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function uv(){var t,e,n,r,a,i,o=av,s=av,c=$r,l=iv;function u(){var t=Math.min(o.length,s.length);return l!==iv&&(l=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(o[0],o[t-1])),r=t>2?cv:sv,a=i=null,h}function h(e){return null==e||isNaN(e=+e)?n:(a||(a=r(o.map(t),s,c)))(t(l(e)))}return h.invert=function(n){return l(e((i||(i=r(s,o.map(t),Kr)))(n)))},h.domain=function(t){return arguments.length?(o=Array.from(t,rv),u()):o.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),c=iy,u()},h.clamp=function(t){return arguments.length?(l=!!t||iv,u()):l!==iv},h.interpolate=function(t){return arguments.length?(c=t,u()):c},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,u()}}function hv(){return uv()(iv,iv)}function dv(t,e,n,r){var a,i=ut(t,e,n);switch((r=Iu(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(a=Bu(i,o))||(r.precision=a),Du(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=ju(i,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=zu(i))||(r.precision=a-2*("%"===r.type))}return Ou(r)}function fv(t){var e=t.domain;return t.ticks=function(t){var n=e();return ct(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return dv(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,a,i=e(),o=0,s=i.length-1,c=i[o],l=i[s],u=10;for(l<c&&(a=c,c=l,l=a,a=o,o=s,s=a);u-- >0;){if((a=lt(c,l,n))===r)return i[o]=c,i[s]=l,e(i);if(a>0)c=Math.floor(c/a)*a,l=Math.ceil(l/a)*a;else{if(!(a<0))break;c=Math.ceil(c*a)/a,l=Math.floor(l*a)/a}r=a}return t},t}function pv(){var t=hv();return t.copy=function(){return lv(t,pv())},Qy.apply(t,arguments),fv(t)}function mv(t){var e;function n(t){return null==t||isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,rv),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return mv(t).unknown(e)},t=arguments.length?Array.from(t,rv):[0,1],fv(n)}function gv(t,e){var n,r=0,a=(t=t.slice()).length-1,i=t[r],o=t[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),t[r]=e.floor(i),t[a]=e.ceil(o),t}function yv(t){return Math.log(t)}function vv(t){return Math.exp(t)}function bv(t){return-Math.log(-t)}function wv(t){return-Math.exp(-t)}function xv(t){return isFinite(t)?+("1e"+t):t<0?0:t}function kv(t){return(e,n)=>-t(-e,n)}function _v(t){const e=t(yv,vv),n=e.domain;let r,a,i=10;function o(){return r=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(i),a=function(t){return 10===t?xv:t===Math.E?Math.exp:e=>Math.pow(t,e)}(i),n()[0]<0?(r=kv(r),a=kv(a),t(bv,wv)):t(yv,vv),e}return e.base=function(t){return arguments.length?(i=+t,o()):i},e.domain=function(t){return arguments.length?(n(t),o()):n()},e.ticks=t=>{const e=n();let o=e[0],s=e[e.length-1];const c=s<o;c&&([o,s]=[s,o]);let l,u,h=r(o),d=r(s);const f=null==t?10:+t;let p=[];if(!(i%1)&&d-h<f){if(h=Math.floor(h),d=Math.ceil(d),o>0){for(;h<=d;++h)for(l=1;l<i;++l)if(u=h<0?l/a(-h):l*a(h),!(u<o)){if(u>s)break;p.push(u)}}else for(;h<=d;++h)for(l=i-1;l>=1;--l)if(u=h>0?l/a(-h):l*a(h),!(u<o)){if(u>s)break;p.push(u)}2*p.length<f&&(p=ct(o,s,f))}else p=ct(h,d,Math.min(d-h,f)).map(a);return c?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===i?"s":","),"function"!==typeof n&&(i%1||null!=(n=Iu(n)).precision||(n.trim=!0),n=Ou(n)),t===1/0)return n;const o=Math.max(1,i*t/e.ticks().length);return t=>{let e=t/a(Math.round(r(t)));return e*i<i-.5&&(e*=i),e<=o?n(t):""}},e.nice=()=>n(gv(n(),{floor:t=>a(Math.floor(r(t))),ceil:t=>a(Math.ceil(r(t)))})),e}function Sv(){const t=_v(uv()).domain([1,10]);return t.copy=()=>lv(t,Sv()).base(t.base()),Qy.apply(t,arguments),t}function Tv(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Iv(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Ev(t){var e=1,n=t(Tv(e),Iv(e));return n.constant=function(n){return arguments.length?t(Tv(e=+n),Iv(e)):e},fv(n)}function Nv(){var t=Ev(uv());return t.copy=function(){return lv(t,Nv()).constant(t.constant())},Qy.apply(t,arguments)}function Cv(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Av(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Rv(t){return t<0?-t*t:t*t}function Ov(t){var e=t(iv,iv),n=1;return e.exponent=function(e){return arguments.length?1===(n=+e)?t(iv,iv):.5===n?t(Av,Rv):t(Cv(n),Cv(1/n)):n},fv(e)}function Dv(){var t=Ov(uv());return t.copy=function(){return lv(t,Dv()).exponent(t.exponent())},Qy.apply(t,arguments),t}function Mv(){return Dv.apply(null,arguments).exponent(.5)}function Fv(t){return Math.sign(t)*t*t}function Pv(){var t,e=hv(),n=[0,1],r=!1;function a(n){var a=function(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}(e(n));return isNaN(a)?t:r?Math.round(a):a}return a.invert=function(t){return e.invert(Fv(t))},a.domain=function(t){return arguments.length?(e.domain(t),a):e.domain()},a.range=function(t){return arguments.length?(e.range((n=Array.from(t,rv)).map(Fv)),a):n.slice()},a.rangeRound=function(t){return a.range(t).round(!0)},a.round=function(t){return arguments.length?(r=!!t,a):r},a.clamp=function(t){return arguments.length?(e.clamp(t),a):e.clamp()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.copy=function(){return Pv(e.domain(),n).round(r).clamp(e.clamp()).unknown(t)},Qy.apply(a,arguments),fv(a)}function Lv(){var t,e=[],n=[],a=[];function i(){var t=0,r=Math.max(1,n.length);for(a=new Array(r-1);++t<r;)a[t-1]=kt(e,t/r);return o}function o(e){return null==e||isNaN(e=+e)?t:n[d(a,e)]}return o.invertExtent=function(t){var r=n.indexOf(t);return r<0?[NaN,NaN]:[r>0?a[r-1]:e[0],r<a.length?a[r]:e[e.length-1]]},o.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(r),i()},o.range=function(t){return arguments.length?(n=Array.from(t),i()):n.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return a.slice()},o.copy=function(){return Lv().domain(e).range(n).unknown(t)},Qy.apply(o,arguments)}function zv(){var t,e=0,n=1,r=1,a=[.5],i=[0,1];function o(e){return null!=e&&e<=e?i[d(a,e,0,r)]:t}function s(){var t=-1;for(a=new Array(r);++t<r;)a[t]=((t+1)*n-(t-r)*e)/(r+1);return o}return o.domain=function(t){return arguments.length?([e,n]=t,e=+e,n=+n,s()):[e,n]},o.range=function(t){return arguments.length?(r=(i=Array.from(t)).length-1,s()):i.slice()},o.invertExtent=function(t){var o=i.indexOf(t);return o<0?[NaN,NaN]:o<1?[e,a[0]]:o>=r?[a[r-1],n]:[a[o-1],a[o]]},o.unknown=function(e){return arguments.length?(t=e,o):o},o.thresholds=function(){return a.slice()},o.copy=function(){return zv().domain([e,n]).range(i).unknown(t)},Qy.apply(fv(o),arguments)}function Bv(){var t,e=[.5],n=[0,1],r=1;function a(a){return null!=a&&a<=a?n[d(e,a,0,r)]:t}return a.domain=function(t){return arguments.length?(e=Array.from(t),r=Math.min(e.length,n.length-1),a):e.slice()},a.range=function(t){return arguments.length?(n=Array.from(t),r=Math.min(e.length,n.length-1),a):n.slice()},a.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},a.unknown=function(e){return arguments.length?(t=e,a):t},a.copy=function(){return Bv().domain(e).range(n).unknown(t)},Qy.apply(a,arguments)}const jv=1e3,Uv=6e4,Vv=36e5,Wv=864e5,Gv=6048e5,Hv=2592e6,qv=31536e6,Kv=new Date,Xv=new Date;function Yv(t,e,n,r){function a(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return a.floor=e=>(t(e=new Date(+e)),e),a.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n),a.round=t=>{const e=a(t),n=a.ceil(t);return t-e<n-t?e:n},a.offset=(t,n)=>(e(t=new Date(+t),null==n?1:Math.floor(n)),t),a.range=(n,r,i)=>{const o=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return o;let s;do{o.push(s=new Date(+n)),e(n,i),t(n)}while(s<n&&n<r);return o},a.filter=n=>Yv(e=>{if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},(t,r)=>{if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}),n&&(a.count=(e,r)=>(Kv.setTime(+e),Xv.setTime(+r),t(Kv),t(Xv),Math.floor(n(Kv,Xv))),a.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?a.filter(r?e=>r(e)%t===0:e=>a.count(0,e)%t===0):a:null)),a}const Qv=Yv(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Qv.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?Yv(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):Qv:null);const Jv=Qv.range,$v=Yv(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*jv)},(t,e)=>(e-t)/jv,t=>t.getUTCSeconds()),Zv=$v.range,tb=Yv(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*jv)},(t,e)=>{t.setTime(+t+e*Uv)},(t,e)=>(e-t)/Uv,t=>t.getMinutes()),eb=tb.range,nb=Yv(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Uv)},(t,e)=>(e-t)/Uv,t=>t.getUTCMinutes()),rb=nb.range,ab=Yv(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*jv-t.getMinutes()*Uv)},(t,e)=>{t.setTime(+t+e*Vv)},(t,e)=>(e-t)/Vv,t=>t.getHours()),ib=ab.range,ob=Yv(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Vv)},(t,e)=>(e-t)/Vv,t=>t.getUTCHours()),sb=ob.range,cb=Yv(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Uv)/Wv,t=>t.getDate()-1),lb=cb.range,ub=Yv(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Wv,t=>t.getUTCDate()-1),hb=ub.range,db=Yv(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Wv,t=>Math.floor(t/Wv)),fb=db.range;function pb(t){return Yv(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(t,e)=>{t.setDate(t.getDate()+7*e)},(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Uv)/Gv)}const mb=pb(0),gb=pb(1),yb=pb(2),vb=pb(3),bb=pb(4),wb=pb(5),xb=pb(6),kb=mb.range,_b=gb.range,Sb=yb.range,Tb=vb.range,Ib=bb.range,Eb=wb.range,Nb=xb.range;function Cb(t){return Yv(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)},(t,e)=>(e-t)/Gv)}const Ab=Cb(0),Rb=Cb(1),Ob=Cb(2),Db=Cb(3),Mb=Cb(4),Fb=Cb(5),Pb=Cb(6),Lb=Ab.range,zb=Rb.range,Bb=Ob.range,jb=Db.range,Ub=Mb.range,Vb=Fb.range,Wb=Pb.range,Gb=Yv(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear()),t=>t.getMonth()),Hb=Gb.range,qb=Yv(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear()),t=>t.getUTCMonth()),Kb=qb.range,Xb=Yv(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Xb.every=t=>isFinite(t=Math.floor(t))&&t>0?Yv(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)}):null;const Yb=Xb.range,Qb=Yv(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());Qb.every=t=>isFinite(t=Math.floor(t))&&t>0?Yv(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null;const Jb=Qb.range;function $b(t,e,n,r,a,o){const s=[[$v,1,jv],[$v,5,5e3],[$v,15,15e3],[$v,30,3e4],[o,1,Uv],[o,5,3e5],[o,15,9e5],[o,30,18e5],[a,1,Vv],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,Wv],[r,2,1728e5],[n,1,Gv],[e,1,Hv],[e,3,7776e6],[t,1,qv]];function c(e,n,r){const a=Math.abs(n-e)/r,o=i(t=>{let[,,e]=t;return e}).right(s,a);if(o===s.length)return t.every(ut(e/qv,n/qv,r));if(0===o)return Qv.every(Math.max(ut(e,n,r),1));const[c,l]=s[a/s[o-1][2]<s[o][2]/a?o-1:o];return c.every(l)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const a=n&&"function"===typeof n.range?n:c(t,e,n),i=a?a.range(t,+e+1):[];return r?i.reverse():i},c]}const[Zb,tw]=$b(Qb,qb,Ab,db,ob,nb),[ew,nw]=$b(Xb,Gb,mb,cb,ab,tb);function rw(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function aw(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function iw(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function ow(t){var e=t.dateTime,n=t.date,r=t.time,a=t.periods,i=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,l=vw(a),u=bw(a),h=vw(i),d=bw(i),f=vw(o),p=bw(o),m=vw(s),g=bw(s),y=vw(c),v=bw(c),b={a:function(t){return o[t.getDay()]},A:function(t){return i[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:jw,e:jw,f:Hw,g:nx,G:ax,H:Uw,I:Vw,j:Ww,L:Gw,m:qw,M:Kw,p:function(t){return a[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Ex,s:Nx,S:Xw,u:Yw,U:Qw,V:$w,w:Zw,W:tx,x:null,X:null,y:ex,Y:rx,Z:ix,"%":Ix},w={a:function(t){return o[t.getUTCDay()]},A:function(t){return i[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:ox,e:ox,f:hx,g:kx,G:Sx,H:sx,I:cx,j:lx,L:ux,m:dx,M:fx,p:function(t){return a[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Ex,s:Nx,S:px,u:mx,U:gx,V:vx,w:bx,W:wx,x:null,X:null,y:xx,Y:_x,Z:Tx,"%":Ix},x={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return S(t,e,n,r)},d:Aw,e:Aw,f:Pw,g:Iw,G:Tw,H:Ow,I:Ow,j:Rw,L:Fw,m:Cw,M:Dw,p:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.p=u.get(r[0].toLowerCase()),n+r[0].length):-1},q:Nw,Q:zw,s:Bw,S:Mw,u:xw,U:kw,V:_w,w:ww,W:Sw,x:function(t,e,r){return S(t,n,e,r)},X:function(t,e,n){return S(t,r,e,n)},y:Iw,Y:Tw,Z:Ew,"%":Lw};function k(t,e){return function(n){var r,a,i,o=[],s=-1,c=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===t.charCodeAt(s)&&(o.push(t.slice(c,s)),null!=(a=dw[r=t.charAt(++s)])?r=t.charAt(++s):a="e"===r?" ":"0",(i=e[r])&&(r=i(n,a)),o.push(r),c=s+1);return o.push(t.slice(c,s)),o.join("")}}function _(t,e){return function(n){var r,a,i=iw(1900,void 0,1);if(S(i,t,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(e&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=aw(iw(i.y,0,1))).getUTCDay(),r=a>4||0===a?Rb.ceil(r):Rb(r),r=ub.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=rw(iw(i.y,0,1))).getDay(),r=a>4||0===a?gb.ceil(r):gb(r),r=cb.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?aw(iw(i.y,0,1)).getUTCDay():rw(iw(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,aw(i)):rw(i)}}function S(t,e,n,r){for(var a,i,o=0,s=e.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(a=e.charCodeAt(o++))){if(a=e.charAt(o++),!(i=x[a in dw?e.charAt(o++):a])||(r=i(t,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=k(n,b),b.X=k(r,b),b.c=k(e,b),w.x=k(n,w),w.X=k(r,w),w.c=k(e,w),{format:function(t){var e=k(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=_(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=k(t+="",w);return e.toString=function(){return t},e},utcParse:function(t){var e=_(t+="",!0);return e.toString=function(){return t},e}}}var sw,cw,lw,uw,hw,dw={"-":"",_:" ",0:"0"},fw=/^\s*\d+/,pw=/^%/,mw=/[\\^$*+?|[\]().{}]/g;function gw(t,e,n){var r=t<0?"-":"",a=(r?-t:t)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(e)+a:a)}function yw(t){return t.replace(mw,"\\$&")}function vw(t){return new RegExp("^(?:"+t.map(yw).join("|")+")","i")}function bw(t){return new Map(t.map((t,e)=>[t.toLowerCase(),e]))}function ww(t,e,n){var r=fw.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function xw(t,e,n){var r=fw.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function kw(t,e,n){var r=fw.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function _w(t,e,n){var r=fw.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Sw(t,e,n){var r=fw.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Tw(t,e,n){var r=fw.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Iw(t,e,n){var r=fw.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Ew(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Nw(t,e,n){var r=fw.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Cw(t,e,n){var r=fw.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Aw(t,e,n){var r=fw.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Rw(t,e,n){var r=fw.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Ow(t,e,n){var r=fw.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Dw(t,e,n){var r=fw.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Mw(t,e,n){var r=fw.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Fw(t,e,n){var r=fw.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Pw(t,e,n){var r=fw.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Lw(t,e,n){var r=pw.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function zw(t,e,n){var r=fw.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Bw(t,e,n){var r=fw.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function jw(t,e){return gw(t.getDate(),e,2)}function Uw(t,e){return gw(t.getHours(),e,2)}function Vw(t,e){return gw(t.getHours()%12||12,e,2)}function Ww(t,e){return gw(1+cb.count(Xb(t),t),e,3)}function Gw(t,e){return gw(t.getMilliseconds(),e,3)}function Hw(t,e){return Gw(t,e)+"000"}function qw(t,e){return gw(t.getMonth()+1,e,2)}function Kw(t,e){return gw(t.getMinutes(),e,2)}function Xw(t,e){return gw(t.getSeconds(),e,2)}function Yw(t){var e=t.getDay();return 0===e?7:e}function Qw(t,e){return gw(mb.count(Xb(t)-1,t),e,2)}function Jw(t){var e=t.getDay();return e>=4||0===e?bb(t):bb.ceil(t)}function $w(t,e){return t=Jw(t),gw(bb.count(Xb(t),t)+(4===Xb(t).getDay()),e,2)}function Zw(t){return t.getDay()}function tx(t,e){return gw(gb.count(Xb(t)-1,t),e,2)}function ex(t,e){return gw(t.getFullYear()%100,e,2)}function nx(t,e){return gw((t=Jw(t)).getFullYear()%100,e,2)}function rx(t,e){return gw(t.getFullYear()%1e4,e,4)}function ax(t,e){var n=t.getDay();return gw((t=n>=4||0===n?bb(t):bb.ceil(t)).getFullYear()%1e4,e,4)}function ix(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+gw(e/60|0,"0",2)+gw(e%60,"0",2)}function ox(t,e){return gw(t.getUTCDate(),e,2)}function sx(t,e){return gw(t.getUTCHours(),e,2)}function cx(t,e){return gw(t.getUTCHours()%12||12,e,2)}function lx(t,e){return gw(1+ub.count(Qb(t),t),e,3)}function ux(t,e){return gw(t.getUTCMilliseconds(),e,3)}function hx(t,e){return ux(t,e)+"000"}function dx(t,e){return gw(t.getUTCMonth()+1,e,2)}function fx(t,e){return gw(t.getUTCMinutes(),e,2)}function px(t,e){return gw(t.getUTCSeconds(),e,2)}function mx(t){var e=t.getUTCDay();return 0===e?7:e}function gx(t,e){return gw(Ab.count(Qb(t)-1,t),e,2)}function yx(t){var e=t.getUTCDay();return e>=4||0===e?Mb(t):Mb.ceil(t)}function vx(t,e){return t=yx(t),gw(Mb.count(Qb(t),t)+(4===Qb(t).getUTCDay()),e,2)}function bx(t){return t.getUTCDay()}function wx(t,e){return gw(Rb.count(Qb(t)-1,t),e,2)}function xx(t,e){return gw(t.getUTCFullYear()%100,e,2)}function kx(t,e){return gw((t=yx(t)).getUTCFullYear()%100,e,2)}function _x(t,e){return gw(t.getUTCFullYear()%1e4,e,4)}function Sx(t,e){var n=t.getUTCDay();return gw((t=n>=4||0===n?Mb(t):Mb.ceil(t)).getUTCFullYear()%1e4,e,4)}function Tx(){return"+0000"}function Ix(){return"%"}function Ex(t){return+t}function Nx(t){return Math.floor(+t/1e3)}function Cx(t){return sw=ow(t),cw=sw.format,lw=sw.parse,uw=sw.utcFormat,hw=sw.utcParse,sw}function Ax(t){return new Date(t)}function Rx(t){return t instanceof Date?+t:+new Date(+t)}function Ox(t,e,n,r,a,i,o,s,c,l){var u=hv(),h=u.invert,d=u.domain,f=l(".%L"),p=l(":%S"),m=l("%I:%M"),g=l("%I %p"),y=l("%a %d"),v=l("%b %d"),b=l("%B"),w=l("%Y");function x(t){return(c(t)<t?f:s(t)<t?p:o(t)<t?m:i(t)<t?g:r(t)<t?a(t)<t?y:v:n(t)<t?b:w)(t)}return u.invert=function(t){return new Date(h(t))},u.domain=function(t){return arguments.length?d(Array.from(t,Rx)):d().map(Ax)},u.ticks=function(e){var n=d();return t(n[0],n[n.length-1],null==e?10:e)},u.tickFormat=function(t,e){return null==e?x:l(e)},u.nice=function(t){var n=d();return t&&"function"===typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?d(gv(n,t)):u},u.copy=function(){return lv(u,Ox(t,e,n,r,a,i,o,s,c,l))},u}function Dx(){return Qy.apply(Ox(ew,nw,Xb,Gb,mb,cb,ab,tb,$v,cw).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Mx(){return Qy.apply(Ox(Zb,tw,Qb,qb,Ab,ub,ob,nb,$v,uw).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Fx(){var t,e,n,r,a,i=0,o=1,s=iv,c=!1;function l(e){return null==e||isNaN(e=+e)?a:s(0===n?.5:(e=(r(e)-t)*n,c?Math.max(0,Math.min(1,e)):e))}function u(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),l):[s(0),s(1)]}}return l.domain=function(a){return arguments.length?([i,o]=a,t=r(i=+i),e=r(o=+o),n=t===e?0:1/(e-t),l):[i,o]},l.clamp=function(t){return arguments.length?(c=!!t,l):c},l.interpolator=function(t){return arguments.length?(s=t,l):s},l.range=u($r),l.rangeRound=u(iy),l.unknown=function(t){return arguments.length?(a=t,l):a},function(a){return r=a,t=a(i),e=a(o),n=t===e?0:1/(e-t),l}}function Px(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Lx(){var t=fv(Fx()(iv));return t.copy=function(){return Px(t,Lx())},Jy.apply(t,arguments)}function zx(){var t=_v(Fx()).domain([1,10]);return t.copy=function(){return Px(t,zx()).base(t.base())},Jy.apply(t,arguments)}function Bx(){var t=Ev(Fx());return t.copy=function(){return Px(t,Bx()).constant(t.constant())},Jy.apply(t,arguments)}function jx(){var t=Ov(Fx());return t.copy=function(){return Px(t,jx()).exponent(t.exponent())},Jy.apply(t,arguments)}function Ux(){return jx.apply(null,arguments).exponent(.5)}function Vx(){var t=[],e=iv;function n(n){if(null!=n&&!isNaN(n=+n))return e((d(t,n,1)-1)/(t.length-1))}return n.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(r),n},n.interpolator=function(t){return arguments.length?(e=t,n):e},n.range=function(){return t.map((n,r)=>e(r/(t.length-1)))},n.quantiles=function(e){return Array.from({length:e+1},(n,r)=>xt(t,r/e))},n.copy=function(){return Vx(e).domain(t)},Jy.apply(n,arguments)}function Wx(){var t,e,n,r,a,i,o,s=0,c=.5,l=1,u=1,h=iv,d=!1;function f(t){return isNaN(t=+t)?o:(t=.5+((t=+i(t))-e)*(u*t<u*e?r:a),h(d?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,a;return arguments.length?([n,r,a]=e,h=vy(t,[n,r,a]),f):[h(0),h(.5),h(1)]}}return f.domain=function(o){return arguments.length?([s,c,l]=o,t=i(s=+s),e=i(c=+c),n=i(l=+l),r=t===e?0:.5/(e-t),a=e===n?0:.5/(n-e),u=e<t?-1:1,f):[s,c,l]},f.clamp=function(t){return arguments.length?(d=!!t,f):d},f.interpolator=function(t){return arguments.length?(h=t,f):h},f.range=p($r),f.rangeRound=p(iy),f.unknown=function(t){return arguments.length?(o=t,f):o},function(o){return i=o,t=o(s),e=o(c),n=o(l),r=t===e?0:.5/(e-t),a=e===n?0:.5/(n-e),u=e<t?-1:1,f}}function Gx(){var t=fv(Wx()(iv));return t.copy=function(){return Px(t,Gx())},Jy.apply(t,arguments)}function Hx(){var t=_v(Wx()).domain([.1,1,10]);return t.copy=function(){return Px(t,Hx()).base(t.base())},Jy.apply(t,arguments)}function qx(){var t=Ev(Wx());return t.copy=function(){return Px(t,qx()).constant(t.constant())},Jy.apply(t,arguments)}function Kx(){var t=Ov(Wx());return t.copy=function(){return Px(t,Kx()).exponent(t.exponent())},Jy.apply(t,arguments)}function Xx(){return Kx.apply(null,arguments).exponent(.5)}function Yx(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}Cx({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});const Qx=Yx("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Jx=Yx("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),$x=Yx("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Zx=Yx("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),tk=Yx("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),ek=Yx("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),nk=Yx("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),rk=Yx("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),ak=Yx("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),ik=Yx("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),ok=Yx("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),sk=t=>jr(t[t.length-1]);var ck=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Yx);const lk=sk(ck);var uk=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Yx);const hk=sk(uk);var dk=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Yx);const fk=sk(dk);var pk=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Yx);const mk=sk(pk);var gk=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Yx);const yk=sk(gk);var vk=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Yx);const bk=sk(vk);var wk=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Yx);const xk=sk(wk);var kk=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Yx);const _k=sk(kk);var Sk=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Yx);const Tk=sk(Sk);var Ik=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Yx);const Ek=sk(Ik);var Nk=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Yx);const Ck=sk(Nk);var Ak=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Yx);const Rk=sk(Ak);var Ok=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Yx);const Dk=sk(Ok);var Mk=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Yx);const Fk=sk(Mk);var Pk=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Yx);const Lk=sk(Pk);var zk=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Yx);const Bk=sk(zk);var jk=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Yx);const Uk=sk(jk);var Vk=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Yx);const Wk=sk(Vk);var Gk=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Yx);const Hk=sk(Gk);var qk=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Yx);const Kk=sk(qk);var Xk=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Yx);const Yk=sk(Xk);var Qk=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Yx);const Jk=sk(Qk);var $k=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Yx);const Zk=sk($k);var t_=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Yx);const e_=sk(t_);var n_=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Yx);const r_=sk(n_);var a_=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Yx);const i_=sk(a_);var o_=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Yx);const s_=sk(o_);function c_(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"}const l_=yy(ms(300,.5,0),ms(-240,.5,1));var u_=yy(ms(-100,.75,.35),ms(80,1.5,.8)),h_=yy(ms(260,.75,.35),ms(80,1.5,.8)),d_=ms();function f_(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return d_.h=360*t-100,d_.s=1.5-1.5*e,d_.l=.8-.9*e,d_+""}var p_=gr(),m_=Math.PI/3,g_=2*Math.PI/3;function y_(t){var e;return t=(.5-t)*Math.PI,p_.r=255*(e=Math.sin(t))*e,p_.g=255*(e=Math.sin(t+m_))*e,p_.b=255*(e=Math.sin(t+g_))*e,p_+""}function v_(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"}function b_(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const w_=b_(Yx("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var x_=b_(Yx("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),k_=b_(Yx("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),__=b_(Yx("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function S_(t){return Un(En(t).call(document.documentElement))}var T_=0;function I_(){return new E_}function E_(){this._="@"+(++T_).toString(36)}function N_(t,e){return t.target&&(t=Zr(t),void 0===e&&(e=t.currentTarget),t=t.touches||[t]),Array.from(t,t=>ta(t,e))}function C_(t){return"string"===typeof t?new zn([document.querySelectorAll(t)],[document.documentElement]):new zn([Ce(t)],Ln)}function A_(t){return function(){return t}}E_.prototype=I_.prototype={constructor:E_,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};const R_=Math.abs,O_=Math.atan2,D_=Math.cos,M_=Math.max,F_=Math.min,P_=Math.sin,L_=Math.sqrt,z_=1e-12,B_=Math.PI,j_=B_/2,U_=2*B_;function V_(t){return t>=1?j_:t<=-1?-j_:Math.asin(t)}function W_(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError("invalid digits: ".concat(n));e=t}return t},()=>new So(e)}function G_(t){return t.innerRadius}function H_(t){return t.outerRadius}function q_(t){return t.startAngle}function K_(t){return t.endAngle}function X_(t){return t&&t.padAngle}function Y_(t,e,n,r,a,i,o){var s=t-n,c=e-r,l=(o?i:-i)/L_(s*s+c*c),u=l*c,h=-l*s,d=t+u,f=e+h,p=n+u,m=r+h,g=(d+p)/2,y=(f+m)/2,v=p-d,b=m-f,w=v*v+b*b,x=a-i,k=d*m-p*f,_=(b<0?-1:1)*L_(M_(0,x*x*w-k*k)),S=(k*b-v*_)/w,T=(-k*v-b*_)/w,I=(k*b+v*_)/w,E=(-k*v+b*_)/w,N=S-g,C=T-y,A=I-g,R=E-y;return N*N+C*C>A*A+R*R&&(S=I,T=E),{cx:S,cy:T,x01:-u,y01:-h,x11:S*(a/x-1),y11:T*(a/x-1)}}function Q_(){var t=G_,e=H_,n=A_(0),r=null,a=q_,i=K_,o=X_,s=null,c=W_(l);function l(){var l,u,h=+t.apply(this,arguments),d=+e.apply(this,arguments),f=a.apply(this,arguments)-j_,p=i.apply(this,arguments)-j_,m=R_(p-f),g=p>f;if(s||(s=l=c()),d<h&&(u=d,d=h,h=u),d>z_)if(m>U_-z_)s.moveTo(d*D_(f),d*P_(f)),s.arc(0,0,d,f,p,!g),h>z_&&(s.moveTo(h*D_(p),h*P_(p)),s.arc(0,0,h,p,f,g));else{var y,v,b=f,w=p,x=f,k=p,_=m,S=m,T=o.apply(this,arguments)/2,I=T>z_&&(r?+r.apply(this,arguments):L_(h*h+d*d)),E=F_(R_(d-h)/2,+n.apply(this,arguments)),N=E,C=E;if(I>z_){var A=V_(I/h*P_(T)),R=V_(I/d*P_(T));(_-=2*A)>z_?(x+=A*=g?1:-1,k-=A):(_=0,x=k=(f+p)/2),(S-=2*R)>z_?(b+=R*=g?1:-1,w-=R):(S=0,b=w=(f+p)/2)}var O=d*D_(b),D=d*P_(b),M=h*D_(k),F=h*P_(k);if(E>z_){var P,L=d*D_(w),z=d*P_(w),B=h*D_(x),j=h*P_(x);if(m<B_)if(P=function(t,e,n,r,a,i,o,s){var c=n-t,l=r-e,u=o-a,h=s-i,d=h*c-u*l;if(!(d*d<z_))return[t+(d=(u*(e-i)-h*(t-a))/d)*c,e+d*l]}(O,D,B,j,L,z,M,F)){var U=O-P[0],V=D-P[1],W=L-P[0],G=z-P[1],H=1/P_(function(t){return t>1?0:t<-1?B_:Math.acos(t)}((U*W+V*G)/(L_(U*U+V*V)*L_(W*W+G*G)))/2),q=L_(P[0]*P[0]+P[1]*P[1]);N=F_(E,(h-q)/(H-1)),C=F_(E,(d-q)/(H+1))}else N=C=0}S>z_?C>z_?(y=Y_(B,j,O,D,d,C,g),v=Y_(L,z,M,F,d,C,g),s.moveTo(y.cx+y.x01,y.cy+y.y01),C<E?s.arc(y.cx,y.cy,C,O_(y.y01,y.x01),O_(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,C,O_(y.y01,y.x01),O_(y.y11,y.x11),!g),s.arc(0,0,d,O_(y.cy+y.y11,y.cx+y.x11),O_(v.cy+v.y11,v.cx+v.x11),!g),s.arc(v.cx,v.cy,C,O_(v.y11,v.x11),O_(v.y01,v.x01),!g))):(s.moveTo(O,D),s.arc(0,0,d,b,w,!g)):s.moveTo(O,D),h>z_&&_>z_?N>z_?(y=Y_(M,F,L,z,h,-N,g),v=Y_(O,D,B,j,h,-N,g),s.lineTo(y.cx+y.x01,y.cy+y.y01),N<E?s.arc(y.cx,y.cy,N,O_(y.y01,y.x01),O_(v.y01,v.x01),!g):(s.arc(y.cx,y.cy,N,O_(y.y01,y.x01),O_(y.y11,y.x11),!g),s.arc(0,0,h,O_(y.cy+y.y11,y.cx+y.x11),O_(v.cy+v.y11,v.cx+v.x11),g),s.arc(v.cx,v.cy,N,O_(v.y11,v.x11),O_(v.y01,v.x01),!g))):s.arc(0,0,h,k,x,g):s.lineTo(M,F)}else s.moveTo(0,0);if(s.closePath(),l)return s=null,l+""||null}return l.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-B_/2;return[D_(r)*n,P_(r)*n]},l.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:A_(+e),l):t},l.outerRadius=function(t){return arguments.length?(e="function"===typeof t?t:A_(+t),l):e},l.cornerRadius=function(t){return arguments.length?(n="function"===typeof t?t:A_(+t),l):n},l.padRadius=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:A_(+t),l):r},l.startAngle=function(t){return arguments.length?(a="function"===typeof t?t:A_(+t),l):a},l.endAngle=function(t){return arguments.length?(i="function"===typeof t?t:A_(+t),l):i},l.padAngle=function(t){return arguments.length?(o="function"===typeof t?t:A_(+t),l):o},l.context=function(t){return arguments.length?(s=null==t?null:t,l):s},l}var J_=Array.prototype.slice;function $_(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function Z_(t){this._context=t}function tS(t){return new Z_(t)}function eS(t){return t[0]}function nS(t){return t[1]}function rS(t,e){var n=A_(!0),r=null,a=tS,i=null,o=W_(s);function s(s){var c,l,u,h=(s=$_(s)).length,d=!1;for(null==r&&(i=a(u=o())),c=0;c<=h;++c)!(c<h&&n(l=s[c],c,s))===d&&((d=!d)?i.lineStart():i.lineEnd()),d&&i.point(+t(l,c,s),+e(l,c,s));if(u)return i=null,u+""||null}return t="function"===typeof t?t:void 0===t?eS:A_(t),e="function"===typeof e?e:void 0===e?nS:A_(e),s.x=function(e){return arguments.length?(t="function"===typeof e?e:A_(+e),s):t},s.y=function(t){return arguments.length?(e="function"===typeof t?t:A_(+t),s):e},s.defined=function(t){return arguments.length?(n="function"===typeof t?t:A_(!!t),s):n},s.curve=function(t){return arguments.length?(a=t,null!=r&&(i=a(r)),s):a},s.context=function(t){return arguments.length?(null==t?r=i=null:i=a(r=t),s):r},s}function aS(t,e,n){var r=null,a=A_(!0),i=null,o=tS,s=null,c=W_(l);function l(l){var u,h,d,f,p,m=(l=$_(l)).length,g=!1,y=new Array(m),v=new Array(m);for(null==i&&(s=o(p=c())),u=0;u<=m;++u){if(!(u<m&&a(f=l[u],u,l))===g)if(g=!g)h=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),d=u-1;d>=h;--d)s.point(y[d],v[d]);s.lineEnd(),s.areaEnd()}g&&(y[u]=+t(f,u,l),v[u]=+e(f,u,l),s.point(r?+r(f,u,l):y[u],n?+n(f,u,l):v[u]))}if(p)return s=null,p+""||null}function u(){return rS().defined(a).curve(o).context(i)}return t="function"===typeof t?t:void 0===t?eS:A_(+t),e="function"===typeof e?e:A_(void 0===e?0:+e),n="function"===typeof n?n:void 0===n?nS:A_(+n),l.x=function(e){return arguments.length?(t="function"===typeof e?e:A_(+e),r=null,l):t},l.x0=function(e){return arguments.length?(t="function"===typeof e?e:A_(+e),l):t},l.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:A_(+t),l):r},l.y=function(t){return arguments.length?(e="function"===typeof t?t:A_(+t),n=null,l):e},l.y0=function(t){return arguments.length?(e="function"===typeof t?t:A_(+t),l):e},l.y1=function(t){return arguments.length?(n=null==t?null:"function"===typeof t?t:A_(+t),l):n},l.lineX0=l.lineY0=function(){return u().x(t).y(e)},l.lineY1=function(){return u().x(t).y(n)},l.lineX1=function(){return u().x(r).y(e)},l.defined=function(t){return arguments.length?(a="function"===typeof t?t:A_(!!t),l):a},l.curve=function(t){return arguments.length?(o=t,null!=i&&(s=o(i)),l):o},l.context=function(t){return arguments.length?(null==t?i=s=null:s=o(i=t),l):i},l}function iS(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function oS(t){return t}function sS(){var t=oS,e=iS,n=null,r=A_(0),a=A_(U_),i=A_(0);function o(o){var s,c,l,u,h,d=(o=$_(o)).length,f=0,p=new Array(d),m=new Array(d),g=+r.apply(this,arguments),y=Math.min(U_,Math.max(-U_,a.apply(this,arguments)-g)),v=Math.min(Math.abs(y)/d,i.apply(this,arguments)),b=v*(y<0?-1:1);for(s=0;s<d;++s)(h=m[p[s]=s]=+t(o[s],s,o))>0&&(f+=h);for(null!=e?p.sort(function(t,n){return e(m[t],m[n])}):null!=n&&p.sort(function(t,e){return n(o[t],o[e])}),s=0,l=f?(y-d*b)/f:0;s<d;++s,g=u)c=p[s],u=g+((h=m[c])>0?h*l:0)+b,m[c]={data:o[c],index:s,value:h,startAngle:g,endAngle:u,padAngle:v};return m}return o.value=function(e){return arguments.length?(t="function"===typeof e?e:A_(+e),o):t},o.sortValues=function(t){return arguments.length?(e=t,n=null,o):e},o.sort=function(t){return arguments.length?(n=t,e=null,o):n},o.startAngle=function(t){return arguments.length?(r="function"===typeof t?t:A_(+t),o):r},o.endAngle=function(t){return arguments.length?(a="function"===typeof t?t:A_(+t),o):a},o.padAngle=function(t){return arguments.length?(i="function"===typeof t?t:A_(+t),o):i},o}Z_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var cS=uS(tS);function lS(t){this._curve=t}function uS(t){function e(e){return new lS(t(e))}return e._curve=t,e}function hS(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(uS(t)):e()._curve},t}function dS(){return hS(rS().curve(cS))}function fS(){var t=aS().curve(cS),e=t.curve,n=t.lineX0,r=t.lineX1,a=t.lineY0,i=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return hS(n())},delete t.lineX0,t.lineEndAngle=function(){return hS(r())},delete t.lineX1,t.lineInnerRadius=function(){return hS(a())},delete t.lineY0,t.lineOuterRadius=function(){return hS(i())},delete t.lineY1,t.curve=function(t){return arguments.length?e(uS(t)):e()._curve},t}function pS(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}lS.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};class mS{constructor(t,e){this._context=t,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,e,t,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,t,this._y0,t,e)}this._x0=t,this._y0=e}}class gS{constructor(t){this._context=t}lineStart(){this._point=0}lineEnd(){}point(t,e){if(t=+t,e=+e,0===this._point)this._point=1;else{const n=pS(this._x0,this._y0),r=pS(this._x0,this._y0=(this._y0+e)/2),a=pS(t,this._y0),i=pS(t,e);this._context.moveTo(...n),this._context.bezierCurveTo(...r,...a,...i)}this._x0=t,this._y0=e}}function yS(t){return new mS(t,!0)}function vS(t){return new mS(t,!1)}function bS(t){return new gS(t)}function wS(t){return t.source}function xS(t){return t.target}function kS(t){let e=wS,n=xS,r=eS,a=nS,i=null,o=null,s=W_(c);function c(){let c;const l=J_.call(arguments),u=e.apply(this,l),h=n.apply(this,l);if(null==i&&(o=t(c=s())),o.lineStart(),l[0]=u,o.point(+r.apply(this,l),+a.apply(this,l)),l[0]=h,o.point(+r.apply(this,l),+a.apply(this,l)),o.lineEnd(),c)return o=null,c+""||null}return c.source=function(t){return arguments.length?(e=t,c):e},c.target=function(t){return arguments.length?(n=t,c):n},c.x=function(t){return arguments.length?(r="function"===typeof t?t:A_(+t),c):r},c.y=function(t){return arguments.length?(a="function"===typeof t?t:A_(+t),c):a},c.context=function(e){return arguments.length?(null==e?i=o=null:o=t(i=e),c):i},c}function _S(){return kS(yS)}function SS(){return kS(vS)}function TS(){const t=kS(bS);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}const IS=L_(3),ES={draw(t,e){const n=.59436*L_(e+F_(e/28,.75)),r=n/2,a=r*IS;t.moveTo(0,n),t.lineTo(0,-n),t.moveTo(-a,-r),t.lineTo(a,r),t.moveTo(-a,r),t.lineTo(a,-r)}},NS={draw(t,e){const n=L_(e/B_);t.moveTo(n,0),t.arc(0,0,n,0,U_)}},CS={draw(t,e){const n=L_(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},AS=L_(1/3),RS=2*AS,OS={draw(t,e){const n=L_(e/RS),r=n*AS;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},DS={draw(t,e){const n=.62625*L_(e);t.moveTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.lineTo(-n,0),t.closePath()}},MS={draw(t,e){const n=.87559*L_(e-F_(e/7,2));t.moveTo(-n,0),t.lineTo(n,0),t.moveTo(0,n),t.lineTo(0,-n)}},FS={draw(t,e){const n=L_(e),r=-n/2;t.rect(r,r,n,n)}},PS={draw(t,e){const n=.4431*L_(e);t.moveTo(n,n),t.lineTo(n,-n),t.lineTo(-n,-n),t.lineTo(-n,n),t.closePath()}},LS=P_(B_/10)/P_(7*B_/10),zS=P_(U_/10)*LS,BS=-D_(U_/10)*LS,jS={draw(t,e){const n=L_(.8908130915292852*e),r=zS*n,a=BS*n;t.moveTo(0,-n),t.lineTo(r,a);for(let i=1;i<5;++i){const e=U_*i/5,o=D_(e),s=P_(e);t.lineTo(s*n,-o*n),t.lineTo(o*r-s*a,s*r+o*a)}t.closePath()}},US=L_(3),VS={draw(t,e){const n=-L_(e/(3*US));t.moveTo(0,2*n),t.lineTo(-US*n,-n),t.lineTo(US*n,-n),t.closePath()}},WS=L_(3),GS={draw(t,e){const n=.6824*L_(e),r=n/2,a=n*WS/2;t.moveTo(0,-n),t.lineTo(a,r),t.lineTo(-a,r),t.closePath()}},HS=-.5,qS=L_(3)/2,KS=1/L_(12),XS=3*(KS/2+1),YS={draw(t,e){const n=L_(e/XS),r=n/2,a=n*KS,i=r,o=n*KS+n,s=-i,c=o;t.moveTo(r,a),t.lineTo(i,o),t.lineTo(s,c),t.lineTo(HS*r-qS*a,qS*r+HS*a),t.lineTo(HS*i-qS*o,qS*i+HS*o),t.lineTo(HS*s-qS*c,qS*s+HS*c),t.lineTo(HS*r+qS*a,HS*a-qS*r),t.lineTo(HS*i+qS*o,HS*o-qS*i),t.lineTo(HS*s+qS*c,HS*c-qS*s),t.closePath()}},QS={draw(t,e){const n=.6189*L_(e-F_(e/6,1.7));t.moveTo(-n,-n),t.lineTo(n,n),t.moveTo(-n,n),t.lineTo(n,-n)}},JS=[NS,CS,OS,FS,jS,VS,YS],$S=[NS,MS,QS,GS,ES,PS,DS];function ZS(t,e){let n=null,r=W_(a);function a(){let a;if(n||(n=a=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),a)return n=null,a+""||null}return t="function"===typeof t?t:A_(t||NS),e="function"===typeof e?e:A_(void 0===e?64:+e),a.type=function(e){return arguments.length?(t="function"===typeof e?e:A_(e),a):t},a.size=function(t){return arguments.length?(e="function"===typeof t?t:A_(+t),a):e},a.context=function(t){return arguments.length?(n=null==t?null:t,a):n},a}function tT(){}function eT(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function nT(t){this._context=t}function rT(t){return new nT(t)}function aT(t){this._context=t}function iT(t){return new aT(t)}function oT(t){this._context=t}function sT(t){return new oT(t)}function cT(t,e){this._basis=new nT(t),this._beta=e}nT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:eT(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:eT(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},aT.prototype={areaStart:tT,areaEnd:tT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:eT(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},oT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:eT(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},cT.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,a=t[0],i=e[0],o=t[n]-a,s=e[n]-i,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(a+r*o),this._beta*e[c]+(1-this._beta)*(i+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const lT=function t(e){function n(t){return 1===e?new nT(t):new cT(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function uT(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function hT(t,e){this._context=t,this._k=(1-e)/6}hT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:uT(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:uT(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const dT=function t(e){function n(t){return new hT(t,e)}return n.tension=function(e){return t(+e)},n}(0);function fT(t,e){this._context=t,this._k=(1-e)/6}fT.prototype={areaStart:tT,areaEnd:tT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:uT(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const pT=function t(e){function n(t){return new fT(t,e)}return n.tension=function(e){return t(+e)},n}(0);function mT(t,e){this._context=t,this._k=(1-e)/6}mT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:uT(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const gT=function t(e){function n(t){return new mT(t,e)}return n.tension=function(e){return t(+e)},n}(0);function yT(t,e,n){var r=t._x1,a=t._y1,i=t._x2,o=t._y2;if(t._l01_a>z_){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,a=(a*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>z_){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,u=3*t._l23_a*(t._l23_a+t._l12_a);i=(i*l+t._x1*t._l23_2a-e*t._l12_2a)/u,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/u}t._context.bezierCurveTo(r,a,i,o,t._x2,t._y2)}function vT(t,e){this._context=t,this._alpha=e}vT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:yT(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const bT=function t(e){function n(t){return e?new vT(t,e):new hT(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function wT(t,e){this._context=t,this._alpha=e}wT.prototype={areaStart:tT,areaEnd:tT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:yT(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const xT=function t(e){function n(t){return e?new wT(t,e):new fT(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function kT(t,e){this._context=t,this._alpha=e}kT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:yT(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const _T=function t(e){function n(t){return e?new kT(t,e):new mT(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function ST(t){this._context=t}function TT(t){return new ST(t)}function IT(t){return t<0?-1:1}function ET(t,e,n){var r=t._x1-t._x0,a=e-t._x1,i=(t._y1-t._y0)/(r||a<0&&-0),o=(n-t._y1)/(a||r<0&&-0),s=(i*a+o*r)/(r+a);return(IT(i)+IT(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(s))||0}function NT(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function CT(t,e,n){var r=t._x0,a=t._y0,i=t._x1,o=t._y1,s=(i-r)/3;t._context.bezierCurveTo(r+s,a+s*e,i-s,o-s*n,i,o)}function AT(t){this._context=t}function RT(t){this._context=new OT(t)}function OT(t){this._context=t}function DT(t){return new AT(t)}function MT(t){return new RT(t)}function FT(t){this._context=t}function PT(t){var e,n,r=t.length-1,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,i[e]=4,o[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/i[e-1],i[e]-=n,o[e]-=n*o[e-1];for(a[r-1]=o[r-1]/i[r-1],e=r-2;e>=0;--e)a[e]=(o[e]-a[e+1])/i[e];for(i[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)i[e]=2*t[e+1]-a[e+1];return[a,i]}function LT(t){return new FT(t)}function zT(t,e){this._context=t,this._t=e}function BT(t){return new zT(t,.5)}function jT(t){return new zT(t,0)}function UT(t){return new zT(t,1)}function VT(t,e){if((a=t.length)>1)for(var n,r,a,i=1,o=t[e[0]],s=o.length;i<a;++i)for(r=o,o=t[e[i]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function WT(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function GT(t,e){return t[e]}function HT(t){const e=[];return e.key=t,e}function qT(){var t=A_([]),e=WT,n=VT,r=GT;function a(a){var i,o,s=Array.from(t.apply(this,arguments),HT),c=s.length,l=-1;for(const t of a)for(i=0,++l;i<c;++i)(s[i][l]=[0,+r(t,s[i].key,l,a)]).data=t;for(i=0,o=$_(e(s));i<c;++i)s[o[i]].index=i;return n(s,o),s}return a.keys=function(e){return arguments.length?(t="function"===typeof e?e:A_(Array.from(e)),a):t},a.value=function(t){return arguments.length?(r="function"===typeof t?t:A_(+t),a):r},a.order=function(t){return arguments.length?(e=null==t?WT:"function"===typeof t?t:A_(Array.from(t)),a):e},a.offset=function(t){return arguments.length?(n=null==t?VT:t,a):n},a}function KT(t,e){if((r=t.length)>0){for(var n,r,a,i=0,o=t[0].length;i<o;++i){for(a=n=0;n<r;++n)a+=t[n][i][1]||0;if(a)for(n=0;n<r;++n)t[n][i][1]/=a}VT(t,e)}}function XT(t,e){if((s=t.length)>0)for(var n,r,a,i,o,s,c=0,l=t[e[0]].length;c<l;++c)for(i=o=0,n=0;n<s;++n)(a=(r=t[e[n]][c])[1]-r[0])>0?(r[0]=i,r[1]=i+=a):a<0?(r[1]=o,r[0]=o+=a):(r[0]=0,r[1]=a)}function YT(t,e){if((n=t.length)>0){for(var n,r=0,a=t[e[0]],i=a.length;r<i;++r){for(var o=0,s=0;o<n;++o)s+=t[o][r][1]||0;a[r][1]+=a[r][0]=-s/2}VT(t,e)}}function QT(t,e){if((a=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,a,i=0,o=1;o<r;++o){for(var s=0,c=0,l=0;s<a;++s){for(var u=t[e[s]],h=u[o][1]||0,d=(h-(u[o-1][1]||0))/2,f=0;f<s;++f){var p=t[e[f]];d+=(p[o][1]||0)-(p[o-1][1]||0)}c+=h,l+=d*h}n[o-1][1]+=n[o-1][0]=i,c&&(i-=l/c)}n[o-1][1]+=n[o-1][0]=i,VT(t,e)}}function JT(t){var e=t.map($T);return WT(t).sort(function(t,n){return e[t]-e[n]})}function $T(t){for(var e,n=-1,r=0,a=t.length,i=-1/0;++n<a;)(e=+t[n][1])>i&&(i=e,r=n);return r}function ZT(t){var e=t.map(tI);return WT(t).sort(function(t,n){return e[t]-e[n]})}function tI(t){for(var e,n=0,r=-1,a=t.length;++r<a;)(e=+t[r][1])&&(n+=e);return n}function eI(t){return ZT(t).reverse()}function nI(t){var e,n,r=t.length,a=t.map(tI),i=JT(t),o=0,s=0,c=[],l=[];for(e=0;e<r;++e)n=i[e],o<s?(o+=a[n],c.push(n)):(s+=a[n],l.push(n));return l.reverse().concat(c)}function rI(t){return WT(t).reverse()}ST.prototype={areaStart:tT,areaEnd:tT,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},AT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:CT(this,this._t0,NT(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,CT(this,NT(this,n=ET(this,t,e)),n);break;default:CT(this,this._t0,n=ET(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(RT.prototype=Object.create(AT.prototype)).point=function(t,e){AT.prototype.point.call(this,e,t)},OT.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,a,i){this._context.bezierCurveTo(e,t,r,n,i,a)}},FT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=PT(t),a=PT(e),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],a[0][i],r[1][i],a[1][i],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},zT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var aI="%Y-%m-%dT%H:%M:%S.%LZ";var iI=Date.prototype.toISOString?function(t){return t.toISOString()}:uw(aI);const oI=iI;var sI=+new Date("2000-01-01T00:00:00.000Z")?function(t){var e=new Date(t);return isNaN(e)?null:e}:hw(aI);const cI=sI;function lI(t,e,n){var r=new fa,a=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?ha():+n,r._restart(function i(o){o+=a,r._restart(i,a+=e,n),t(o)},e,n)},r.restart(t,e,n),r)}const uI=t=>()=>t;function hI(t,e){let{sourceEvent:n,target:r,transform:a,dispatch:i}=e;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:a,enumerable:!0,configurable:!0},_:{value:i}})}function dI(t,e,n){this.k=t,this.x=e,this.y=n}dI.prototype={constructor:dI,scale:function(t){return 1===t?this:new dI(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new dI(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var fI=new dI(1,0,0);function pI(t){for(;!t.__zoom;)if(!(t=t.parentNode))return fI;return t.__zoom}function mI(t){t.stopImmediatePropagation()}function gI(t){t.preventDefault(),t.stopImmediatePropagation()}function yI(t){return(!t.ctrlKey||"wheel"===t.type)&&!t.button}function vI(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function bI(){return this.__zoom||fI}function wI(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function xI(){return navigator.maxTouchPoints||"ontouchstart"in this}function kI(t,e,n){var r=t.invertX(e[0][0])-n[0][0],a=t.invertX(e[1][0])-n[1][0],i=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o))}function _I(){var t,e,n,r=yI,a=vI,i=kI,o=wI,s=xI,c=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,h=sy,d=Ie("start","zoom","end"),f=0,p=10;function m(t){t.property("__zoom",bI).on("wheel.zoom",k,{passive:!1}).on("mousedown.zoom",_).on("dblclick.zoom",S).filter(s).on("touchstart.zoom",T).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",E).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(t,e){return(e=Math.max(c[0],Math.min(c[1],e)))===t.k?t:new dI(e,t.x,t.y)}function y(t,e,n){var r=e[0]-n[0]*t.k,a=e[1]-n[1]*t.k;return r===t.x&&a===t.y?t:new dI(t.k,r,a)}function v(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function b(t,e,n,r){t.on("start.zoom",function(){w(this,arguments).event(r).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).event(r).end()}).tween("zoom",function(){var t=this,i=arguments,o=w(t,i).event(r),s=a.apply(t,i),c=null==n?v(s):"function"===typeof n?n.apply(t,i):n,l=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),u=t.__zoom,d="function"===typeof e?e.apply(t,i):e,f=h(u.invert(c).concat(l/u.k),d.invert(c).concat(l/d.k));return function(t){if(1===t)t=d;else{var e=f(t),n=l/e[2];t=new dI(n,c[0]-e[0]*n,c[1]-e[1]*n)}o.zoom(null,t)}})}function w(t,e,n){return!n&&t.__zooming||new x(t,e)}function x(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=a.apply(t,e),this.taps=0}function k(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];if(r.apply(this,arguments)){var s=w(this,n).event(t),u=this.__zoom,h=Math.max(c[0],Math.min(c[1],u.k*Math.pow(2,o.apply(this,arguments)))),d=ta(t);if(s.wheel)s.mouse[0][0]===d[0]&&s.mouse[0][1]===d[1]||(s.mouse[1]=u.invert(s.mouse[0]=d)),clearTimeout(s.wheel);else{if(u.k===h)return;s.mouse=[d,u.invert(d)],Aa(this),s.start()}gI(t),s.wheel=setTimeout(function(){s.wheel=null,s.end()},150),s.zoom("mouse",i(y(g(u,h),s.mouse[0],s.mouse[1]),s.extent,l))}}function _(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),o=1;o<e;o++)a[o-1]=arguments[o];if(!n&&r.apply(this,arguments)){var s=t.currentTarget,c=w(this,a,!0).event(t),u=Un(t.view).on("mousemove.zoom",function(t){if(gI(t),!c.moved){var e=t.clientX-d,n=t.clientY-p;c.moved=e*e+n*n>f}c.event(t).zoom("mouse",i(y(c.that.__zoom,c.mouse[0]=ta(t,s),c.mouse[1]),c.extent,l))},!0).on("mouseup.zoom",function(t){u.on("mousemove.zoom mouseup.zoom",null),Kn(t.view,c.moved),gI(t),c.event(t).end()},!0),h=ta(t,s),d=t.clientX,p=t.clientY;qn(t.view),mI(t),c.mouse=[h,this.__zoom.invert(h)],Aa(this),c.start()}}function S(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];if(r.apply(this,arguments)){var s=this.__zoom,c=ta(t.changedTouches?t.changedTouches[0]:t,this),h=s.invert(c),d=s.k*(t.shiftKey?.5:2),f=i(y(g(s,d),c,h),a.apply(this,n),l);gI(t),u>0?Un(this).transition().duration(u).call(b,f,c,t):Un(this).call(m.transform,f,c,t)}}function T(n){for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];if(r.apply(this,arguments)){var s,c,l,u,h=n.touches,d=h.length,f=w(this,i,n.changedTouches.length===d).event(n);for(mI(n),c=0;c<d;++c)u=[u=ta(l=h[c],this),this.__zoom.invert(u),l.identifier],f.touch0?f.touch1||f.touch0[2]===u[2]||(f.touch1=u,f.taps=0):(f.touch0=u,s=!0,f.taps=1+!!t);t&&(t=clearTimeout(t)),s&&(f.taps<2&&(e=u[0],t=setTimeout(function(){t=null},500)),Aa(this),f.start())}}function I(t){if(this.__zooming){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var a,o,s,c,u=w(this,n).event(t),h=t.changedTouches,d=h.length;for(gI(t),a=0;a<d;++a)s=ta(o=h[a],this),u.touch0&&u.touch0[2]===o.identifier?u.touch0[0]=s:u.touch1&&u.touch1[2]===o.identifier&&(u.touch1[0]=s);if(o=u.that.__zoom,u.touch1){var f=u.touch0[0],p=u.touch0[1],m=u.touch1[0],v=u.touch1[1],b=(b=m[0]-f[0])*b+(b=m[1]-f[1])*b,x=(x=v[0]-p[0])*x+(x=v[1]-p[1])*x;o=g(o,Math.sqrt(b/x)),s=[(f[0]+m[0])/2,(f[1]+m[1])/2],c=[(p[0]+v[0])/2,(p[1]+v[1])/2]}else{if(!u.touch0)return;s=u.touch0[0],c=u.touch0[1]}u.zoom("touch",i(y(o,s,c),u.extent,l))}}function E(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];if(this.__zooming){var o,s,c=w(this,a).event(t),l=t.changedTouches,u=l.length;for(mI(t),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),o=0;o<u;++o)s=l[o],c.touch0&&c.touch0[2]===s.identifier?delete c.touch0:c.touch1&&c.touch1[2]===s.identifier&&delete c.touch1;if(c.touch1&&!c.touch0&&(c.touch0=c.touch1,delete c.touch1),c.touch0)c.touch0[1]=this.__zoom.invert(c.touch0[0]);else if(c.end(),2===c.taps&&(s=ta(s,this),Math.hypot(e[0]-s[0],e[1]-s[1])<p)){var h=Un(this).on("dblclick.zoom");h&&h.apply(this,arguments)}}}return m.transform=function(t,e,n,r){var a=t.selection?t.selection():t;a.property("__zoom",bI),t!==a?b(t,e,n,r):a.interrupt().each(function(){w(this,arguments).event(r).start().zoom(null,"function"===typeof e?e.apply(this,arguments):e).end()})},m.scaleBy=function(t,e,n,r){m.scaleTo(t,function(){return this.__zoom.k*("function"===typeof e?e.apply(this,arguments):e)},n,r)},m.scaleTo=function(t,e,n,r){m.transform(t,function(){var t=a.apply(this,arguments),r=this.__zoom,o=null==n?v(t):"function"===typeof n?n.apply(this,arguments):n,s=r.invert(o),c="function"===typeof e?e.apply(this,arguments):e;return i(y(g(r,c),o,s),t,l)},n,r)},m.translateBy=function(t,e,n,r){m.transform(t,function(){return i(this.__zoom.translate("function"===typeof e?e.apply(this,arguments):e,"function"===typeof n?n.apply(this,arguments):n),a.apply(this,arguments),l)},null,r)},m.translateTo=function(t,e,n,r,o){m.transform(t,function(){var t=a.apply(this,arguments),o=this.__zoom,s=null==r?v(t):"function"===typeof r?r.apply(this,arguments):r;return i(fI.translate(s[0],s[1]).scale(o.k).translate("function"===typeof e?-e.apply(this,arguments):-e,"function"===typeof n?-n.apply(this,arguments):-n),t,l)},r,o)},x.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=Un(this.that).datum();d.call(t,this.that,new hI(t,{sourceEvent:this.sourceEvent,target:m,type:t,transform:this.that.__zoom,dispatch:d}),e)}},m.wheelDelta=function(t){return arguments.length?(o="function"===typeof t?t:uI(+t),m):o},m.filter=function(t){return arguments.length?(r="function"===typeof t?t:uI(!!t),m):r},m.touchable=function(t){return arguments.length?(s="function"===typeof t?t:uI(!!t),m):s},m.extent=function(t){return arguments.length?(a="function"===typeof t?t:uI([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),m):a},m.scaleExtent=function(t){return arguments.length?(c[0]=+t[0],c[1]=+t[1],m):[c[0],c[1]]},m.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],m):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},m.constrain=function(t){return arguments.length?(i=t,m):i},m.duration=function(t){return arguments.length?(u=+t,m):u},m.interpolate=function(t){return arguments.length?(h=t,m):h},m.on=function(){var t=d.on.apply(d,arguments);return t===d?m:t},m.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,m):Math.sqrt(f)},m.tapDistance=function(t){return arguments.length?(p=+t,m):p},m}pI.prototype=dI.prototype},5807:(t,e,n)=>{"use strict";n(7800)({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:n(7220)})},5817:()=>{},5838:(t,e,n)=>{"use strict";n(7800)({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:n(7250)})},5881:(t,e,n)=>{"use strict";var r=n(6551),a=n(9846),i=n(4121),o=n(6680),s=n(3148),c=n(1663),l=n(2174),u=n(3345),h=n(6806),d=n(2133),f=n(7565),p=n(9381),m=n(6582)("replace"),g=Math.max,y=Math.min,v=function(t){return void 0===t?t:String(t)},b="$0"==="a".replace(/./,"$0"),w=!!/./[m]&&""===/./[m]("a","$0");r("replace",function(t,e,n){var r=w?"$":"$0";return[function(t,n){var r=u(this),a=void 0==t?void 0:d(t,m);return a?a.call(t,r,n):e.call(l(r),t,n)},function(t,a){var u=i(this),d=l(t);if("string"===typeof a&&-1===a.indexOf(r)&&-1===a.indexOf("$<")){var m=n(e,u,d,a);if(m.done)return m.value}var b=o(a);b||(a=l(a));var w=u.global;if(w){var x=u.unicode;u.lastIndex=0}for(var k=[];;){var _=p(u,d);if(null===_)break;if(k.push(_),!w)break;""===l(_[0])&&(u.lastIndex=h(d,c(u.lastIndex),x))}for(var S="",T=0,I=0;I<k.length;I++){_=k[I];for(var E=l(_[0]),N=g(y(s(_.index),d.length),0),C=[],A=1;A<_.length;A++)C.push(v(_[A]));var R=_.groups;if(b){var O=[E].concat(C,N,d);void 0!==R&&O.push(R);var D=l(a.apply(void 0,O))}else D=f(E,d,N,C,R,a);N>=T&&(S+=d.slice(T,N)+D,T=N+E.length)}return S+d.slice(T)}]},!!a(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})||!b||w)},5900:(t,e,n)=>{"use strict";var r=n(9607);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},5901:(t,e,n)=>{var r=n(494),a=n(2324),i=n(2820),o=n(358);t.exports=function(t,e){for(var n=a(e),s=o.f,c=i.f,l=0;l<n.length;l++){var u=n[l];r(t,u)||s(t,u,c(e,u))}}},5916:(t,e,n)=>{"use strict";var r=n(7800),a=n(5749),i=n(375),o=n(2203),s=n(8366),c=n(8445),l=n(9607),u=n(307),h=n(78),d=n(4403),f=n(6521),p=String,m=a("JSON","stringify"),g=s(/./.exec),y=s("".charAt),v=s("".charCodeAt),b=s("".replace),w=s(1.1.toString),x=/[\uD800-\uDFFF]/g,k=/^[\uD800-\uDBFF]$/,_=/^[\uDC00-\uDFFF]$/,S=!f||c(function(){var t=a("Symbol")("stringify detection");return"[null]"!==m([t])||"{}"!==m({a:t})||"{}"!==m(Object(t))}),T=c(function(){return'"\\udf06\\ud834"'!==m("\udf06\ud834")||'"\\udead"'!==m("\udead")}),I=function(t,e){var n=h(arguments),r=d(e);if(l(r)||void 0!==t&&!u(t))return n[1]=function(t,e){if(l(r)&&(e=o(r,this,p(t),e)),!u(e))return e},i(m,null,n)},E=function(t,e,n){var r=y(n,e-1),a=y(n,e+1);return g(k,t)&&!g(_,a)||g(_,t)&&!g(k,r)?"\\u"+w(v(t,0),16):t};m&&r({target:"JSON",stat:!0,arity:3,forced:S||T},{stringify:function(t,e,n){var r=h(arguments),a=i(S?I:m,null,r);return T&&"string"==typeof a?b(a,x,E):a}})},5949:(t,e,n)=>{"use strict";var r=n(4402);t.exports=r},6015:(t,e,n)=>{"use strict";var r=n(4205),a=n(6891),i=r("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(a.Array===t||o[i]===t)}},6045:(t,e,n)=>{"use strict";var r=n(9203),a=n(6094),i=r("keys");t.exports=function(t){return i[t]||(i[t]=a(t))}},6071:(t,e,n)=>{var r=n(3148),a=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?a(n+e,0):i(n,e)}},6094:(t,e,n)=>{"use strict";var r=n(8366),a=0,i=Math.random(),o=r(1.1.toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+o(++a+i,36)}},6095:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},6100:(t,e,n)=>{t.exports=n(3212)},6107:t=>{"use strict";t.exports=function(){}},6140:t=>{var e=Object.prototype;t.exports=function(t){var n=t&&t.constructor;return t===("function"==typeof n&&n.prototype||e)}},6152:(t,e,n)=>{"use strict";var r=n(2203),a=n(9607),i=n(5900),o=TypeError;t.exports=function(t,e){var n,s;if("string"===e&&a(n=t.toString)&&!i(s=r(n,t)))return s;if(a(n=t.valueOf)&&!i(s=r(n,t)))return s;if("string"!==e&&a(n=t.toString)&&!i(s=r(n,t)))return s;throw new o("Can't convert object to primitive value")}},6162:(t,e,n)=>{"use strict";var r=n(7800),a=n(3239).filter;r({target:"Array",proto:!0,forced:!n(1903)("filter")},{filter:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},6173:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},6178:(t,e,n)=>{"use strict";n(3005)("isConcatSpreadable")},6179:t=>{t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},6188:(t,e,n)=>{"use strict";var r=n(1363),a=n(1760),i=Array.prototype;t.exports=function(t){var e=t.filter;return t===i||r(i,t)&&e===i.filter?a:e}},6209:(t,e,n)=>{"use strict";var r=n(9486);n(5403),t.exports=r},6222:(t,e,n)=>{"use strict";n(3005)("patternMatch")},6226:(t,e,n)=>{t.exports=n(1898)},6249:(t,e,n)=>{"use strict";var r=n(4205);e.f=r},6255:(t,e,n)=>{t.exports=n(5207)},6258:(t,e,n)=>{"use strict";n(468);var r=n(8118);t.exports=r("Array","splice")},6280:(t,e,n)=>{"use strict";var r=n(7800),a=n(5231),i=n(5612),o=n(1773),s=n(8967);r({target:"Array",proto:!0,arity:1,forced:n(8445)(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=a(this),n=i(e),r=arguments.length;s(n+r);for(var c=0;c<r;c++)e[n]=arguments[c],n++;return o(e,n),n}})},6288:function(t,e,n){var r;!function(t,a){function i(t){var e=this;e.next=function(){var t,n,r=e.w,a=e.X,i=e.i;return e.w=r=r+1640531527|0,n=a[i+34&127],t=a[i=i+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=a[i]=n^t,e.i=i,n+(r^r>>>16)|0},function(t,e){var n,r,a,i,o,s=[],c=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,c=Math.max(c,e.length)),a=0,i=-32;i<c;++i)e&&(r^=e.charCodeAt((i+32)%e.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(e&&e.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;t.w=o,t.X=s,t.i=a}(e,t)}function o(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function s(t,e){null==t&&(t=+new Date);var n=new i(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&(r.X&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(e,n,e,a))||(a.exports=r):this.xor4096=s}(0,t=n.nmd(t),n.amdD)},6319:(t,e,n)=>{t.exports=n(4823)},6337:(t,e,n)=>{"use strict";var r=n(4606),a=n(8061);t.exports=r?{}.toString:function(){return"[object "+a(this)+"]"}},6381:t=>{"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(n){return"Object"}}},6383:(t,e,n)=>{"use strict";var r=n(7800),a=n(4702),i=n(2203),o=n(8366),s=n(2545),c=n(3570),l=n(6521),u=n(8445),h=n(4071),d=n(1363),f=n(6929),p=n(7555),m=n(5099),g=n(8777),y=n(2582),v=n(4662),b=n(3734),w=n(6434),x=n(4136),k=n(6839),_=n(7965),S=n(607),T=n(1731),I=n(8143),E=n(5718),N=n(3220),C=n(9203),A=n(6045),R=n(6663),O=n(6094),D=n(4205),M=n(6249),F=n(3005),P=n(3684),L=n(473),z=n(1543),B=n(3239).forEach,j=A("hidden"),U="Symbol",V="prototype",W=z.set,G=z.getterFor(U),H=Object[V],q=a.Symbol,K=q&&q[V],X=a.RangeError,Y=a.TypeError,Q=a.QObject,J=_.f,$=S.f,Z=x.f,tt=I.f,et=o([].push),nt=C("symbols"),rt=C("op-symbols"),at=C("wks"),it=!Q||!Q[V]||!Q[V].findChild,ot=function(t,e,n){var r=J(H,e);r&&delete H[e],$(t,e,n),r&&t!==H&&$(H,e,r)},st=c&&u(function(){return 7!==v($({},"a",{get:function(){return $(this,"a",{value:7}).a}})).a})?ot:$,ct=function(t,e){var n=nt[t]=v(K);return W(n,{type:U,tag:t,description:e}),c||(n.description=e),n},lt=function(t,e,n){t===H&&lt(rt,e,n),f(t);var r=m(e);return f(n),h(nt,r)?(n.enumerable?(h(t,j)&&t[j][r]&&(t[j][r]=!1),n=v(n,{enumerable:y(0,!1)})):(h(t,j)||$(t,j,y(1,v(null))),t[j][r]=!0),st(t,r,n)):$(t,r,n)},ut=function(t,e){f(t);var n=p(e),r=b(n).concat(pt(n));return B(r,function(e){c&&!i(ht,n,e)||lt(t,e,n[e])}),t},ht=function(t){var e=m(t),n=i(tt,this,e);return!(this===H&&h(nt,e)&&!h(rt,e))&&(!(n||!h(this,e)||!h(nt,e)||h(this,j)&&this[j][e])||n)},dt=function(t,e){var n=p(t),r=m(e);if(n!==H||!h(nt,r)||h(rt,r)){var a=J(n,r);return!a||!h(nt,r)||h(n,j)&&n[j][r]||(a.enumerable=!0),a}},ft=function(t){var e=Z(p(t)),n=[];return B(e,function(t){h(nt,t)||h(R,t)||et(n,t)}),n},pt=function(t){var e=t===H,n=Z(e?rt:p(t)),r=[];return B(n,function(t){!h(nt,t)||e&&!h(H,t)||et(r,nt[t])}),r};l||(E(K=(q=function(){if(d(K,this))throw new Y("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?g(arguments[0]):void 0,e=O(t),n=function(t){var r=void 0===this?a:this;r===H&&i(n,rt,t),h(r,j)&&h(r[j],e)&&(r[j][e]=!1);var o=y(1,t);try{st(r,e,o)}catch(s){if(!(s instanceof X))throw s;ot(r,e,o)}};return c&&it&&st(H,e,{configurable:!0,set:n}),ct(e,t)})[V],"toString",function(){return G(this).tag}),E(q,"withoutSetter",function(t){return ct(O(t),t)}),I.f=ht,S.f=lt,T.f=ut,_.f=dt,w.f=x.f=ft,k.f=pt,M.f=function(t){return ct(D(t),t)},c&&(N(K,"description",{configurable:!0,get:function(){return G(this).description}}),s||E(H,"propertyIsEnumerable",ht,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!l,sham:!l},{Symbol:q}),B(b(at),function(t){F(t)}),r({target:U,stat:!0,forced:!l},{useSetter:function(){it=!0},useSimple:function(){it=!1}}),r({target:"Object",stat:!0,forced:!l,sham:!c},{create:function(t,e){return void 0===e?v(t):ut(v(t),e)},defineProperty:lt,defineProperties:ut,getOwnPropertyDescriptor:dt}),r({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:ft}),P(),L(q,U),R[j]=!0},6388:(t,e,n)=>{t.exports=n(5583)},6399:(t,e,n)=>{var r=n(5538),a=n(3668),i=n(9987),o=n(5752),s=n(6924),c=n(4052),l=n(4543),u=n(1268),h="[object Arguments]",d="[object Array]",f="[object Object]",p=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,m,g,y){var v=c(t),b=c(e),w=v?d:s(t),x=b?d:s(e),k=(w=w==h?f:w)==f,_=(x=x==h?f:x)==f,S=w==x;if(S&&l(t)){if(!l(e))return!1;v=!0,k=!1}if(S&&!k)return y||(y=new r),v||u(t)?a(t,e,n,m,g,y):i(t,e,w,n,m,g,y);if(!(1&n)){var T=k&&p.call(t,"__wrapped__"),I=_&&p.call(e,"__wrapped__");if(T||I){var E=T?t.value():t,N=I?e.value():e;return y||(y=new r),g(E,N,n,m,y)}}return!!S&&(y||(y=new r),o(t,e,n,m,g,y))}},6404:(t,e,n)=>{"use strict";var r=n(7499);t.exports=r},6434:(t,e,n)=>{"use strict";var r=n(9482),a=n(2721).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,a)}},6502:(t,e,n)=>{var r=n(899),a=n(8116),i=n(2133),o=n(3883),s=n(6582)("toPrimitive");t.exports=function(t,e){if(!r(t)||a(t))return t;var n,c=i(t,s);if(c){if(void 0===e&&(e="default"),n=c.call(t,e),!r(n)||a(n))return n;throw TypeError("Can't convert object to primitive value")}return void 0===e&&(e="number"),o(t,e)}},6521:(t,e,n)=>{"use strict";var r=n(5145),a=n(8445),i=n(4702).String;t.exports=!!Object.getOwnPropertySymbols&&!a(function(){var t=Symbol("symbol detection");return!i(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41})},6551:(t,e,n)=>{"use strict";n(572);var r=n(5345),a=n(1218),i=n(9846),o=n(6582),s=n(2540),c=o("species"),l=RegExp.prototype;t.exports=function(t,e,n,u){var h=o(t),d=!i(function(){var e={};return e[h]=function(){return 7},7!=""[t](e)}),f=d&&!i(function(){var e=!1,n=/a/;return"split"===t&&((n={}).constructor={},n.constructor[c]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return e=!0,null},n[h](""),!e});if(!d||!f||n){var p=/./[h],m=e(h,""[t],function(t,e,n,r,i){var o=e.exec;return o===a||o===l.exec?d&&!i?{done:!0,value:p.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}});r(String.prototype,t,m[0]),r(l,h,m[1])}u&&s(l[h],"sham",!0)}},6552:(t,e,n)=>{var r=n(7105),a="object"==typeof self&&self&&self.Object===Object&&self,i=r||a||Function("return this")();t.exports=i},6571:(t,e,n)=>{var r=n(1629),a=n(6173);t.exports=function(t){return null!=t&&a(t.length)&&!r(t)}},6582:(t,e,n)=>{var r=n(1500),a=n(1126),i=n(494),o=n(629),s=n(2405),c=n(4245),l=a("wks"),u=r.Symbol,h=c?u:u&&u.withoutSetter||o;t.exports=function(t){return i(l,t)&&(s||"string"==typeof l[t])||(s&&i(u,t)?l[t]=u[t]:l[t]=h("Symbol."+t)),l[t]}},6586:(t,e,n)=>{"use strict";var r=n(8061),a=n(5480),i=n(6779),o=n(6891),s=n(4205)("iterator");t.exports=function(t){if(!i(t))return a(t,s)||a(t,"@@iterator")||o[r(t)]}},6591:(t,e,n)=>{"use strict";var r=n(4205),a=n(607).f,i=r("metadata"),o=Function.prototype;void 0===o[i]&&a(o,i,{value:null})},6599:(t,e,n)=>{"use strict";var r=n(7800),a=n(8366),i=Date,o=a(i.prototype.getTime);r({target:"Date",stat:!0},{now:function(){return o(new i)}})},6600:(t,e,n)=>{var r=n(7937)(n(6552),"WeakMap");t.exports=r},6615:(t,e,n)=>{t.exports=n(4095)},6663:t=>{"use strict";t.exports={}},6665:()=>{},6678:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.drawNeedle=void 0;var r=n(5760),a=n(7110);e.drawNeedle=function(t,e,n,i,o,s,c,l){var u=n.percent,h=n.needleColor,d=n.needleBaseColor,f=n.hideText,p=n.animate,m=n.needleScale,g=n.textComponent,y=i.current/500*15,v=[0,-y/2];o.current.selectAll("*").remove(),o.current.attr("transform","translate("+c.current+", "+c.current+")");var b=e?e.percent:0,w=(0,a.calculateRotation)(b||u,c,i,m);o.current.append("path").attr("d",w).attr("fill",h),o.current.append("circle").attr("cx",v[0]).attr("cy",v[1]).attr("r",y).attr("fill",d),f||g||(0,a.addText)(u,n,c,i,l),!t&&p?o.current.transition().delay(n.animDelay).ease(r.easeElastic).duration(n.animateDuration).tween("progress",function(){var t=(0,r.interpolateNumber)(b,u);return function(e){var n=t(e);return s.current.select(".needle path").attr("d",(0,a.calculateRotation)(n,c,i,m))}}):s.current.select(".needle path").attr("d",(0,a.calculateRotation)(u,c,i,m))}},6680:t=>{t.exports=function(t){return"function"===typeof t}},6686:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},6704:t=>{t.exports=function(t){return this.__data__.has(t)}},6751:(t,e,n)=>{t.exports=n(6804)},6756:(t,e,n)=>{"use strict";var r=n(7800),a=n(8445),i=n(5334),o=n(5900),s=n(5231),c=n(5612),l=n(8967),u=n(4794),h=n(7403),d=n(1903),f=n(4205),p=n(5145),m=f("isConcatSpreadable"),g=p>=51||!a(function(){var t=[];return t[m]=!1,t.concat()[0]!==t}),y=function(t){if(!o(t))return!1;var e=t[m];return void 0!==e?!!e:i(t)};r({target:"Array",proto:!0,arity:1,forced:!g||!d("concat")},{concat:function(t){var e,n,r,a,i,o=s(this),d=h(o,0),f=0;for(e=-1,r=arguments.length;e<r;e++)if(y(i=-1===e?o:arguments[e]))for(a=c(i),l(f+a),n=0;n<a;n++,f++)n in i&&u(d,f,i[n]);else l(f+1),u(d,f++,i);return d.length=f,d}})},6779:t=>{"use strict";t.exports=function(t){return null===t||void 0===t}},6788:(t,e,n)=>{var r=n(7160),a=n(5204),i=n(4816);t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!a||o.length<199)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new i(o)}return n.set(t,e),this.size=n.size,this}},6802:(t,e,n)=>{"use strict";n(3005)("matcher")},6804:(t,e,n)=>{"use strict";var r=n(8512);t.exports=r},6806:(t,e,n)=>{"use strict";var r=n(4e3).charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},6809:(t,e,n)=>{"use strict";var r=n(9790);t.exports=r},6832:(t,e,n)=>{t=n.nmd(t);var r=n(7105),a=e&&!e.nodeType&&e,i=a&&t&&!t.nodeType&&t,o=i&&i.exports===a&&r.process,s=function(){try{var t=i&&i.require&&i.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(e){}}();t.exports=s},6839:(t,e)=>{"use strict";e.f=Object.getOwnPropertySymbols},6856:t=>{t.exports={}},6874:(t,e,n)=>{var r=n(2622);t.exports=function(t,e){var n=r(this,t),a=n.size;return n.set(t,e),this.size+=n.size==a?0:1,this}},6891:t=>{"use strict";t.exports={}},6913:(t,e,n)=>{var r=n(9812),a=n(4552),i=n(6095),o=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":o&&o in Object(t)?a(t):i(t)}},6924:(t,e,n)=>{var r=n(7685),a=n(5204),i=n(5387),o=n(2070),s=n(6600),c=n(6913),l=n(6996),u="[object Map]",h="[object Promise]",d="[object Set]",f="[object WeakMap]",p="[object DataView]",m=l(r),g=l(a),y=l(i),v=l(o),b=l(s),w=c;(r&&w(new r(new ArrayBuffer(1)))!=p||a&&w(new a)!=u||i&&w(i.resolve())!=h||o&&w(new o)!=d||s&&w(new s)!=f)&&(w=function(t){var e=c(t),n="[object Object]"==e?t.constructor:void 0,r=n?l(n):"";if(r)switch(r){case m:return p;case g:return u;case y:return h;case v:return d;case b:return f}return e}),t.exports=w},6929:(t,e,n)=>{"use strict";var r=n(5900),a=String,i=TypeError;t.exports=function(t){if(r(t))return t;throw new i(a(t)+" is not an object")}},6954:(t,e,n)=>{var r=n(1629),a=n(7857),i=n(6686),o=n(6996),s=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,h=l.hasOwnProperty,d=RegExp("^"+u.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||a(t))&&(r(t)?d:s).test(o(t))}},6967:(t,e,n)=>{"use strict";n(3005)("hasInstance")},6988:(t,e,n)=>{t.exports=n(3255)},6989:(t,e,n)=>{var r=n(6399),a=n(2761);t.exports=function t(e,n,i,o,s){return e===n||(null==e||null==n||!a(e)&&!a(n)?e!==e&&n!==n:r(e,n,i,o,t,s))}},6996:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(n){}try{return t+""}catch(n){}}return""}},7066:function(t,e,n){var r;!function(t,a){function i(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function s(t,e){var n=new i(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(e,n,e,a))||(a.exports=r):this.xor128=s}(0,t=n.nmd(t),n.amdD)},7101:()=>{},7105:(t,e,n)=>{var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;t.exports=r},7110:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setArcData=e.addText=e.calculateRotation=e.updateDimensions=e.centerGraph=e.calculateRadius=void 0;var r=n(5760);e.calculateRadius=function(t,e,n,r,i){t.current<2*e.current?n.current=(t.current-r.current.left-r.current.right)/2:n.current=e.current-r.current.top-r.current.bottom,a(t,i,n,r)};var a=function(t,e,n,r){r.current.left=t.current/2-n.current+r.current.right,e.current.attr("transform","translate("+r.current.left+", "+r.current.top+")")};e.centerGraph=a;e.updateDimensions=function(t,e,n,r,a){var i=t.marginInPercent,o=e.current.node().getBoundingClientRect(),s=o.width,c=o.height;n.current.left=s*i,n.current.right=s*i,r.current=s-n.current.left-n.current.right,n.current.top=c*i,n.current.bottom=c*i,a.current=r.current/2-n.current.top-n.current.bottom};e.calculateRotation=function(t,e,n,r){var a=e.current*r,i=n.current/500*15,o=s(t),c=[0,-i/2],l=[c[0]-a*Math.cos(o),c[1]-a*Math.sin(o)],u=[c[0]-i*Math.cos(o-Math.PI/2),c[1]-i*Math.sin(o-Math.PI/2)],h=[c[0]-i*Math.cos(o+Math.PI/2),c[1]-i*Math.sin(o+Math.PI/2)];return"M ".concat(u[0]," ").concat(u[1]," L ").concat(l[0]," ").concat(l[1]," L ").concat(h[0]," ").concat(h[1])};e.addText=function(t,e,n,r,a){var i=e.formatTextValue,s=e.fontSize,c=i?i(o(t)):o(t)+"%";a.current.append("g").attr("class","text-group").attr("transform","translate(".concat(n.current,", ").concat(n.current/2+20,")")).append("text").text(c).style("font-size",function(){return s||"".concat(r.current/11/(c.length>10?c.length/10:1),"px")}).style("fill",e.textColor).style("text-anchor","middle")};e.setArcData=function(t,e,n,r){e.current=t.arcsLength?t.arcsLength.length:t.nrOfLevels,e.current===t.colors.length?n.current=t.colors:n.current=i(t,e),r.current=[];for(var a=0;a<e.current;a++){var o={value:t.arcsLength&&t.arcsLength.length>a?t.arcsLength[a]:1,color:n.current[a]};r.current.push(o)}};var i=function(t,e){for(var n=t.colors,a=(0,r.scaleLinear)().domain([1,e.current]).range([n[0],n[n.length-1]]).interpolate(r.interpolateHsl),i=[],o=1;o<=e.current;o++)i.push(a(o));return i},o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Math.round(100*t*Math.pow(10,e))/Math.pow(10,e)},s=function(t){return t*Math.PI}},7159:(t,e,n)=>{var r=n(2622);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},7160:(t,e,n)=>{var r=n(7563),a=n(9935),i=n(4190),o=n(1946),s=n(1714);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=a,c.prototype.get=i,c.prototype.has=o,c.prototype.set=s,t.exports=c},7220:(t,e,n)=>{"use strict";var r=n(5749),a=n(8366),i=r("Symbol"),o=i.keyFor,s=a(i.prototype.valueOf);t.exports=i.isRegisteredSymbol||function(t){try{return void 0!==o(s(t))}catch(e){return!1}}},7234:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var r=n-1>>>1,a=t[r];if(!(0<i(a,e)))break t;t[r]=e,t[n]=a,n=r}}function r(t){return 0===t.length?null:t[0]}function a(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var r=0,a=t.length,o=a>>>1;r<o;){var s=2*(r+1)-1,c=t[s],l=s+1,u=t[l];if(0>i(c,n))l<a&&0>i(u,c)?(t[r]=u,t[l]=n,r=l):(t[r]=c,t[s]=n,r=s);else{if(!(l<a&&0>i(u,n)))break t;t[r]=u,t[l]=n,r=l}}}return e}function i(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,c=s.now();e.unstable_now=function(){return s.now()-c}}var l=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(t){for(var e=r(u);null!==e;){if(null===e.callback)a(u);else{if(!(e.startTime<=t))break;a(u),e.sortIndex=e.expirationTime,n(l,e)}e=r(u)}}function x(t){if(g=!1,w(t),!m)if(null!==r(l))m=!0,D(k);else{var e=r(u);null!==e&&M(x,e.startTime-t)}}function k(t,n){m=!1,g&&(g=!1,v(I),I=-1),p=!0;var i=f;try{for(w(n),d=r(l);null!==d&&(!(d.expirationTime>n)||t&&!C());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var s=o(d.expirationTime<=n);n=e.unstable_now(),"function"===typeof s?d.callback=s:d===r(l)&&a(l),w(n)}else a(l);d=r(l)}if(null!==d)var c=!0;else{var h=r(u);null!==h&&M(x,h.startTime-n),c=!1}return c}finally{d=null,f=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S=!1,T=null,I=-1,E=5,N=-1;function C(){return!(e.unstable_now()-N<E)}function A(){if(null!==T){var t=e.unstable_now();N=t;var n=!0;try{n=T(!0,t)}finally{n?_():(S=!1,T=null)}}else S=!1}if("function"===typeof b)_=function(){b(A)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,O=R.port2;R.port1.onmessage=A,_=function(){O.postMessage(null)}}else _=function(){y(A,0)};function D(t){T=t,S||(S=!0,_())}function M(t,n){I=y(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,D(k))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_scheduleCallback=function(t,a,i){var o=e.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,t){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return t={id:h++,callback:a,priorityLevel:t,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(t.sortIndex=i,n(u,t),null===r(l)&&t===r(u)&&(g?(v(I),I=-1):g=!0,M(x,i-o))):(t.sortIndex=s,n(l,t),m||p||(m=!0,D(k))),t},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(t){var e=f;return function(){var n=f;f=e;try{return t.apply(this,arguments)}finally{f=n}}}},7250:(t,e,n)=>{"use strict";for(var r=n(9203),a=n(5749),i=n(8366),o=n(307),s=n(4205),c=a("Symbol"),l=c.isWellKnownSymbol,u=a("Object","getOwnPropertyNames"),h=i(c.prototype.valueOf),d=r("wks"),f=0,p=u(c),m=p.length;f<m;f++)try{var g=p[f];o(c[g])&&s(g)}catch(y){}t.exports=function(t){if(l&&l(t))return!0;try{for(var e=h(t),n=0,r=u(d),a=r.length;n<a;n++)if(d[r[n]]==e)return!0}catch(y){}return!1}},7251:(t,e,n)=>{var r=n(8724),a=n(7160),i=n(5204);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||a),string:new r}}},7253:(t,e,n)=>{var r=n(6680),a=n(5290);t.exports=function(t){if(r(t))return t;throw TypeError(a(t)+" is not a function")}},7353:t=>{t.exports=n;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(T){}function n(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function r(t){return!0===(t&&t.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},i={};function o(t,e){var n,r,o;return e?(o=0<=(t>>>=0)&&t<256)&&(r=i[t])?r:(n=c(t,(0|t)<0?-1:0,!0),o&&(i[t]=n),n):(o=-128<=(t|=0)&&t<128)&&(r=a[t])?r:(n=c(t,t<0?-1:0,!1),o&&(a[t]=n),n)}function s(t,e){if(isNaN(t))return e?y:g;if(e){if(t<0)return y;if(t>=f)return k}else{if(t<=-p)return _;if(t+1>=p)return x}return t<0?s(-t,e).neg():c(t%d|0,t/d|0,e)}function c(t,e,r){return new n(t,e,r)}n.fromInt=o,n.fromNumber=s,n.fromBits=c;var l=Math.pow;function u(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return g;if("number"===typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(t.substring(1),e,n).neg();for(var a=s(l(n,8)),i=g,o=0;o<t.length;o+=8){var c=Math.min(8,t.length-o),h=parseInt(t.substring(o,o+c),n);if(c<8){var d=s(l(n,c));i=i.mul(d).add(s(h))}else i=(i=i.mul(a)).add(s(h))}return i.unsigned=e,i}function h(t,e){return"number"===typeof t?s(t,e):"string"===typeof t?u(t,e):c(t.low,t.high,"boolean"===typeof e?e:t.unsigned)}n.fromString=u,n.fromValue=h;var d=4294967296,f=d*d,p=f/2,m=o(1<<24),g=o(0);n.ZERO=g;var y=o(0,!0);n.UZERO=y;var v=o(1);n.ONE=v;var b=o(1,!0);n.UONE=b;var w=o(-1);n.NEG_ONE=w;var x=c(-1,2147483647,!1);n.MAX_VALUE=x;var k=c(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var _=c(0,-2147483648,!1);n.MIN_VALUE=_;var S=n.prototype;S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},S.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var e=s(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var a=s(l(t,6),this.unsigned),i=this,o="";;){var c=i.div(a),u=(i.sub(c.mul(a)).toInt()>>>0).toString(t);if((i=c).isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1===(1&this.low)},S.isEven=function(){return 0===(1&this.low)},S.equals=function(t){return r(t)||(t=h(t)),(this.unsigned===t.unsigned||this.high>>>31!==1||t.high>>>31!==1)&&(this.high===t.high&&this.low===t.low)},S.eq=S.equals,S.notEquals=function(t){return!this.eq(t)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(t){return this.comp(t)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(t){return this.comp(t)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(t){return this.comp(t)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(t){return this.comp(t)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(t){if(r(t)||(t=h(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(v)},S.neg=S.negate,S.add=function(t){r(t)||(t=h(t));var e=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,o=t.high>>>16,s=65535&t.high,l=t.low>>>16,u=0,d=0,f=0,p=0;return f+=(p+=i+(65535&t.low))>>>16,d+=(f+=a+l)>>>16,u+=(d+=n+s)>>>16,u+=e+o,c((f&=65535)<<16|(p&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},S.subtract=function(t){return r(t)||(t=h(t)),this.add(t.neg())},S.sub=S.subtract,S.multiply=function(t){if(this.isZero())return g;if(r(t)||(t=h(t)),e)return c(e.mul(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned);if(t.isZero())return g;if(this.eq(_))return t.isOdd()?_:g;if(t.eq(_))return this.isOdd()?_:g;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(m)&&t.lt(m))return s(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,i=this.low>>>16,o=65535&this.low,l=t.high>>>16,u=65535&t.high,d=t.low>>>16,f=65535&t.low,p=0,y=0,v=0,b=0;return v+=(b+=o*f)>>>16,y+=(v+=i*f)>>>16,v&=65535,y+=(v+=o*d)>>>16,p+=(y+=a*f)>>>16,y&=65535,p+=(y+=i*d)>>>16,y&=65535,p+=(y+=o*u)>>>16,p+=n*f+a*d+i*u+o*l,c((v&=65535)<<16|(b&=65535),(p&=65535)<<16|(y&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(t){if(r(t)||(t=h(t)),t.isZero())throw Error("division by zero");var n,a,i;if(e)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?c((this.unsigned?e.div_u:e.div_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?y:g;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return y;if(t.gt(this.shru(1)))return b;i=y}else{if(this.eq(_))return t.eq(v)||t.eq(w)?_:t.eq(_)?v:(n=this.shr(1).div(t).shl(1)).eq(g)?t.isNegative()?v:w:(a=this.sub(t.mul(n)),i=n.add(a.div(t)));if(t.eq(_))return this.unsigned?y:g;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=g}for(a=this;a.gte(t);){n=Math.max(1,Math.floor(a.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),u=o<=48?1:l(2,o-48),d=s(n),f=d.mul(t);f.isNegative()||f.gt(a);)f=(d=s(n-=u,this.unsigned)).mul(t);d.isZero()&&(d=v),i=i.add(d),a=a.sub(f)}return i},S.div=S.divide,S.modulo=function(t){return r(t)||(t=h(t)),e?c((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return c(~this.low,~this.high,this.unsigned)},S.and=function(t){return r(t)||(t=h(t)),c(this.low&t.low,this.high&t.high,this.unsigned)},S.or=function(t){return r(t)||(t=h(t)),c(this.low|t.low,this.high|t.high,this.unsigned)},S.xor=function(t){return r(t)||(t=h(t)),c(this.low^t.low,this.high^t.high,this.unsigned)},S.shiftLeft=function(t){return r(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?c(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):c(0,this.low<<t-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(t){return r(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):c(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(t){if(r(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;return t<32?c(this.low>>>t|e<<32-t,e>>>t,this.unsigned):c(32===t?e:e>>>t-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},S.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},S.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},n.fromBytes=function(t,e,r){return r?n.fromBytesLE(t,e):n.fromBytesBE(t,e)},n.fromBytesLE=function(t,e){return new n(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},n.fromBytesBE=function(t,e){return new n(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},7359:function(t,e,n){var r;!function(t,a){function i(t){var e=this,n=function(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function o(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function s(t,e){var n=new i(t),r=e&&e.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(e,n,e,a))||(a.exports=r):this.alea=s}(0,t=n.nmd(t),n.amdD)},7403:(t,e,n)=>{"use strict";var r=n(3595);t.exports=function(t,e){return new(r(t))(0===e?0:e)}},7448:(t,e,n)=>{t.exports=n(2306)()},7479:(t,e,n)=>{"use strict";var r=n(7800),a=n(877);r({target:"Array",proto:!0,forced:[].forEach!==a},{forEach:a})},7499:(t,e,n)=>{"use strict";var r=n(1338);t.exports=r},7529:t=>{t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,a=0,i=[];++n<r;){var o=t[n];e(o,n,t)&&(i[a++]=o)}return i}},7555:(t,e,n)=>{"use strict";var r=n(8365),a=n(4300);t.exports=function(t){return r(a(t))}},7563:t=>{t.exports=function(){this.__data__=[],this.size=0}},7565:(t,e,n)=>{var r=n(8496),a=Math.floor,i="".replace,o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,s=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,c,l,u){var h=n+t.length,d=c.length,f=s;return void 0!==l&&(l=r(l),f=o),i.call(u,f,function(r,i){var o;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(h);case"<":o=l[i.slice(1,-1)];break;default:var s=+i;if(0===s)return r;if(s>d){var u=a(s/10);return 0===u?r:u<=d?void 0===c[u-1]?i.charAt(1):c[u-1]+i.charAt(1):r}o=c[s-1]}return void 0===o?"":o})}},7574:t=>{t.exports=function(t){return function(e){return t(e)}}},7592:(t,e,n)=>{"use strict";var r=n(4185);t.exports=r},7615:(t,e,n)=>{var r=n(5575);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},7685:(t,e,n)=>{var r=n(7937)(n(6552),"DataView");t.exports=r},7760:t=>{t.exports=function(t){return this.__data__.get(t)}},7800:(t,e,n)=>{"use strict";var r=n(4702),a=n(375),i=n(4774),o=n(9607),s=n(7965).f,c=n(4582),l=n(5313),u=n(1566),h=n(9825),d=n(4071);n(8531);var f=function(t){var e=function(n,r,i){if(this instanceof e){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,i)}return a(t,this,arguments)};return e.prototype=t.prototype,e};t.exports=function(t,e){var n,a,p,m,g,y,v,b,w,x=t.target,k=t.global,_=t.stat,S=t.proto,T=k?r:_?r[x]:r[x]&&r[x].prototype,I=k?l:l[x]||h(l,x,{})[x],E=I.prototype;for(m in e)a=!(n=c(k?m:x+(_?".":"#")+m,t.forced))&&T&&d(T,m),y=I[m],a&&(v=t.dontCallGetSet?(w=s(T,m))&&w.value:T[m]),g=a&&v?v:e[m],(n||S||typeof y!=typeof g)&&(b=t.bind&&a?u(g,r):t.wrap&&a?f(g):S&&o(g)?i(g):g,(t.sham||g&&g.sham||y&&y.sham)&&h(b,"sham",!0),h(I,m,b),S&&(d(l,p=x+"Prototype")||h(l,p,{}),h(l[p],m,g),t.real&&E&&(n||!E[m])&&h(E,m,g)))}},7823:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},7828:t=>{t.exports=function(){return[]}},7857:(t,e,n)=>{var r=n(3440),a=function(){var t=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();t.exports=function(t){return!!a&&a in t}},7886:(t,e,n)=>{"use strict";var r=n(8445);t.exports=!r(function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})},7892:(t,e)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,a=r&&!n.call({1:2},1);e.f=a?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},7921:(t,e,n)=>{"use strict";n(3005)("match")},7937:(t,e,n)=>{var r=n(6954),a=n(4657);t.exports=function(t,e){var n=a(t,e);return r(n)?n:void 0}},7939:(t,e,n)=>{"use strict";var r=n(8304);t.exports=r},7944:(t,e,n)=>{"use strict";n(7800)({target:"Array",stat:!0},{isArray:n(5334)})},7950:(t,e,n)=>{"use strict";!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=n(2730)},7965:(t,e,n)=>{"use strict";var r=n(3570),a=n(2203),i=n(8143),o=n(2582),s=n(7555),c=n(5099),l=n(4071),u=n(8331),h=Object.getOwnPropertyDescriptor;e.f=r?h:function(t,e){if(t=s(t),e=c(e),u)try{return h(t,e)}catch(n){}if(l(t,e))return o(!a(i.f,t,e),t[e])}},8006:t=>{"use strict";var e=TypeError;t.exports=function(t,n){if(t<n)throw new e("Not enough arguments");return t}},8057:(t,e,n)=>{var r=n(2622);t.exports=function(t){return r(this,t).get(t)}},8061:(t,e,n)=>{"use strict";var r=n(4606),a=n(9607),i=n(2202),o=n(4205)("toStringTag"),s=Object,c="Arguments"===i(function(){return arguments}());t.exports=r?i:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(n){}}(e=s(t),o))?n:c?i(e):"Object"===(r=i(e))&&a(e.callee)?"Arguments":r}},8083:(t,e,n)=>{"use strict";var r=n(5900);t.exports=function(t){return r(t)||null===t}},8108:()=>{},8114:t=>{t.exports=function(t,e){return t.has(e)}},8116:(t,e,n)=>{var r=n(6680),a=n(1755),i=n(4245);t.exports=i?function(t){return"symbol"==typeof t}:function(t){var e=a("Symbol");return r(e)&&Object(t)instanceof e}},8118:(t,e,n)=>{"use strict";var r=n(4702),a=n(5313);t.exports=function(t,e){var n=a[t+"Prototype"],i=n&&n[e];if(i)return i;var o=r[t],s=o&&o.prototype;return s&&s[e]}},8143:(t,e)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,a=r&&!n.call({1:2},1);e.f=a?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},8210:(t,e,n)=>{var r=n(1500),a=n(4419),i="__core-js_shared__",o=r[i]||a(i,{});t.exports=o},8232:(t,e)=>{e.f=Object.getOwnPropertySymbols},8237:(t,e,n)=>{"use strict";n(6383),n(2224),n(1426),n(5916),n(8591)},8280:(t,e,n)=>{"use strict";var r=n(4121);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},8304:(t,e,n)=>{"use strict";n(4044);var r=n(5313);t.exports=r.Math.sign},8321:(t,e,n)=>{"use strict";var r=n(6404);t.exports=r},8331:(t,e,n)=>{"use strict";var r=n(3570),a=n(8445),i=n(1925);t.exports=!r&&!a(function(){return 7!==Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a})},8365:(t,e,n)=>{"use strict";var r=n(8366),a=n(8445),i=n(2202),o=Object,s=r("".split);t.exports=a(function(){return!o("z").propertyIsEnumerable(0)})?function(t){return"String"===i(t)?s(t,""):o(t)}:o},8366:(t,e,n)=>{"use strict";var r=n(7886),a=Function.prototype,i=a.call,o=r&&a.bind.bind(i,i);t.exports=r?o:function(t){return function(){return i.apply(t,arguments)}}},8404:(t,e,n)=>{"use strict";var r=n(3657);n(5060),n(5838),n(5118),n(4007),n(5807),n(8641),n(6802),n(1353),n(6222),n(9370),t.exports=r},8420:(t,e,n)=>{"use strict";var r=n(4721),a=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?a(n+e,0):i(n,e)}},8436:(t,e,n)=>{"use strict";var r=n(7800),a=n(5334),i=n(1187),o=n(5900),s=n(8420),c=n(5612),l=n(7555),u=n(4794),h=n(4205),d=n(1903),f=n(78),p=d("slice"),m=h("species"),g=Array,y=Math.max;r({target:"Array",proto:!0,forced:!p},{slice:function(t,e){var n,r,h,d=l(this),p=c(d),v=s(t,p),b=s(void 0===e?p:e,p);if(a(d)&&(n=d.constructor,(i(n)&&(n===g||a(n.prototype))||o(n)&&null===(n=n[m]))&&(n=void 0),n===g||void 0===n))return f(d,v,b);for(r=new(void 0===n?g:n)(y(b-v,0)),h=0;v<b;v++,h++)v in d&&u(r,h,d[v]);return r.length=h,r}})},8445:t=>{"use strict";t.exports=function(t){try{return!!t()}catch(e){return!0}}},8466:t=>{t.exports=!1},8472:(t,e,n)=>{"use strict";var r=n(5729);t.exports=r},8496:(t,e,n)=>{var r=n(3345);t.exports=function(t){return Object(r(t))}},8512:(t,e,n)=>{"use strict";n(2400);var r=n(5313);t.exports=r.Object.getOwnPropertyDescriptors},8531:(t,e,n)=>{"use strict";var r=n(2545),a=n(4702),i=n(1099),o="__core-js_shared__",s=t.exports=a[o]||i(o,{});(s.versions||(s.versions=[])).push({version:"3.43.0",mode:r?"pure":"global",copyright:"\xa9 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"})},8590:()=>{},8591:(t,e,n)=>{"use strict";var r=n(7800),a=n(6521),i=n(8445),o=n(6839),s=n(5231);r({target:"Object",stat:!0,forced:!a||i(function(){o.f(1)})},{getOwnPropertySymbols:function(t){var e=o.f;return e?e(s(t)):[]}})},8641:(t,e,n)=>{"use strict";n(7800)({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:n(7250)})},8673:(t,e,n)=>{var r=n(3204),a=n(3713),i=n(6571);t.exports=function(t){return i(t)?r(t):a(t)}},8724:(t,e,n)=>{var r=n(7615),a=n(5051),i=n(2154),o=n(8734),s=n(2662);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=a,c.prototype.get=i,c.prototype.has=o,c.prototype.set=s,t.exports=c},8734:(t,e,n)=>{var r=n(5575),a=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:a.call(e,t)}},8738:(t,e,n)=>{var r=n(1500),a=n(899),i=r.document,o=a(i)&&a(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},8743:(t,e,n)=>{"use strict";n(1446),n(3918);var r=n(6586);t.exports=r},8777:(t,e,n)=>{"use strict";var r=n(8061),a=String;t.exports=function(t){if("Symbol"===r(t))throw new TypeError("Cannot convert a Symbol value to a string");return a(t)}},8843:t=>{"use strict";t.exports=function(t,e){return{value:t,done:e}}},8853:(t,e,n)=>{"use strict";t.exports=n(7234)},8869:(t,e,n)=>{"use strict";var r=n(7800),a=n(4702),i=n(4102)(a.setInterval,!0);r({global:!0,bind:!0,forced:a.setInterval!==i},{setInterval:i})},8885:(t,e,n)=>{"use strict";var r=n(4702),a=n(3273),i=n(2202),o=function(t){return a.slice(0,t.length)===t};t.exports=o("Bun/")?"BUN":o("Cloudflare-Workers")?"CLOUDFLARE":o("Deno/")?"DENO":o("Node.js/")?"NODE":r.Bun&&"string"==typeof Bun.version?"BUN":r.Deno&&"object"==typeof Deno.version?"DENO":"process"===i(r.process)?"NODE":r.window&&r.document?"BROWSER":"REST"},8895:t=>{t.exports=function(t,e){for(var n=-1,r=e.length,a=t.length;++n<r;)t[a+n]=e[n];return t}},8902:(t,e,n)=>{var r=n(4816),a=n(6179),i=n(6704);function o(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}o.prototype.add=o.prototype.push=a,o.prototype.has=i,t.exports=o},8928:(t,e,n)=>{t.exports=n(504)},8967:t=>{"use strict";var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},9016:function(t,e,n){var r;!function(t,a){function i(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function s(t,e){var n=new i(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(e,n,e,a))||(a.exports=r):this.xorwow=s}(0,t=n.nmd(t),n.amdD)},9052:(t,e,n)=>{"use strict";var r=n(8366),a=n(4508);t.exports=function(t,e,n){try{return r(a(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(i){}}},9073:()=>{},9077:(t,e,n)=>{"use strict";n(7479);var r=n(8118);t.exports=r("Array","forEach")},9085:(t,e,n)=>{"use strict";var r=n(5749),a=n(8366),i=n(6434),o=n(6839),s=n(6929),c=a([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(s(t)),n=o.f;return n?c(e,n(t)):e}},9151:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.renderChart=void 0;var r=n(7110);e.renderChart=function(t,e,n,a,i,o,s,c,l,u,h,d,f,p,m){(0,r.updateDimensions)(f,p,a,n,i),d.current.attr("width",n.current+a.current.left+a.current.right).attr("height",i.current+a.current.top+a.current.bottom),s.current.attr("transform","translate("+a.current.left+", "+a.current.top+")"),(0,r.calculateRadius)(n,i,o,a,s),c.current.attr("transform","translate("+o.current+", "+o.current+")"),l.current.outerRadius(o.current).innerRadius(o.current*(1-f.arcWidth)).cornerRadius(f.cornerRadius).padAngle(f.arcPadding),c.current.selectAll(".arc").remove(),s.current.selectAll(".text-group").remove(),c.current.selectAll(".arc").data(h.current(m.current)).enter().append("g").attr("class","arc").append("path").attr("d",l.current).style("fill",function(t){return t.data.color})}},9168:(t,e,n)=>{var r=n(9748),a=n(3345);t.exports=function(t){return r(a(t))}},9194:t=>{var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,n){var r=typeof t;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&e.test(t))&&t>-1&&t%1==0&&t<n}},9200:(t,e,n)=>{"use strict";var r=n(1363),a=n(1844),i=Array.prototype;t.exports=function(t){var e=t.indexOf;return t===i||r(i,t)&&e===i.indexOf?a:e}},9203:(t,e,n)=>{"use strict";var r=n(8531);t.exports=function(t,e){return r[t]||(r[t]=e||{})}},9215:(t,e,n)=>{"use strict";n(3005)("metadata")},9278:(t,e,n)=>{"use strict";n(3005)("asyncIterator")},9370:(t,e,n)=>{"use strict";n(3005)("replaceAll")},9381:(t,e,n)=>{var r=n(4121),a=n(6680),i=n(1437),o=n(1218);t.exports=function(t,e){var n=t.exec;if(a(n)){var s=n.call(t,e);return null!==s&&r(s),s}if("RegExp"===i(t))return o.call(t,e);throw TypeError("RegExp#exec called on incompatible receiver")}},9394:(t,e,n)=>{var r=n(2622);t.exports=function(t){return r(this,t).has(t)}},9395:(t,e,n)=>{var r=n(4262),a=n(9621),i=n(8673);t.exports=function(t){return r(t,i,a)}},9418:(t,e,n)=>{var r=n(1500),a=n(6680),i=n(3017),o=r.WeakMap;t.exports=a(o)&&/native code/.test(i(o))},9482:(t,e,n)=>{"use strict";var r=n(8366),a=n(4071),i=n(7555),o=n(1348).indexOf,s=n(6663),c=r([].push);t.exports=function(t,e){var n,r=i(t),l=0,u=[];for(n in r)!a(s,n)&&a(r,n)&&c(u,n);for(;e.length>l;)a(r,n=e[l++])&&(~o(u,n)||c(u,n));return u}},9483:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==typeof t&&"function"!==typeof t)return{default:t};var e=h();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var i=r?Object.getOwnPropertyDescriptor(t,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=t[a]}n.default=t,e&&e.set(t,n);return n}(n(5043)),a=n(5760),i=u(n(5173)),o=n(7110),s=n(9151),c=n(6678),l=u(n(438));function u(t){return t&&t.__esModule?t:{default:t}}function h(){if("function"!==typeof WeakMap)return null;var t=new WeakMap;return h=function(){return t},t}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach(function(e){p(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=-Math.PI/2,g=Math.PI/2,y=["marginInPercent","arcPadding","percent","nrOfLevels","animDelay"],v={style:{width:"100%"},marginInPercent:.05,cornerRadius:6,nrOfLevels:3,percent:.4,arcPadding:.05,arcWidth:.2,colors:["#00FF00","#FF0000"],textColor:"#fff",needleColor:"#464A4F",needleBaseColor:"#464A4F",hideText:!1,animate:!0,animDelay:500,formatTextValue:null,fontSize:null,animateDuration:3e3,textComponent:void 0,needleScale:.55,customNeedleComponent:null},b=function(t){var e=(0,r.useMemo)(function(){return f(f({},v),t)},[t]),n=(0,r.useRef)({}),i=(0,r.useRef)({}),u=(0,r.useRef)({}),h=(0,r.useRef)({}),d=(0,r.useRef)({}),p=(0,r.useRef)({}),b=(0,r.useRef)({}),w=(0,r.useRef)({}),x=(0,r.useRef)({}),k=(0,r.useRef)(0),_=(0,r.useRef)([]),S=(0,r.useRef)((0,a.arc)()),T=(0,r.useRef)([]),I=(0,r.useRef)((0,a.pie)()),E=(0,r.useRef)(e),N=(0,r.useRef)({}),C=(0,r.useCallback)(function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;if(t)return(0,s.renderChart)(r,a,u,w,h,b,i,d,S,p,I,n,e,x,T),void(!F&&(0,c.drawNeedle)(r,a,e,u,p,x,b,i));x.current.select("svg").remove(),n.current=x.current.append("svg"),i.current=n.current.append("g"),d.current=i.current.append("g").attr("class","doughnut"),I.current.value(function(t){return t.value}).startAngle(m).endAngle(g).sort(null),p.current=i.current.append("g").attr("class","needle"),(0,s.renderChart)(r,a,u,w,h,b,i,d,S,p,I,n,e,x,T),!F&&(0,c.drawNeedle)(r,a,e,u,p,x,b,i)},[e]);(0,r.useLayoutEffect)(function(){(0,o.setArcData)(e,k,_,T),x.current=(0,a.select)(N),C()},[e,C]),(0,l.default)(function(){(e.nrOfLevels||E.current.arcsLength.every(function(t){return e.arcsLength.includes(t)})||E.current.colors.every(function(t){return e.colors.includes(t)}))&&(0,o.setArcData)(e,k,_,T);var t=!y.some(function(t){return E.current[t]!==e[t]});C(!0,t,E.current),E.current=e},[e.nrOfLevels,e.arcsLength,e.colors,e.percent,e.needleColor,e.needleBaseColor]),(0,r.useEffect)(function(){var t=function(){var t=!0;(0,s.renderChart)(t,E,u,w,h,b,i,d,S,p,I,n,e,x,T),!F&&(0,c.drawNeedle)(t,E,e,u,p,x,b,i)};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}},[e]);var A=e.id,R=e.style,O=e.className,D=e.textComponent,M=e.textComponentContainerClassName,F=e.customNeedleComponent,P=e.customNeedleStyle,L=e.customNeedleComponentClassName;return r.default.createElement("div",{id:A,className:O,style:R},r.default.createElement("div",{ref:function(t){return N=t}},r.default.createElement("div",{className:M,style:{position:"relative",top:"50%"}},D)),F&&r.default.createElement("div",{className:L,style:f({position:"relative"},P)},F))},w=b;e.default=w,b.propTypes={id:i.default.string,className:i.default.string,style:i.default.object,marginInPercent:i.default.number,cornerRadius:i.default.number,nrOfLevels:i.default.number,percent:i.default.number,arcPadding:i.default.number,arcWidth:i.default.number,arcsLength:i.default.array,colors:i.default.array,textColor:i.default.string,needleColor:i.default.string,needleBaseColor:i.default.string,hideText:i.default.bool,animate:i.default.bool,formatTextValue:i.default.func,fontSize:i.default.string,animateDuration:i.default.number,animDelay:i.default.number,textComponent:i.default.element,textComponentContainerClassName:i.default.string,needleScale:i.default.number,customNeedleComponent:i.default.element,customNeedleComponentClassName:i.default.string,customNeedleStyle:i.default.object}},9486:(t,e,n)=>{"use strict";n(1446),n(6665),n(3918),n(5102);var r=n(6249);t.exports=r.f("iterator")},9502:t=>{"use strict";t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},9538:function(t,e,n){var r;!function(t,a){function i(t){var e=this;e.next=function(){var t,n,r=e.x,a=e.i;return t=r[a],n=(t^=t>>>7)^t<<24,n^=(t=r[a+1&7])^t>>>10,n^=(t=r[a+3&7])^t>>>3,n^=(t=r[a+4&7])^t<<7,t=r[a+7&7],n^=(t^=t<<13)^t<<9,r[a]=n,e.i=a+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function o(t,e){return e.x=t.x.slice(),e.i=t.i,e}function s(t,e){null==t&&(t=+new Date);var n=new i(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,r&&(r.x&&o(r,n),a.state=function(){return o(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(e,n,e,a))||(a.exports=r):this.xorshift7=s}(0,t=n.nmd(t),n.amdD)},9550:(t,e,n)=>{t.exports=n(2742)},9607:t=>{"use strict";var e="object"==typeof document&&document.all;t.exports="undefined"==typeof e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},9621:(t,e,n)=>{var r=n(7529),a=n(7828),i=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(t){return null==t?[]:(t=Object(t),r(o(t),function(e){return i.call(t,e)}))}:a;t.exports=s},9637:(t,e,n)=>{"use strict";n(5461);var r=n(5313).Object,a=t.exports=function(t,e){return r.getOwnPropertyDescriptor(t,e)};r.getOwnPropertyDescriptor.sham&&(a.sham=!0)},9645:(t,e,n)=>{"use strict";var r=n(9052),a=n(5900),i=n(4300),o=n(1192);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=r(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(s){}return function(n,r){return i(n),o(r),a(n)?(e?t(n,r):n.__proto__=r,n):n}}():void 0)},9719:(t,e,n)=>{"use strict";n(3005)("search")},9721:(t,e,n)=>{"use strict";var r=n(4078);t.exports=r},9746:(t,e,n)=>{"use strict";var r=n(7800),a=n(4774),i=n(1348).indexOf,o=n(844),s=a([].indexOf),c=!!s&&1/s([1],1,-0)<0;r({target:"Array",proto:!0,forced:c||!o("indexOf")},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return c?s(this,t,e)||0:i(this,t,e)}})},9748:(t,e,n)=>{var r=n(9846),a=n(1437),i="".split;t.exports=r(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==a(t)?i.call(t,""):Object(t)}:Object},9757:(t,e,n)=>{var r=n(9846),a=n(1500).RegExp;t.exports=r(function(){var t=a("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})},9790:(t,e,n)=>{"use strict";var r=n(1363),a=n(6258),i=Array.prototype;t.exports=function(t){var e=t.splice;return t===i||r(i,t)&&e===i.splice?a:e}},9812:(t,e,n)=>{var r=n(6552).Symbol;t.exports=r},9825:(t,e,n)=>{"use strict";var r=n(3570),a=n(607),i=n(2582);t.exports=r?function(t,e,n){return a.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},9828:(t,e,n)=>{var r=n(1126),a=n(629),i=r("keys");t.exports=function(t){return i[t]||(i[t]=a(t))}},9844:(t,e,n)=>{"use strict";n(855)},9845:(t,e,n)=>{var r,a=n(4121),i=n(138),o=n(3334),s=n(6856),c=n(1334),l=n(8738),u=n(9828),h="prototype",d="script",f=u("IE_PROTO"),p=function(){},m=function(t){return"<"+d+">"+t+"</"+d+">"},g=function(t){t.write(m("")),t.close();var e=t.parentWindow.Object;return t=null,e},y=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}y="undefined"!=typeof document?document.domain&&r?g(r):function(){var t,e=l("iframe"),n="java"+d+":";return e.style.display="none",c.appendChild(e),e.src=String(n),(t=e.contentWindow.document).open(),t.write(m("document.F=Object")),t.close(),t.F}():g(r);for(var t=o.length;t--;)delete y[h][o[t]];return y()};s[f]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(p[h]=a(t),n=new p,p[h]=null,n[f]=t):n=y(),void 0===e?n:i(n,e)}},9846:t=>{t.exports=function(t){try{return!!t()}catch(e){return!0}}},9853:(t,e,n)=>{var r=n(6989);t.exports=function(t,e){return r(t,e)}},9855:(t,e,n)=>{"use strict";var r=n(5749);t.exports=r("document","documentElement")},9880:(t,e,n)=>{"use strict";var r=n(8366),a=n(9607),i=n(8531),o=r(Function.toString);a(i.inspectSource)||(i.inspectSource=function(t){return o(t)}),t.exports=i.inspectSource},9935:(t,e,n)=>{var r=n(1340),a=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():a.call(e,n,1),--this.size,!0)}},9987:(t,e,n)=>{var r=n(9812),a=n(2929),i=n(3211),o=n(3668),s=n(4160),c=n(2074),l=r?r.prototype:void 0,u=l?l.valueOf:void 0;t.exports=function(t,e,n,r,l,h,d){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!h(new a(t),new a(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var f=s;case"[object Set]":var p=1&r;if(f||(f=c),t.size!=e.size&&!p)return!1;var m=d.get(t);if(m)return m==e;r|=2,d.set(t,e);var g=o(f(t),f(e),r,l,h,d);return d.delete(t),g;case"[object Symbol]":if(u)return u.call(t)==u.call(e)}return!1}}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},(()=>{var t,e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var o={};t=t||[null,e({}),e([]),e(e)];for(var s=2&a&&r;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach(t=>o[t]=()=>r[t]);return o.default=()=>r,n.d(i,o),i}})(),n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce((e,r)=>(n.f[r](t,e),e),[])),n.u=t=>"static/js/"+t+".570e6447.chunk.js",n.miniCssF=t=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="student:";n.l=(r,a,i,o)=>{if(t[r])t[r].push(a);else{var s,c;if(void 0!==i)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var h=l[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==e+i){s=h;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",e+i),s.src=r),t[r]=[a];var d=(e,n)=>{s.onerror=s.onload=null,clearTimeout(f);var a=t[r];if(delete t[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach(t=>t(n)),e)return e(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=d.bind(null,s.onerror),s.onload=d.bind(null,s.onload),c&&document.head.appendChild(s)}}})(),n.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n.p="/",(()=>{var t={792:0};n.f.j=(e,r)=>{var a=n.o(t,e)?t[e]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((n,r)=>a=t[e]=[n,r]);r.push(a[2]=i);var o=n.p+n.u(e),s=new Error;n.l(o,r=>{if(n.o(t,e)&&(0!==(a=t[e])&&(t[e]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}},"chunk-"+e,e)}};var e=(e,r)=>{var a,i,o=r[0],s=r[1],c=r[2],l=0;if(o.some(e=>0!==t[e])){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(c)c(n)}for(e&&e(r);l<o.length;l++)i=o[l],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0},r=self.webpackChunkstudent=self.webpackChunkstudent||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),(()=>{"use strict";var t={};n.r(t),n.d(t,{hasBrowserEnv:()=>pn,hasStandardBrowserEnv:()=>gn,hasStandardBrowserWebWorkerEnv:()=>yn,navigator:()=>mn,origin:()=>vn});var e={};n.r(e),n.d(e,{browserFiles:()=>Gf,browserHTTPRequest:()=>Zf,concatenateArrayBuffers:()=>Gd,copyModel:()=>Rf,decodeWeights:()=>jd,encodeWeights:()=>Bd,fromMemory:()=>rp,fromMemorySync:()=>ap,getLoadHandlers:()=>nf,getModelArtifactsForJSON:()=>Xd,getModelArtifactsForJSONSync:()=>Kd,getModelArtifactsInfoForJSON:()=>Yd,getSaveHandlers:()=>ef,getWeightSpecs:()=>Qd,http:()=>$f,isHTTPScheme:()=>Qf,listModels:()=>Cf,loadWeights:()=>Kf,moveModel:()=>Of,registerLoadRouter:()=>tf,registerSaveRouter:()=>Zd,removeModel:()=>Af,weightsLoaderFactory:()=>Xf,withSaveHandler:()=>ip,withSaveHandlerSync:()=>op});var r={};n.r(r),n.d(r,{assertParamsValid:()=>gp,computeFlatOffset:()=>Cp,computeOutShape:()=>vp,getNormalizedAxes:()=>kp,isSliceContinous:()=>Np,maskToAxes:()=>yp,parseSliceParams:()=>Ap,sliceInfo:()=>Rp,startForAxis:()=>Ip,startIndicesWithElidedDims:()=>_p,stopForAxis:()=>Ep,stopIndicesWithElidedDims:()=>Sp,stridesForAxis:()=>Tp,stridesWithElidedDims:()=>bp});var a={};n.r(a),n.d(a,{conv2d:()=>cb,depthwiseConv2d:()=>hb,matMul:()=>db});var i={};n.r(i),n.d(i,{collectGatherOpShapeInfo:()=>Cx,computeOutShape:()=>Nx,segOpComputeOptimalWindowSize:()=>Ex});var o={};n.r(o),n.d(o,{ERF_A1:()=>Hw,ERF_A2:()=>qw,ERF_A3:()=>Kw,ERF_A4:()=>Xw,ERF_A5:()=>Yw,ERF_P:()=>Gw,PARALLELIZE_THRESHOLD:()=>Dw,RowPartitionType:()=>Nw,SELU_SCALE:()=>Ww,SELU_SCALEALPHA:()=>Vw,applyActivation:()=>ob,assertAndGetBroadcastShape:()=>lp,assertAxesAreInnerMostDims:()=>wg,assertParamsConsistent:()=>Iw,assignToTypedArray:()=>ex,axesAreInnerMostDims:()=>gg,calculateShapes:()=>Yv,checkEinsumDimSizes:()=>ux,checkPadOnDimRoundingMode:()=>vm,combineLocations:()=>yg,combineRaggedTensorToTensorShapes:()=>Cw,complexWithEvenIndex:()=>$w,complexWithOddIndex:()=>Zw,computeConv2DInfo:()=>cm,computeConv3DInfo:()=>lm,computeDefaultPad:()=>um,computeDilation2DInfo:()=>im,computeOptimalWindowSize:()=>Mw,computeOutAndReduceShapes:()=>vg,computeOutShape:()=>Ew,computePool2DInfo:()=>om,computePool3DInfo:()=>sm,convertConv2DDataFormat:()=>ym,decodeEinsumEquation:()=>cx,eitherStridesOrDilationsAreOne:()=>gm,expandShapeToKeepDim:()=>bg,exponent:()=>rx,exponents:()=>nx,fromStringArrayToUint8:()=>Rx,fromUint8ToStringArray:()=>Ax,getAxesPermutation:()=>xg,getBroadcastDims:()=>sp,getComplexWithIndex:()=>tx,getEinsumComputePath:()=>hx,getEinsumPermutation:()=>lx,getFusedBiasGradient:()=>ib,getFusedDyActivation:()=>ab,getImageCenter:()=>Fw,getInnerMostAxes:()=>_g,getPermuted:()=>Lw,getRaggedRank:()=>Rw,getReductionAxes:()=>cp,getReshaped:()=>Pw,getReshapedPermuted:()=>zw,getRowPartitionTypesHelper:()=>Aw,getSliceBeginCoords:()=>Bw,getSliceSize:()=>jw,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>mx,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>gx,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>yx,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>wx,getSparseReshapeInputOutputMismatchErrorMessage:()=>kx,getSparseReshapeInputOutputMultipleErrorMessage:()=>xx,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>vx,getSparseReshapeNegativeOutputDimErrorMessage:()=>bx,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>Ix,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>_x,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>Sx,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>Tx,getUndoAxesPermutation:()=>kg,isIdentityPermutation:()=>dx,log:()=>gh,mergeRealAndImagArrays:()=>Qw,prepareAndValidate:()=>Uw,prepareSplitSize:()=>px,segment_util:()=>i,shouldFuse:()=>sb,slice_util:()=>r,splitRealAndImagArrays:()=>Jw,tupleValuesAreOne:()=>mm,upcastType:()=>hd,validateDefaultValueShape:()=>Ow,validateInput:()=>Xv,validateUpdateShape:()=>Kv,warn:()=>mh});var s={};n.r(s),n.d(s,{json:()=>hC});var c={};n.r(c),n.d(c,{json:()=>dC});var l={};n.r(l),n.d(l,{json:()=>fC});var u={};n.r(u),n.d(u,{json:()=>pC});var h={};n.r(h),n.d(h,{json:()=>mC});var d={};n.r(d),n.d(d,{json:()=>gC});var f={};n.r(f),n.d(f,{json:()=>yC});var p={};n.r(p),n.d(p,{json:()=>vC});var m={};n.r(m),n.d(m,{json:()=>bC});var g={};n.r(g),n.d(g,{json:()=>wC});var y={};n.r(y),n.d(y,{json:()=>xC});var v={};n.r(v),n.d(v,{json:()=>kC});var b={};n.r(b),n.d(b,{json:()=>_C});var w={};n.r(w),n.d(w,{json:()=>SC});var x={};n.r(x),n.d(x,{json:()=>TC});var k={};n.r(k),n.d(k,{json:()=>IC});var _={};n.r(_),n.d(_,{json:()=>EC});var S={};n.r(S),n.d(S,{json:()=>NC});var T={};n.r(T),n.d(T,{json:()=>CC});var I={};n.r(I),n.d(I,{OP_SCOPE_SUFFIX:()=>Od,abs:()=>Hp,acos:()=>qp,acosh:()=>Kp,add:()=>Xp,addN:()=>Yp,all:()=>Qp,any:()=>Jp,argMax:()=>$p,argMin:()=>Zp,asin:()=>tm,asinh:()=>em,atan:()=>nm,atan2:()=>rm,atanh:()=>am,avgPool:()=>wm,avgPool3d:()=>xm,basicLSTMCell:()=>Nm,batchNorm:()=>Am,batchNorm2d:()=>Rm,batchNorm3d:()=>Om,batchNorm4d:()=>Dm,batchToSpaceND:()=>Cm,bincount:()=>Mm,booleanMaskAsync:()=>Gv,broadcastArgs:()=>Fm,broadcastTo:()=>Pm,buffer:()=>Lf,cast:()=>zf,ceil:()=>Lm,clipByValue:()=>Bm,clone:()=>Bf,complex:()=>Md,concat:()=>km,concat1d:()=>jm,concat2d:()=>Um,concat3d:()=>Vm,concat4d:()=>Wm,conv1d:()=>Hm,conv2d:()=>Gm,conv2dTranspose:()=>Km,conv3d:()=>Xm,conv3dTranspose:()=>Qm,cos:()=>Jm,cosh:()=>$m,cosineWindow:()=>eb,cumprod:()=>Zm,cumsum:()=>tg,denseBincount:()=>eg,depthToSpace:()=>ng,depthwiseConv2d:()=>rg,diag:()=>ag,dilation2d:()=>ig,div:()=>sg,divNoNan:()=>hg,dot:()=>dg,dropout:()=>Zv,einsum:()=>fg,elu:()=>pg,enclosingPowerOfTwo:()=>tb,equal:()=>cg,erf:()=>mg,euclideanNorm:()=>Og,exp:()=>Dg,expandDims:()=>Mg,expm1:()=>Fg,eye:()=>Lg,fft:()=>bv,fill:()=>zm,floor:()=>zg,floorDiv:()=>og,fused:()=>a,gather:()=>Bg,gatherND:()=>$v,greater:()=>jg,greaterEqual:()=>Ug,ifft:()=>wv,imag:()=>Vg,image:()=>uw,inTopKAsync:()=>nb,irfft:()=>xv,isFinite:()=>Wg,isInf:()=>Gg,isNaN:()=>Hg,leakyRelu:()=>qg,less:()=>Kg,lessEqual:()=>Xg,linalg:()=>hw,linspace:()=>Yg,localResponseNormalization:()=>Qg,log:()=>Jg,log1p:()=>$g,logSigmoid:()=>ey,logSoftmax:()=>ry,logSumExp:()=>ay,logicalAnd:()=>iy,logicalNot:()=>oy,logicalOr:()=>sy,logicalXor:()=>cy,losses:()=>dw,lowerBound:()=>hy,matMul:()=>_m,max:()=>Sg,maxPool:()=>dy,maxPool3d:()=>fy,maxPoolWithArgmax:()=>py,maximum:()=>my,mean:()=>gy,meshgrid:()=>by,min:()=>Tg,minimum:()=>wy,mirrorPad:()=>xy,mod:()=>ky,moments:()=>_y,movingAverage:()=>qv,mul:()=>Sm,multiRNNCell:()=>Sy,multinomial:()=>Ty,neg:()=>Zg,norm:()=>Rg,notEqual:()=>Iy,oneHot:()=>Ey,ones:()=>vy,onesLike:()=>Ny,op:()=>Dd,outerProduct:()=>Cy,pad:()=>Ay,pad1d:()=>Ry,pad2d:()=>Oy,pad3d:()=>Dy,pad4d:()=>My,pool:()=>Py,pow:()=>Ig,prelu:()=>Ly,print:()=>jf,prod:()=>zy,raggedGather:()=>By,raggedTensorToTensor:()=>jy,rand:()=>Uy,randomGamma:()=>qy,randomNormal:()=>Ky,randomStandardNormal:()=>Xy,randomUniform:()=>Yy,range:()=>Qy,real:()=>Jy,reciprocal:()=>$y,relu:()=>Zy,relu6:()=>tv,reshape:()=>bm,reverse:()=>ev,reverse1d:()=>nv,reverse2d:()=>rv,reverse3d:()=>av,reverse4d:()=>iv,rfft:()=>_v,round:()=>ov,rsqrt:()=>sv,scalar:()=>Wp,scatterND:()=>Qv,searchSorted:()=>uy,selu:()=>cv,separableConv2d:()=>lv,setdiff1dAsync:()=>uv,sigmoid:()=>Tm,sign:()=>hv,signal:()=>lw,sin:()=>dv,sinh:()=>fv,slice:()=>Im,slice1d:()=>pv,slice2d:()=>mv,slice3d:()=>gv,slice4d:()=>yv,softmax:()=>vv,softplus:()=>ty,spaceToBatchND:()=>Fy,sparse:()=>fw,sparseToDense:()=>Jv,spectral:()=>cw,split:()=>kv,sqrt:()=>Eg,square:()=>Ng,squaredDifference:()=>Sv,squeeze:()=>Tv,stack:()=>Iv,step:()=>Ev,stridedSlice:()=>Nv,string:()=>pw,sub:()=>ny,sum:()=>Cg,tan:()=>Cv,tanh:()=>Em,tensor:()=>Pd,tensor1d:()=>Av,tensor2d:()=>Rv,tensor3d:()=>up,tensor4d:()=>Ov,tensor5d:()=>Dv,tensor6d:()=>Mv,tile:()=>Pg,topk:()=>Fv,transpose:()=>Hv,truncatedNormal:()=>Pv,unique:()=>Lv,unsortedSegmentSum:()=>zv,unstack:()=>Bv,upperBound:()=>jv,variable:()=>Uv,where:()=>lg,whereAsync:()=>Wv,zeros:()=>yy,zerosLike:()=>ug});var E={};n.r(E),n.d(E,{mx:()=>NR,XI:()=>wO,Nk:()=>xO,ct:()=>_R,YG:()=>SO,hH:()=>AO,z3:()=>fD,sG:()=>SD,uM:()=>CD,vS:()=>qD,qB:()=>tM,GG:()=>nM,lg:()=>sM,rq:()=>aM,cu:()=>wM,WR:()=>yM,GE:()=>_M,px:()=>TM,jC:()=>jM,He:()=>WM,hE:()=>ZM,BF:()=>iD,Dk:()=>lF,cl:()=>yF,_B:()=>AF,ub:()=>FF,Ku:()=>UF,qy:()=>WF,Zy:()=>eP,bu:()=>aP,zv:()=>pR,dH:()=>LR,HS:()=>gO,yH:()=>SP,l3:()=>IP,z9:()=>NP,x6:()=>DP,eW:()=>VP,GK:()=>HP,SP:()=>XP,f6:()=>QP,dl:()=>FD,Dw:()=>eL,xT:()=>iL,_X:()=>GR,wz:()=>dL});var N,C=n(5043),A=n.t(C,2),R=n(4391),O=n(7950),D=n.t(O,2);function M(){return M=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},M.apply(this,arguments)}!function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"}(N||(N={}));const F="popstate";function P(t,e){if(!1===t||null===t||"undefined"===typeof t)throw new Error(e)}function L(t,e){if(!t){"undefined"!==typeof console&&console.warn(e);try{throw new Error(e)}catch(n){}}}function z(t,e){return{usr:t.state,key:t.key,idx:e}}function B(t,e,n,r){return void 0===n&&(n=null),M({pathname:"string"===typeof t?t:t.pathname,search:"",hash:""},"string"===typeof e?U(e):e,{state:n,key:e&&e.key||r||Math.random().toString(36).substr(2,8)})}function j(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&"?"!==n&&(e+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(e+="#"===r.charAt(0)?r:"#"+r),e}function U(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function V(t,e,n,r){void 0===r&&(r={});let{window:a=document.defaultView,v5Compat:i=!1}=r,o=a.history,s=N.Pop,c=null,l=u();function u(){return(o.state||{idx:null}).idx}function h(){s=N.Pop;let t=u(),e=null==t?null:t-l;l=t,c&&c({action:s,location:f.location,delta:e})}function d(t){let e="null"!==a.location.origin?a.location.origin:a.location.href,n="string"===typeof t?t:j(t);return n=n.replace(/ $/,"%20"),P(e,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,e)}null==l&&(l=0,o.replaceState(M({},o.state,{idx:l}),""));let f={get action(){return s},get location(){return t(a,o)},listen(t){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(F,h),c=t,()=>{a.removeEventListener(F,h),c=null}},createHref:t=>e(a,t),createURL:d,encodeLocation(t){let e=d(t);return{pathname:e.pathname,search:e.search,hash:e.hash}},push:function(t,e){s=N.Push;let r=B(f.location,t,e);n&&n(r,t),l=u()+1;let h=z(r,l),d=f.createHref(r);try{o.pushState(h,"",d)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;a.location.assign(d)}i&&c&&c({action:s,location:f.location,delta:1})},replace:function(t,e){s=N.Replace;let r=B(f.location,t,e);n&&n(r,t),l=u();let a=z(r,l),h=f.createHref(r);o.replaceState(a,"",h),i&&c&&c({action:s,location:f.location,delta:0})},go:t=>o.go(t)};return f}var W;!function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"}(W||(W={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function G(t,e,n){return void 0===n&&(n="/"),H(t,e,n,!1)}function H(t,e,n,r){let a=it(("string"===typeof e?U(e):e).pathname||"/",n);if(null==a)return null;let i=q(t);!function(t){t.sort((t,e)=>t.score!==e.score?e.score-t.score:function(t,e){let n=t.length===e.length&&t.slice(0,-1).every((t,n)=>t===e[n]);return n?t[t.length-1]-e[e.length-1]:0}(t.routesMeta.map(t=>t.childrenIndex),e.routesMeta.map(t=>t.childrenIndex)))}(i);let o=null;for(let s=0;null==o&&s<i.length;++s){let t=at(a);o=nt(i[s],t,r)}return o}function q(t,e,n,r){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r="");let a=(t,a,i)=>{let o={relativePath:void 0===i?t.path||"":i,caseSensitive:!0===t.caseSensitive,childrenIndex:a,route:t};o.relativePath.startsWith("/")&&(P(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));let s=ut([r,o.relativePath]),c=n.concat(o);t.children&&t.children.length>0&&(P(!0!==t.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),q(t.children,e,c,s)),(null!=t.path||t.index)&&e.push({path:s,score:et(s,t.index),routesMeta:c})};return t.forEach((t,e)=>{var n;if(""!==t.path&&null!=(n=t.path)&&n.includes("?"))for(let r of K(t.path))a(t,e,r);else a(t,e)}),e}function K(t){let e=t.split("/");if(0===e.length)return[];let[n,...r]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return a?[i,""]:[i];let o=K(r.join("/")),s=[];return s.push(...o.map(t=>""===t?i:[i,t].join("/"))),a&&s.push(...o),s.map(e=>t.startsWith("/")&&""===e?"/":e)}const X=/^:[\w-]+$/,Y=3,Q=2,J=1,$=10,Z=-2,tt=t=>"*"===t;function et(t,e){let n=t.split("/"),r=n.length;return n.some(tt)&&(r+=Z),e&&(r+=Q),n.filter(t=>!tt(t)).reduce((t,e)=>t+(X.test(e)?Y:""===e?J:$),r)}function nt(t,e,n){void 0===n&&(n=!1);let{routesMeta:r}=t,a={},i="/",o=[];for(let s=0;s<r.length;++s){let t=r[s],c=s===r.length-1,l="/"===i?e:e.slice(i.length)||"/",u=rt({path:t.relativePath,caseSensitive:t.caseSensitive,end:c},l),h=t.route;if(!u&&c&&n&&!r[r.length-1].route.index&&(u=rt({path:t.relativePath,caseSensitive:t.caseSensitive,end:!1},l)),!u)return null;Object.assign(a,u.params),o.push({params:a,pathname:ut([i,u.pathname]),pathnameBase:ht(ut([i,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(i=ut([i,u.pathnameBase]))}return o}function rt(t,e){"string"===typeof t&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=function(t,e,n){void 0===e&&(e=!1);void 0===n&&(n=!0);L("*"===t||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were "'+t.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+t.replace(/\*$/,"/*")+'".');let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(t,e,n)=>(r.push({paramName:e,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)"));t.endsWith("*")?(r.push({paramName:"*"}),a+="*"===t||"/*"===t?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==t&&"/"!==t&&(a+="(?:(?=\\/|$))");let i=new RegExp(a,e?void 0:"i");return[i,r]}(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((t,e,n)=>{let{paramName:r,isOptional:a}=e;if("*"===r){let t=s[n]||"";o=i.slice(0,i.length-t.length).replace(/(.)\/+$/,"$1")}const c=s[n];return t[r]=a&&!c?void 0:(c||"").replace(/%2F/g,"/"),t},{}),pathname:i,pathnameBase:o,pattern:t}}function at(t){try{return t.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(e){return L(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+e+")."),t}}function it(t,e){if("/"===e)return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&"/"!==r?null:t.slice(n)||"/"}function ot(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified `to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function st(t){return t.filter((t,e)=>0===e||t.route.path&&t.route.path.length>0)}function ct(t,e){let n=st(t);return e?n.map((t,e)=>e===n.length-1?t.pathname:t.pathnameBase):n.map(t=>t.pathnameBase)}function lt(t,e,n,r){let a;void 0===r&&(r=!1),"string"===typeof t?a=U(t):(a=M({},t),P(!a.pathname||!a.pathname.includes("?"),ot("?","pathname","search",a)),P(!a.pathname||!a.pathname.includes("#"),ot("#","pathname","hash",a)),P(!a.search||!a.search.includes("#"),ot("#","search","hash",a)));let i,o=""===t||""===a.pathname,s=o?"/":a.pathname;if(null==s)i=n;else{let t=e.length-1;if(!r&&s.startsWith("..")){let e=s.split("/");for(;".."===e[0];)e.shift(),t-=1;a.pathname=e.join("/")}i=t>=0?e[t]:"/"}let c=function(t,e){void 0===e&&(e="/");let{pathname:n,search:r="",hash:a=""}="string"===typeof t?U(t):t,i=n?n.startsWith("/")?n:function(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(t=>{".."===t?n.length>1&&n.pop():"."!==t&&n.push(t)}),n.length>1?n.join("/"):"/"}(n,e):e;return{pathname:i,search:dt(r),hash:ft(a)}}(a,i),l=s&&"/"!==s&&s.endsWith("/"),u=(o||"."===s)&&n.endsWith("/");return c.pathname.endsWith("/")||!l&&!u||(c.pathname+="/"),c}const ut=t=>t.join("/").replace(/\/\/+/g,"/"),ht=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),dt=t=>t&&"?"!==t?t.startsWith("?")?t:"?"+t:"",ft=t=>t&&"#"!==t?t.startsWith("#")?t:"#"+t:"";Error;function pt(t){return null!=t&&"number"===typeof t.status&&"string"===typeof t.statusText&&"boolean"===typeof t.internal&&"data"in t}const mt=["post","put","patch","delete"],gt=(new Set(mt),["get",...mt]);new Set(gt),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function yt(){return yt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yt.apply(this,arguments)}const vt=C.createContext(null);const bt=C.createContext(null);const wt=C.createContext(null);const xt=C.createContext(null);const kt=C.createContext({outlet:null,matches:[],isDataRoute:!1});const _t=C.createContext(null);function St(){return null!=C.useContext(xt)}function Tt(){return St()||P(!1),C.useContext(xt).location}function It(t){C.useContext(wt).static||C.useLayoutEffect(t)}function Et(){let{isDataRoute:t}=C.useContext(kt);return t?function(){let{router:t}=Lt(Ft.UseNavigateStable),e=Bt(Pt.UseNavigateStable),n=C.useRef(!1);return It(()=>{n.current=!0}),C.useCallback(function(r,a){void 0===a&&(a={}),n.current&&("number"===typeof r?t.navigate(r):t.navigate(r,yt({fromRouteId:e},a)))},[t,e])}():function(){St()||P(!1);let t=C.useContext(vt),{basename:e,future:n,navigator:r}=C.useContext(wt),{matches:a}=C.useContext(kt),{pathname:i}=Tt(),o=JSON.stringify(ct(a,n.v7_relativeSplatPath)),s=C.useRef(!1);It(()=>{s.current=!0});let c=C.useCallback(function(n,a){if(void 0===a&&(a={}),!s.current)return;if("number"===typeof n)return void r.go(n);let c=lt(n,JSON.parse(o),i,"path"===a.relative);null==t&&"/"!==e&&(c.pathname="/"===c.pathname?e:ut([e,c.pathname])),(a.replace?r.replace:r.push)(c,a.state,a)},[e,r,o,i,t]);return c}()}function Nt(t,e){let{relative:n}=void 0===e?{}:e,{future:r}=C.useContext(wt),{matches:a}=C.useContext(kt),{pathname:i}=Tt(),o=JSON.stringify(ct(a,r.v7_relativeSplatPath));return C.useMemo(()=>lt(t,JSON.parse(o),i,"path"===n),[t,o,i,n])}function Ct(t,e,n,r){St()||P(!1);let{navigator:a}=C.useContext(wt),{matches:i}=C.useContext(kt),o=i[i.length-1],s=o?o.params:{},c=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let l,u=Tt();if(e){var h;let t="string"===typeof e?U(e):e;"/"===c||(null==(h=t.pathname)?void 0:h.startsWith(c))||P(!1),l=t}else l=u;let d=l.pathname||"/",f=d;if("/"!==c){let t=c.replace(/^\//,"").split("/");f="/"+d.replace(/^\//,"").split("/").slice(t.length).join("/")}let p=G(t,{pathname:f});let m=Mt(p&&p.map(t=>Object.assign({},t,{params:Object.assign({},s,t.params),pathname:ut([c,a.encodeLocation?a.encodeLocation(t.pathname).pathname:t.pathname]),pathnameBase:"/"===t.pathnameBase?c:ut([c,a.encodeLocation?a.encodeLocation(t.pathnameBase).pathname:t.pathnameBase])})),i,n,r);return e&&m?C.createElement(xt.Provider,{value:{location:yt({pathname:"/",search:"",hash:"",state:null,key:"default"},l),navigationType:N.Pop}},m):m}function At(){let t=function(){var t;let e=C.useContext(_t),n=zt(Pt.UseRouteError),r=Bt(Pt.UseRouteError);if(void 0!==e)return e;return null==(t=n.errors)?void 0:t[r]}(),e=pt(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),n?C.createElement("pre",{style:a},n):null,null)}const Rt=C.createElement(At,null);class Ot extends C.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||"idle"!==e.revalidation&&"idle"===t.revalidation?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:void 0!==t.error?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return void 0!==this.state.error?C.createElement(kt.Provider,{value:this.props.routeContext},C.createElement(_t.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Dt(t){let{routeContext:e,match:n,children:r}=t,a=C.useContext(vt);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),C.createElement(kt.Provider,{value:e},r)}function Mt(t,e,n,r){var a;if(void 0===e&&(e=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==t){var i;if(!n)return null;if(n.errors)t=n.matches;else{if(!(null!=(i=r)&&i.v7_partialHydration&&0===e.length&&!n.initialized&&n.matches.length>0))return null;t=n.matches}}let o=t,s=null==(a=n)?void 0:a.errors;if(null!=s){let t=o.findIndex(t=>t.route.id&&void 0!==(null==s?void 0:s[t.route.id]));t>=0||P(!1),o=o.slice(0,Math.min(o.length,t+1))}let c=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let u=0;u<o.length;u++){let t=o[u];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(l=u),t.route.id){let{loaderData:e,errors:r}=n,a=t.route.loader&&void 0===e[t.route.id]&&(!r||void 0===r[t.route.id]);if(t.route.lazy||a){c=!0,o=l>=0?o.slice(0,l+1):[o[0]];break}}}return o.reduceRight((t,r,a)=>{let i,u=!1,h=null,d=null;var f;n&&(i=s&&r.route.id?s[r.route.id]:void 0,h=r.route.errorElement||Rt,c&&(l<0&&0===a?(f="route-fallback",!1||jt[f]||(jt[f]=!0),u=!0,d=null):l===a&&(u=!0,d=r.route.hydrateFallbackElement||null)));let p=e.concat(o.slice(0,a+1)),m=()=>{let e;return e=i?h:u?d:r.route.Component?C.createElement(r.route.Component,null):r.route.element?r.route.element:t,C.createElement(Dt,{match:r,routeContext:{outlet:t,matches:p,isDataRoute:null!=n},children:e})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===a)?C.createElement(Ot,{location:n.location,revalidation:n.revalidation,component:h,error:i,children:m(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):m()},null)}var Ft=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Ft||{}),Pt=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Pt||{});function Lt(t){let e=C.useContext(vt);return e||P(!1),e}function zt(t){let e=C.useContext(bt);return e||P(!1),e}function Bt(t){let e=function(){let t=C.useContext(kt);return t||P(!1),t}(),n=e.matches[e.matches.length-1];return n.route.id||P(!1),n.route.id}const jt={};function Ut(t,e){null==t||t.v7_startTransition,void 0===(null==t?void 0:t.v7_relativeSplatPath)&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}A.startTransition;function Vt(t){P(!1)}function Wt(t){let{basename:e="/",children:n=null,location:r,navigationType:a=N.Pop,navigator:i,static:o=!1,future:s}=t;St()&&P(!1);let c=e.replace(/^\/*/,"/"),l=C.useMemo(()=>({basename:c,navigator:i,static:o,future:yt({v7_relativeSplatPath:!1},s)}),[c,s,i,o]);"string"===typeof r&&(r=U(r));let{pathname:u="/",search:h="",hash:d="",state:f=null,key:p="default"}=r,m=C.useMemo(()=>{let t=it(u,c);return null==t?null:{location:{pathname:t,search:h,hash:d,state:f,key:p},navigationType:a}},[c,u,h,d,f,p,a]);return null==m?null:C.createElement(wt.Provider,{value:l},C.createElement(xt.Provider,{children:n,value:m}))}function Gt(t){let{children:e,location:n}=t;return Ct(Ht(e),n)}new Promise(()=>{});C.Component;function Ht(t,e){void 0===e&&(e=[]);let n=[];return C.Children.forEach(t,(t,r)=>{if(!C.isValidElement(t))return;let a=[...e,r];if(t.type===C.Fragment)return void n.push.apply(n,Ht(t.props.children,a));t.type!==Vt&&P(!1),t.props.index&&t.props.children&&P(!1);let i={id:t.props.id||a.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(i.children=Ht(t.props.children,a)),n.push(i)}),n}function qt(){return qt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qt.apply(this,arguments)}function Kt(t,e){if(null==t)return{};var n,r,a={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Xt=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(Grt){}new Map;const Yt=A.startTransition;D.flushSync,A.useId;function Qt(t){let{basename:e,children:n,future:r,window:a}=t,i=C.useRef();var o;null==i.current&&(i.current=(void 0===(o={window:a,v5Compat:!0})&&(o={}),V(function(t,e){let{pathname:n,search:r,hash:a}=t.location;return B("",{pathname:n,search:r,hash:a},e.state&&e.state.usr||null,e.state&&e.state.key||"default")},function(t,e){return"string"===typeof e?e:j(e)},null,o)));let s=i.current,[c,l]=C.useState({action:s.action,location:s.location}),{v7_startTransition:u}=r||{},h=C.useCallback(t=>{u&&Yt?Yt(()=>l(t)):l(t)},[l,u]);return C.useLayoutEffect(()=>s.listen(h),[s,h]),C.useEffect(()=>Ut(r),[r]),C.createElement(Wt,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:s,future:r})}const Jt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,$t=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zt=C.forwardRef(function(t,e){let n,{onClick:r,relative:a,reloadDocument:i,replace:o,state:s,target:c,to:l,preventScrollReset:u,viewTransition:h}=t,d=Kt(t,Xt),{basename:f}=C.useContext(wt),p=!1;if("string"===typeof l&&$t.test(l)&&(n=l,Jt))try{let t=new URL(window.location.href),e=l.startsWith("//")?new URL(t.protocol+l):new URL(l),n=it(e.pathname,f);e.origin===t.origin&&null!=n?l=n+e.search+e.hash:p=!0}catch(Grt){}let m=function(t,e){let{relative:n}=void 0===e?{}:e;St()||P(!1);let{basename:r,navigator:a}=C.useContext(wt),{hash:i,pathname:o,search:s}=Nt(t,{relative:n}),c=o;return"/"!==r&&(c="/"===o?r:ut([r,o])),a.createHref({pathname:c,search:s,hash:i})}(l,{relative:a}),g=function(t,e){let{target:n,replace:r,state:a,preventScrollReset:i,relative:o,viewTransition:s}=void 0===e?{}:e,c=Et(),l=Tt(),u=Nt(t,{relative:o});return C.useCallback(e=>{if(function(t,e){return 0===t.button&&(!e||"_self"===e)&&!function(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}(t)}(e,n)){e.preventDefault();let n=void 0!==r?r:j(l)===j(u);c(t,{replace:n,state:a,preventScrollReset:i,relative:o,viewTransition:s})}},[l,c,u,r,a,n,t,i,o,s])}(l,{replace:o,state:s,target:c,preventScrollReset:u,relative:a,viewTransition:h});return C.createElement("a",qt({},d,{href:n||m,onClick:p||i?r:function(t){r&&r(t),t.defaultPrevented||g(t)},ref:e,target:c}))});var te,ee;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(te||(te={})),function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"}(ee||(ee={}));function ne(t){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ne(t)}function re(t){var e=function(t,e){if("object"!=ne(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=ne(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==ne(e)?e:e+""}function ae(t,e,n){return(e=re(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ie(Object(n),!0).forEach(function(e){ae(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function se(t,e){return function(){return t.apply(e,arguments)}}const{toString:ce}=Object.prototype,{getPrototypeOf:le}=Object,{iterator:ue,toStringTag:he}=Symbol,de=(fe=Object.create(null),t=>{const e=ce.call(t);return fe[e]||(fe[e]=e.slice(8,-1).toLowerCase())});var fe;const pe=t=>(t=t.toLowerCase(),e=>de(e)===t),me=t=>e=>typeof e===t,{isArray:ge}=Array,ye=me("undefined");const ve=pe("ArrayBuffer");const be=me("string"),we=me("function"),xe=me("number"),ke=t=>null!==t&&"object"===typeof t,_e=t=>{if("object"!==de(t))return!1;const e=le(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(he in t)&&!(ue in t)},Se=pe("Date"),Te=pe("File"),Ie=pe("Blob"),Ee=pe("FileList"),Ne=pe("URLSearchParams"),[Ce,Ae,Re,Oe]=["ReadableStream","Request","Response","Headers"].map(pe);function De(t,e){let n,r,{allOwnKeys:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),ge(t))for(n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else{const r=a?Object.getOwnPropertyNames(t):Object.keys(t),i=r.length;let o;for(n=0;n<i;n++)o=r[n],e.call(null,t[o],o,t)}}function Me(t,e){e=e.toLowerCase();const n=Object.keys(t);let r,a=n.length;for(;a-- >0;)if(r=n[a],e===r.toLowerCase())return r;return null}const Fe="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Pe=t=>!ye(t)&&t!==Fe;const Le=(ze="undefined"!==typeof Uint8Array&&le(Uint8Array),t=>ze&&t instanceof ze);var ze;const Be=pe("HTMLFormElement"),je=(t=>{let{hasOwnProperty:e}=t;return(t,n)=>e.call(t,n)})(Object.prototype),Ue=pe("RegExp"),Ve=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};De(n,(n,a)=>{let i;!1!==(i=e(n,a,t))&&(r[a]=i||n)}),Object.defineProperties(t,r)};const We=pe("AsyncFunction"),Ge=(He="function"===typeof setImmediate,qe=we(Fe.postMessage),He?setImmediate:qe?((t,e)=>(Fe.addEventListener("message",n=>{let{source:r,data:a}=n;r===Fe&&a===t&&e.length&&e.shift()()},!1),n=>{e.push(n),Fe.postMessage(t,"*")}))("axios@".concat(Math.random()),[]):t=>setTimeout(t));var He,qe;const Ke="undefined"!==typeof queueMicrotask?queueMicrotask.bind(Fe):"undefined"!==typeof process&&process.nextTick||Ge,Xe={isArray:ge,isArrayBuffer:ve,isBuffer:function(t){return null!==t&&!ye(t)&&null!==t.constructor&&!ye(t.constructor)&&we(t.constructor.isBuffer)&&t.constructor.isBuffer(t)},isFormData:t=>{let e;return t&&("function"===typeof FormData&&t instanceof FormData||we(t.append)&&("formdata"===(e=de(t))||"object"===e&&we(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&ve(t.buffer),e},isString:be,isNumber:xe,isBoolean:t=>!0===t||!1===t,isObject:ke,isPlainObject:_e,isReadableStream:Ce,isRequest:Ae,isResponse:Re,isHeaders:Oe,isUndefined:ye,isDate:Se,isFile:Te,isBlob:Ie,isRegExp:Ue,isFunction:we,isStream:t=>ke(t)&&we(t.pipe),isURLSearchParams:Ne,isTypedArray:Le,isFileList:Ee,forEach:De,merge:function t(){const{caseless:e}=Pe(this)&&this||{},n={},r=(r,a)=>{const i=e&&Me(n,a)||a;_e(n[i])&&_e(r)?n[i]=t(n[i],r):_e(r)?n[i]=t({},r):ge(r)?n[i]=r.slice():n[i]=r};for(let a=0,i=arguments.length;a<i;a++)arguments[a]&&De(arguments[a],r);return n},extend:function(t,e,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return De(e,(e,r)=>{n&&we(e)?t[r]=se(e,n):t[r]=e},{allOwnKeys:r}),t},trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},toFlatObject:(t,e,n,r)=>{let a,i,o;const s={};if(e=e||{},null==t)return e;do{for(a=Object.getOwnPropertyNames(t),i=a.length;i-- >0;)o=a[i],r&&!r(o,t,e)||s[o]||(e[o]=t[o],s[o]=!0);t=!1!==n&&le(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},kindOf:de,kindOfTest:pe,endsWith:(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return-1!==r&&r===n},toArray:t=>{if(!t)return null;if(ge(t))return t;let e=t.length;if(!xe(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},forEachEntry:(t,e)=>{const n=(t&&t[ue]).call(t);let r;for(;(r=n.next())&&!r.done;){const n=r.value;e.call(t,n[0],n[1])}},matchAll:(t,e)=>{let n;const r=[];for(;null!==(n=t.exec(e));)r.push(n);return r},isHTMLForm:Be,hasOwnProperty:je,hasOwnProp:je,reduceDescriptors:Ve,freezeMethods:t=>{Ve(t,(e,n)=>{if(we(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=t[n];we(r)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(t,e)=>{const n={},r=t=>{t.forEach(t=>{n[t]=!0})};return ge(t)?r(t):r(String(t).split(e)),n},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,e,n){return e.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:Me,global:Fe,isContextDefined:Pe,isSpecCompliantForm:function(t){return!!(t&&we(t.append)&&"FormData"===t[he]&&t[ue])},toJSONObject:t=>{const e=new Array(10),n=(t,r)=>{if(ke(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[r]=t;const a=ge(t)?[]:{};return De(t,(t,e)=>{const i=n(t,r+1);!ye(i)&&(a[e]=i)}),e[r]=void 0,a}}return t};return n(t,0)},isAsyncFn:We,isThenable:t=>t&&(ke(t)||we(t))&&we(t.then)&&we(t.catch),setImmediate:Ge,asap:Ke,isIterable:t=>null!=t&&we(t[ue])};function Ye(t,e,n,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}Xe.inherits(Ye,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Xe.toJSONObject(this.config),code:this.code,status:this.status}}});const Qe=Ye.prototype,Je={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Je[t]={value:t}}),Object.defineProperties(Ye,Je),Object.defineProperty(Qe,"isAxiosError",{value:!0}),Ye.from=(t,e,n,r,a,i)=>{const o=Object.create(Qe);return Xe.toFlatObject(t,o,function(t){return t!==Error.prototype},t=>"isAxiosError"!==t),Ye.call(o,t.message,e,n,r,a),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const $e=Ye;function Ze(t){return Xe.isPlainObject(t)||Xe.isArray(t)}function tn(t){return Xe.endsWith(t,"[]")?t.slice(0,-2):t}function en(t,e,n){return t?t.concat(e).map(function(t,e){return t=tn(t),!n&&e?"["+t+"]":t}).join(n?".":""):e}const nn=Xe.toFlatObject(Xe,{},null,function(t){return/^is[A-Z]/.test(t)});const rn=function(t,e,n){if(!Xe.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const r=(n=Xe.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(t,e){return!Xe.isUndefined(e[t])})).metaTokens,a=n.visitor||l,i=n.dots,o=n.indexes,s=(n.Blob||"undefined"!==typeof Blob&&Blob)&&Xe.isSpecCompliantForm(e);if(!Xe.isFunction(a))throw new TypeError("visitor must be a function");function c(t){if(null===t)return"";if(Xe.isDate(t))return t.toISOString();if(Xe.isBoolean(t))return t.toString();if(!s&&Xe.isBlob(t))throw new $e("Blob is not supported. Use a Buffer instead.");return Xe.isArrayBuffer(t)||Xe.isTypedArray(t)?s&&"function"===typeof Blob?new Blob([t]):Buffer.from(t):t}function l(t,n,a){let s=t;if(t&&!a&&"object"===typeof t)if(Xe.endsWith(n,"{}"))n=r?n:n.slice(0,-2),t=JSON.stringify(t);else if(Xe.isArray(t)&&function(t){return Xe.isArray(t)&&!t.some(Ze)}(t)||(Xe.isFileList(t)||Xe.endsWith(n,"[]"))&&(s=Xe.toArray(t)))return n=tn(n),s.forEach(function(t,r){!Xe.isUndefined(t)&&null!==t&&e.append(!0===o?en([n],r,i):null===o?n:n+"[]",c(t))}),!1;return!!Ze(t)||(e.append(en(a,n,i),c(t)),!1)}const u=[],h=Object.assign(nn,{defaultVisitor:l,convertValue:c,isVisitable:Ze});if(!Xe.isObject(t))throw new TypeError("data must be an object");return function t(n,r){if(!Xe.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),Xe.forEach(n,function(n,i){!0===(!(Xe.isUndefined(n)||null===n)&&a.call(e,n,Xe.isString(i)?i.trim():i,r,h))&&t(n,r?r.concat(i):[i])}),u.pop()}}(t),e};function an(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(t){return e[t]})}function on(t,e){this._pairs=[],t&&rn(t,this,e)}const sn=on.prototype;sn.append=function(t,e){this._pairs.push([t,e])},sn.toString=function(t){const e=t?function(e){return t.call(this,e,an)}:an;return this._pairs.map(function(t){return e(t[0])+"="+e(t[1])},"").join("&")};const cn=on;function ln(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function un(t,e,n){if(!e)return t;const r=n&&n.encode||ln;Xe.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let i;if(i=a?a(e,n):Xe.isURLSearchParams(e)?e.toString():new cn(e,n).toString(r),i){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+i}return t}const hn=class{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Xe.forEach(this.handlers,function(e){null!==e&&t(e)})}},dn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},fn={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:cn,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},pn="undefined"!==typeof window&&"undefined"!==typeof document,mn="object"===typeof navigator&&navigator||void 0,gn=pn&&(!mn||["ReactNative","NativeScript","NS"].indexOf(mn.product)<0),yn="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,vn=pn&&window.location.href||"http://localhost",bn=oe(oe({},t),fn);const wn=function(t){function e(t,n,r,a){let i=t[a++];if("__proto__"===i)return!0;const o=Number.isFinite(+i),s=a>=t.length;if(i=!i&&Xe.isArray(r)?r.length:i,s)return Xe.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!o;r[i]&&Xe.isObject(r[i])||(r[i]=[]);return e(t,n,r[i],a)&&Xe.isArray(r[i])&&(r[i]=function(t){const e={},n=Object.keys(t);let r;const a=n.length;let i;for(r=0;r<a;r++)i=n[r],e[i]=t[i];return e}(r[i])),!o}if(Xe.isFormData(t)&&Xe.isFunction(t.entries)){const n={};return Xe.forEachEntry(t,(t,r)=>{e(function(t){return Xe.matchAll(/\w+|\[(\w*)]/g,t).map(t=>"[]"===t[0]?"":t[1]||t[0])}(t),r,n,0)}),n}return null};const xn={transitional:dn,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const n=e.getContentType()||"",r=n.indexOf("application/json")>-1,a=Xe.isObject(t);a&&Xe.isHTMLForm(t)&&(t=new FormData(t));if(Xe.isFormData(t))return r?JSON.stringify(wn(t)):t;if(Xe.isArrayBuffer(t)||Xe.isBuffer(t)||Xe.isStream(t)||Xe.isFile(t)||Xe.isBlob(t)||Xe.isReadableStream(t))return t;if(Xe.isArrayBufferView(t))return t.buffer;if(Xe.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let i;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return rn(t,new bn.classes.URLSearchParams,Object.assign({visitor:function(t,e,n,r){return bn.isNode&&Xe.isBuffer(t)?(this.append(e,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},e))}(t,this.formSerializer).toString();if((i=Xe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return rn(i?{"files[]":t}:t,e&&new e,this.formSerializer)}}return a||r?(e.setContentType("application/json",!1),function(t,e,n){if(Xe.isString(t))try{return(e||JSON.parse)(t),Xe.trim(t)}catch(Grt){if("SyntaxError"!==Grt.name)throw Grt}return(n||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||xn.transitional,n=e&&e.forcedJSONParsing,r="json"===this.responseType;if(Xe.isResponse(t)||Xe.isReadableStream(t))return t;if(t&&Xe.isString(t)&&(n&&!this.responseType||r)){const n=!(e&&e.silentJSONParsing)&&r;try{return JSON.parse(t)}catch(Grt){if(n){if("SyntaxError"===Grt.name)throw $e.from(Grt,$e.ERR_BAD_RESPONSE,this,null,this.response);throw Grt}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:bn.classes.FormData,Blob:bn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Xe.forEach(["delete","get","head","post","put","patch"],t=>{xn.headers[t]={}});const kn=xn,_n=Xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Sn=Symbol("internals");function Tn(t){return t&&String(t).trim().toLowerCase()}function In(t){return!1===t||null==t?t:Xe.isArray(t)?t.map(In):String(t)}function En(t,e,n,r,a){return Xe.isFunction(r)?r.call(this,e,n):(a&&(e=n),Xe.isString(e)?Xe.isString(r)?-1!==e.indexOf(r):Xe.isRegExp(r)?r.test(e):void 0:void 0)}class Nn{constructor(t){t&&this.set(t)}set(t,e,n){const r=this;function a(t,e,n){const a=Tn(e);if(!a)throw new Error("header name must be a non-empty string");const i=Xe.findKey(r,a);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||e]=In(t))}const i=(t,e)=>Xe.forEach(t,(t,n)=>a(t,n,e));if(Xe.isPlainObject(t)||t instanceof this.constructor)i(t,e);else if(Xe.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))i((t=>{const e={};let n,r,a;return t&&t.split("\n").forEach(function(t){a=t.indexOf(":"),n=t.substring(0,a).trim().toLowerCase(),r=t.substring(a+1).trim(),!n||e[n]&&_n[n]||("set-cookie"===n?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e})(t),e);else if(Xe.isObject(t)&&Xe.isIterable(t)){let n,r,a={};for(const e of t){if(!Xe.isArray(e))throw TypeError("Object iterator must return a key-value pair");a[r=e[0]]=(n=a[r])?Xe.isArray(n)?[...n,e[1]]:[n,e[1]]:e[1]}i(a,e)}else null!=t&&a(e,t,n);return this}get(t,e){if(t=Tn(t)){const n=Xe.findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}(t);if(Xe.isFunction(e))return e.call(this,t,n);if(Xe.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Tn(t)){const n=Xe.findKey(this,t);return!(!n||void 0===this[n]||e&&!En(0,this[n],n,e))}return!1}delete(t,e){const n=this;let r=!1;function a(t){if(t=Tn(t)){const a=Xe.findKey(n,t);!a||e&&!En(0,n[a],a,e)||(delete n[a],r=!0)}}return Xe.isArray(t)?t.forEach(a):a(t),r}clear(t){const e=Object.keys(this);let n=e.length,r=!1;for(;n--;){const a=e[n];t&&!En(0,this[a],a,t,!0)||(delete this[a],r=!0)}return r}normalize(t){const e=this,n={};return Xe.forEach(this,(r,a)=>{const i=Xe.findKey(n,a);if(i)return e[i]=In(r),void delete e[a];const o=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}(a):String(a).trim();o!==a&&delete e[a],e[o]=In(r),n[o]=!0}),this}concat(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.constructor.concat(this,...e)}toJSON(t){const e=Object.create(null);return Xe.forEach(this,(n,r)=>{null!=n&&!1!==n&&(e[r]=t&&Xe.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(t=>{let[e,n]=t;return e+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t){const e=new this(t);for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.forEach(t=>e.set(t)),e}static accessor(t){const e=(this[Sn]=this[Sn]={accessors:{}}).accessors,n=this.prototype;function r(t){const r=Tn(t);e[r]||(!function(t,e){const n=Xe.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(t,n,a){return this[r].call(this,e,t,n,a)},configurable:!0})})}(n,t),e[r]=!0)}return Xe.isArray(t)?t.forEach(r):r(t),this}}Nn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Xe.reduceDescriptors(Nn.prototype,(t,e)=>{let{value:n}=t,r=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(t){this[r]=t}}}),Xe.freezeMethods(Nn);const Cn=Nn;function An(t,e){const n=this||kn,r=e||n,a=Cn.from(r.headers);let i=r.data;return Xe.forEach(t,function(t){i=t.call(n,i,a.normalize(),e?e.status:void 0)}),a.normalize(),i}function Rn(t){return!(!t||!t.__CANCEL__)}function On(t,e,n){$e.call(this,null==t?"canceled":t,$e.ERR_CANCELED,e,n),this.name="CanceledError"}Xe.inherits(On,$e,{__CANCEL__:!0});const Dn=On;function Mn(t,e,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?e(new $e("Request failed with status code "+n.status,[$e.ERR_BAD_REQUEST,$e.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}const Fn=function(t,e){t=t||10;const n=new Array(t),r=new Array(t);let a,i=0,o=0;return e=void 0!==e?e:1e3,function(s){const c=Date.now(),l=r[o];a||(a=c),n[i]=s,r[i]=c;let u=o,h=0;for(;u!==i;)h+=n[u++],u%=t;if(i=(i+1)%t,i===o&&(o=(o+1)%t),c-a<e)return;const d=l&&c-l;return d?Math.round(1e3*h/d):void 0}};const Pn=function(t,e){let n,r,a=0,i=1e3/e;const o=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();a=i,n=null,r&&(clearTimeout(r),r=null),t.apply(null,e)};return[function(){const t=Date.now(),e=t-a;for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];e>=i?o(c,t):(n=c,r||(r=setTimeout(()=>{r=null,o(n)},i-e)))},()=>n&&o(n)]},Ln=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const a=Fn(50,250);return Pn(n=>{const i=n.loaded,o=n.lengthComputable?n.total:void 0,s=i-r,c=a(s);r=i;t({loaded:i,total:o,progress:o?i/o:void 0,bytes:s,rate:c||void 0,estimated:c&&o&&i<=o?(o-i)/c:void 0,event:n,lengthComputable:null!=o,[e?"download":"upload"]:!0})},n)},zn=(t,e)=>{const n=null!=t;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},Bn=t=>function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Xe.asap(()=>t(...n))},jn=bn.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,bn.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(bn.origin),bn.navigator&&/(msie|trident)/i.test(bn.navigator.userAgent)):()=>!0,Un=bn.hasStandardBrowserEnv?{write(t,e,n,r,a,i){const o=[t+"="+encodeURIComponent(e)];Xe.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Xe.isString(r)&&o.push("path="+r),Xe.isString(a)&&o.push("domain="+a),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Vn(t,e,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);return t&&(r||0==n)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const Wn=t=>t instanceof Cn?oe({},t):t;function Gn(t,e){e=e||{};const n={};function r(t,e,n,r){return Xe.isPlainObject(t)&&Xe.isPlainObject(e)?Xe.merge.call({caseless:r},t,e):Xe.isPlainObject(e)?Xe.merge({},e):Xe.isArray(e)?e.slice():e}function a(t,e,n,a){return Xe.isUndefined(e)?Xe.isUndefined(t)?void 0:r(void 0,t,0,a):r(t,e,0,a)}function i(t,e){if(!Xe.isUndefined(e))return r(void 0,e)}function o(t,e){return Xe.isUndefined(e)?Xe.isUndefined(t)?void 0:r(void 0,t):r(void 0,e)}function s(n,a,i){return i in e?r(n,a):i in t?r(void 0,n):void 0}const c={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(t,e,n)=>a(Wn(t),Wn(e),0,!0)};return Xe.forEach(Object.keys(Object.assign({},t,e)),function(r){const i=c[r]||a,o=i(t[r],e[r],r);Xe.isUndefined(o)&&i!==s||(n[r]=o)}),n}const Hn=t=>{const e=Gn({},t);let n,{data:r,withXSRFToken:a,xsrfHeaderName:i,xsrfCookieName:o,headers:s,auth:c}=e;if(e.headers=s=Cn.from(s),e.url=un(Vn(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&s.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),Xe.isFormData(r))if(bn.hasStandardBrowserEnv||bn.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(!1!==(n=s.getContentType())){const[t,...e]=n?n.split(";").map(t=>t.trim()).filter(Boolean):[];s.setContentType([t||"multipart/form-data",...e].join("; "))}if(bn.hasStandardBrowserEnv&&(a&&Xe.isFunction(a)&&(a=a(e)),a||!1!==a&&jn(e.url))){const t=i&&o&&Un.read(o);t&&s.set(i,t)}return e},qn="undefined"!==typeof XMLHttpRequest&&function(t){return new Promise(function(e,n){const r=Hn(t);let a=r.data;const i=Cn.from(r.headers).normalize();let o,s,c,l,u,{responseType:h,onUploadProgress:d,onDownloadProgress:f}=r;function p(){l&&l(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(o),r.signal&&r.signal.removeEventListener("abort",o)}let m=new XMLHttpRequest;function g(){if(!m)return;const r=Cn.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());Mn(function(t){e(t),p()},function(t){n(t),p()},{data:h&&"text"!==h&&"json"!==h?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:t,request:m}),m=null}m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new $e("Request aborted",$e.ECONNABORTED,t,m)),m=null)},m.onerror=function(){n(new $e("Network Error",$e.ERR_NETWORK,t,m)),m=null},m.ontimeout=function(){let e=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const a=r.transitional||dn;r.timeoutErrorMessage&&(e=r.timeoutErrorMessage),n(new $e(e,a.clarifyTimeoutError?$e.ETIMEDOUT:$e.ECONNABORTED,t,m)),m=null},void 0===a&&i.setContentType(null),"setRequestHeader"in m&&Xe.forEach(i.toJSON(),function(t,e){m.setRequestHeader(e,t)}),Xe.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),h&&"json"!==h&&(m.responseType=r.responseType),f&&([c,u]=Ln(f,!0),m.addEventListener("progress",c)),d&&m.upload&&([s,l]=Ln(d),m.upload.addEventListener("progress",s),m.upload.addEventListener("loadend",l)),(r.cancelToken||r.signal)&&(o=e=>{m&&(n(!e||e.type?new Dn(null,t,m):e),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(o),r.signal&&(r.signal.aborted?o():r.signal.addEventListener("abort",o)));const y=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(r.url);y&&-1===bn.protocols.indexOf(y)?n(new $e("Unsupported protocol "+y+":",$e.ERR_BAD_REQUEST,t)):m.send(a||null)})},Kn=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let n,r=new AbortController;const a=function(t){if(!n){n=!0,o();const e=t instanceof Error?t:this.reason;r.abort(e instanceof $e?e:new Dn(e instanceof Error?e.message:e))}};let i=e&&setTimeout(()=>{i=null,a(new $e("timeout ".concat(e," of ms exceeded"),$e.ETIMEDOUT))},e);const o=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(t=>{t.unsubscribe?t.unsubscribe(a):t.removeEventListener("abort",a)}),t=null)};t.forEach(t=>t.addEventListener("abort",a));const{signal:s}=r;return s.unsubscribe=()=>Xe.asap(o),s}};function Xn(t,e){this.v=t,this.k=e}function Yn(t){return function(){return new Qn(t.apply(this,arguments))}}function Qn(t){var e,n;function r(e,n){try{var i=t[e](n),o=i.value,s=o instanceof Xn;Promise.resolve(s?o.v:o).then(function(n){if(s){var c="return"===e?"return":"next";if(!o.k||n.done)return r(c,n);n=t[c](n).value}a(i.done?"return":"normal",n)},function(t){r("throw",t)})}catch(t){a("throw",t)}}function a(t,a){switch(t){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):n=null}this._invoke=function(t,a){return new Promise(function(i,o){var s={key:t,arg:a,resolve:i,reject:o,next:null};n?n=n.next=s:(e=n=s,r(t,a))})},"function"!=typeof t.return&&(this.return=void 0)}function Jn(t){return new Xn(t,0)}function $n(t){var e={},n=!1;function r(e,r){return n=!0,r=new Promise(function(n){n(t[e](r))}),{done:!1,value:new Xn(r,1)}}return e["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},e.next=function(t){return n?(n=!1,t):r("next",t)},"function"==typeof t.throw&&(e.throw=function(t){if(n)throw n=!1,t;return r("throw",t)}),"function"==typeof t.return&&(e.return=function(t){return n?(n=!1,t):r("return",t)}),e}function Zn(t){var e,n,r,a=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);a--;){if(n&&null!=(e=t[n]))return e.call(t);if(r&&null!=(e=t[r]))return new tr(e.call(t));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function tr(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then(function(t){return{value:t,done:e}})}return tr=function(t){this.s=t,this.n=t.next},tr.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var n=this.s.return;return void 0===n?Promise.resolve({value:t,done:!0}):e(n.apply(this.s,arguments))},throw:function(t){var n=this.s.return;return void 0===n?Promise.reject(t):e(n.apply(this.s,arguments))}},new tr(t)}Qn.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Qn.prototype.next=function(t){return this._invoke("next",t)},Qn.prototype.throw=function(t){return this._invoke("throw",t)},Qn.prototype.return=function(t){return this._invoke("return",t)};const er=function*(t,e){let n=t.byteLength;if(!e||n<e)return void(yield t);let r,a=0;for(;a<n;)r=a+e,yield t.slice(a,r),a=r},nr=function(){var t=Yn(function*(t,e){var n,r=!1,a=!1;try{for(var i,o=Zn(rr(t));r=!(i=yield Jn(o.next())).done;r=!1){const t=i.value;yield*$n(Zn(er(t,e)))}}catch(s){a=!0,n=s}finally{try{r&&null!=o.return&&(yield Jn(o.return()))}finally{if(a)throw n}}});return function(e,n){return t.apply(this,arguments)}}(),rr=function(){var t=Yn(function*(t){if(t[Symbol.asyncIterator])return void(yield*$n(Zn(t)));const e=t.getReader();try{for(;;){const{done:t,value:n}=yield Jn(e.read());if(t)break;yield n}}finally{yield Jn(e.cancel())}});return function(e){return t.apply(this,arguments)}}(),ar=(t,e,n,r)=>{const a=nr(t,e);let i,o=0,s=t=>{i||(i=!0,r&&r(t))};return new ReadableStream({async pull(t){try{const{done:e,value:r}=await a.next();if(e)return s(),void t.close();let i=r.byteLength;if(n){let t=o+=i;n(t)}t.enqueue(new Uint8Array(r))}catch(e){throw s(e),e}},cancel:t=>(s(t),a.return())},{highWaterMark:2})},ir="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,or=ir&&"function"===typeof ReadableStream,sr=ir&&("function"===typeof TextEncoder?(cr=new TextEncoder,t=>cr.encode(t)):async t=>new Uint8Array(await new Response(t).arrayBuffer()));var cr;const lr=function(t){try{for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return!!t(...n)}catch(Grt){return!1}},ur=or&&lr(()=>{let t=!1;const e=new Request(bn.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),hr=or&&lr(()=>Xe.isReadableStream(new Response("").body)),dr={stream:hr&&(t=>t.body)};var fr;ir&&(fr=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!dr[t]&&(dr[t]=Xe.isFunction(fr[t])?e=>e[t]():(e,n)=>{throw new $e("Response type '".concat(t,"' is not supported"),$e.ERR_NOT_SUPPORT,n)})}));const pr=async(t,e)=>{const n=Xe.toFiniteNumber(t.getContentLength());return null==n?(async t=>{if(null==t)return 0;if(Xe.isBlob(t))return t.size;if(Xe.isSpecCompliantForm(t)){const e=new Request(bn.origin,{method:"POST",body:t});return(await e.arrayBuffer()).byteLength}return Xe.isArrayBufferView(t)||Xe.isArrayBuffer(t)?t.byteLength:(Xe.isURLSearchParams(t)&&(t+=""),Xe.isString(t)?(await sr(t)).byteLength:void 0)})(e):n},mr=ir&&(async t=>{let{url:e,method:n,data:r,signal:a,cancelToken:i,timeout:o,onDownloadProgress:s,onUploadProgress:c,responseType:l,headers:u,withCredentials:h="same-origin",fetchOptions:d}=Hn(t);l=l?(l+"").toLowerCase():"text";let f,p=Kn([a,i&&i.toAbortSignal()],o);const m=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let g;try{if(c&&ur&&"get"!==n&&"head"!==n&&0!==(g=await pr(u,r))){let t,n=new Request(e,{method:"POST",body:r,duplex:"half"});if(Xe.isFormData(r)&&(t=n.headers.get("content-type"))&&u.setContentType(t),n.body){const[t,e]=zn(g,Ln(Bn(c)));r=ar(n.body,65536,t,e)}}Xe.isString(h)||(h=h?"include":"omit");const a="credentials"in Request.prototype;f=new Request(e,oe(oe({},d),{},{signal:p,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:a?h:void 0}));let i=await fetch(f,d);const o=hr&&("stream"===l||"response"===l);if(hr&&(s||o&&m)){const t={};["status","statusText","headers"].forEach(e=>{t[e]=i[e]});const e=Xe.toFiniteNumber(i.headers.get("content-length")),[n,r]=s&&zn(e,Ln(Bn(s),!0))||[];i=new Response(ar(i.body,65536,n,()=>{r&&r(),m&&m()}),t)}l=l||"text";let y=await dr[Xe.findKey(dr,l)||"text"](i,t);return!o&&m&&m(),await new Promise((e,n)=>{Mn(e,n,{data:y,headers:Cn.from(i.headers),status:i.status,statusText:i.statusText,config:t,request:f})})}catch(y){if(m&&m(),y&&"TypeError"===y.name&&/Load failed|fetch/i.test(y.message))throw Object.assign(new $e("Network Error",$e.ERR_NETWORK,t,f),{cause:y.cause||y});throw $e.from(y,y&&y.code,t,f)}}),gr={http:null,xhr:qn,fetch:mr};Xe.forEach(gr,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(Grt){}Object.defineProperty(t,"adapterName",{value:e})}});const yr=t=>"- ".concat(t),vr=t=>Xe.isFunction(t)||null===t||!1===t,br=t=>{t=Xe.isArray(t)?t:[t];const{length:e}=t;let n,r;const a={};for(let i=0;i<e;i++){let e;if(n=t[i],r=n,!vr(n)&&(r=gr[(e=String(n)).toLowerCase()],void 0===r))throw new $e("Unknown adapter '".concat(e,"'"));if(r)break;a[e||"#"+i]=r}if(!r){const t=Object.entries(a).map(t=>{let[e,n]=t;return"adapter ".concat(e," ")+(!1===n?"is not supported by the environment":"is not available in the build")});let n=e?t.length>1?"since :\n"+t.map(yr).join("\n"):" "+yr(t[0]):"as no adapter specified";throw new $e("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function wr(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Dn(null,t)}function xr(t){wr(t),t.headers=Cn.from(t.headers),t.data=An.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);return br(t.adapter||kn.adapter)(t).then(function(e){return wr(t),e.data=An.call(t,t.transformResponse,e),e.headers=Cn.from(e.headers),e},function(e){return Rn(e)||(wr(t),e&&e.response&&(e.response.data=An.call(t,t.transformResponse,e.response),e.response.headers=Cn.from(e.response.headers))),Promise.reject(e)})}const kr="1.10.0",_r={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{_r[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const Sr={};_r.transitional=function(t,e,n){function r(t,e){return"[Axios v"+kr+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,a,i)=>{if(!1===t)throw new $e(r(a," has been removed"+(e?" in "+e:"")),$e.ERR_DEPRECATED);return e&&!Sr[a]&&(Sr[a]=!0,console.warn(r(a," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,a,i)}},_r.spelling=function(t){return(e,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(t)),!0)};const Tr={assertOptions:function(t,e,n){if("object"!==typeof t)throw new $e("options must be an object",$e.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let a=r.length;for(;a-- >0;){const i=r[a],o=e[i];if(o){const e=t[i],n=void 0===e||o(e,i,t);if(!0!==n)throw new $e("option "+i+" must be "+n,$e.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new $e("Unknown option "+i,$e.ERR_BAD_OPTION)}},validators:_r},Ir=Tr.validators;class Er{constructor(t){this.defaults=t||{},this.interceptors={request:new hn,response:new hn}}async request(t,e){try{return await this._request(t,e)}catch(n){if(n instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const e=t.stack?t.stack.replace(/^.+\n/,""):"";try{n.stack?e&&!String(n.stack).endsWith(e.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+e):n.stack=e}catch(Grt){}}throw n}}_request(t,e){"string"===typeof t?(e=e||{}).url=t:e=t||{},e=Gn(this.defaults,e);const{transitional:n,paramsSerializer:r,headers:a}=e;void 0!==n&&Tr.assertOptions(n,{silentJSONParsing:Ir.transitional(Ir.boolean),forcedJSONParsing:Ir.transitional(Ir.boolean),clarifyTimeoutError:Ir.transitional(Ir.boolean)},!1),null!=r&&(Xe.isFunction(r)?e.paramsSerializer={serialize:r}:Tr.assertOptions(r,{encode:Ir.function,serialize:Ir.function},!0)),void 0!==e.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Tr.assertOptions(e,{baseUrl:Ir.spelling("baseURL"),withXsrfToken:Ir.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let i=a&&Xe.merge(a.common,a[e.method]);a&&Xe.forEach(["delete","get","head","post","put","patch","common"],t=>{delete a[t]}),e.headers=Cn.concat(i,a);const o=[];let s=!0;this.interceptors.request.forEach(function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(s=s&&t.synchronous,o.unshift(t.fulfilled,t.rejected))});const c=[];let l;this.interceptors.response.forEach(function(t){c.push(t.fulfilled,t.rejected)});let u,h=0;if(!s){const t=[xr.bind(this),void 0];for(t.unshift.apply(t,o),t.push.apply(t,c),u=t.length,l=Promise.resolve(e);h<u;)l=l.then(t[h++],t[h++]);return l}u=o.length;let d=e;for(h=0;h<u;){const t=o[h++],e=o[h++];try{d=t(d)}catch(f){e.call(this,f);break}}try{l=xr.call(this,d)}catch(f){return Promise.reject(f)}for(h=0,u=c.length;h<u;)l=l.then(c[h++],c[h++]);return l}getUri(t){return un(Vn((t=Gn(this.defaults,t)).baseURL,t.url,t.allowAbsoluteUrls),t.params,t.paramsSerializer)}}Xe.forEach(["delete","get","head","options"],function(t){Er.prototype[t]=function(e,n){return this.request(Gn(n||{},{method:t,url:e,data:(n||{}).data}))}}),Xe.forEach(["post","put","patch"],function(t){function e(e){return function(n,r,a){return this.request(Gn(a||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Er.prototype[t]=e(),Er.prototype[t+"Form"]=e(!0)});const Nr=Er;class Cr{constructor(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(t){e=t});const n=this;this.promise.then(t=>{if(!n._listeners)return;let e=n._listeners.length;for(;e-- >0;)n._listeners[e](t);n._listeners=null}),this.promise.then=t=>{let e;const r=new Promise(t=>{n.subscribe(t),e=t}).then(t);return r.cancel=function(){n.unsubscribe(e)},r},t(function(t,r,a){n.reason||(n.reason=new Dn(t,r,a),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=e=>{t.abort(e)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new Cr(function(e){t=e}),cancel:t}}}const Ar=Cr;const Rr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Rr).forEach(t=>{let[e,n]=t;Rr[n]=e});const Or=Rr;const Dr=function t(e){const n=new Nr(e),r=se(Nr.prototype.request,n);return Xe.extend(r,Nr.prototype,n,{allOwnKeys:!0}),Xe.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return t(Gn(e,n))},r}(kn);Dr.Axios=Nr,Dr.CanceledError=Dn,Dr.CancelToken=Ar,Dr.isCancel=Rn,Dr.VERSION=kr,Dr.toFormData=rn,Dr.AxiosError=$e,Dr.Cancel=Dr.CanceledError,Dr.all=function(t){return Promise.all(t)},Dr.spread=function(t){return function(e){return t.apply(null,e)}},Dr.isAxiosError=function(t){return Xe.isObject(t)&&!0===t.isAxiosError},Dr.mergeConfig=Gn,Dr.AxiosHeaders=Cn,Dr.formToJSON=t=>wn(Xe.isHTMLForm(t)?new FormData(t):t),Dr.getAdapter=br,Dr.HttpStatusCode=Or,Dr.default=Dr;const Mr=Dr;function Fr(t,e,n,r,a,i,o){try{var s=t[i](o),c=s.value}catch(l){return void n(l)}s.done?e(c):Promise.resolve(c).then(r,a)}function Pr(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var i=t.apply(e,n);function o(t){Fr(i,r,a,o,s,"next",t)}function s(t){Fr(i,r,a,o,s,"throw",t)}o(void 0)})}}var Lr=n(446);const zr="undefined"!==typeof window&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition);var Br=()=>/(android)/i.test("undefined"!==typeof navigator?navigator.userAgent:"");const jr=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.map(t=>t.trim()).join(" ").trim()},Ur=/\s*\((.*?)\)\s*/g,Vr=/(\(\?:[^)]+\))\?/g,Wr=/(\(\?)?:\w+/g,Gr=/\*/g,Hr=/[-{}[\]+?.,\\^$|#]/g,qr=()=>"undefined"!==typeof window&&void 0!==window.navigator&&void 0!==window.navigator.mediaDevices&&void 0!==window.navigator.mediaDevices.getUserMedia&&(void 0!==window.AudioContext||void 0!==window.webkitAudioContext);class Kr{setSpeechRecognition(t){const e=!!t&&((t=>t===zr)(t)||qr());e&&(this.disableRecognition(),this.recognition=new t,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(e)}subscribe(t,e){this.subscribers[t]=e}unsubscribe(t){delete this.subscribers[t]}emitListeningChange(t){this.listening=t,Object.keys(this.subscribers).forEach(e=>{const{onListeningChange:n}=this.subscribers[e];n(t)})}emitMicrophoneAvailabilityChange(t){this.isMicrophoneAvailable=t,Object.keys(this.subscribers).forEach(e=>{const{onMicrophoneAvailabilityChange:n}=this.subscribers[e];n(t)})}emitTranscriptChange(t,e){Object.keys(this.subscribers).forEach(n=>{const{onTranscriptChange:r}=this.subscribers[n];r(t,e)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(t=>{const{onClearTranscript:e}=this.subscribers[t];e()})}emitBrowserSupportsSpeechRecognitionChange(t){Object.keys(this.subscribers).forEach(e=>{const{onBrowserSupportsSpeechRecognitionChange:n,onBrowserSupportsContinuousListeningChange:r}=this.subscribers[e];n(t),r(t)})}disconnect(t){if(this.recognition&&this.listening)switch(t){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(t){t&&t.error&&"not-allowed"===t.error&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript(t){let{results:e,resultIndex:n}=t;const r=void 0===n?e.length-1:n;this.interimTranscript="",this.finalTranscript="";for(let i=r;i<e.length;++i)e[i].isFinal&&(!Br()||e[i][0].confidence>0)?this.updateFinalTranscript(e[i][0].transcript):this.interimTranscript=jr(this.interimTranscript,e[i][0].transcript);let a=!1;""===this.interimTranscript&&""!==this.finalTranscript?(this.previousResultWasFinalOnly&&(a=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,a||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(t){this.finalTranscript=jr(this.finalTranscript,t)}resetTranscript(){this.disconnect("RESET")}startListening(){return Pr(function(){var t=this;let{continuous:e=!1,language:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){if(!t.recognition)return;const r=e!==t.recognition.continuous,a=n&&n!==t.recognition.lang;if((r||a)&&(t.listening&&(yield t.stopListening()),t.recognition.continuous=r?e:t.recognition.continuous,t.recognition.lang=a?n:t.recognition.lang),!t.listening){t.recognition.continuous||(t.resetTranscript(),t.emitClearTranscript());try{yield t.start(),t.emitListeningChange(!0)}catch(Grt){Grt instanceof DOMException||t.emitMicrophoneAvailabilityChange(!1)}}}()}).apply(this,arguments)}abortListening(){return Pr(function*(){this.disconnect("ABORT"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}stopListening(){return Pr(function*(){this.disconnect("STOP"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}getRecognition(){return this.recognition}start(){return Pr(function*(){this.recognition&&!this.listening&&(yield this.recognition.start(),this.listening=!0)}).call(this)}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(t){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(t),Br()&&(this.updateFinalTranscript=Lr(this.updateFinalTranscript,250,{leading:!0}))}}const Xr="CLEAR_TRANSCRIPT",Yr="APPEND_TRANSCRIPT",Qr=(t,e)=>{switch(e.type){case Xr:return{interimTranscript:"",finalTranscript:""};case Yr:return{interimTranscript:e.payload.interimTranscript,finalTranscript:jr(t.finalTranscript,e.payload.finalTranscript)};default:throw new Error}};let Jr,$r=!!zr,Zr=$r&&!Br();const ta=function(){let{transcribing:t=!0,clearTranscriptOnListen:e=!0,commands:n=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[r]=(0,C.useState)(ea.getRecognitionManager()),[a,i]=(0,C.useState)($r),[o,s]=(0,C.useState)(Zr),[{interimTranscript:c,finalTranscript:l},u]=(0,C.useReducer)(Qr,{interimTranscript:r.interimTranscript,finalTranscript:""}),[h,d]=(0,C.useState)(r.listening),[f,p]=(0,C.useState)(r.isMicrophoneAvailable),m=(0,C.useRef)(n);m.current=n;const g=()=>{u({type:Xr})},y=(0,C.useCallback)(()=>{r.resetTranscript(),g()},[r]),v=(t,e,n)=>{const r=("object"===typeof t?t.toString():t).replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),a=((t,e)=>{if(t=t.replace(/\s+/g,"").toLowerCase(),e=e.replace(/\s+/g,"").toLowerCase(),!t.length&&!e.length)return 1;if(!t.length||!e.length)return 0;if(t===e)return 1;if(1===t.length&&1===e.length)return 0;if(t.length<2||e.length<2)return 0;const n=new Map;for(let a=0;a<t.length-1;a++){const e=t.substring(a,a+2),r=n.has(e)?n.get(e)+1:1;n.set(e,r)}let r=0;for(let a=0;a<e.length-1;a++){const t=e.substring(a,a+2),i=n.has(t)?n.get(t):0;i>0&&(n.set(t,i-1),r++)}return 2*r/(t.length+e.length-2)})(r,e);return a>=n?{command:t,commandWithoutSpecials:r,howSimilar:a,isFuzzyMatch:!0}:null},b=(t,e)=>{const n=(t=>t instanceof RegExp?new RegExp(t.source,"i"):(t=t.replace(Hr,"\\$&").replace(Ur,"(?:$1)?").replace(Wr,(t,e)=>e?t:"([^\\s]+)").replace(Gr,"(.*?)").replace(Vr,"\\s*$1?\\s*"),new RegExp("^"+t+"$","i")))(t),r=n.exec(e);return r?{command:t,parameters:r.slice(1)}:null},w=(0,C.useCallback)((t,e)=>{m.current.forEach(n=>{let{command:r,callback:a,matchInterim:i=!1,isFuzzyMatch:o=!1,fuzzyMatchingThreshold:s=.8,bestMatchOnly:c=!1}=n;const l=!e&&i?t.trim():e.trim(),u=(Array.isArray(r)?r:[r]).map(t=>o?v(t,l,s):b(t,l)).filter(t=>t);if(o&&c&&u.length>=2){u.sort((t,e)=>e.howSimilar-t.howSimilar);const{command:t,commandWithoutSpecials:e,howSimilar:n}=u[0];a(e,l,n,{command:t,resetTranscript:y})}else u.forEach(t=>{if(t.isFuzzyMatch){const{command:e,commandWithoutSpecials:n,howSimilar:r}=t;a(n,l,r,{command:e,resetTranscript:y})}else{const{command:e,parameters:n}=t;a(...n,{command:e,resetTranscript:y})}})})},[y]),x=(0,C.useCallback)((e,n)=>{t&&u(((t,e)=>({type:Yr,payload:{interimTranscript:t,finalTranscript:e}}))(e,n)),w(e,n)},[w,t]),k=(0,C.useCallback)(()=>{e&&g()},[e]);(0,C.useEffect)(()=>{const t=ea.counter;ea.counter+=1;const e={onListeningChange:d,onMicrophoneAvailabilityChange:p,onTranscriptChange:x,onClearTranscript:k,onBrowserSupportsSpeechRecognitionChange:i,onBrowserSupportsContinuousListeningChange:s};return r.subscribe(t,e),()=>{r.unsubscribe(t)}},[t,e,r,x,k]);return{transcript:jr(l,c),interimTranscript:c,finalTranscript:l,listening:h,isMicrophoneAvailable:f,resetTranscript:y,browserSupportsSpeechRecognition:a,browserSupportsContinuousListening:o}},ea={counter:0,applyPolyfill:t=>{Jr?Jr.setSpeechRecognition(t):Jr=new Kr(t);const e=!!t&&qr();$r=e,Zr=e},removePolyfill:()=>{Jr?Jr.setSpeechRecognition(zr):Jr=new Kr(zr),$r=!!zr,Zr=$r&&!Br()},getRecognitionManager:()=>(Jr||(Jr=new Kr(zr)),Jr),getRecognition:()=>ea.getRecognitionManager().getRecognition(),startListening:function(){let{continuous:t,language:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Pr(function*(){const n=ea.getRecognitionManager();yield n.startListening({continuous:t,language:e})})()},stopListening:()=>Pr(function*(){const t=ea.getRecognitionManager();yield t.stopListening()})(),abortListening:()=>Pr(function*(){const t=ea.getRecognitionManager();yield t.abortListening()})(),browserSupportsSpeechRecognition:()=>$r,browserSupportsContinuousListening:()=>Zr};var na=n(4713),ra=n(579);const aa=t=>{let{value:e}=t;return(0,ra.jsx)("div",{style:{width:"300px"},children:(0,ra.jsx)(na.A,{id:"fluency-gauge",nrOfLevels:30,colors:["#FF5F6D","#FFC371","#00FF00"],arcWidth:.3,percent:e/100,textColor:"#000000",formatTextValue:t=>"".concat(e," Wpm")})})},ia="generated",oa="pointerleave",sa="pointermove",ca="touchend",la="tsParticles - Error",ua=100,ha=.5,da=1e3,fa=0,pa=0,ma=0,ga=1,ya=0,va=0,ba=1,wa="random",xa=2*Math.PI,ka="true",_a="false",Sa="canvas",Ta=255,Ia=.25;var Ea;function Na(t){return"boolean"===typeof t}function Ca(t){return"string"===typeof t}function Aa(t){return"number"===typeof t}function Ra(t){return"object"===typeof t&&null!==t}function Oa(t){return Array.isArray(t)}function Da(t){return null===t||void 0===t}!function(t){t.bottom="bottom",t.bottomLeft="bottom-left",t.bottomRight="bottom-right",t.left="left",t.none="none",t.right="right",t.top="top",t.topLeft="top-left",t.topRight="top-right",t.outside="outside",t.inside="inside"}(Ea||(Ea={}));class Ma{constructor(t,e,n){if(this._updateFromAngle=(t,e)=>{this.x=Math.cos(t)*e,this.y=Math.sin(t)*e},!Aa(t)&&t){this.x=t.x,this.y=t.y;const e=t;this.z=e.z?e.z:ma}else{if(void 0===t||void 0===e)throw new Error("".concat(la," Vector3d not initialized correctly"));this.x=t,this.y=e,this.z=null!==n&&void 0!==n?n:ma}}static get origin(){return Ma.create(fa,pa,ma)}get angle(){return Math.atan2(this.y,this.x)}set angle(t){this._updateFromAngle(t,this.length)}get length(){return Math.sqrt(this.getLengthSq())}set length(t){this._updateFromAngle(this.angle,t)}static clone(t){return Ma.create(t.x,t.y,t.z)}static create(t,e,n){return new Ma(t,e,n)}add(t){return Ma.create(this.x+t.x,this.y+t.y,this.z+t.z)}addTo(t){this.x+=t.x,this.y+=t.y,this.z+=t.z}copy(){return Ma.clone(this)}distanceTo(t){return this.sub(t).length}distanceToSq(t){return this.sub(t).getLengthSq()}div(t){return Ma.create(this.x/t,this.y/t,this.z/t)}divTo(t){this.x/=t,this.y/=t,this.z/=t}getLengthSq(){return this.x**2+this.y**2}mult(t){return Ma.create(this.x*t,this.y*t,this.z*t)}multTo(t){this.x*=t,this.y*=t,this.z*=t}normalize(){const t=this.length;0!=t&&this.multTo(1/t)}rotate(t){return Ma.create(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t),ma)}setTo(t){this.x=t.x,this.y=t.y;const e=t;this.z=e.z?e.z:ma}sub(t){return Ma.create(this.x-t.x,this.y-t.y,this.z-t.z)}subFrom(t){this.x-=t.x,this.y-=t.y,this.z-=t.z}}class Fa extends Ma{constructor(t,e){super(t,e,ma)}static get origin(){return Fa.create(fa,pa)}static clone(t){return Fa.create(t.x,t.y)}static create(t,e){return new Fa(t,e)}}let Pa=Math.random;const La={nextFrame:t=>requestAnimationFrame(t),cancel:t=>cancelAnimationFrame(t)};function za(){return Ba(Pa(),0,1-Number.EPSILON)}function Ba(t,e,n){return Math.min(Math.max(t,e),n)}function ja(t){const e=Wa(t);let n=Va(t);return e===n&&(n=0),za()*(e-n)+n}function Ua(t){return Aa(t)?t:ja(t)}function Va(t){return Aa(t)?t:t.min}function Wa(t){return Aa(t)?t:t.max}function Ga(t,e){if(t===e||void 0===e&&Aa(t))return t;const n=Va(t),r=Wa(t);return void 0!==e?{min:Math.min(n,e),max:Math.max(r,e)}:Ga(n,r)}function Ha(t,e){return function(t,e){const n=t.x-e.x,r=t.y-e.y;return{dx:n,dy:r,distance:Math.sqrt(n**2+r**2)}}(t,e).distance}function qa(t){return t*Math.PI/180}function Ka(t){var e,n,r,a;return{x:null!==(e=null===(n=t.position)||void 0===n?void 0:n.x)&&void 0!==e?e:za()*t.size.width,y:null!==(r=null===(a=t.position)||void 0===a?void 0:a.y)&&void 0!==r?r:za()*t.size.height}}var Xa,Ya,Qa,Ja,$a,Za;!function(t){t.auto="auto",t.increase="increase",t.decrease="decrease",t.random="random"}(Xa||(Xa={})),function(t){t.increasing="increasing",t.decreasing="decreasing"}(Ya||(Ya={})),function(t){t.none="none",t.max="max",t.min="min"}(Qa||(Qa={})),function(t){t.bottom="bottom",t.left="left",t.right="right",t.top="top"}(Ja||(Ja={})),function(t){t.precise="precise",t.percent="percent"}($a||($a={})),function(t){t.max="max",t.min="min",t.random="random"}(Za||(Za={}));const ti=["mode"],ei={debug:console.debug,error:console.error,info:console.info,log:console.log,verbose:console.log,warning:console.warn};function ni(){return ei}function ri(){return"undefined"===typeof window||!window||"undefined"===typeof window.document||!window.document}function ai(t){if(!ri()&&"undefined"!==typeof matchMedia)return matchMedia(t)}function ii(t,e){return t===e||Oa(e)&&e.indexOf(t)>-1}function oi(t,e){return t[void 0!==e&&(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])?e%t.length:function(t){return Math.floor(za()*t.length)}(t)]}function si(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const a of n){if(void 0===a||null===a)continue;if(!Ra(a)){t=a;continue}const e=Array.isArray(a);!e||!Ra(t)&&t&&Array.isArray(t)?e||!Ra(t)&&t&&!Array.isArray(t)||(t={}):t=[];for(const n in a){if("__proto__"===n)continue;const e=a[n],r=t;r[n]=Ra(e)&&Array.isArray(e)?e.map(t=>si(r[n],t)):si(r[n],e)}}return t}function ci(t,e){return Oa(t)?t.map((t,n)=>e(t,n)):e(t,0)}function li(t,e,n){return Oa(t)?oi(t,e,n):t}function ui(t,e){if(!(t.mode===$a.percent)){const{mode:e}=t,n=function(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(-1!==e.indexOf(r))continue;n[r]=t[r]}return n}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}(t,ti);return n}return"x"in t?{x:t.x/ua*e.width,y:t.y/ua*e.height}:{width:t.width/ua*e.width,height:t.height/ua*e.height}}function hi(t,e){return ui(t,e)}const di=function(t){const e=new Map;return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];const i=JSON.stringify(r);if(e.has(i))return e.get(i);const o=t(...r);return e.set(i,o),o}}(function(t){const e=document.createElement("div").style,n={width:"100%",height:"100%",margin:"0",padding:"0",borderWidth:"0",position:"fixed",zIndex:t.toString(10),"z-index":t.toString(10),top:"0",left:"0"};for(const r in n){const t=n[r];e.setProperty(r,t)}return e});var fi,pi,mi,gi,yi,vi,bi,wi,xi,ki,_i,Si;function Ti(t,e){if(e)for(const n of t.colorManagers.values())if(e.startsWith(n.stringPrefix))return n.parseString(e)}function Ii(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!e)return;const a=Ca(e)?{value:e}:e;if(Ca(a.value))return Ei(t,a.value,n,r);if(Oa(a.value))return Ii(t,{value:oi(a.value,n,r)});for(const i of t.colorManagers.values()){const t=i.handleRangeColor(a);if(t)return t}}function Ei(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!e)return;const a=Ca(e)?{value:e}:e;if(Ca(a.value))return a.value===wa?Ai():function(t,e){return Ti(t,e)}(t,a.value);if(Oa(a.value))return Ei(t,{value:oi(a.value,n,r)});for(const i of t.colorManagers.values()){const t=i.handleColor(a);if(t)return t}}function Ni(t,e,n){const r=Ii(t,e,n,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]);return r?Ci(r):void 0}function Ci(t){const e=t.r/Ta,n=t.g/Ta,r=t.b/Ta,a=Math.max(e,n,r),i=Math.min(e,n,r),o={h:0,l:(a+i)*ha,s:0};return a!==i&&(o.s=o.l<ha?(a-i)/(a+i):(a-i)/(2-a-i),o.h=e===a?(n-r)/(a-i):o.h=n===a?2+(r-e)/(a-i):4+(e-n)/(a-i)),o.l*=100,o.s*=100,o.h*=60,o.h<0&&(o.h+=360),o.h>=360&&(o.h-=360),o}function Ai(t){const e=null!==t&&void 0!==t?t:0;return{b:Math.floor(ja(Ga(e,256))),g:Math.floor(ja(Ga(e,256))),r:Math.floor(ja(Ga(e,256)))}}function Ri(t,e){return"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(null!==e&&void 0!==e?e:1,")")}function Oi(t,e){return"hsla(".concat(t.h,", ").concat(t.s,"%, ").concat(t.l,"%, ").concat(null!==e&&void 0!==e?e:1,")")}function Di(t){return void 0!==t?{h:t.h.value,s:t.s.value,l:t.l.value}:void 0}function Mi(t,e){t.clearRect(fa,pa,e.width,e.height)}function Fi(t){var e,n,r,a,i,o,s;const{container:c,context:l,particle:u,delta:h,colorStyles:d,backgroundMask:f,composite:p,radius:m,opacity:g,shadow:y,transform:v}=t,b=u.getPosition(),w=u.rotation+(u.pathRotation?u.velocity.angle:0),x=Math.sin(w),k=Math.cos(w),_=!!w,S={a:k*(null!==(e=v.a)&&void 0!==e?e:ga),b:_?x*(null!==(n=v.b)&&void 0!==n?n:1):null!==(r=v.b)&&void 0!==r?r:ya,c:_?-x*(null!==(a=v.c)&&void 0!==a?a:1):null!==(i=v.c)&&void 0!==i?i:va,d:k*(null!==(o=v.d)&&void 0!==o?o:ba)};l.setTransform(S.a,S.b,S.c,S.d,b.x,b.y),f&&(l.globalCompositeOperation=p);const T=u.shadowColor;y.enable&&T&&(l.shadowBlur=y.blur,l.shadowColor=Ri(T),l.shadowOffsetX=y.offset.x,l.shadowOffsetY=y.offset.y),d.fill&&(l.fillStyle=d.fill);const I=null!==(s=u.strokeWidth)&&void 0!==s?s:0;l.lineWidth=I,d.stroke&&(l.strokeStyle=d.stroke);const E={container:c,context:l,particle:u,radius:m,opacity:g,delta:h,transformData:S,strokeWidth:I};!function(t){const{container:e,context:n,particle:r,radius:a,opacity:i,delta:o,strokeWidth:s,transformData:c}=t;if(!r.shape)return;const l=e.shapeDrawers.get(r.shape);if(!l)return;n.beginPath(),l.draw({context:n,particle:r,radius:a,opacity:i,delta:o,pixelRatio:e.retina.pixelRatio,transformData:oe({},c)}),r.shapeClose&&n.closePath();s>0&&n.stroke();r.shapeFill&&n.fill()}(E),function(t){const{container:e,context:n,particle:r,radius:a,opacity:i,delta:o,transformData:s}=t;if(!r.shape)return;const c=e.shapeDrawers.get(r.shape);if(null===c||void 0===c||!c.afterDraw)return;c.afterDraw({context:n,particle:r,radius:a,opacity:i,delta:o,pixelRatio:e.retina.pixelRatio,transformData:oe({},s)})}(E),function(t){const{container:e,context:n,particle:r,radius:a,opacity:i,delta:o,transformData:s}=t;if(!r.effect)return;const c=e.effectDrawers.get(r.effect);if(!c)return;c.draw({context:n,particle:r,radius:a,opacity:i,delta:o,pixelRatio:e.retina.pixelRatio,transformData:oe({},s)})}(E),l.globalCompositeOperation="source-over",l.resetTransform()}function Pi(t,e,n){const r=e[n];var a;void 0!==r&&(t[n]=(null!==(a=t[n])&&void 0!==a?a:1)*r)}function Li(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return;if(!t)return;const r=t.style;if(!r)return;const a=new Set;for(const i in r)Object.prototype.hasOwnProperty.call(r,i)&&a.add(r[i]);for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&a.add(e[i]);for(const i of a){const t=e.getPropertyValue(i);t?r.setProperty(i,t,n?"important":""):r.removeProperty(i)}}!function(t){t.darken="darken",t.enlighten="enlighten"}(fi||(fi={}));class zi{constructor(t,e){this.container=t,this._applyPostDrawUpdaters=t=>{for(const n of this._postDrawUpdaters){var e;null===(e=n.afterDraw)||void 0===e||e.call(n,t)}},this._applyPreDrawUpdaters=(t,e,n,r,a,i)=>{for(const s of this._preDrawUpdaters){var o;if(s.getColorStyles){const{fill:i,stroke:o}=s.getColorStyles(e,t,n,r);i&&(a.fill=i),o&&(a.stroke=o)}if(s.getTransformValues){const t=s.getTransformValues(e);for(const e in t)Pi(i,t,e)}null===(o=s.beforeDraw)||void 0===o||o.call(s,e)}},this._applyResizePlugins=()=>{for(const e of this._resizePlugins){var t;null===(t=e.resize)||void 0===t||t.call(e)}},this._getPluginParticleColors=t=>{let e,n;for(const r of this._colorPlugins)if(!e&&r.particleFillColor&&(e=Ni(this._engine,r.particleFillColor(t))),!n&&r.particleStrokeColor&&(n=Ni(this._engine,r.particleStrokeColor(t))),e&&n)break;return[e,n]},this._initCover=async()=>{const t=this.container.actualOptions.backgroundMask.cover,e=t.color;if(e){const n=Ii(this._engine,e);if(n){const e=oe(oe({},n),{},{a:t.opacity});this._coverColorStyle=Ri(e,e.a)}}else await new Promise((e,n)=>{if(!t.image)return;const r=document.createElement("img");r.addEventListener("load",()=>{this._coverImage={image:r,opacity:t.opacity},e()}),r.addEventListener("error",t=>{n(t.error)}),r.src=t.image})},this._initStyle=()=>{const t=this.element,e=this.container.actualOptions;if(t){this._fullScreen?this._setFullScreenStyle():this._resetOriginalStyle();for(const n in e.style){if(!n||!e.style||!Object.prototype.hasOwnProperty.call(e.style,n))continue;const r=e.style[n];r&&t.style.setProperty(n,r,"important")}}},this._initTrail=async()=>{const t=this.container.actualOptions.particles.move.trail,e=t.fill;if(!t.enable)return;const n=1/t.length;if(e.color){const t=Ii(this._engine,e.color);if(!t)return;this._trailFill={color:oe({},t),opacity:n}}else await new Promise((t,r)=>{if(!e.image)return;const a=document.createElement("img");a.addEventListener("load",()=>{this._trailFill={image:a,opacity:n},t()}),a.addEventListener("error",t=>{r(t.error)}),a.src=e.image})},this._paintBase=t=>{this.draw(e=>function(t,e,n){t.fillStyle=null!==n&&void 0!==n?n:"rgba(0,0,0,0)",t.fillRect(fa,pa,e.width,e.height)}(e,this.size,t))},this._paintImage=(t,e)=>{this.draw(n=>function(t,e,n,r){n&&(t.globalAlpha=r,t.drawImage(n,fa,pa,e.width,e.height),t.globalAlpha=1)}(n,this.size,t,e))},this._repairStyle=()=>{const t=this.element;t&&(this._safeMutationObserver(t=>t.disconnect()),this._initStyle(),this.initBackground(),this._safeMutationObserver(e=>{t&&t instanceof Node&&e.observe(t,{attributes:!0})}))},this._resetOriginalStyle=()=>{const t=this.element,e=this._originalStyle;t&&e&&Li(t,e,!0)},this._safeMutationObserver=t=>{this._mutationObserver&&t(this._mutationObserver)},this._setFullScreenStyle=()=>{const t=this.element;t&&Li(t,di(this.container.actualOptions.fullScreen.zIndex),!0)},this._engine=e,this._standardSize={height:0,width:0};const n=t.retina.pixelRatio,r=this._standardSize;this.size={height:r.height*n,width:r.width*n},this._context=null,this._generated=!1,this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}get _fullScreen(){return this.container.actualOptions.fullScreen.enable}clear(){const t=this.container.actualOptions,e=t.particles.move.trail,n=this._trailFill;t.backgroundMask.enable?this.paint():e.enable&&e.length>0&&n?n.color?this._paintBase(Ri(n.color,n.opacity)):n.image&&this._paintImage(n.image,n.opacity):t.clear&&this.draw(t=>{Mi(t,this.size)})}destroy(){if(this.stop(),this._generated){const t=this.element;null===t||void 0===t||t.remove(),this.element=void 0}else this._resetOriginalStyle();this._preDrawUpdaters=[],this._postDrawUpdaters=[],this._resizePlugins=[],this._colorPlugins=[]}draw(t){const e=this._context;if(e)return t(e)}drawAsync(t){const e=this._context;if(e)return t(e)}drawParticle(t,e){var n;if(t.spawning||t.destroyed)return;const r=t.getRadius();if(r<=0)return;const a=t.getFillColor(),i=null!==(n=t.getStrokeColor())&&void 0!==n?n:a;let[o,s]=this._getPluginParticleColors(t);o||(o=a),s||(s=i),(o||s)&&this.draw(n=>{var a,i,c,l;const u=this.container,h=u.actualOptions,d=t.options.zIndex,f=1-t.zIndexFactor,p=f**d.opacityRate,m=null!==(a=null!==(i=t.bubble.opacity)&&void 0!==i?i:null===(c=t.opacity)||void 0===c?void 0:c.value)&&void 0!==a?a:1,g=m*p,y=(null!==(l=t.strokeOpacity)&&void 0!==l?l:m)*p,v={},b={fill:o?Oi(o,g):void 0};b.stroke=s?Oi(s,y):b.fill,this._applyPreDrawUpdaters(n,t,r,g,b,v),Fi({container:u,context:n,particle:t,delta:e,colorStyles:b,backgroundMask:h.backgroundMask.enable,composite:h.backgroundMask.composite,radius:r*f**d.sizeRate,opacity:g,shadow:t.options.shadow,transform:v}),this._applyPostDrawUpdaters(t)})}drawParticlePlugin(t,e,n){this.draw(r=>function(t,e,n,r){e.drawParticle&&e.drawParticle(t,n,r)}(r,t,e,n))}drawPlugin(t,e){this.draw(n=>function(t,e,n){e.draw&&e.draw(t,n)}(n,t,e))}async init(){this._safeMutationObserver(t=>t.disconnect()),this._mutationObserver=function(t){if(!ri()&&"undefined"!==typeof MutationObserver)return new MutationObserver(t)}(t=>{for(const e of t)"attributes"===e.type&&"style"===e.attributeName&&this._repairStyle()}),this.resize(),this._initStyle(),await this._initCover();try{await this._initTrail()}catch(Grt){ni().error(Grt)}this.initBackground(),this._safeMutationObserver(t=>{this.element&&this.element instanceof Node&&t.observe(this.element,{attributes:!0})}),this.initUpdaters(),this.initPlugins(),this.paint()}initBackground(){const t=this.container.actualOptions.background,e=this.element;if(!e)return;const n=e.style;if(n){if(t.color){const e=Ii(this._engine,t.color);n.backgroundColor=e?Ri(e,t.opacity):""}else n.backgroundColor="";n.backgroundImage=t.image||"",n.backgroundPosition=t.position||"",n.backgroundRepeat=t.repeat||"",n.backgroundSize=t.size||""}}initPlugins(){this._resizePlugins=[];for(const e of this.container.plugins.values()){var t;e.resize&&this._resizePlugins.push(e),(null!==(t=e.particleFillColor)&&void 0!==t?t:e.particleStrokeColor)&&this._colorPlugins.push(e)}}initUpdaters(){this._preDrawUpdaters=[],this._postDrawUpdaters=[];for(const n of this.container.particles.updaters){var t,e;n.afterDraw&&this._postDrawUpdaters.push(n),(null!==(t=null!==(e=n.getColorStyles)&&void 0!==e?e:n.getTransformValues)&&void 0!==t?t:n.beforeDraw)&&this._preDrawUpdaters.push(n)}}loadCanvas(t){this._generated&&this.element&&this.element.remove(),this._generated=t.dataset&&ia in t.dataset?"true"===t.dataset[ia]:this._generated,this.element=t,this.element.ariaHidden="true",this._originalStyle=function(t){const e=document.createElement("div").style;if(!t)return e;for(const o in t){var n,r;const s=t[o];if(!Object.prototype.hasOwnProperty.call(t,o)||Da(s))continue;const c=null===(n=t.getPropertyValue)||void 0===n?void 0:n.call(t,s);if(!c)continue;const l=null===(r=t.getPropertyPriority)||void 0===r?void 0:r.call(t,s);var a,i;l?null===(a=e.setProperty)||void 0===a||a.call(e,s,c,l):null===(i=e.setProperty)||void 0===i||i.call(e,s,c)}return e}(this.element.style);const e=this._standardSize;e.height=t.offsetHeight,e.width=t.offsetWidth;const n=this.container.retina.pixelRatio,r=this.size;t.height=r.height=e.height*n,t.width=r.width=e.width*n,this._context=this.element.getContext("2d"),this._safeMutationObserver(t=>t.disconnect()),this.container.retina.init(),this.initBackground(),this._safeMutationObserver(t=>{this.element&&this.element instanceof Node&&t.observe(this.element,{attributes:!0})})}paint(){const t=this.container.actualOptions;this.draw(e=>{t.backgroundMask.enable&&t.backgroundMask.cover?(Mi(e,this.size),this._coverImage?this._paintImage(this._coverImage.image,this._coverImage.opacity):this._coverColorStyle?this._paintBase(this._coverColorStyle):this._paintBase()):this._paintBase()})}resize(){if(!this.element)return!1;const t=this.container,e=t.canvas._standardSize,n={width:this.element.offsetWidth,height:this.element.offsetHeight},r=t.retina.pixelRatio,a={width:n.width*r,height:n.height*r};if(n.height===e.height&&n.width===e.width&&a.height===this.element.height&&a.width===this.element.width)return!1;const i=oe({},e);e.height=n.height,e.width=n.width;const o=this.size;return this.element.width=o.width=a.width,this.element.height=o.height=a.height,this.container.started&&t.particles.setResizeFactor({width:e.width/i.width,height:e.height/i.height}),!0}stop(){this._safeMutationObserver(t=>t.disconnect()),this._mutationObserver=void 0,this.draw(t=>Mi(t,this.size))}async windowResize(){if(!this.element||!this.resize())return;const t=this.container,e=t.updateActualOptions();t.particles.setDensity(),this._applyResizePlugins(),e&&await t.refresh()}}function Bi(t,e,n,r,a){if(r){let r={passive:!0};Na(a)?r.capture=a:void 0!==a&&(r=a),t.addEventListener(e,n,r)}else{const r=a;t.removeEventListener(e,n,r)}}!function(t){t.canvas="canvas",t.parent="parent",t.window="window"}(pi||(pi={}));class ji{constructor(t){this.container=t,this._doMouseTouchClick=t=>{const e=this.container,n=e.actualOptions;if(this._canPush){const t=e.interactivity.mouse,r=t.position;if(!r)return;t.clickPosition=oe({},r),t.clickTime=(new Date).getTime();ci(n.interactivity.events.onClick.mode,t=>this.container.handleClickMode(t))}"touchend"===t.type&&setTimeout(()=>this._mouseTouchFinish(),500)},this._handleThemeChange=t=>{const e=t,n=this.container,r=n.options,a=r.defaultThemes,i=e.matches?a.dark:a.light,o=r.themes.find(t=>t.name===i);null!==o&&void 0!==o&&o.default.auto&&n.loadTheme(i)},this._handleVisibilityChange=()=>{var t;const e=this.container,n=e.actualOptions;this._mouseTouchFinish(),n.pauseOnBlur&&(null!==(t=document)&&void 0!==t&&t.hidden?(e.pageHidden=!0,e.pause()):(e.pageHidden=!1,e.animationStatus?e.play(!0):e.draw(!0)))},this._handleWindowResize=()=>{this._resizeTimeout&&(clearTimeout(this._resizeTimeout),delete this._resizeTimeout);const t=async()=>{const t=this.container.canvas;await(null===t||void 0===t?void 0:t.windowResize())};this._resizeTimeout=setTimeout(()=>{t()},this.container.actualOptions.interactivity.events.resize.delay*da)},this._manageInteractivityListeners=(t,e)=>{const n=this._handlers,r=this.container,a=r.actualOptions,i=r.interactivity.element;if(!i)return;const o=i,s=r.canvas.element;s&&(s.style.pointerEvents=o===s?"initial":"none"),(a.interactivity.events.onHover.enable||a.interactivity.events.onClick.enable)&&(Bi(i,sa,n.mouseMove,e),Bi(i,"touchstart",n.touchStart,e),Bi(i,"touchmove",n.touchMove,e),a.interactivity.events.onClick.enable?(Bi(i,ca,n.touchEndClick,e),Bi(i,"pointerup",n.mouseUp,e),Bi(i,"pointerdown",n.mouseDown,e)):Bi(i,ca,n.touchEnd,e),Bi(i,t,n.mouseLeave,e),Bi(i,"touchcancel",n.touchCancel,e))},this._manageListeners=t=>{const e=this._handlers,n=this.container,r=n.actualOptions.interactivity.detectsOn,a=n.canvas.element;let i=oa;if(r===pi.window)n.interactivity.element=window,i="pointerout";else if(r===pi.parent&&a){var o;n.interactivity.element=null!==(o=a.parentElement)&&void 0!==o?o:a.parentNode}else n.interactivity.element=a;this._manageMediaMatch(t),this._manageResize(t),this._manageInteractivityListeners(i,t),document&&Bi(document,"visibilitychange",e.visibilityChange,t,!1)},this._manageMediaMatch=t=>{const e=this._handlers,n=ai("(prefers-color-scheme: dark)");n&&(void 0===n.addEventListener?void 0!==n.addListener&&(t?n.addListener(e.oldThemeChange):n.removeListener(e.oldThemeChange)):Bi(n,"change",e.themeChange,t))},this._manageResize=t=>{const e=this._handlers,n=this.container;if(!n.actualOptions.interactivity.events.resize)return;if("undefined"===typeof ResizeObserver)return void Bi(window,"resize",e.resize,t);const r=n.canvas.element;this._resizeObserver&&!t?(r&&this._resizeObserver.unobserve(r),this._resizeObserver.disconnect(),delete this._resizeObserver):!this._resizeObserver&&t&&r&&(this._resizeObserver=new ResizeObserver(t=>{t.find(t=>t.target===r)&&this._handleWindowResize()}),this._resizeObserver.observe(r))},this._mouseDown=()=>{const{interactivity:t}=this.container;if(!t)return;const{mouse:e}=t;e.clicking=!0,e.downPosition=e.position},this._mouseTouchClick=t=>{const e=this.container,n=e.actualOptions,{mouse:r}=e.interactivity;r.inside=!0;let a=!1;const i=r.position;if(i&&n.interactivity.events.onClick.enable){for(const t of e.plugins.values())if(t.clickPositionValid&&(a=t.clickPositionValid(i),a))break;a||this._doMouseTouchClick(t),r.clicking=!1}},this._mouseTouchFinish=()=>{const t=this.container.interactivity;if(!t)return;const e=t.mouse;delete e.position,delete e.clickPosition,delete e.downPosition,t.status=oa,e.inside=!1,e.clicking=!1},this._mouseTouchMove=t=>{const e=this.container,n=e.actualOptions,r=e.interactivity,a=e.canvas.element;if(null===r||void 0===r||!r.element)return;let i;if(r.mouse.inside=!0,t.type.startsWith("pointer")){this._canPush=!0;const e=t;if(r.element===window){if(a){const t=a.getBoundingClientRect();i={x:e.clientX-t.left,y:e.clientY-t.top}}}else if(n.interactivity.detectsOn===pi.parent){const t=e.target,n=e.currentTarget;if(t&&n&&a){const r=t.getBoundingClientRect(),o=n.getBoundingClientRect(),s=a.getBoundingClientRect();i={x:e.offsetX+2*r.left-(o.left+s.left),y:e.offsetY+2*r.top-(o.top+s.top)}}else{var o,s;i={x:null!==(o=e.offsetX)&&void 0!==o?o:e.clientX,y:null!==(s=e.offsetY)&&void 0!==s?s:e.clientY}}}else if(e.target===a){var c,l;i={x:null!==(c=e.offsetX)&&void 0!==c?c:e.clientX,y:null!==(l=e.offsetY)&&void 0!==l?l:e.clientY}}}else if(this._canPush="touchmove"!==t.type,a){var u,h;const e=t,n=e.touches[e.touches.length-1],r=a.getBoundingClientRect();i={x:n.clientX-(null!==(u=r.left)&&void 0!==u?u:0),y:n.clientY-(null!==(h=r.top)&&void 0!==h?h:0)}}const d=e.retina.pixelRatio;i&&(i.x*=d,i.y*=d),r.mouse.position=i,r.status=sa},this._touchEnd=t=>{const e=t,n=Array.from(e.changedTouches);for(const r of n)this._touches.delete(r.identifier);this._mouseTouchFinish()},this._touchEndClick=t=>{const e=t,n=Array.from(e.changedTouches);for(const r of n)this._touches.delete(r.identifier);this._mouseTouchClick(t)},this._touchStart=t=>{const e=t,n=Array.from(e.changedTouches);for(const r of n)this._touches.set(r.identifier,performance.now());this._mouseTouchMove(t)},this._canPush=!0,this._touches=new Map,this._handlers={mouseDown:()=>this._mouseDown(),mouseLeave:()=>this._mouseTouchFinish(),mouseMove:t=>this._mouseTouchMove(t),mouseUp:t=>this._mouseTouchClick(t),touchStart:t=>this._touchStart(t),touchMove:t=>this._mouseTouchMove(t),touchEnd:t=>this._touchEnd(t),touchCancel:t=>this._touchEnd(t),touchEndClick:t=>this._touchEndClick(t),visibilityChange:()=>this._handleVisibilityChange(),themeChange:t=>this._handleThemeChange(t),oldThemeChange:t=>this._handleThemeChange(t),resize:()=>{this._handleWindowResize()}}}addListeners(){this._manageListeners(!0)}removeListeners(){this._manageListeners(!1)}}!function(t){t.configAdded="configAdded",t.containerInit="containerInit",t.particlesSetup="particlesSetup",t.containerStarted="containerStarted",t.containerStopped="containerStopped",t.containerDestroyed="containerDestroyed",t.containerPaused="containerPaused",t.containerPlay="containerPlay",t.containerBuilt="containerBuilt",t.particleAdded="particleAdded",t.particleDestroyed="particleDestroyed",t.particleRemoved="particleRemoved"}(mi||(mi={}));class Ui{constructor(){this.value=""}static create(t,e){const n=new Ui;return n.load(t),void 0!==e&&(Ca(e)||Oa(e)?n.load({value:e}):n.load(e)),n}load(t){Da(t)||Da(t.value)||(this.value=t.value)}}class Vi{constructor(){this.color=new Ui,this.color.value="",this.image="",this.position="",this.repeat="",this.size="",this.opacity=1}load(t){Da(t)||(void 0!==t.color&&(this.color=Ui.create(this.color,t.color)),void 0!==t.image&&(this.image=t.image),void 0!==t.position&&(this.position=t.position),void 0!==t.repeat&&(this.repeat=t.repeat),void 0!==t.size&&(this.size=t.size),void 0!==t.opacity&&(this.opacity=t.opacity))}}class Wi{constructor(){this.opacity=1}load(t){Da(t)||(void 0!==t.color&&(this.color=Ui.create(this.color,t.color)),void 0!==t.image&&(this.image=t.image),void 0!==t.opacity&&(this.opacity=t.opacity))}}class Gi{constructor(){this.composite="destination-out",this.cover=new Wi,this.enable=!1}load(t){if(!Da(t)){if(void 0!==t.composite&&(this.composite=t.composite),void 0!==t.cover){const e=t.cover,n=Ca(t.cover)?{color:t.cover}:t.cover;this.cover.load(void 0!==e.color||void 0!==e.image?e:{color:n})}void 0!==t.enable&&(this.enable=t.enable)}}}class Hi{constructor(){this.enable=!0,this.zIndex=0}load(t){Da(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.zIndex&&(this.zIndex=t.zIndex))}}class qi{constructor(){this.enable=!1,this.mode=[]}load(t){Da(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.mode&&(this.mode=t.mode))}}!function(t){t.circle="circle",t.rectangle="rectangle"}(gi||(gi={}));class Ki{constructor(){this.selectors=[],this.enable=!1,this.mode=[],this.type=gi.circle}load(t){Da(t)||(void 0!==t.selectors&&(this.selectors=t.selectors),void 0!==t.enable&&(this.enable=t.enable),void 0!==t.mode&&(this.mode=t.mode),void 0!==t.type&&(this.type=t.type))}}class Xi{constructor(){this.enable=!1,this.force=2,this.smooth=10}load(t){Da(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.force&&(this.force=t.force),void 0!==t.smooth&&(this.smooth=t.smooth))}}class Yi{constructor(){this.enable=!1,this.mode=[],this.parallax=new Xi}load(t){Da(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.mode&&(this.mode=t.mode),this.parallax.load(t.parallax))}}class Qi{constructor(){this.delay=.5,this.enable=!0}load(t){Da(t)||(void 0!==t.delay&&(this.delay=t.delay),void 0!==t.enable&&(this.enable=t.enable))}}class Ji{constructor(){this.onClick=new qi,this.onDiv=new Ki,this.onHover=new Yi,this.resize=new Qi}load(t){if(Da(t))return;this.onClick.load(t.onClick);const e=t.onDiv;void 0!==e&&(this.onDiv=ci(e,t=>{const e=new Ki;return e.load(t),e})),this.onHover.load(t.onHover),this.resize.load(t.resize)}}class $i{constructor(t,e){this._engine=t,this._container=e}load(t){if(Da(t))return;if(!this._container)return;const e=this._engine.interactors.get(this._container);if(e)for(const n of e)n.loadModeOptions&&n.loadModeOptions(this,t)}}class Zi{constructor(t,e){this.detectsOn=pi.window,this.events=new Ji,this.modes=new $i(t,e)}load(t){if(Da(t))return;const e=t.detectsOn;void 0!==e&&(this.detectsOn=e),this.events.load(t.events),this.modes.load(t.modes)}}class to{load(t){if(!Da(t)){var e,n,r;if(t.position)this.position={x:null!==(e=t.position.x)&&void 0!==e?e:50,y:null!==(n=t.position.y)&&void 0!==n?n:50,mode:null!==(r=t.position.mode)&&void 0!==r?r:$a.percent};t.options&&(this.options=si({},t.options))}}}!function(t){t.screen="screen",t.canvas="canvas"}(yi||(yi={}));class eo{constructor(){this.maxWidth=1/0,this.options={},this.mode=yi.canvas}load(t){Da(t)||(Da(t.maxWidth)||(this.maxWidth=t.maxWidth),Da(t.mode)||(t.mode===yi.screen?this.mode=yi.screen:this.mode=yi.canvas),Da(t.options)||(this.options=si({},t.options)))}}!function(t){t.any="any",t.dark="dark",t.light="light"}(vi||(vi={}));class no{constructor(){this.auto=!1,this.mode=vi.any,this.value=!1}load(t){Da(t)||(void 0!==t.auto&&(this.auto=t.auto),void 0!==t.mode&&(this.mode=t.mode),void 0!==t.value&&(this.value=t.value))}}class ro{constructor(){this.name="",this.default=new no}load(t){Da(t)||(void 0!==t.name&&(this.name=t.name),this.default.load(t.default),void 0!==t.options&&(this.options=si({},t.options)))}}class ao{constructor(){this.count=0,this.enable=!1,this.speed=1,this.decay=0,this.delay=0,this.sync=!1}load(t){Da(t)||(void 0!==t.count&&(this.count=Ga(t.count)),void 0!==t.enable&&(this.enable=t.enable),void 0!==t.speed&&(this.speed=Ga(t.speed)),void 0!==t.decay&&(this.decay=Ga(t.decay)),void 0!==t.delay&&(this.delay=Ga(t.delay)),void 0!==t.sync&&(this.sync=t.sync))}}class io extends ao{constructor(){super(),this.mode=Xa.auto,this.startValue=Za.random}load(t){super.load(t),Da(t)||(void 0!==t.mode&&(this.mode=t.mode),void 0!==t.startValue&&(this.startValue=t.startValue))}}class oo extends ao{constructor(){super(),this.offset=0,this.sync=!0}load(t){super.load(t),Da(t)||void 0!==t.offset&&(this.offset=Ga(t.offset))}}class so{constructor(){this.h=new oo,this.s=new oo,this.l=new oo}load(t){Da(t)||(this.h.load(t.h),this.s.load(t.s),this.l.load(t.l))}}class co extends Ui{constructor(){super(),this.animation=new so}static create(t,e){const n=new co;return n.load(t),void 0!==e&&(Ca(e)||Oa(e)?n.load({value:e}):n.load(e)),n}load(t){if(super.load(t),Da(t))return;const e=t.animation;void 0!==e&&(void 0!==e.enable?this.animation.h.load(e):this.animation.load(t.animation))}}!function(t){t.absorb="absorb",t.bounce="bounce",t.destroy="destroy"}(bi||(bi={}));class lo{constructor(){this.speed=2}load(t){Da(t)||void 0!==t.speed&&(this.speed=t.speed)}}class uo{constructor(){this.enable=!0,this.retries=0}load(t){Da(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.retries&&(this.retries=t.retries))}}class ho{constructor(){this.value=0}load(t){Da(t)||Da(t.value)||(this.value=Ga(t.value))}}class fo extends ho{constructor(){super(),this.animation=new ao}load(t){if(super.load(t),Da(t))return;const e=t.animation;void 0!==e&&this.animation.load(e)}}class po extends fo{constructor(){super(),this.animation=new io}load(t){super.load(t)}}class mo extends ho{constructor(){super(),this.value=1}}class go{constructor(){this.horizontal=new mo,this.vertical=new mo}load(t){Da(t)||(this.horizontal.load(t.horizontal),this.vertical.load(t.vertical))}}class yo{constructor(){this.absorb=new lo,this.bounce=new go,this.enable=!1,this.maxSpeed=50,this.mode=bi.bounce,this.overlap=new uo}load(t){Da(t)||(this.absorb.load(t.absorb),this.bounce.load(t.bounce),void 0!==t.enable&&(this.enable=t.enable),void 0!==t.maxSpeed&&(this.maxSpeed=Ga(t.maxSpeed)),void 0!==t.mode&&(this.mode=t.mode),this.overlap.load(t.overlap))}}class vo{constructor(){this.close=!0,this.fill=!0,this.options={},this.type=[]}load(t){if(Da(t))return;const e=t.options;if(void 0!==e)for(const r in e){const t=e[r];var n;if(t)this.options[r]=si(null!==(n=this.options[r])&&void 0!==n?n:{},t)}void 0!==t.close&&(this.close=t.close),void 0!==t.fill&&(this.fill=t.fill),void 0!==t.type&&(this.type=t.type)}}class bo{constructor(){this.offset=0,this.value=90}load(t){Da(t)||(void 0!==t.offset&&(this.offset=Ga(t.offset)),void 0!==t.value&&(this.value=Ga(t.value)))}}class wo{constructor(){this.distance=200,this.enable=!1,this.rotate={x:3e3,y:3e3}}load(t){if(!Da(t)&&(void 0!==t.distance&&(this.distance=Ga(t.distance)),void 0!==t.enable&&(this.enable=t.enable),t.rotate)){const e=t.rotate.x;void 0!==e&&(this.rotate.x=e);const n=t.rotate.y;void 0!==n&&(this.rotate.y=n)}}}class xo{constructor(){this.x=50,this.y=50,this.mode=$a.percent,this.radius=0}load(t){Da(t)||(void 0!==t.x&&(this.x=t.x),void 0!==t.y&&(this.y=t.y),void 0!==t.mode&&(this.mode=t.mode),void 0!==t.radius&&(this.radius=t.radius))}}class ko{constructor(){this.acceleration=9.81,this.enable=!1,this.inverse=!1,this.maxSpeed=50}load(t){Da(t)||(void 0!==t.acceleration&&(this.acceleration=Ga(t.acceleration)),void 0!==t.enable&&(this.enable=t.enable),void 0!==t.inverse&&(this.inverse=t.inverse),void 0!==t.maxSpeed&&(this.maxSpeed=Ga(t.maxSpeed)))}}class _o{constructor(){this.clamp=!0,this.delay=new ho,this.enable=!1,this.options={}}load(t){Da(t)||(void 0!==t.clamp&&(this.clamp=t.clamp),this.delay.load(t.delay),void 0!==t.enable&&(this.enable=t.enable),this.generator=t.generator,t.options&&(this.options=si(this.options,t.options)))}}class So{load(t){Da(t)||(void 0!==t.color&&(this.color=Ui.create(this.color,t.color)),void 0!==t.image&&(this.image=t.image))}}class To{constructor(){this.enable=!1,this.length=10,this.fill=new So}load(t){Da(t)||(void 0!==t.enable&&(this.enable=t.enable),void 0!==t.fill&&this.fill.load(t.fill),void 0!==t.length&&(this.length=t.length))}}!function(t){t.bounce="bounce",t.none="none",t.out="out",t.destroy="destroy",t.split="split"}(wi||(wi={}));class Io{constructor(){this.default=wi.out}load(t){var e,n,r,a;Da(t)||(void 0!==t.default&&(this.default=t.default),this.bottom=null!==(e=t.bottom)&&void 0!==e?e:t.default,this.left=null!==(n=t.left)&&void 0!==n?n:t.default,this.right=null!==(r=t.right)&&void 0!==r?r:t.default,this.top=null!==(a=t.top)&&void 0!==a?a:t.default)}}class Eo{constructor(){this.acceleration=0,this.enable=!1}load(t){Da(t)||(void 0!==t.acceleration&&(this.acceleration=Ga(t.acceleration)),void 0!==t.enable&&(this.enable=t.enable),t.position&&(this.position=si({},t.position)))}}class No{constructor(){this.angle=new bo,this.attract=new wo,this.center=new xo,this.decay=0,this.distance={},this.direction=Ea.none,this.drift=0,this.enable=!1,this.gravity=new ko,this.path=new _o,this.outModes=new Io,this.random=!1,this.size=!1,this.speed=2,this.spin=new Eo,this.straight=!1,this.trail=new To,this.vibrate=!1,this.warp=!1}load(t){if(Da(t))return;this.angle.load(Aa(t.angle)?{value:t.angle}:t.angle),this.attract.load(t.attract),this.center.load(t.center),void 0!==t.decay&&(this.decay=Ga(t.decay)),void 0!==t.direction&&(this.direction=t.direction),void 0!==t.distance&&(this.distance=Aa(t.distance)?{horizontal:t.distance,vertical:t.distance}:oe({},t.distance)),void 0!==t.drift&&(this.drift=Ga(t.drift)),void 0!==t.enable&&(this.enable=t.enable),this.gravity.load(t.gravity);const e=t.outModes;void 0!==e&&(Ra(e)?this.outModes.load(e):this.outModes.load({default:e})),this.path.load(t.path),void 0!==t.random&&(this.random=t.random),void 0!==t.size&&(this.size=t.size),void 0!==t.speed&&(this.speed=Ga(t.speed)),this.spin.load(t.spin),void 0!==t.straight&&(this.straight=t.straight),this.trail.load(t.trail),void 0!==t.vibrate&&(this.vibrate=t.vibrate),void 0!==t.warp&&(this.warp=t.warp)}}class Co extends io{constructor(){super(),this.destroy=Qa.none,this.speed=2}load(t){super.load(t),Da(t)||void 0!==t.destroy&&(this.destroy=t.destroy)}}class Ao extends po{constructor(){super(),this.animation=new Co,this.value=1}load(t){if(Da(t))return;super.load(t);const e=t.animation;void 0!==e&&this.animation.load(e)}}class Ro{constructor(){this.enable=!1,this.width=1920,this.height=1080}load(t){if(Da(t))return;void 0!==t.enable&&(this.enable=t.enable);const e=t.width;void 0!==e&&(this.width=e);const n=t.height;void 0!==n&&(this.height=n)}}!function(t){t.delete="delete",t.wait="wait"}(xi||(xi={}));class Oo{constructor(){this.mode=xi.delete,this.value=0}load(t){Da(t)||(void 0!==t.mode&&(this.mode=t.mode),void 0!==t.value&&(this.value=t.value))}}class Do{constructor(){this.density=new Ro,this.limit=new Oo,this.value=0}load(t){Da(t)||(this.density.load(t.density),this.limit.load(t.limit),void 0!==t.value&&(this.value=t.value))}}class Mo{constructor(){this.blur=0,this.color=new Ui,this.enable=!1,this.offset={x:0,y:0},this.color.value="#000"}load(t){Da(t)||(void 0!==t.blur&&(this.blur=t.blur),this.color=Ui.create(this.color,t.color),void 0!==t.enable&&(this.enable=t.enable),void 0!==t.offset&&(void 0!==t.offset.x&&(this.offset.x=t.offset.x),void 0!==t.offset.y&&(this.offset.y=t.offset.y)))}}class Fo{constructor(){this.close=!0,this.fill=!0,this.options={},this.type="circle"}load(t){if(Da(t))return;const e=t.options;if(void 0!==e)for(const r in e){const t=e[r];var n;if(t)this.options[r]=si(null!==(n=this.options[r])&&void 0!==n?n:{},t)}void 0!==t.close&&(this.close=t.close),void 0!==t.fill&&(this.fill=t.fill),void 0!==t.type&&(this.type=t.type)}}class Po extends io{constructor(){super(),this.destroy=Qa.none,this.speed=5}load(t){super.load(t),Da(t)||void 0!==t.destroy&&(this.destroy=t.destroy)}}class Lo extends po{constructor(){super(),this.animation=new Po,this.value=3}load(t){if(super.load(t),Da(t))return;const e=t.animation;void 0!==e&&this.animation.load(e)}}class zo{constructor(){this.width=0}load(t){Da(t)||(void 0!==t.color&&(this.color=co.create(this.color,t.color)),void 0!==t.width&&(this.width=Ga(t.width)),void 0!==t.opacity&&(this.opacity=Ga(t.opacity)))}}class Bo extends ho{constructor(){super(),this.opacityRate=1,this.sizeRate=1,this.velocityRate=1}load(t){super.load(t),Da(t)||(void 0!==t.opacityRate&&(this.opacityRate=t.opacityRate),void 0!==t.sizeRate&&(this.sizeRate=t.sizeRate),void 0!==t.velocityRate&&(this.velocityRate=t.velocityRate))}}class jo{constructor(t,e){this._engine=t,this._container=e,this.bounce=new go,this.collisions=new yo,this.color=new co,this.color.value="#fff",this.effect=new vo,this.groups={},this.move=new No,this.number=new Do,this.opacity=new Ao,this.reduceDuplicates=!1,this.shadow=new Mo,this.shape=new Fo,this.size=new Lo,this.stroke=new zo,this.zIndex=new Bo}load(t){if(Da(t))return;if(void 0!==t.groups)for(const r of Object.keys(t.groups)){if(!Object.hasOwn(t.groups,r))continue;const n=t.groups[r];var e;if(void 0!==n)this.groups[r]=si(null!==(e=this.groups[r])&&void 0!==e?e:{},n)}void 0!==t.reduceDuplicates&&(this.reduceDuplicates=t.reduceDuplicates),this.bounce.load(t.bounce),this.color.load(co.create(this.color,t.color)),this.effect.load(t.effect),this.move.load(t.move),this.number.load(t.number),this.opacity.load(t.opacity),this.shape.load(t.shape),this.size.load(t.size),this.shadow.load(t.shadow),this.zIndex.load(t.zIndex),this.collisions.load(t.collisions),void 0!==t.interactivity&&(this.interactivity=si({},t.interactivity));const n=t.stroke;if(n&&(this.stroke=ci(n,t=>{const e=new zo;return e.load(t),e})),this._container){const e=this._engine.updaters.get(this._container);if(e)for(const r of e)r.loadOptions&&r.loadOptions(this,t);const n=this._engine.interactors.get(this._container);if(n)for(const r of n)r.loadParticlesOptions&&r.loadParticlesOptions(this,t)}}}function Uo(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(const a of n)t.load(a)}function Vo(t,e){const n=new jo(t,e);for(var r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];return Uo(n,...a),n}class Wo{constructor(t,e){this._findDefaultTheme=t=>{var e;return null!==(e=this.themes.find(e=>e.default.value&&e.default.mode===t))&&void 0!==e?e:this.themes.find(t=>t.default.value&&t.default.mode===vi.any)},this._importPreset=t=>{this.load(this._engine.getPreset(t))},this._engine=t,this._container=e,this.autoPlay=!0,this.background=new Vi,this.backgroundMask=new Gi,this.clear=!0,this.defaultThemes={},this.delay=0,this.fullScreen=new Hi,this.detectRetina=!0,this.duration=0,this.fpsLimit=120,this.interactivity=new Zi(t,e),this.manualParticles=[],this.particles=Vo(this._engine,this._container),this.pauseOnBlur=!0,this.pauseOnOutsideViewport=!0,this.responsive=[],this.smooth=!1,this.style={},this.themes=[],this.zLayers=100}load(t){var e,n;if(Da(t))return;void 0!==t.preset&&ci(t.preset,t=>this._importPreset(t)),void 0!==t.autoPlay&&(this.autoPlay=t.autoPlay),void 0!==t.clear&&(this.clear=t.clear),void 0!==t.key&&(this.key=t.key),void 0!==t.name&&(this.name=t.name),void 0!==t.delay&&(this.delay=Ga(t.delay));const r=t.detectRetina;void 0!==r&&(this.detectRetina=r),void 0!==t.duration&&(this.duration=Ga(t.duration));const a=t.fpsLimit;void 0!==a&&(this.fpsLimit=a),void 0!==t.pauseOnBlur&&(this.pauseOnBlur=t.pauseOnBlur),void 0!==t.pauseOnOutsideViewport&&(this.pauseOnOutsideViewport=t.pauseOnOutsideViewport),void 0!==t.zLayers&&(this.zLayers=t.zLayers),this.background.load(t.background);const i=t.fullScreen;Na(i)?this.fullScreen.enable=i:this.fullScreen.load(i),this.backgroundMask.load(t.backgroundMask),this.interactivity.load(t.interactivity),t.manualParticles&&(this.manualParticles=t.manualParticles.map(t=>{const e=new to;return e.load(t),e})),this.particles.load(t.particles),this.style=si(this.style,t.style),this._engine.loadOptions(this,t),void 0!==t.smooth&&(this.smooth=t.smooth);const o=this._engine.interactors.get(this._container);if(o)for(const s of o)s.loadOptions&&s.loadOptions(this,t);if(void 0!==t.responsive)for(const s of t.responsive){const t=new eo;t.load(s),this.responsive.push(t)}if(this.responsive.sort((t,e)=>t.maxWidth-e.maxWidth),void 0!==t.themes)for(const s of t.themes){const t=this.themes.find(t=>t.name===s.name);if(t)t.load(s);else{const t=new ro;t.load(s),this.themes.push(t)}}this.defaultThemes.dark=null===(e=this._findDefaultTheme(vi.dark))||void 0===e?void 0:e.name,this.defaultThemes.light=null===(n=this._findDefaultTheme(vi.light))||void 0===n?void 0:n.name}setResponsive(t,e,n){this.load(n);const r=this.responsive.find(n=>n.mode===yi.screen&&screen?n.maxWidth>screen.availWidth:n.maxWidth*e>t);return this.load(null===r||void 0===r?void 0:r.options),null===r||void 0===r?void 0:r.maxWidth}setTheme(t){if(t){const e=this.themes.find(e=>e.name===t);e&&this.load(e.options)}else{const t=ai("(prefers-color-scheme: dark)"),e=null===t||void 0===t?void 0:t.matches,n=this._findDefaultTheme(e?vi.dark:vi.light);n&&this.load(n.options)}}}!function(t){t.external="external",t.particles="particles"}(ki||(ki={}));class Go{constructor(t,e){this.container=e,this._engine=t,this._interactors=[],this._externalInteractors=[],this._particleInteractors=[]}externalInteract(t){for(const e of this._externalInteractors)e.isEnabled()&&e.interact(t)}handleClickMode(t){for(const n of this._externalInteractors){var e;null===(e=n.handleClickMode)||void 0===e||e.call(n,t)}}async init(){this._interactors=await this._engine.getInteractors(this.container,!0),this._externalInteractors=[],this._particleInteractors=[];for(const t of this._interactors){switch(t.type){case ki.external:this._externalInteractors.push(t);break;case ki.particles:this._particleInteractors.push(t)}t.init()}}particlesInteract(t,e){for(const n of this._externalInteractors)n.clear(t,e);for(const n of this._particleInteractors)n.isEnabled(t)&&n.interact(t,e)}reset(t){for(const e of this._externalInteractors)e.isEnabled()&&e.reset(t);for(const e of this._particleInteractors)e.isEnabled(t)&&e.reset(t)}}function Ho(t){if(!ii(t.outMode,t.checkModes))return;const e=2*t.radius;t.coord>t.maxCoord-e?t.setCb(-t.radius):t.coord<e&&t.setCb(t.radius)}!function(t){t.normal="normal",t.inside="inside",t.outside="outside"}(_i||(_i={}));class qo{constructor(t,e){var n=this;this.container=e,this._calcPosition=function(t,e,r){var a,i,o,s;let c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(const m of t.plugins.values()){const t=void 0!==m.particlePosition?m.particlePosition(e,n):void 0;if(t)return Ma.create(t.x,t.y,r)}const l=Ka({size:t.canvas.size,position:e}),u=Ma.create(l.x,l.y,r),h=n.getRadius(),d=n.options.move.outModes,f=e=>{Ho({outMode:e,checkModes:[wi.bounce],coord:u.x,maxCoord:t.canvas.size.width,setCb:t=>u.x+=t,radius:h})},p=e=>{Ho({outMode:e,checkModes:[wi.bounce],coord:u.y,maxCoord:t.canvas.size.height,setCb:t=>u.y+=t,radius:h})};return f(null!==(a=d.left)&&void 0!==a?a:d.default),f(null!==(i=d.right)&&void 0!==i?i:d.default),p(null!==(o=d.top)&&void 0!==o?o:d.default),p(null!==(s=d.bottom)&&void 0!==s?s:d.default),n._checkOverlap(u,c)?n._calcPosition(t,void 0,r,c+1):u},this._calculateVelocity=()=>{const t=function(t){const e=Fa.origin;return e.length=1,e.angle=t,e}(this.direction).copy(),e=this.options.move;if(e.direction===Ea.inside||e.direction===Ea.outside)return t;const n=qa(Ua(e.angle.value)),r=qa(Ua(e.angle.offset)),a={left:r-n*ha,right:r+n*ha};return e.straight||(t.angle+=ja(Ga(a.left,a.right))),e.random&&"number"===typeof e.speed&&(t.length*=za()),t},this._checkOverlap=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=n.options.collisions,a=n.getRadius();if(!r.enable)return!1;const i=r.overlap;if(i.enable)return!1;const o=i.retries;if(o>=0&&e>o)throw new Error("".concat(la," particle is overlapping and can't be placed"));return!!n.container.particles.find(e=>Ha(t,e.position)<a+e.getRadius())},this._getRollColor=t=>{var e;if(!t||!this.roll||!this.backColor&&!this.roll.alter)return t;const n=this.roll.horizontal&&this.roll.vertical?2:1,r=this.roll.horizontal?Math.PI*ha:0;return Math.floor(((null!==(e=this.roll.angle)&&void 0!==e?e:0)+r)/(Math.PI/n))%2?this.backColor?this.backColor:this.roll.alter?function(t,e,n){return{h:t.h,s:t.s,l:t.l+(e===fi.darken?-1:1)*n}}(t,this.roll.alter.type,this.roll.alter.value):t:t},this._initPosition=t=>{var e,n;const r=this.container,a=Ua(this.options.zIndex.value);this.position=this._calcPosition(r,t,Ba(a,0,r.zLayers)),this.initialPosition=this.position.copy();const i=r.canvas.size;switch(this.moveCenter=oe(oe({},hi(this.options.move.center,i)),{},{radius:null!==(e=this.options.move.center.radius)&&void 0!==e?e:0,mode:null!==(n=this.options.move.center.mode)&&void 0!==n?n:$a.percent}),this.direction=function(t,e,n){if(Aa(t))return qa(t);switch(t){case Ea.top:return-Math.PI*ha;case Ea.topRight:return-Math.PI*Ia;case Ea.right:return 0;case Ea.bottomRight:return Math.PI*Ia;case Ea.bottom:return Math.PI*ha;case Ea.bottomLeft:return.75*Math.PI;case Ea.left:return Math.PI;case Ea.topLeft:return.75*-Math.PI;case Ea.inside:return Math.atan2(n.y-e.y,n.x-e.x);case Ea.outside:return Math.atan2(e.y-n.y,e.x-n.x);default:return za()*xa}}(this.options.move.direction,this.position,this.moveCenter),this.options.move.direction){case Ea.inside:this.outType=_i.inside;break;case Ea.outside:this.outType=_i.outside}this.offset=Fa.origin},this._engine=t}destroy(t){var e;if(this.unbreakable||this.destroyed)return;this.destroyed=!0,this.bubble.inRange=!1,this.slow.inRange=!1;const n=this.container,r=this.pathGenerator,a=n.shapeDrawers.get(this.shape);null===a||void 0===a||null===(e=a.particleDestroy)||void 0===e||e.call(a,this);for(const s of n.plugins.values()){var i;null===(i=s.particleDestroyed)||void 0===i||i.call(s,this,t)}for(const s of n.particles.updaters){var o;null===(o=s.particleDestroyed)||void 0===o||o.call(s,this,t)}null===r||void 0===r||r.reset(this),this._engine.dispatchEvent(mi.particleDestroyed,{container:this.container,data:{particle:this}})}draw(t){const e=this.container,n=e.canvas;for(const r of e.plugins.values())n.drawParticlePlugin(r,this,t);n.drawParticle(this,t)}getFillColor(){var t;return this._getRollColor(null!==(t=this.bubble.color)&&void 0!==t?t:Di(this.color))}getMass(){return this.getRadius()**2*Math.PI*ha}getPosition(){return{x:this.position.x+this.offset.x,y:this.position.y+this.offset.y,z:this.position.z}}getRadius(){var t;return null!==(t=this.bubble.radius)&&void 0!==t?t:this.size.value}getStrokeColor(){var t;return this._getRollColor(null!==(t=this.bubble.color)&&void 0!==t?t:Di(this.strokeColor))}init(t,e,n,r){var a,i,o,s,c,l,u,h,d,f,p;const m=this.container,g=this._engine;this.id=t,this.group=r,this.effectClose=!0,this.effectFill=!0,this.shapeClose=!0,this.shapeFill=!0,this.pathRotation=!1,this.lastPathTime=0,this.destroyed=!1,this.unbreakable=!1,this.isRotating=!1,this.rotation=0,this.misplaced=!1,this.retina={maxDistance:{}},this.outType=_i.normal,this.ignoresResizeRatio=!0;const y=m.retina.pixelRatio,v=m.actualOptions,b=Vo(this._engine,m,v.particles),{reduceDuplicates:w}=b,x=b.effect.type,k=b.shape.type;this.effect=li(x,this.id,w),this.shape=li(k,this.id,w);const _=b.effect,S=b.shape;if(n){var T,I;if(null!==(T=n.effect)&&void 0!==T&&T.type){const t=li(n.effect.type,this.id,w);t&&(this.effect=t,_.load(n.effect))}if(null!==(I=n.shape)&&void 0!==I&&I.type){const t=li(n.shape.type,this.id,w);t&&(this.shape=t,S.load(n.shape))}}if(this.effect===wa){const t=[...this.container.effectDrawers.keys()];this.effect=t[Math.floor(Math.random()*t.length)]}if(this.shape===wa){const t=[...this.container.shapeDrawers.keys()];this.shape=t[Math.floor(Math.random()*t.length)]}this.effectData=function(t,e,n,r){const a=e.options[t];if(a)return si({close:e.close,fill:e.fill},li(a,n,r))}(this.effect,_,this.id,w),this.shapeData=function(t,e,n,r){const a=e.options[t];if(a)return si({close:e.close,fill:e.fill},li(a,n,r))}(this.shape,S,this.id,w),b.load(n);const E=this.effectData;E&&b.load(E.particles);const N=this.shapeData;N&&b.load(N.particles);const C=new Zi(g,m);C.load(m.actualOptions.interactivity),C.load(b.interactivity),this.interactivity=C,this.effectFill=null!==(a=null===E||void 0===E?void 0:E.fill)&&void 0!==a?a:b.effect.fill,this.effectClose=null!==(i=null===E||void 0===E?void 0:E.close)&&void 0!==i?i:b.effect.close,this.shapeFill=null!==(o=null===N||void 0===N?void 0:N.fill)&&void 0!==o?o:b.shape.fill,this.shapeClose=null!==(s=null===N||void 0===N?void 0:N.close)&&void 0!==s?s:b.shape.close,this.options=b;const A=this.options.move.path;this.pathDelay=Ua(A.delay.value)*da,A.generator&&(this.pathGenerator=this._engine.getPathGenerator(A.generator),this.pathGenerator&&m.addPath(A.generator,this.pathGenerator)&&this.pathGenerator.init(m)),m.retina.initParticle(this),this.size=function(t,e){const n=t.value,r=t.animation,a={delayTime:Ua(r.delay)*da,enable:r.enable,value:Ua(t.value)*e,max:Wa(n)*e,min:Va(n)*e,loops:0,maxLoops:Ua(r.count),time:0};if(r.enable){switch(a.decay=1-Ua(r.decay),r.mode){case Xa.increase:a.status=Ya.increasing;break;case Xa.decrease:a.status=Ya.decreasing;break;case Xa.random:a.status=za()>=ha?Ya.increasing:Ya.decreasing}const t=r.mode===Xa.auto;switch(r.startValue){case Za.min:a.value=a.min,t&&(a.status=Ya.increasing);break;case Za.max:a.value=a.max,t&&(a.status=Ya.decreasing);break;case Za.random:default:a.value=ja(a),t&&(a.status=za()>=ha?Ya.increasing:Ya.decreasing)}}return a.initialValue=a.value,a}(this.options.size,y),this.bubble={inRange:!1},this.slow={inRange:!1,factor:1},this._initPosition(e),this.initialVelocity=this._calculateVelocity(),this.velocity=this.initialVelocity.copy(),this.moveDecay=1-Ua(this.options.move.decay);const R=m.particles;R.setLastZIndex(this.position.z),this.zIndexFactor=this.position.z/m.zLayers,this.sides=24;let O=m.effectDrawers.get(this.effect);O||(O=this._engine.getEffectDrawer(this.effect),O&&m.effectDrawers.set(this.effect,O)),null!==(c=O)&&void 0!==c&&c.loadEffect&&O.loadEffect(this);let D=m.shapeDrawers.get(this.shape);D||(D=this._engine.getShapeDrawer(this.shape),D&&m.shapeDrawers.set(this.shape,D)),null!==(l=D)&&void 0!==l&&l.loadShape&&D.loadShape(this);const M=null===(u=D)||void 0===u?void 0:u.getSidesCount;M&&(this.sides=M(this)),this.spawning=!1,this.shadowColor=Ii(this._engine,this.options.shadow.color);for(const L of R.updaters)L.init(this);for(const L of R.movers){var F;null===(F=L.init)||void 0===F||F.call(L,this)}null===(h=O)||void 0===h||null===(d=h.particleInit)||void 0===d||d.call(h,m,this),null===(f=D)||void 0===f||null===(p=f.particleInit)||void 0===p||p.call(f,m,this);for(const L of m.plugins.values()){var P;null===(P=L.particleCreated)||void 0===P||P.call(L,this)}}isInsideCanvas(){const t=this.getRadius(),e=this.container.canvas.size,n=this.position;return n.x>=-t&&n.y>=-t&&n.y<=e.height+t&&n.x<=e.width+t}isVisible(){return!this.destroyed&&!this.spawning&&this.isInsideCanvas()}reset(){for(const e of this.container.particles.updaters){var t;null===(t=e.reset)||void 0===t||t.call(e,this)}}}class Ko{constructor(t,e){this.position=t,this.particle=e}}!function(t){t.circle="circle",t.rectangle="rectangle"}(Si||(Si={}));class Xo{constructor(t,e,n){this.position={x:t,y:e},this.type=n}}class Yo extends Xo{constructor(t,e,n){super(t,e,Si.circle),this.radius=n}contains(t){return Ha(t,this.position)<=this.radius}intersects(t){const e=this.position,n=t.position,r=Math.abs(n.x-e.x),a=Math.abs(n.y-e.y),i=this.radius;if(t instanceof Yo||t.type===Si.circle){return i+t.radius>Math.sqrt(r**2+a**2)}if(t instanceof Qo||t.type===Si.rectangle){const e=t,{width:n,height:o}=e.size;return Math.pow(r-n,2)+Math.pow(a-o,2)<=i**2||r<=i+n&&a<=i+o||r<=n||a<=o}return!1}}class Qo extends Xo{constructor(t,e,n,r){super(t,e,Si.rectangle),this.size={height:r,width:n}}contains(t){const e=this.size.width,n=this.size.height,r=this.position;return t.x>=r.x&&t.x<=r.x+e&&t.y>=r.y&&t.y<=r.y+n}intersects(t){if(t instanceof Yo)return t.intersects(this);const e=this.size.width,n=this.size.height,r=this.position,a=t.position,i=t instanceof Qo?t.size:{width:0,height:0},o=i.width,s=i.height;return a.x<r.x+e&&a.x+o>r.x&&a.y<r.y+n&&a.y+s>r.y}}class Jo{constructor(t,e){this.rectangle=t,this.capacity=e,this._subdivide=()=>{const{x:t,y:e}=this.rectangle.position,{width:n,height:r}=this.rectangle.size,{capacity:a}=this;for(let i=0;i<4;i++){const o=i%2;this._subs.push(new Jo(new Qo(t+n*ha*o,e+r*ha*(Math.round(i*ha)-o),n*ha,r*ha),a))}this._divided=!0},this._points=[],this._divided=!1,this._subs=[]}insert(t){return!!this.rectangle.contains(t.position)&&(this._points.length<this.capacity?(this._points.push(t),!0):(this._divided||this._subdivide(),this._subs.some(e=>e.insert(t))))}query(t,e){const n=[];if(!t.intersects(this.rectangle))return[];for(const r of this._points)!t.contains(r.position)&&Ha(t.position,r.position)>r.particle.getRadius()&&(!e||e(r.particle))||n.push(r.particle);if(this._divided)for(const r of this._subs)n.push(...r.query(t,e));return n}queryCircle(t,e,n){return this.query(new Yo(t.x,t.y,e),n)}queryRectangle(t,e,n){return this.query(new Qo(t.x,t.y,e.width,e.height),n)}}const $o=t=>{const{height:e,width:n}=t;return new Qo(-.25*n,-.25*e,1.5*n,1.5*e)};class Zo{constructor(t,e){var n=this;this._addToPool=function(){n._pool.push(...arguments)},this._applyDensity=(t,e,n)=>{var r;const a=t.number;if(null===(r=t.number.density)||void 0===r||!r.enable)return void(void 0===n?this._limit=a.limit.value:a.limit&&this._groupLimits.set(n,a.limit.value));const i=this._initDensityFactor(a.density),o=a.value,s=a.limit.value>0?a.limit.value:o,c=Math.min(o,s)*i+e,l=Math.min(this.count,this.filter(t=>t.group===n).length);void 0===n?this._limit=a.limit.value*i:this._groupLimits.set(n,a.limit.value*i),l<c?this.push(Math.abs(c-l),void 0,t,n):l>c&&this.removeQuantity(l-c,n)},this._initDensityFactor=t=>{const e=this._container;if(!e.canvas.element||!t.enable)return 1;const n=e.canvas.element,r=e.retina.pixelRatio;return n.width*n.height/(t.height*t.width*r**2)},this._pushParticle=(t,e,n,r)=>{try{let a=this._pool.pop();a||(a=new qo(this._engine,this._container)),a.init(this._nextId,t,e,n);let i=!0;if(r&&(i=r(a)),!i)return;return this._array.push(a),this._zArray.push(a),this._nextId++,this._engine.dispatchEvent(mi.particleAdded,{container:this._container,data:{particle:a}}),a}catch(Grt){ni().warning("".concat(la," adding particle: ").concat(Grt))}},this._removeParticle=(t,e,n)=>{const r=this._array[t];if(!r||r.group!==e)return!1;const a=this._zArray.indexOf(r);return this._array.splice(t,1),this._zArray.splice(a,1),r.destroy(n),this._engine.dispatchEvent(mi.particleRemoved,{container:this._container,data:{particle:r}}),this._addToPool(r),!0},this._engine=t,this._container=e,this._nextId=0,this._array=[],this._zArray=[],this._pool=[],this._limit=0,this._groupLimits=new Map,this._needsSort=!1,this._lastZIndex=0,this._interactionManager=new Go(t,e),this._pluginsInitialized=!1;const r=e.canvas.size;this.quadTree=new Jo($o(r),4),this.movers=[],this.updaters=[]}get count(){return this._array.length}addManualParticles(){const t=this._container;t.actualOptions.manualParticles.forEach(e=>this.addParticle(e.position?hi(e.position,t.canvas.size):void 0,e.options))}addParticle(t,e,n,r){var a;const i=this._container.actualOptions.particles.number.limit.mode,o=void 0===n?this._limit:null!==(a=this._groupLimits.get(n))&&void 0!==a?a:this._limit,s=this.count;if(o>0)switch(i){case xi.delete:{const t=s+1-o;t>0&&this.removeQuantity(t);break}case xi.wait:if(s>=o)return}return this._pushParticle(t,e,n,r)}clear(){this._array=[],this._zArray=[],this._pluginsInitialized=!1}destroy(){this._array=[],this._zArray=[],this.movers=[],this.updaters=[]}draw(t){const e=this._container,n=e.canvas;n.clear(),this.update(t);for(const r of e.plugins.values())n.drawPlugin(r,t);for(const r of this._zArray)r.draw(t)}filter(t){return this._array.filter(t)}find(t){return this._array.find(t)}get(t){return this._array[t]}handleClickMode(t){this._interactionManager.handleClickMode(t)}async init(){const t=this._container,e=t.actualOptions;this._lastZIndex=0,this._needsSort=!1,await this.initPlugins();let n=!1;for(const o of t.plugins.values()){var r,a;if(n=null!==(r=null===(a=o.particlesInitialization)||void 0===a?void 0:a.call(o))&&void 0!==r?r:n,n)break}if(this.addManualParticles(),!n){const t=e.particles,n=t.groups;for(const e in n){const r=n[e];for(let n=this.count,a=0;a<(null===(i=r.number)||void 0===i?void 0:i.value)&&n<t.number.value;n++,a++){var i;this.addParticle(void 0,r,e)}}for(let e=this.count;e<t.number.value;e++)this.addParticle()}}async initPlugins(){if(this._pluginsInitialized)return;const t=this._container;this.movers=await this._engine.getMovers(t,!0),this.updaters=await this._engine.getUpdaters(t,!0),await this._interactionManager.init();for(const e of t.pathGenerators.values())e.init(t)}push(t,e,n,r){for(let a=0;a<t;a++)this.addParticle(null===e||void 0===e?void 0:e.position,n,r)}async redraw(){this.clear(),await this.init(),this.draw({value:0,factor:0})}remove(t,e,n){this.removeAt(this._array.indexOf(t),void 0,e,n)}removeAt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(t<0||t>this.count)return;let a=0;for(let i=t;a<e&&i<this.count;i++)this._removeParticle(i,n,r)&&(i--,a++)}removeQuantity(t,e){this.removeAt(0,t,e)}setDensity(){const t=this._container.actualOptions,e=t.particles.groups;for(const n in e)this._applyDensity(e[n],0,n);this._applyDensity(t.particles,t.manualParticles.length)}setLastZIndex(t){this._lastZIndex=t,this._needsSort=this._needsSort||this._lastZIndex<t}setResizeFactor(t){this._resizeFactor=t}update(t){const e=this._container,n=new Set;this.quadTree=new Jo($o(e.canvas.size),4);for(const o of e.pathGenerators.values())o.update();for(const o of e.plugins.values()){var r;null===(r=o.update)||void 0===r||r.call(o,t)}const a=this._resizeFactor;for(const o of this._array){a&&!o.ignoresResizeRatio&&(o.position.x*=a.width,o.position.y*=a.height,o.initialPosition.x*=a.width,o.initialPosition.y*=a.height),o.ignoresResizeRatio=!1,this._interactionManager.reset(o);for(const e of this._container.plugins.values()){var i;if(o.destroyed)break;null===(i=e.particleUpdate)||void 0===i||i.call(e,o,t)}for(const e of this.movers)e.isEnabled(o)&&e.move(o,t);o.destroyed?n.add(o):this.quadTree.insert(new Ko(o.getPosition(),o))}if(n.size){const t=t=>!n.has(t);this._array=this.filter(t),this._zArray=this._zArray.filter(t);for(const e of n)this._engine.dispatchEvent(mi.particleRemoved,{container:this._container,data:{particle:e}});this._addToPool(...n)}this._interactionManager.externalInteract(t);for(const o of this._array){for(const e of this.updaters)e.update(o,t);o.destroyed||o.spawning||this._interactionManager.particlesInteract(o,t)}if(delete this._resizeFactor,this._needsSort){const t=this._zArray;t.sort((t,e)=>e.position.z-t.position.z||t.id-e.id),this._lastZIndex=t[t.length-1].position.z,this._needsSort=!1}}}class ts{constructor(t){this.container=t,this.pixelRatio=1,this.reduceFactor=1}init(){const t=this.container,e=t.actualOptions;this.pixelRatio=!e.detectRetina||ri()?1:window.devicePixelRatio,this.reduceFactor=1;const n=this.pixelRatio,r=t.canvas;if(r.element){const t=r.element;r.size.width=t.offsetWidth*n,r.size.height=t.offsetHeight*n}const a=e.particles,i=a.move;this.maxSpeed=Ua(i.gravity.maxSpeed)*n,this.sizeAnimationSpeed=Ua(a.size.animation.speed)*n}initParticle(t){const e=t.options,n=this.pixelRatio,r=e.move,a=r.distance,i=t.retina;i.moveDrift=Ua(r.drift)*n,i.moveSpeed=Ua(r.speed)*n,i.sizeAnimationSpeed=Ua(e.size.animation.speed)*n;const o=i.maxDistance;o.horizontal=void 0!==a.horizontal?a.horizontal*n:void 0,o.vertical=void 0!==a.vertical?a.vertical*n:void 0,i.maxSpeed=Ua(r.gravity.maxSpeed)*n}}function es(t){return t&&!t.destroyed}function ns(t,e){const n=new Wo(t,e);for(var r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];return Uo(n,...a),n}class rs{constructor(t,e,n){this._intersectionManager=t=>{if(es(this)&&this.actualOptions.pauseOnOutsideViewport)for(const e of t)e.target===this.interactivity.element&&(e.isIntersecting?this.play():this.pause())},this._nextFrame=t=>{try{var e;if(!this._smooth&&void 0!==this._lastFrameTime&&t<this._lastFrameTime+da/this.fpsLimit)return void this.draw(!1);null!==(e=this._lastFrameTime)&&void 0!==e||(this._lastFrameTime=t);const n=function(t){return{value:t,factor:arguments.length>2&&void 0!==arguments[2]&&arguments[2]?60/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:60):60*t/da}}(t-this._lastFrameTime,this.fpsLimit,this._smooth);if(this.addLifeTime(n.value),this._lastFrameTime=t,n.value>da)return void this.draw(!1);if(this.particles.draw(n),!this.alive())return void this.destroy();this.animationStatus&&this.draw(!1)}catch(Grt){ni().error("".concat(la," in animation loop"),Grt)}},this._engine=t,this.id=Symbol(e),this.fpsLimit=120,this._smooth=!1,this._delay=0,this._duration=0,this._lifeTime=0,this._firstStart=!0,this.started=!1,this.destroyed=!1,this._paused=!0,this._lastFrameTime=0,this.zLayers=100,this.pageHidden=!1,this._clickHandlers=new Map,this._sourceOptions=n,this._initialSourceOptions=n,this.retina=new ts(this),this.canvas=new zi(this,this._engine),this.particles=new Zo(this._engine,this),this.pathGenerators=new Map,this.interactivity={mouse:{clicking:!1,inside:!1}},this.plugins=new Map,this.effectDrawers=new Map,this.shapeDrawers=new Map,this._options=ns(this._engine,this),this.actualOptions=ns(this._engine,this),this._eventListeners=new ji(this),this._intersectionObserver=function(t){if(!ri()&&"undefined"!==typeof IntersectionObserver)return new IntersectionObserver(t)}(t=>this._intersectionManager(t)),this._engine.dispatchEvent(mi.containerBuilt,{container:this})}get animationStatus(){return!this._paused&&!this.pageHidden&&es(this)}get options(){return this._options}get sourceOptions(){return this._sourceOptions}addClickHandler(t){if(!es(this))return;const e=this.interactivity.element;if(!e)return;const n=(e,n,r)=>{if(!es(this))return;const a=this.retina.pixelRatio,i={x:n.x*a,y:n.y*a},o=this.particles.quadTree.queryCircle(i,r*a);t(e,o)};let r=!1,a=!1;this._clickHandlers.set("click",t=>{if(!es(this))return;const e=t,r={x:e.offsetX||e.clientX,y:e.offsetY||e.clientY};n(t,r,1)}),this._clickHandlers.set("touchstart",()=>{es(this)&&(r=!0,a=!1)}),this._clickHandlers.set("touchmove",()=>{es(this)&&(a=!0)}),this._clickHandlers.set("touchend",t=>{if(es(this)){if(r&&!a){const e=t;let r=e.touches[e.touches.length-1];if(!r&&(r=e.changedTouches[e.changedTouches.length-1],!r))return;const a=this.canvas.element,i=a?a.getBoundingClientRect():void 0,o={x:r.clientX-(i?i.left:0),y:r.clientY-(i?i.top:0)};n(t,o,Math.max(r.radiusX,r.radiusY))}r=!1,a=!1}}),this._clickHandlers.set("touchcancel",()=>{es(this)&&(r=!1,a=!1)});for(const[i,o]of this._clickHandlers)e.addEventListener(i,o)}addLifeTime(t){this._lifeTime+=t}addPath(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!(!es(this)||!n&&this.pathGenerators.has(t))&&(this.pathGenerators.set(t,e),!0)}alive(){return!this._duration||this._lifeTime<=this._duration}clearClickHandlers(){if(es(this)){for(const[e,n]of this._clickHandlers){var t;null===(t=this.interactivity.element)||void 0===t||t.removeEventListener(e,n)}this._clickHandlers.clear()}}destroy(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(es(this)){this.stop(),this.clearClickHandlers(),this.particles.destroy(),this.canvas.destroy();for(const t of this.effectDrawers.values()){var e;null===(e=t.destroy)||void 0===e||e.call(t,this)}for(const t of this.shapeDrawers.values()){var n;null===(n=t.destroy)||void 0===n||n.call(t,this)}for(const t of this.effectDrawers.keys())this.effectDrawers.delete(t);for(const t of this.shapeDrawers.keys())this.shapeDrawers.delete(t);if(this._engine.clearPlugins(this),this.destroyed=!0,t){const t=this._engine.items,e=t.findIndex(t=>t===this);e>=0&&t.splice(e,1)}this._engine.dispatchEvent(mi.containerDestroyed,{container:this})}}draw(t){if(!es(this))return;let e=t;const n=t=>{e&&(this._lastFrameTime=void 0,e=!1),this._nextFrame(t)};var r;this._drawAnimationFrame=(r=t=>n(t),La.nextFrame(r))}async export(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(const n of this.plugins.values()){if(!n.export)continue;const r=await n.export(t,e);if(r.supported)return r.blob}ni().error("".concat(la," - Export plugin with type ").concat(t," not found"))}handleClickMode(t){if(es(this)){this.particles.handleClickMode(t);for(const n of this.plugins.values()){var e;null===(e=n.handleClickMode)||void 0===e||e.call(n,t)}}}async init(){if(!es(this))return;const t=this._engine.getSupportedEffects();for(const d of t){const t=this._engine.getEffectDrawer(d);t&&this.effectDrawers.set(d,t)}const e=this._engine.getSupportedShapes();for(const d of e){const t=this._engine.getShapeDrawer(d);t&&this.shapeDrawers.set(d,t)}await this.particles.initPlugins(),this._options=ns(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=ns(this._engine,this,this._options);const n=await this._engine.getAvailablePlugins(this);for(const[d,f]of n)this.plugins.set(d,f);this.retina.init(),await this.canvas.init(),this.updateActualOptions(),this.canvas.initBackground(),this.canvas.resize();const{zLayers:r,duration:a,delay:i,fpsLimit:o,smooth:s}=this.actualOptions;this.zLayers=r,this._duration=Ua(a)*da,this._delay=Ua(i)*da,this._lifeTime=0,this.fpsLimit=o>0?o:120,this._smooth=s;for(const d of this.effectDrawers.values()){var c;await(null===(c=d.init)||void 0===c?void 0:c.call(d,this))}for(const d of this.shapeDrawers.values()){var l;await(null===(l=d.init)||void 0===l?void 0:l.call(d,this))}for(const d of this.plugins.values()){var u;await(null===(u=d.init)||void 0===u?void 0:u.call(d))}this._engine.dispatchEvent(mi.containerInit,{container:this}),await this.particles.init(),this.particles.setDensity();for(const d of this.plugins.values()){var h;null===(h=d.particlesSetup)||void 0===h||h.call(d)}this._engine.dispatchEvent(mi.particlesSetup,{container:this})}async loadTheme(t){es(this)&&(this._currentTheme=t,await this.refresh())}pause(){var t;if(es(this)&&(void 0!==this._drawAnimationFrame&&(t=this._drawAnimationFrame,La.cancel(t),delete this._drawAnimationFrame),!this._paused)){for(const t of this.plugins.values()){var e;null===(e=t.pause)||void 0===e||e.call(t)}this.pageHidden||(this._paused=!0),this._engine.dispatchEvent(mi.containerPaused,{container:this})}}play(t){if(!es(this))return;const e=this._paused||t;if(!this._firstStart||this.actualOptions.autoPlay){if(this._paused&&(this._paused=!1),e)for(const t of this.plugins.values())t.play&&t.play();this._engine.dispatchEvent(mi.containerPlay,{container:this}),this.draw(null!==e&&void 0!==e&&e)}else this._firstStart=!1}async refresh(){if(es(this))return this.stop(),this.start()}async reset(t){if(es(this))return this._initialSourceOptions=t,this._sourceOptions=t,this._options=ns(this._engine,this,this._initialSourceOptions,this.sourceOptions),this.actualOptions=ns(this._engine,this,this._options),this.refresh()}async start(){es(this)&&!this.started&&(await this.init(),this.started=!0,await new Promise(t=>{const e=async()=>{this._eventListeners.addListeners(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.observe(this.interactivity.element);for(const t of this.plugins.values()){var e;await(null===(e=t.start)||void 0===e?void 0:e.call(t))}this._engine.dispatchEvent(mi.containerStarted,{container:this}),this.play(),t()};this._delayTimeout=setTimeout(()=>{e()},this._delay)}))}stop(){if(es(this)&&this.started){this._delayTimeout&&(clearTimeout(this._delayTimeout),delete this._delayTimeout),this._firstStart=!0,this.started=!1,this._eventListeners.removeListeners(),this.pause(),this.particles.clear(),this.canvas.stop(),this.interactivity.element instanceof HTMLElement&&this._intersectionObserver&&this._intersectionObserver.unobserve(this.interactivity.element);for(const e of this.plugins.values()){var t;null===(t=e.stop)||void 0===t||t.call(e)}for(const t of this.plugins.keys())this.plugins.delete(t);this._sourceOptions=this._options,this._engine.dispatchEvent(mi.containerStopped,{container:this})}}updateActualOptions(){this.actualOptions.responsive=[];const t=this.actualOptions.setResponsive(this.canvas.size.width,this.retina.pixelRatio,this._options);return this.actualOptions.setTheme(this._currentTheme),this._responsiveMaxWidth!==t&&(this._responsiveMaxWidth=t,!0)}}class as{constructor(){this._listeners=new Map}addEventListener(t,e){this.removeEventListener(t,e);let n=this._listeners.get(t);n||(n=[],this._listeners.set(t,n)),n.push(e)}dispatchEvent(t,e){const n=this._listeners.get(t);null===n||void 0===n||n.forEach(t=>t(e))}hasEventListener(t){return!!this._listeners.get(t)}removeAllEventListeners(t){t?this._listeners.delete(t):this._listeners=new Map}removeEventListener(t,e){const n=this._listeners.get(t);if(!n)return;const r=n.length,a=n.indexOf(e);a<0||(1===r?this._listeners.delete(t):n.splice(a,1))}}async function is(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.get(t);return a&&!r||(a=await Promise.all([...n.values()].map(e=>e(t))),e.set(t,a)),a}class os{constructor(){this._configs=new Map,this._domArray=[],this._eventDispatcher=new as,this._initialized=!1,this.plugins=[],this.colorManagers=new Map,this.easingFunctions=new Map,this._initializers={interactors:new Map,movers:new Map,updaters:new Map},this.interactors=new Map,this.movers=new Map,this.updaters=new Map,this.presets=new Map,this.effectDrawers=new Map,this.shapeDrawers=new Map,this.pathGenerators=new Map}get configs(){const t={};for(const[e,n]of this._configs)t[e]=n;return t}get items(){return this._domArray}get version(){return"3.8.1"}async addColorManager(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.colorManagers.set(t.key,t),await this.refresh(e)}addConfig(t){var e,n;const r=null!==(e=null!==(n=t.key)&&void 0!==n?n:t.name)&&void 0!==e?e:"default";this._configs.set(r,t),this._eventDispatcher.dispatchEvent(mi.configAdded,{data:{name:r,config:t}})}async addEasing(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.getEasing(t)||(this.easingFunctions.set(t,e),await this.refresh(n))}async addEffect(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];ci(t,t=>{this.getEffectDrawer(t)||this.effectDrawers.set(t,e)}),await this.refresh(n)}addEventListener(t,e){this._eventDispatcher.addEventListener(t,e)}async addInteractor(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._initializers.interactors.set(t,e),await this.refresh(n)}async addMover(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._initializers.movers.set(t,e),await this.refresh(n)}async addParticleUpdater(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._initializers.updaters.set(t,e),await this.refresh(n)}async addPathGenerator(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.getPathGenerator(t)||this.pathGenerators.set(t,e),await this.refresh(n)}async addPlugin(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.getPlugin(t.id)||this.plugins.push(t),await this.refresh(e)}async addPreset(t,e){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&this.getPreset(t)||this.presets.set(t,e),await this.refresh(n)}async addShape(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(const n of t.validTypes)this.getShapeDrawer(n)||this.shapeDrawers.set(n,t);await this.refresh(e)}checkVersion(t){if(this.version!==t)throw new Error("The tsParticles version is different from the loaded plugins version. Engine version: ".concat(this.version,". Plugin version: ").concat(t))}clearPlugins(t){this.updaters.delete(t),this.movers.delete(t),this.interactors.delete(t)}dispatchEvent(t,e){this._eventDispatcher.dispatchEvent(t,e)}dom(){return this.items}domItem(t){return this.item(t)}async getAvailablePlugins(t){const e=new Map;for(const n of this.plugins)n.needsPlugin(t.actualOptions)&&e.set(n.id,await n.getPlugin(t));return e}getEasing(t){var e;return null!==(e=this.easingFunctions.get(t))&&void 0!==e?e:t=>t}getEffectDrawer(t){return this.effectDrawers.get(t)}async getInteractors(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return is(t,this.interactors,this._initializers.interactors,e)}async getMovers(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return is(t,this.movers,this._initializers.movers,e)}getPathGenerator(t){return this.pathGenerators.get(t)}getPlugin(t){return this.plugins.find(e=>e.id===t)}getPreset(t){return this.presets.get(t)}getShapeDrawer(t){return this.shapeDrawers.get(t)}getSupportedEffects(){return this.effectDrawers.keys()}getSupportedShapes(){return this.shapeDrawers.keys()}async getUpdaters(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return is(t,this.updaters,this._initializers.updaters,e)}init(){this._initialized||(this._initialized=!0)}item(t){const{items:e}=this,n=e[t];if(n&&!n.destroyed)return n;e.splice(t,1)}async load(t){var e,n,r;const a=null!==(e=null!==(n=t.id)&&void 0!==n?n:null===(r=t.element)||void 0===r?void 0:r.id)&&void 0!==e?e:"tsparticles".concat(Math.floor(1e4*za())),{index:i,url:o}=t,s=o?await async function(t){const e=li(t.url,t.index);if(!e)return t.fallback;const n=await fetch(e);return n.ok?await n.json():(ni().error("".concat(la," ").concat(n.status," while retrieving config file")),t.fallback)}({fallback:t.options,url:o,index:i}):t.options,c=li(s,i),{items:l}=this,u=l.findIndex(t=>t.id.description===a),h=new rs(this,a,c);if(u>=0){const t=this.item(u),e=t?1:0;t&&!t.destroyed&&t.destroy(!1),l.splice(u,e,h)}else l.push(h);const d=((t,e)=>{let n=null!==e&&void 0!==e?e:document.getElementById(t);return n||(n=document.createElement("div"),n.id=t,n.dataset[ia]=ka,document.body.append(n),n)})(a,t.element),f=(t=>{let e;if(t instanceof HTMLCanvasElement||t.tagName.toLowerCase()===Sa)e=t,e.dataset[ia]||(e.dataset[ia]=_a);else{const n=t.getElementsByTagName(Sa);n.length?(e=n[0],e.dataset[ia]=_a):(e=document.createElement(Sa),e.dataset[ia]=ka,t.appendChild(e))}const n="100%";return e.style.width||(e.style.width=n),e.style.height||(e.style.height=n),e})(d);return h.canvas.loadCanvas(f),await h.start(),h}loadOptions(t,e){this.plugins.forEach(n=>{var r;return null===(r=n.loadOptions)||void 0===r?void 0:r.call(n,t,e)})}loadParticlesOptions(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];const i=this.updaters.get(t);i&&i.forEach(t=>{var n;return null===(n=t.loadOptions)||void 0===n?void 0:n.call(t,e,...r)})}async refresh(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&await Promise.all(this.items.map(t=>t.refresh()))}removeEventListener(t,e){this._eventDispatcher.removeEventListener(t,e)}setOnClickHandler(t){const{items:e}=this;if(!e.length)throw new Error("".concat(la," can only set click handlers after calling tsParticles.load()"));e.forEach(e=>e.addClickHandler(t))}}var ss,cs,ls;!function(t){t.clockwise="clockwise",t.counterClockwise="counter-clockwise",t.random="random"}(ss||(ss={})),function(t){t.linear="linear",t.radial="radial",t.random="random"}(cs||(cs={})),function(t){t.easeInBack="ease-in-back",t.easeInCirc="ease-in-circ",t.easeInCubic="ease-in-cubic",t.easeInLinear="ease-in-linear",t.easeInQuad="ease-in-quad",t.easeInQuart="ease-in-quart",t.easeInQuint="ease-in-quint",t.easeInExpo="ease-in-expo",t.easeInSine="ease-in-sine",t.easeOutBack="ease-out-back",t.easeOutCirc="ease-out-circ",t.easeOutCubic="ease-out-cubic",t.easeOutLinear="ease-out-linear",t.easeOutQuad="ease-out-quad",t.easeOutQuart="ease-out-quart",t.easeOutQuint="ease-out-quint",t.easeOutExpo="ease-out-expo",t.easeOutSine="ease-out-sine",t.easeInOutBack="ease-in-out-back",t.easeInOutCirc="ease-in-out-circ",t.easeInOutCubic="ease-in-out-cubic",t.easeInOutLinear="ease-in-out-linear",t.easeInOutQuad="ease-in-out-quad",t.easeInOutQuart="ease-in-out-quart",t.easeInOutQuint="ease-in-out-quint",t.easeInOutExpo="ease-in-out-expo",t.easeInOutSine="ease-in-out-sine"}(ls||(ls={}));const us=function(){const t=new os;return t.init(),t}();ri()||(window.tsParticles=us);const hs=t=>{var e;const n=null!==(e=t.id)&&void 0!==e?e:"tsparticles";return(0,C.useEffect)(()=>{let e;return us.load({id:n,url:t.url,options:t.options}).then(n=>{var r;e=n,null==(r=t.particlesLoaded)||r.call(t,n)}),()=>{null==e||e.destroy()}},[n,t,t.url,t.options]),(0,ra.jsx)("div",{id:n,className:t.className})};const ds={background:{color:{value:"#33ffe0 "}},particles:{number:{value:50,density:{enable:!0,area:800}},color:{value:"#00ffff"},shape:{type:"circle"},opacity:{value:.5},size:{value:{min:1,max:5}},links:{enable:!0,distance:150,color:"#00ffff",opacity:.4,width:1},move:{enable:!0,speed:1.5,direction:"none",outModes:"bounce"}},detectRetina:!0},fs=t=>{let{handleSubmit:e,handleChange:n,handleFileChange:r,loading:a}=t;return(0,ra.jsxs)("div",{className:"container d-flex flex-column justify-content-center align-items-center",children:[(0,ra.jsx)("div",{children:(0,ra.jsx)("h3",{children:"Fill Form Below to continue.."})}),(0,ra.jsxs)("div",{style:{position:"relative",height:"100vh",overflow:"hidden"},children:[(0,ra.jsx)(hs,{id:"tsparticles",options:ds,style:{position:"absolute",top:0,left:0,zIndex:0,pointerEvents:"none"}}),(0,ra.jsx)("div",{className:"container d-flex justify-content-center align-items-center",style:{height:"100%",position:"relative",zIndex:2},children:(0,ra.jsxs)("form",{onSubmit:e,className:"row g-3 bg- p-4 rounded",style:{minWidth:"60%",boxShadow:"0 0 20px #00ffff99",color:"#0ff",backgroundColor:"#E8E7E5"},children:[(0,ra.jsx)("div",{className:"col-12 col-md-6",children:(0,ra.jsx)("input",{name:"name",placeholder:"Your Name",className:"form-control",onChange:n})}),(0,ra.jsx)("div",{className:"col-12 col-md-6",children:(0,ra.jsx)("input",{name:"location",placeholder:"Location",className:"form-control",onChange:n})}),(0,ra.jsx)("div",{className:"col-12 col-md-6",children:(0,ra.jsx)("input",{name:"education",placeholder:"Education",className:"form-control",onChange:n})}),(0,ra.jsx)("div",{className:"col-12 col-md-6",children:(0,ra.jsx)("input",{name:"fatherName",placeholder:"Father's Name",className:"form-control",onChange:n})}),(0,ra.jsx)("div",{className:"col-12 col-md-6",children:(0,ra.jsx)("input",{name:"motherName",placeholder:"Mother's Name",className:"form-control",onChange:n})}),(0,ra.jsx)("div",{className:"col-12 col-md-6",children:(0,ra.jsx)("input",{name:"siblings",placeholder:"No. of Siblings",className:"form-control",onChange:n})}),(0,ra.jsxs)("div",{className:"col-12",children:[(0,ra.jsx)("label",{className:"form-label",children:"Upload Resume"}),(0,ra.jsx)("input",{name:"resume",type:"file",accept:".pdf,.doc,.docx",onChange:r,className:"form-control"})]}),(0,ra.jsx)("div",{className:"col-12",children:(0,ra.jsx)("button",{type:"submit",className:"btn btn-info mt-2 w-100 text-black fw-bold",children:a?"Generating...":"Submit & Generate AI Question"})})]})})]})]})},ps=t=>{let{children:e}=t;const n=(0,C.useRef)(null);return(0,C.useEffect)(()=>{let t=null;return window.VANTA&&window.VANTA.WAVES&&n.current&&(t=window.VANTA.WAVES({el:n.current,mouseControls:!0,touchControls:!0,gyroControls:!1,minHeight:200,minWidth:200,scale:1,scaleMobile:1,color:21896,shininess:30,waveHeight:15,waveSpeed:1,zoom:1})),()=>{t&&(t.destroy(),t.current=null)}},[]),(0,ra.jsxs)("div",{style:{position:"relative",minHeight:"100vh",width:"100%"},children:[(0,ra.jsx)("div",{ref:n,style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:-1}}),(0,ra.jsx)("div",{style:{position:"relative",zIndex:1},children:e})]})};class ms{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class gs{refCount(t){return ys("refCount")}incRef(t){return ys("incRef")}timerAvailable(){return!0}time(t){return ys("time")}read(t){return ys("read")}readSync(t){return ys("readSync")}readToGPU(t,e){return ys("readToGPU")}numDataIds(){return ys("numDataIds")}disposeData(t,e){return ys("disposeData")}write(t,e,n){return ys("write")}move(t,e,n,r,a){return ys("move")}memory(){return ys("memory")}floatPrecision(){return ys("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return ys("dispose")}}function ys(t){throw new Error("'".concat(t,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}function vs(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,xs(t,e,n)}function bs(t,e,n){return Math.max(t,Math.min(e,n))}function ws(t){return t%2===0?t:t+1}function xs(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function ks(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function _s(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";ks(Es(t,e),()=>n+" Shapes ".concat(t," and ").concat(e," must match"))}function Ss(t){ks(null!=t,()=>"The input to the tensor constructor must be a non-null value.")}function Ts(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e&&(e=[]),Array.isArray(t)||zs(t)&&!n)for(let r=0;r<t.length;++r)Ts(t[r],e,n);else e.push(t);return e}function Is(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Es(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Ns(t){return t%1===0}function Cs(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function As(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Rs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t=>0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:setTimeout;return new Promise((a,i)=>{let o=0;const s=()=>{if(t())return void a();o++;const c=e(o);null!=n&&o>=n?i():r(s,c)};s()})}function Os(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(i));r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found ".concat(t[i]," at dim ").concat(i));if(-1===r){if(e>0&&e!==n)throw Error("Size(".concat(e,") must match the product of shape ").concat(t));return t}if(0===n)throw Error("Cannot infer the missing size in [".concat(t,"] when ")+"there are 0 elements");if(e%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(e," / ").concat(n));const a=t.slice();return a[r]=e/n,a}function Ds(t,e){const n=e.length;return ks((t=null==t?e.map((t,e)=>e):[].concat(t)).every(t=>t>=-n&&t<n),()=>"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(t)),ks(t.every(t=>Ns(t)),()=>"All values in axis param must be integers but "+"got axis ".concat(t)),t.map(t=>t<0?n+t:t)}function Ms(t,e){const n=[],r=[],a=null!=e&&Array.isArray(e)&&0===e.length,i=null==e||a?null:Ds(e,t).sort();let o=0;for(let s=0;s<t.length;++s){if(null!=i){if(i[o]===s&&1!==t[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(t[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),i[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function Fs(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type ".concat(t));n=new Uint8Array(e)}return n}function Ps(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type ".concat(t));n=new Array(e)}return n}function Ls(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function zs(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function Bs(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype ".concat(t))}function js(t){return"string"===typeof t||t instanceof String}function Us(t){return"number"===typeof t}function Vs(t){return Array.isArray(t)?Vs(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Us(t)?"float32":js(t)?"string":"boolean"===typeof t?"bool":"float32"}function Ws(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Gs(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Hs(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function qs(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=new Array;if(1===e.length){const i=e[0]*(r?2:1);for(let e=0;e<i;e++)a[e]=n[t+e]}else{const i=e[0],o=e.slice(1),s=o.reduce((t,e)=>t*e)*(r?2:1);for(let e=0;e<i;e++)a[e]=qs(t+e*s,o,n,r)}return a}function Ks(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===t.length)return e[0];const r=t.reduce((t,e)=>t*e)*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error("[".concat(t,"] does not match the input size ").concat(e.length).concat(n?" for a complex tensor":"","."));return qs(0,t,e,n)}function Xs(t,e){const n=Ys(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function Ys(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type ".concat(e))}function Qs(t,e){const n=t.reduce((t,e)=>t*e,1);if(null==e||"float32"===e)return Ks(t,new Float32Array(n));if("int32"===e)return Ks(t,new Int32Array(n));if("bool"===e)return Ks(t,new Uint8Array(n));throw new Error("Unknown data type ".concat(e))}function Js(t){t.forEach(e=>{ks(Number.isInteger(e)&&e>=0,()=>"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(t,"]."))})}function $s(t,e,n){if(0===e)return 0;if(1===e)return t[0];let r=t[t.length-1];for(let a=0;a<t.length-1;++a)r+=n[a]*t[a];return r}function Zs(t,e,n){if(0===e)return[];if(1===e)return[t];const r=new Array(e);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(t/n[a]),t-=r[a]*n[a];return r[r.length-1]=t,r}function tc(t){return t&&t.then&&"function"===typeof t.then}const ec="tfjsflags";class nc{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=rc,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(ac().getBool("IS_TEST")||ac().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,"."))),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];ac().getBool("IS_TEST")||ac().getBool("PROD")||console.warn("Setting feature override from URL ".concat(t,": ").concat(e,".")),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(tc(e))throw new Error("Flag ".concat(t," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag ".concat(t," as it has not been registered."));this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '".concat(t,"': no evaluation function found."));return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const t=this.getQueryParams(this.global.location.search);if(ec in t){t[ec].split(",").forEach(t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if("".concat(+e)===e)return+e;throw new Error("Could not parse value flag value ".concat(e," for flag ").concat(t,"."))}(e,n)})}}}function rc(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,r[0],r[1]),r.join("=")}),e}function ac(){return oc}let ic,oc=null;function sc(){if(null==ic){let t;if("undefined"!==typeof window)t=window;else if("undefined"!==typeof n.g)t=n.g;else if("undefined"!==typeof process)t=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");t=self}ic=t}return ic}function cc(t,e){const n=function(){const t=sc();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const lc="Abs",uc="Acos",hc="Acosh",dc="Add",fc="AddN",pc="All",mc="Any",gc="ArgMax",yc="ArgMin",vc="Asin",bc="Asinh",wc="Atan",xc="Atanh",kc="Atan2",_c="AvgPool",Sc="AvgPoolGrad",Tc="AvgPool3D",Ic="AvgPool3DGrad",Ec="BatchMatMul",Nc="BatchToSpaceND",Cc="Bincount",Ac="BroadcastArgs",Rc="Cast",Oc="Ceil",Dc="ClipByValue",Mc="Complex",Fc="ComplexAbs",Pc="Concat",Lc="Conv2D",zc="Conv2DBackpropFilter",Bc="Conv2DBackpropInput",jc="Conv3D",Uc="Conv3DBackpropFilterV2",Vc="Conv3DBackpropInputV2",Wc="Cos",Gc="Cosh",Hc="Cumprod",qc="Cumsum",Kc="CropAndResize",Xc="DenseBincount",Yc="DepthToSpace",Qc="DepthwiseConv2dNative",Jc="DepthwiseConv2dNativeBackpropFilter",$c="DepthwiseConv2dNativeBackpropInput",Zc="Diag",tl="Dilation2D",el="Dilation2DBackpropInput",nl="Dilation2DBackpropFilter",rl="RealDiv",al="Einsum",il="Elu",ol="EluGrad",sl="Erf",cl="Equal",ll="Exp",ul="ExpandDims",hl="Expm1",dl="FFT",fl="Fill",pl="FlipLeftRight",ml="Floor",gl="FloorDiv",yl="FusedBatchNorm",vl="GatherV2",bl="GatherNd",wl="Greater",xl="GreaterEqual",kl="Identity",_l="IFFT",Sl="Imag",Tl="IsFinite",Il="IsInf",El="IsNan",Nl="LeakyRelu",Cl="Less",Al="LessEqual",Rl="LinSpace",Ol="Log",Dl="Log1p",Ml="LogicalAnd",Fl="LogicalNot",Pl="LogicalOr",Ll="LRN",zl="LRNGrad",Bl="Max",jl="Maximum",Ul="MaxPool",Vl="MaxPoolGrad",Wl="MaxPool3D",Gl="MaxPool3DGrad",Hl="MaxPoolWithArgmax",ql="Mean",Kl="Min",Xl="Minimum",Yl="MirrorPad",Ql="Mod",Jl="Multinomial",$l="Multiply",Zl="Neg",tu="NotEqual",eu="NonMaxSuppressionV3",nu="NonMaxSuppressionV4",ru="NonMaxSuppressionV5",au="OnesLike",iu="OneHot",ou="Pack",su="PadV2",cu="Pow",lu="Prelu",uu="Prod",hu="RaggedGather",du="RaggedTensorToTensor",fu="Range",pu="Real",mu="Reciprocal",gu="Relu",yu="Reshape",vu="ResizeNearestNeighbor",bu="ResizeNearestNeighborGrad",wu="ResizeBilinear",xu="ResizeBilinearGrad",ku="Relu6",_u="Reverse",Su="Round",Tu="Rsqrt",Iu="ScatterNd",Eu="SearchSorted",Nu="Select",Cu="Selu",Au="Slice",Ru="Sin",Ou="Sinh",Du="Sign",Mu="Sigmoid",Fu="Softplus",Pu="Sqrt",Lu="Sum",zu="SpaceToBatchND",Bu="SplitV",ju="Softmax",Uu="SparseFillEmptyRows",Vu="SparseReshape",Wu="SparseSegmentMean",Gu="SparseSegmentSum",Hu="SparseToDense",qu="SquaredDifference",Ku="Square",Xu="StridedSlice",Yu="StringNGrams",Qu="StringSplit",Ju="StringToHashBucketFast",$u="Sub",Zu="Tan",th="Tanh",eh="Tile",nh="TopK",rh="Transform",ah="Transpose",ih="Unique",oh="Unpack",sh="UnsortedSegmentSum",ch="ZerosLike",lh="Step",uh="FromPixels",hh="RotateWithOffset",dh="_FusedMatMul",fh="FusedConv2D",ph="FusedDepthwiseConv2D";function mh(){ac().getBool("IS_TEST")||ac().getBool("PROD")||console.warn(...arguments)}function gh(){ac().getBool("IS_TEST")||ac().getBool("PROD")||console.log(...arguments)}const yh=cc("kernelRegistry",()=>new Map),vh=cc("gradRegistry",()=>new Map);function bh(t,e){const n=Sh(t,e);return yh.get(n)}function wh(t){return vh.get(t)}function xh(t){const e=yh.entries(),n=[];for(;;){const{done:r,value:a}=e.next();if(r)break;const[i,o]=a,[s]=i.split("_");s===t&&n.push(o)}return n}function kh(t){const{kernelName:e,backendName:n}=t,r=Sh(e,n);yh.has(r)&&mh("The kernel '".concat(e,"' for backend ")+"'".concat(n,"' is already registered")),yh.set(r,t)}function _h(t){const{kernelName:e}=t;vh.has(e)&&ac().getBool("DEBUG")&&mh("Overriding the gradient for '".concat(e,"'")),vh.set(e,t)}function Sh(t,e){return"".concat(e,"_").concat(t)}var Th=n(7353);const Ih=n.n(Th)()||Th;function Eh(t){return Ih.fromString(t,!0,16)}const Nh=Eh("c3a5c85c97cb3127"),Ch=Eh("b492b66fbe98f273"),Ah=Eh("9ae16a3b2f90404f");function Rh(t){return t.xor(t.shru(47))}function Oh(t,e,n){const r=t.slice(e,e+n);return Ih.fromBytes(Array.from(r),!0,!0)}function Dh(t,e){return Oh(t,e,8)}function Mh(t,e){return Oh(t,e,4)}function Fh(t,e){return 0===e?t:t.shru(e).or(t.shl(64-e))}function Ph(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Eh("9ddfea08eb382d69"),r=t.xor(e).mul(n);r=r.xor(r.shru(47));let a=e.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function Lh(t,e,n,r){return function(t,e,n,r,a,i){a=a.add(t),i=Fh(i.add(a).add(r),21);const o=a;return a=(a=a.add(e)).add(n),i=i.add(Fh(a,44)),[a.add(r),i.add(o)]}(Dh(t,e),Dh(t,e+8),Dh(t,e+16),Dh(t,e+24),n,r)}function zh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=Ih.fromNumber(81,!0);if(e<=32)return e<=16?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;if(e>=8){const n=Ah.add(2*e),r=Dh(t,0).add(Ah),a=Dh(t,e-8);return Ph(Fh(a,37).mul(n).add(r),Fh(r,25).add(a).mul(n),n)}if(e>=4){const n=Ah.add(2*e);return Ph(Mh(t,0).shl(3).add(e),Mh(t,e-4),n)}if(e>0){const n=t[0]+(t[e>>1]<<8),r=e+(t[e-1]<<2);return Rh(Ah.mul(n).xor(Nh.mul(r))).mul(Ah)}return Ah}(t,e):function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=Ah.add(2*e),r=Dh(t,0).mul(Ch),a=Dh(t,8),i=Dh(t,e-8).mul(n),o=Dh(t,e-16).mul(Ah);return Ph(Fh(r.add(a),43).add(Fh(i,30)).add(o),r.add(Fh(a.add(Ah),18)).add(i),n)}(t,e);if(e<=64)return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.length;const n=Ah.add(2*e),r=Dh(t,0).mul(Ah),a=Dh(t,8),i=Dh(t,e-8).mul(n),o=Dh(t,e-16).mul(Ah),s=Fh(r.add(a),43).add(Fh(i,30)).add(o),c=Ph(s,r.add(Fh(a.add(Ah),18)).add(i),n),l=Dh(t,16).mul(n),u=Dh(t,24),h=s.add(Dh(t,e-32)).mul(n),d=c.add(Dh(t,e-24)).mul(n);return Ph(Fh(l.add(u),43).add(Fh(h,30)).add(d),l.add(Fh(u.add(r),18)).add(h),n)}(t,e);let r=n,a=n.mul(Ch).add(113),i=Rh(a.mul(Ah).add(113)).mul(Ah),o=[Ih.UZERO,Ih.UZERO],s=[Ih.UZERO,Ih.UZERO];r=r.mul(Ah).add(Dh(t,0));let c=0;const l=64*(e-1>>6),u=l+(e-1&63)-63;do{r=Fh(r.add(a).add(o[0]).add(Dh(t,c+8)),37).mul(Ch),a=Fh(a.add(o[1]).add(Dh(t,c+48)),42).mul(Ch),r=r.xor(s[1]),a=a.add(o[0]).add(Dh(t,c+40)),i=Fh(i.add(s[0]),33).mul(Ch),o=Lh(t,c,o[1].mul(Ch),r.add(s[0])),s=Lh(t,c+32,i.add(s[1]),a.add(Dh(t,c+16))),[i,r]=[r,i],c+=64}while(c!==l);const h=Ch.add(i.and(255).shl(1));return c=u,s[0]=s[0].add(e-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=Fh(r.add(a).add(o[0]).add(Dh(t,c+8)),37).mul(h),a=Fh(a.add(o[1]).add(Dh(t,c+48)),42).mul(h),r=r.xor(s[1].mul(9)),a=a.add(o[0].mul(9).add(Dh(t,c+40))),i=Fh(i.add(s[0]),33).mul(h),o=Lh(t,c,o[1].mul(h),r.add(s[0])),s=Lh(t,c+32,i.add(s[1]),a.add(Dh(t,c+16))),[i,r]=[r,i],Ph(Ph(o[0],s[0],h).add(Rh(a).mul(Nh)).add(i),Ph(o[1],s[1],h).add(r),h)}function Bh(t,e){return"string"===e?Vh(t):jh([t],e)}function jh(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Ts(t)),ac().getBool("DEBUG")&&function(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(e," being uploaded contains ").concat(r,"."))}}(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type ".concat(e))}function Uh(){return ac().platform.now()}function Vh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",ac().platform.encode(t,e)}function Wh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return e=e||"utf-8",ac().platform.decode(t,e)}class Gh{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new qh)}profileKernel(t,e,n){let r;const a=()=>{r=n()};let i;const o=Uh();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(const t of r)t.dataSync();i=Promise.resolve({kernelMs:Uh()-o})}if(ac().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let s=0;s<r.length;s++){const e=r[s];e.data().then(n=>{Hh(n,e.dtype,t)})}return{kernelName:t,outputs:r,inputs:e,timeMs:i.then(t=>t.kernelMs),extraInfo:i.then(t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:a,extraInfo:i}=t;n.forEach(t=>{Promise.all([t.data(),r,i]).then(n=>{this.logger.logKernelProfile(e,t,n[0],n[1],a,n[2])})})}}function Hh(t,e,n){if("float32"!==e)return!1;for(let r=0;r<t.length;r++){const e=t[r];if(isNaN(e)||!isFinite(e))return console.warn("Found ".concat(e," in the result of '").concat(n,"'")),!0}return!1}class qh{logKernelProfile(t,e,n,r,a,i){const o="number"===typeof r?As("".concat(r,"ms"),9):r.error,s=As(t,25),c=e.rank,l=e.size,u=As(e.shape.toString(),14);let h="";for(const d in a){const t=a[d];if(null!=t){const n=t.shape||e.shape,r=n.length;h+="".concat(d,": ").concat(r,"D ").concat(r>0?n:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(c,"D ").concat(u,"\t%c").concat(l,"\t%c").concat(h,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function Kh(t,e,n,r){const a=Hs(e),i=function(t,e,n,r){const a=Is(e),i=r[r.length-1],o=new Array(i).fill(0),s=e.length,c="complex64"===n?Jh(t):t;if(s>1)for(let l=0;l<a/i;l++){const t=l*i;for(let e=0;e<i;e++)o[e]=Math.max(o[e],Xh(c[t+e],0,n).length)}return o}(t,e,n,a),o=e.length,s=Qh(t,e,n,a,i),c=["Tensor"];return r&&(c.push("  dtype: ".concat(n)),c.push("  rank: ".concat(o)),c.push("  shape: [".concat(e,"]")),c.push("  values:")),c.push(s.map(t=>"    "+t).join("\n")),c.join("\n")}function Xh(t,e,n){let r;return r=Array.isArray(t)?"".concat(parseFloat(t[0].toFixed(7))," + ")+"".concat(parseFloat(t[1].toFixed(7)),"j"):js(t)?"'".concat(t,"'"):"bool"===n?Yh(t):parseFloat(t.toFixed(7)).toString(),As(r,e)}function Yh(t){return 0===t?"false":"true"}function Qh(t,e,n,r,a){let i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const o="complex64"===n?2:1,s=e[0],c=e.length;if(0===c){if("complex64"===n){return[Xh(Jh(t)[0],0,n)]}return"bool"===n?[Yh(t[0])]:[t[0].toString()]}if(1===c){if(s>20){const e=3*o;let r=Array.from(t.slice(0,e)),i=Array.from(t.slice((s-3)*o,s*o));return"complex64"===n&&(r=Jh(r),i=Jh(i)),["["+r.map((t,e)=>Xh(t,a[e],n)).join(", ")+", ..., "+i.map((t,e)=>Xh(t,a[s-3+e],n)).join(", ")+"]"]}return["["+("complex64"===n?Jh(t):Array.from(t)).map((t,e)=>Xh(t,a[e],n)).join(", ")+"]"]}const l=e.slice(1),u=r.slice(1),h=r[0]*o,d=[];if(s>20){for(let e=0;e<3;e++){const r=e*h,i=r+h;d.push(...Qh(t.slice(r,i),l,n,u,a,!1))}d.push("...");for(let e=s-3;e<s;e++){const r=e*h,i=r+h;d.push(...Qh(t.slice(r,i),l,n,u,a,e===s-1))}}else for(let m=0;m<s;m++){const e=m*h,r=e+h;d.push(...Qh(t.slice(e,r),l,n,u,a,m===s-1))}const f=2===c?",":"";d[0]="["+d[0]+f;for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+f;let p=",\n";for(let m=2;m<c;m++)p+="\n";return d[d.length-1]=" "+d[d.length-1]+"]"+(i?"":p),d}function Jh(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}class $h{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=Is(t),null!=n){const t=n.length;ks(t===this.size,()=>"Length of values '".concat(t,"' does not match the size ")+"inferred by the shape '".concat(this.size,"'."))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Ps(e,this.size),this.strides=Hs(t)}set(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),ks(n.length===this.rank,()=>"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(this.rank,")"));const a=this.locToIndex(n);this.values[a]=t}get(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];0===e.length&&(e=[0]);let r=0;for(const i of e){if(i<0||i>=this.shape[r]){const t="Requested out of range element at ".concat(e,". ")+"  Buffer shape=".concat(this.shape);throw new Error(t)}r++}let a=e[e.length-1];for(let i=0;i<e.length-1;++i)a+=this.strides[i]*e[i];return this.values[a]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return Zh().makeTensor(this.values,this.shape,this.dtype)}}let Zh=null,td=null,ed=null;class nd{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=Is(t),this.strides=Hs(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return td.buffer(this.shape,this.dtype,t)}bufferSync(){return td.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Ks(this.shape,t,"complex64"===this.dtype)}arraySync(){return Ks(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const t=Zh().read(this.dataId);if("string"===this.dtype){const n=await t;try{return n.map(t=>Wh(t))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),Zh().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Zh().readSync(this.dataId);if("string"===this.dtype)try{return t.map(t=>Wh(t))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await Zh().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(Zh().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return td.print(this,t)}clone(){return this.throwIfDisposed(),td.clone(this)}toString(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Kh(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),td.cast(this,t)}variable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),Zh().makeVariable(this,t,e,n)}}function rd(){return cc("Tensor",()=>nd)}Object.defineProperty(nd,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}),rd();class ad extends nd{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(t.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!Es(t.shape,this.shape))throw new Error("shape of the new value (".concat(t.shape,") and ")+"previous value (".concat(this.shape,") must match"));Zh().disposeTensor(this),this.dataId=t.dataId,Zh().incRef(this,null)}dispose(){Zh().disposeVariable(this),this.isDisposedInternal=!0}}var id,od,sd,cd,ld;Object.defineProperty(ad,Symbol.hasInstance,{value:t=>t instanceof nd&&null!=t.assign&&t.assign instanceof Function}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(id||(id={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(od||(od={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(sd||(sd={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(cd||(cd={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(ld||(ld={}));const ud={float32:cd,int32:od,bool:sd,complex64:ld};function hd(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast ".concat(t," with ").concat(e))}return ud[t][e]}function dd(t){return hd(t,"int32")}function fd(t,e){if(t.dtype===e.dtype)return[t,e];const n=hd(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function pd(t,e){return e.some(e=>e.id===t.id)}function md(t){const e=[];return gd(t,e,new Set),e}function gd(t,e,n){if(null==t)return;if(t instanceof nd)return void e.push(t);if(r=t,!Array.isArray(r)&&"object"!==typeof r)return;var r;const a=t;for(const i in a){const t=a[i];n.has(t)||(n.add(t),gd(t,e,n))}}function yd(t){return null!=t.kernelName}class vd{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class bd{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new vd}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t in this.registryFactory?(mh("".concat(t," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error("Backend name '".concat(t,"' not found in registry"));if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Gh(this.backendInstance),!0}setupRegisteredKernels(){xh(this.backendName).forEach(t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){xh(t).forEach(e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])})}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error("Cannot initialize backend ".concat(t,", no registration found."));try{const n=e.factory();if(!n||n instanceof gs||"function"!==typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then(n=>!(e<this.pendingBackendInitId)&&(this.registry[t]=n,this.pendingBackendInit=null,!0)).catch(n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,mh("Initialization of backend ".concat(t," failed")),mh(n.stack||n.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return mh("Initialization of backend ".concat(t," failed")),mh(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error("".concat(t," backend not found in registry"));this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,a=this.readSync(e),i=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!==typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!==typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun(()=>this.startScope(r),()=>this.endScope(n),()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(r){throw e(),r}}nextTensorId(){return bd.nextTensorId++}nextVariableId(){return bd.nextVariableId++}clone(t){const e=xd.runKernel(kl,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],t=>({x:()=>{const e={x:t},n={dtype:"float32"};return xd.runKernel(Rc,e,n)}}),[],{}),e}runKernel(t,e,n){null==this.backendName&&this.backend;if(!(null!=bh(t,this.backendName)))throw new Error("Kernel '".concat(t,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let a=0;n.forEach(t=>{a+="complex64"===t.dtype?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(t,"'"))}runKernelFunc(t){let e,n=[];const r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;let o,s;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const c=yd(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(yd(t)){const{kernelName:e,inputs:a,attrs:i}=t;null==this.backendName&&this.backend;const c=bh(e,this.backendName);ks(null!=c,()=>"Cannot find registered kernel '".concat(e,"' for backend '").concat(this.backendName,"'")),o=()=>{const t=this.backend.numDataIds();s=c.kernelFunc({inputs:a,attrs:i,backend:this.backend});const o=Array.isArray(s)?s:[s];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(e,t,o);const l=o.map(t=>null!=t.rank?t:this.makeTensorFromTensorInfo(t));if(r){const t=this.getTensorsForGradient(e,a,l);n=this.saveTensorsForBackwardMode(t)}return l}}else{const{forwardFunc:e}=t,a=t=>{r&&(n=t.map(t=>this.keep(this.clone(t))))};o=()=>{const t=this.backend.numDataIds();s=this.tidy(()=>e(this.backend,a));const n=Array.isArray(s)?s:[s];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,t,n),n}}const{inputs:l,attrs:u}=t,h=yd(t)?null:t.backwardsFunc;let d;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(d=this.profiler.profileKernel(c,l,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(d),e=d.outputs):e=o()}),r&&this.addTapeNode(c,l,e,h,n,u),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(l).map(t=>null!=l[t]?l[t].shape:null),outputShapes:e.map(t=>t.shape),kernelTimeMs:d.timeMs,extraInfo:d.extraInfo}),Array.isArray(s)?e:e[0]}saveTensorsForBackwardMode(t){const e=t.map(t=>this.keep(this.clone(t)));return e}getTensorsForGradient(t,e,n){const r=wh(t);if(null!=r){const t=r.inputsToSave||[],a=r.outputsToSave||[];let i;r.saveAllInputs?(ks(Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(e).map(t=>e[t])):i=t.map(t=>e[t]);const o=n.filter((t,e)=>a[e]);return i.concat(o)}return[]}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=t;"string"===n&&js(t[0])&&(a=t.map(t=>Vh(t)));const i=r.write(a,e,n),o=new nd(e,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){const t=this.state.tensorInfo.get(i),e=function(t){if(null==t)return 0;let e=0;return t.forEach(t=>e+=t.length),e}(a);this.state.numBytes+=e-t.bytes,t.bytes=e}return o}makeTensorFromDataId(t,e,n,r){const a={dataId:t,shape:e,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(t,e){const{dataId:n,shape:r,dtype:a}=t,i=new nd(r,a,n,this.nextTensorId());return this.trackTensor(i,e),i}makeVariable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const a=new ad(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*Bs(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof ad||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){const e=t.size*Bs(t.dtype);this.state.numBytes-=e}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(t=>t.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,a,i){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:a},s=wh(t);null!=s&&(r=s.gradFunc),null!=r&&(o.gradient=t=>(t=t.map((t,e)=>{if(null==t){const t=n[e],r=Ys(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t}),r(t.length>1?t:t[0],a,i))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=md(t),n=new Set(e.map(t=>t.id));for(let a=0;a<this.state.activeScope.track.length;a++){const t=this.state.activeScope.track[a];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(t=>{t.kept||t.scopeId!==r.id||this.track(t)})}gradients(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(ks(e.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));ks(a instanceof nd,()=>"The result y returned by f() must be a tensor.");const i=function(t,e,n){const r={},a={};for(let c=0;c<e.length;c++)r[e[c].id]=!0;for(let c=0;c<t.length;c++){const n=t[c],i=n.inputs;for(const t in i){const o=i[t];let s=!1;for(let t=0;t<e.length;t++)if(r[o.id]){n.outputs.forEach(t=>r[t.id]=!0),s=!0,a[n.id]=!0;break}if(s)break}}const i={};i[n.id]=!0;const o={};for(let c=t.length-1;c>=0;c--){const e=t[c],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(i[e.outputs[t].id]){for(const t in n)i[n[t].id]=!0,o[e.id]=!0;break}}const s=[];for(let c=0;c<t.length;c++){const e=t[c];if(a[e.id]&&o[e.id]){const t={};for(const a in e.inputs){const n=e.inputs[a];r[n.id]&&(t[a]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,s.push(n)}}return s}(this.state.activeTape,e,a);if(!r&&0===i.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const t={};t[a.id]=null==n?function(t){const e=Xs(Is(t),"float32");return xd.makeTensor(e,t,"float32")}(a.shape):n,function(t,e,n,r){for(let a=e.length-1;a>=0;a--){const i=e[a],o=[];if(i.outputs.forEach(e=>{const n=t[e.id];null!=n?o.push(n):o.push(null)}),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));const s=i.gradient(o);for(const e in i.inputs){if(!(e in s))throw new Error("Cannot backprop through input ".concat(e,". ")+"Available gradients found: ".concat(Object.keys(s),"."));const a=n(()=>s[e]());if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(e," must have 'float32' dtype, but has '").concat(a.dtype,"'"));const o=i.inputs[e];if(!Es(a.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(e,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==t[o.id])t[o.id]=a;else{const e=t[o.id];t[o.id]=r(e,a),e.dispose()}}}}(t,i,t=>this.tidy(t),kd);const r=e.map(e=>t[e.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(t=>{for(const e of t.saved)e.dispose()}),this.state.activeTape=null),{value:a,grads:r}})}customGrad(t){var e=this;return ks(Ws(t),()=>"The f passed in customGrad(f) must be a function."),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];let i;ks(r.every(t=>t instanceof nd),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const o={};r.forEach((t,e)=>{o[e]=t});return e.runKernelFunc({forwardFunc:(e,n)=>(i=t(...r,n),ks(i.value instanceof nd,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),ks(Ws(i.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),i.value),backwardsFunc:(t,e)=>{const n=i.gradFunc(t,e),a=Array.isArray(n)?n:[n];ks(a.length===r.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),ks(a.every(t=>t instanceof nd),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const o={};return a.forEach((t,e)=>{o[e]=()=>t}),o},inputs:o})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)}async time(t){const e=Uh(),n=await this.backend.time(t);return n.wallMs=Uh()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new vd;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function wd(){const t=sc();if(null==t._tfengine){const e=new nc(t);t._tfengine=new bd(e)}var e;return e=t._tfengine.ENV,oc=e,Zh=()=>t._tfengine,t._tfengine}bd.nextTensorId=0,bd.nextVariableId=0;const xd=wd();function kd(t,e){const n={a:t,b:e};return xd.runKernel(dc,n)}let _d;function Sd(t){if(void 0!==_d)return _d;if(t||"undefined"!==typeof navigator&&null!=navigator){if(t||(t=navigator),"ReactNative"===t.product)return!0;const e=t.userAgent||t.vendor||("undefined"!==typeof window?window.opera:"");if(!e){const e=t;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function Td(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}const Id=ac();function Ed(t,e){let n=t;if(zs(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||zs(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&ac().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Nd(t,r,[]),r}function Nd(t,e,n){if(n=n||[],!Array.isArray(t)&&!zs(t))return void ks(0===e.length,()=>"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(e[0]," elements"));ks(e.length>0,()=>"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements")),ks(t.length===e[0],()=>"Element arr[".concat(n.join("]["),"] should have ").concat(e[0]," ")+"elements, but has ".concat(t.length," elements"));const r=e.slice(1);for(let a=0;a<t.length;++a)Nd(t[a],r,n.concat(a))}function Cd(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(t," tensor, but got ").concat(e," tensor"))}}function Ad(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(t instanceof nd)return Cd(r,t.dtype,e,n),t;let a=Vs(t);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),Cd(r,a,e,n),null==t||!zs(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t){const r=null==t?"null":t.constructor.name;throw new Error("Argument '".concat(e,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(r,"'"))}const i=Ed(t,a);zs(t)||Array.isArray(t)||(t=[t]);const o="string"!==a?jh(t,a):Ts(t,[],!0);return xd.makeTensor(o,i,a)}function Rd(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(t))throw new Error("Argument ".concat(e," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return t.map((t,a)=>Ad(t,"".concat(e,"[").concat(a,"]"),n,r))}Id.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Id.registerFlag("IS_BROWSER",()=>Td()),Id.registerFlag("IS_NODE",()=>"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node),Id.registerFlag("IS_CHROME",()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),Id.registerFlag("PROD",()=>!1),Id.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Id.getBool("DEBUG")),Id.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),Id.registerFlag("IS_TEST",()=>!1),Id.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0),Id.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),Id.registerFlag("ENGINE_COMPILE_ONLY",()=>!1),Id.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),Id.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);const Od="__op";function Dd(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(e.length," keys."));let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=Od;const a=function(){xd.startScope(n);try{const t=r(...arguments);return tc(t)&&console.error("Cannot return a Promise inside of tidy."),xd.endScope(t),t}catch(t){throw xd.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}const Md=Dd({complex_:function(t,e){const n=Ad(t,"real","complex"),r=Ad(e,"imag","complex");_s(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");const a={real:n,imag:r};return xd.runKernel(Mc,a)}});function Fd(t,e,n,r){if(null==r&&(r=Vs(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!zs(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Js(e);const t=Is(e),r=Is(n);ks(t===r,()=>"Based on the provided shape, [".concat(e,"], the tensor should have ")+"".concat(t," values but has ").concat(r));for(let a=0;a<n.length;++a){const t=n[a],r=a!==n.length-1||t!==Is(e.slice(a));ks(n[a]===e[a]||!r,()=>"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(e,"). "))}}return zs(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?jh(t,r):Ts(t,[],!0),xd.makeTensor(t,e,r)}function Pd(t,e,n){return Fd(t,e,Ed(t,n),n)}const Ld={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},zd=4;async function Bd(t,e){const n=[],r=[],a=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);for(let i=0;i<a.length;++i){const o=a[i],s=Array.isArray(t)?t[i].tensor:t[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));const c={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){const t=new Promise(async t=>{const e=await s.bytes(),n=e.reduce((t,e)=>t+e.length,0)+zd*e.length,r=new Uint8Array(n);let a=0;for(let i=0;i<e.length;i++){const t=e[i],n=new Uint8Array(new Uint32Array([t.length]).buffer);r.set(n,a),a+=zd,r.set(t,a),a+=t.length}t(r)});r.push(t)}else r.push(s.data());null!=e&&(c.group=e),n.push(c)}return{data:Ud(await Promise.all(r)),specs:n}}function jd(t,e){const n={};let r,a=0;for(const i of e){const e=i.name,o=i.dtype,s=i.shape,c=Is(s);let l;if("quantization"in i){const n=i.quantization;if("uint8"===n.dtype||"uint16"===n.dtype){if(!("min"in n)||!("scale"in n))throw new Error("Weight ".concat(i.name," with quantization ").concat(n.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==n.dtype)throw new Error("Weight ".concat(i.name," has unknown ")+"quantization dtype ".concat(n.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==o)throw new Error("Weight ".concat(i.name," is quantized with ").concat(n.dtype," ")+"which only supports weights of type float32 not ".concat(o,"."))}const s=Ld[n.dtype],u=t.slice(a,a+c*s),h="uint8"===n.dtype?new Uint8Array(u):new Uint16Array(u);if("float32"===o)if("uint8"===n.dtype||"uint16"===n.dtype){l=new Float32Array(h.length);for(let t=0;t<h.length;t++){const e=h[t];l[t]=e*n.scale+n.min}}else{if("float16"!==n.dtype)throw new Error("Unsupported quantization type ".concat(n.dtype," ")+"for weight type float32.");void 0===r&&(r=Jd()),l=r(h)}else{if("int32"!==o)throw new Error("Unsupported dtype in weight '".concat(e,"': ").concat(o));if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error("Unsupported quantization type ".concat(n.dtype," ")+"for weight type int32.");l=new Int32Array(h.length);for(let t=0;t<h.length;t++){const e=h[t];l[t]=Math.round(e*n.scale+n.min)}}a+=c*s}else if("string"===o){const e=Is(i.shape);l=[];for(let n=0;n<e;n++){const e=new Uint32Array(t.slice(a,a+zd))[0];a+=zd;const n=new Uint8Array(t.slice(a,a+e));l.push(n),a+=e}}else{const r=Ld[o],i=t.slice(a,a+c*r);if("float32"===o)l=new Float32Array(i);else if("int32"===o)l=new Int32Array(i);else if("bool"===o)l=new Uint8Array(i);else{if("complex64"!==o)throw new Error("Unsupported dtype in weight '".concat(e,"': ").concat(o));{l=new Float32Array(i);const t=new Float32Array(l.length/2),r=new Float32Array(l.length/2);for(let e=0;e<t.length;e++)t[e]=l[2*e],r[e]=l[2*e+1];const a=Pd(t,s,"float32"),o=Pd(r,s,"float32");n[e]=Md(a,o),a.dispose(),o.dispose()}}a+=c*r}"complex64"!==o&&(n[e]=Pd(l,s,o))}return n}function Ud(t){if(null===t)throw new Error("Invalid input value: ".concat(JSON.stringify(t)));let e=0;const n=[];t.forEach(t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(t.constructor.name))});const r=new Uint8Array(e);let a=0;return n.forEach(t=>{r.set(new Uint8Array(t.buffer),a),a+=t.byteLength}),r.buffer}const Vd="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function Wd(t){return Vd?Buffer.byteLength(t):new Blob([t]).size}function Gd(t){if(1===t.length)return t[0];let e=0;t.forEach(t=>{e+=t.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(t=>{n.set(new Uint8Array(t),r),r+=t.byteLength}),n.buffer}function Hd(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function qd(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function Kd(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),r}async function Xd(t,e){let n,r;return null!=t.weightsManifest&&([n,r]=await e(t.weightsManifest)),Kd(t,n,r)}function Yd(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:Wd(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:Wd(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function Qd(t){const e=[];for(const n of t)e.push(...n.weights);return e}function Jd(){const t=function(){const t=t=>{let e=t<<13,n=0;for(;0===(8388608&e);)n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),n=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return r=>{const a=new ArrayBuffer(4*r.length),i=new Uint32Array(a);for(let o=0;o<r.length;o++){const a=r[o],s=t[n[a>>10]+(1023&a)]+e[a>>10];i[o]=s}return new Float32Array(a)}}class $d{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==$d.instance&&($d.instance=new $d),$d.instance}static registerSaveRouter(t){$d.getInstance().saveRouters.push(t)}static registerLoadRouter(t){$d.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return $d.getHandlers(t,"save")}static getLoadHandlers(t,e){return $d.getHandlers(t,"load",e)}static getHandlers(t,e,n){const r=[];return("load"===e?$d.getInstance().loadRouters:$d.getInstance().saveRouters).forEach(e=>{const a=e(t,n);null!==a&&r.push(a)}),r}}const Zd=t=>$d.registerSaveRouter(t),tf=t=>$d.registerLoadRouter(t),ef=t=>$d.getSaveHandlers(t),nf=(t,e)=>$d.getLoadHandlers(t,e),rf="tensorflowjs",af="models_store",of="model_info_store";function sf(){if(!ac().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"===typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function cf(t){const e=t.result;e.createObjectStore(af,{keyPath:"modelPath"}),e.createObjectStore(of,{keyPath:"modelPath"})}class lf{constructor(t){if(this.indexedDB=sf(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise((t,n)=>{const r=this.indexedDB.open(rf,1);r.onupgradeneeded=()=>cf(r),r.onsuccess=()=>{const a=r.result;if(null==e){const e=a.transaction(af,"readonly"),r=e.objectStore(af).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return a.close(),n(new Error("Cannot find model with path '".concat(this.modelPath,"' ")+"in IndexedDB."));t(r.result.modelArtifacts)},r.onerror=t=>(a.close(),n(r.error)),e.oncomplete=()=>a.close()}else{const r=Yd(e),i=a.transaction(of,"readwrite");let o=i.objectStore(of);const s=o.put({modelPath:this.modelPath,modelArtifactsInfo:r});let c;s.onsuccess=()=>{c=a.transaction(af,"readwrite");const s=c.objectStore(af).put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r});s.onsuccess=()=>t({modelArtifactsInfo:r}),s.onerror=t=>{o=i.objectStore(of);const e=o.delete(this.modelPath);e.onsuccess=()=>(a.close(),n(s.error)),e.onerror=t=>(a.close(),n(s.error))}},s.onerror=t=>(a.close(),n(s.error)),i.oncomplete=()=>{null==c?a.close():c.oncomplete=()=>a.close()}}},r.onerror=t=>n(r.error)})}}lf.URL_SCHEME="indexeddb://";const uf=t=>{return ac().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(lf.URL_SCHEME)?(e=t.slice(lf.URL_SCHEME.length),new lf(e)):null;var e};$d.registerSaveRouter(uf),$d.registerLoadRouter(uf);class hf{constructor(){this.indexedDB=sf()}async listModels(){return new Promise((t,e)=>{const n=this.indexedDB.open(rf,1);n.onupgradeneeded=()=>cf(n),n.onsuccess=()=>{const r=n.result,a=r.transaction(of,"readonly"),i=a.objectStore(of).getAll();i.onsuccess=()=>{const e={};for(const t of i.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},i.onerror=t=>(r.close(),e(i.error)),a.oncomplete=()=>r.close()},n.onerror=t=>e(n.error)})}async removeModel(t){var e;return t=(e=t).startsWith(lf.URL_SCHEME)?e.slice(lf.URL_SCHEME.length):e,new Promise((e,n)=>{const r=this.indexedDB.open(rf,1);r.onupgradeneeded=()=>cf(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(of,"readwrite"),o=i.objectStore(of),s=o.get(t);let c;s.onsuccess=()=>{if(null==s.result)return a.close(),n(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));{const r=o.delete(t),i=()=>{c=a.transaction(af,"readwrite");const r=c.objectStore(af).delete(t);r.onsuccess=()=>e(s.result.modelArtifactsInfo),r.onerror=t=>n(s.error)};r.onsuccess=i,r.onerror=t=>(i(),a.close(),n(s.error))}},s.onerror=t=>(a.close(),n(s.error)),i.oncomplete=()=>{null==c?a.close():c.oncomplete=()=>a.close()}},r.onerror=t=>n(r.error)})}}const df="/",ff="tensorflowjs_models",pf="info",mf="model_topology",gf="weight_specs",yf="weight_data",vf="model_metadata";function bf(t){return{info:[ff,t,pf].join(df),topology:[ff,t,mf].join(df),weightSpecs:[ff,t,gf].join(df),weightData:[ff,t,yf].join(df),modelMetadata:[ff,t,vf].join(df)}}function wf(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function xf(t){const e=t.split(df);if(e.length<3)throw new Error("Invalid key format: ".concat(t));return e.slice(1,e.length-1).join(df)}class kf{constructor(t){if(!ac().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=bf(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=Yd(t);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(t){if(Vd)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,a=e.length;r<a;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(t.weightData));const e={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(e)),{modelArtifactsInfo:a}}catch(e){throw wf(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."))}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");e.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(null!=a){const t=JSON.parse(a);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),null!=t.trainingConfig&&(e.trainingConfig=t.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(null==i)throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));return e.weightData=function(t){if(Vd){const e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}(i),e}}kf.URL_SCHEME="localstorage://";const _f=t=>{return ac().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(kf.URL_SCHEME)?(e=t.slice(kf.URL_SCHEME.length),new kf(e)):null;var e};$d.registerSaveRouter(_f),$d.registerLoadRouter(_f);class Sf{constructor(){ks(ac().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),ks("undefined"===typeof window||"undefined"!==typeof window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},e=ff+df,n=df+pf;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(e)&&a.endsWith(n)){t[xf(a)]=JSON.parse(this.LS.getItem(a))}}return t}async removeModel(t){var e;const n=bf(t=(e=t).startsWith(kf.URL_SCHEME)?e.slice(kf.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error("Cannot find model at path '".concat(t,"'"));const r=JSON.parse(this.LS.getItem(n.info));return wf(n),r}}const Tf="://";class If{constructor(){this.managers={}}static getInstance(){return null==If.instance&&(If.instance=new If),If.instance}static registerManager(t,e){ks(null!=t,()=>"scheme must not be undefined or null."),t.endsWith(Tf)&&(t=t.slice(0,t.indexOf(Tf))),ks(t.length>0,()=>"scheme must not be an empty string.");const n=If.getInstance();ks(null==n.managers[t],()=>"A model store manager is already registered for scheme '".concat(t,"'.")),n.managers[t]=e}static getManager(t){const e=If.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return e}static getSchemes(){return Object.keys(If.getInstance().managers)}}function Ef(t){if(-1===t.indexOf(Tf))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(If.getSchemes().join(",")));return{scheme:t.split(Tf)[0],path:t.split(Tf)[1]}}async function Nf(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];ks(t!==e,()=>"Old path and new path are the same: '".concat(t,"'"));const r=$d.getLoadHandlers(t);ks(r.length>0,()=>"Copying failed because no load handler is found for source URL ".concat(t,".")),ks(r.length<2,()=>"Copying failed because more than one (".concat(r.length,") ")+"load handlers for source URL ".concat(t,"."));const a=r[0],i=$d.getSaveHandlers(e);ks(i.length>0,()=>"Copying failed because no save handler is found for destination "+"URL ".concat(e,".")),ks(i.length<2,()=>"Copying failed because more than one (".concat(r.length,") ")+"save handlers for destination URL ".concat(e,"."));const o=i[0],s=Ef(t).scheme,c=Ef(t).path,l=s===Ef(t).scheme,u=await a.load();n&&l&&await If.getManager(s).removeModel(c);const h=await o.save(u);return n&&!l&&await If.getManager(s).removeModel(c),h.modelArtifactsInfo}async function Cf(){const t=If.getSchemes(),e={};for(const n of t){const t=await If.getManager(n).listModels();for(const r in t){e[n+Tf+r]=t[r]}}return e}async function Af(t){const e=Ef(t);return If.getManager(e.scheme).removeModel(e.path)}async function Rf(t,e){return Nf(t,e,!1)}async function Of(t,e){return Nf(t,e,!0)}class Df{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got ".concat(e));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){window&&ac().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",t=>{if(t.source===window&&t.data.name===this.messageName){t.stopPropagation();(0,this.functionRefs[t.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))):setTimeout(t,e)}}if(ac().get("IS_BROWSER")){ac().setPlatform("browser",new Df);try{If.registerManager(kf.URL_SCHEME,new Sf)}catch(Hrt){}try{If.registerManager(lf.URL_SCHEME,new hf)}catch(Hrt){}}const Mf=()=>n(5817);let Ff;class Pf{constructor(){this.util=n(8590),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=ac().global.fetch?ac().global.fetch(t,e):(null==Ff&&(Ff=Mf()),Ff(t,e))}now(){const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(e));return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}}function Lf(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return e=e||"float32",Js(t),new $h(t,e,n)}ac().get("IS_NODE")&&!ac().get("IS_BROWSER")&&ac().setPlatform("node",new Pf);const zf=Dd({cast_:function(t,e){const n=Ad(t,"x","cast");if(!function(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}(e))throw new Error("Failed to cast to unknown dtype ".concat(e));if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},a={dtype:e};return xd.runKernel(Rc,r,a)}});const Bf=Dd({clone_:function(t){const e={x:Ad(t,"x","clone","string_or_numeric")};return xd.runKernel(kl,e)}});function jf(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(t.toString(e))}wd();td={buffer:Lf,cast:zf,clone:Bf,print:jf};function Uf(t){return new Promise(t=>setTimeout(t)).then(t)}class Vf{constructor(t){if(!ac().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Vf.URL_SCHEME)&&(t=t.slice(Vf.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=qd(t,[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(n)],{type:"application/json"})),a=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=r,await Uf(()=>a.dispatchEvent(new MouseEvent("click"))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await Uf(()=>t.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Yd(t)}}}}Vf.URL_SCHEME="downloads://";class Wf{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,e)=>{const n=new FileReader;n.onload=n=>{const r=JSON.parse(n.target.result),a=r.modelTopology;if(null==a)return void e(new Error("modelTopology field is missing from file ".concat(this.jsonFile.name)));if(null==r.weightsManifest)return void e(new Error("weightManifest field is missing from file ".concat(this.jsonFile.name)));if(0===this.weightsFiles.length)return void t({modelTopology:a});const i=Xd(r,t=>this.loadWeights(t));t(i)},n.onerror=t=>e("Failed to read model topology and weights manifest JSON "+"from file '".concat(this.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only."),n.readAsText(this.jsonFile)})}loadWeights(t){const e=[],n=[];for(const i of t)e.push(...i.weights),n.push(...i.paths);const r=this.checkManifestAndWeightFiles(t),a=n.map(t=>this.loadWeightsFile(t,r[t]));return Promise.all(a).then(t=>[e,Gd(t)])}loadWeightsFile(t,e){return new Promise((n,r)=>{const a=new FileReader;a.onload=t=>{const e=t.target.result;n(e)},a.onerror=e=>r("Failed to weights data from file of path '".concat(t,"'.")),a.readAsArrayBuffer(e)})}checkManifestAndWeightFiles(t){const e=[],n=this.weightsFiles.map(t=>Hd(t.name)),r={};for(const a of t)a.paths.forEach(t=>{const a=Hd(t);if(-1!==e.indexOf(a))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(a,"'"));if(e.push(a),-1===n.indexOf(a))throw new Error("Weight file with basename '".concat(a,"' is not provided."));r[t]=this.weightsFiles[n.indexOf(a)]});if(e.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(e.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return r}}function Gf(t){return new Wf(t)}function Hf(t,e,n,r){!function(t){ks(null!=t&&Array.isArray(t)&&t.length>0,()=>"promises must be a none empty array")}(t),function(t,e){ks(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(t)),ks(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(e)),ks(e>=t,()=>"startFraction must be no more than endFraction, but "+"got startFraction ".concat(t," and endFraction ")+"".concat(e))}(n=null==n?0:n,r=null==r?1:r);let a=0;return Promise.all(t.map(i=>(i.then(i=>{const o=n+ ++a/t.length*(r-n);return e(o),i}),i)))}async function qf(t,e){null==e&&(e={});const n=null==e.fetchFunc?ac().platform.fetch:e.fetchFunc,r=t.map(t=>n(t,e.requestInit,{isBinary:!0})),a=(null==e.onProgress?await Promise.all(r):await Hf(r,e.onProgress,0,.5)).map(t=>t.arrayBuffer());return null==e.onProgress?await Promise.all(a):await Hf(a,e.onProgress,.5,1)}async function Kf(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return Xf(t=>qf(t,{requestInit:r}))(t,e,n)}function Xf(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;const a=e.map(()=>!1),i={},o=null!=r?r.map(()=>!1):[],s=[];if(e.forEach((t,e)=>{let n=0;t.weights.forEach(t=>{const c="quantization"in t?t.quantization.dtype:t.dtype,l=Ld[c]*Is(t.shape),u=()=>{a[e]=!0,null==i[e]&&(i[e]=[]),i[e].push({manifestEntry:t,groupOffset:n,sizeBytes:l})};null!=r?r.forEach((e,n)=>{e===t.name&&(u(),o[n]=!0)}):u(),s.push(t.name),n+=l})}),!o.every(t=>t)){const t=r.filter((t,e)=>!o[e]);throw new Error("Could not find weights in manifest with names: "+"".concat(t.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(s.join(", "),"."))}const c=a.reduce((t,e,n)=>(e&&t.push(n),t),[]),l=[];c.forEach(t=>{e[t].paths.forEach(t=>{const e=n+(n.endsWith("/")?"":"/")+t;l.push(e)})});const u=await t(l),h={};let d=0;return c.forEach(t=>{const n=e[t].paths.length;let r=0;for(let e=0;e<n;e++)r+=u[d+e].byteLength;const a=new ArrayBuffer(r),o=new Uint8Array(a);let s=0;for(let e=0;e<n;e++){const t=new Uint8Array(u[d+e]);o.set(t,s),s+=t.byteLength}i[t].forEach(t=>{const e=jd(a.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(const n in e)h[n]=e[n]}),d+=n}),h}}$d.registerSaveRouter(t=>ac().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Vf.URL_SCHEME)?function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new Vf(t)}(t.slice(Vf.URL_SCHEME.length)):null);class Yf{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(ks("function"===typeof e.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=ac().platform.fetch,ks(null!=t&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&ks(2===t.length,()=>"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=qd(t,[{paths:["./model.weights.bin"],weights:t.weightSpecs}]);e.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin");const r=await this.fetch(this.path,e);if(r.ok)return{modelArtifactsInfo:Yd(t),responses:[r]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(r.status,"."))}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");let e;try{e=await t.json()}catch(Grt){let e="Failed to parse model JSON of response from ".concat(this.path,".");throw this.path.endsWith(".pb")?e+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":e+=" Please make sure the server is serving valid JSON for this request.",new Error(e)}const n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");return Xd(e,t=>this.loadWeights(t))}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),a=n>e?t.substring(n):"";return[r+"/",a]}(e),a=this.weightPathPrefix||n,i=Qd(t),o=[],s=[];for(const c of t)for(const t of c.paths)null!=this.weightUrlConverter?s.push(this.weightUrlConverter(t)):o.push(a+t+r);this.weightUrlConverter&&o.push(...await Promise.all(s));return[i,Gd(await qf(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress}))]}}function Qf(t){return null!=t.match(Yf.URL_SCHEME_REGEX)}Yf.URL_SCHEME_REGEX=/^https?:\/\//;const Jf=(t,e)=>{if("undefined"===typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every(t=>Qf(t)):Qf(t),n)return $f(t,e)}return null};function $f(t,e){return new Yf(t,e)}function Zf(t,e){return $f(t,e)}$d.registerSaveRouter(Jf),$d.registerLoadRouter(Jf);class tp{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class ep{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class np{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=e=>Promise.resolve(t.save(e)))}}function rp(t,e,n,r){return new np(ap(...arguments))}function ap(t,e,n,r){if(1===arguments.length){return null!=t.modelTopology||null!=t.weightSpecs?new tp(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new tp({modelTopology:t}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new tp({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r})}function ip(t){return new ep(t)}function op(t){return new ep(t)}function sp(t,e){const n=t.length,r=[];for(let a=0;a<n;a++){const i=n-1-a,o=t[i]||1;(e[e.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function cp(t,e){const n=[];for(let r=0;r<e.length;r++){const a=t[t.length-r-1],i=e.length-r-1,o=e[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function lp(t,e){const n=[],r=Math.max(t.length,e.length);for(let a=0;a<r;a++){let r=t[t.length-a-1];null==r&&(r=1);let i=e[e.length-a-1];if(null==i&&(i=1),1===r)n.unshift(i);else if(1===i)n.unshift(r);else{if(r!==i){const n="Operands could not be broadcast together with shapes "+"".concat(t," and ").concat(e,".");throw Error(n)}n.unshift(r)}}return n}function up(t,e,n){if(Ss(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const r=Ed(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Fd(t,e,r,n)}let hp;function dp(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement)i=!0;else if(null!=t.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(t.constructor.name));s=!0}if(null!=bh(uh,xd.backendName)){const n={pixels:t},r={numChannels:e};return xd.runKernel(uh,n,r)}const[c,l]=a?[t.videoWidth,t.videoHeight]:[t.width,t.height];let u,h;if(o)u=t.getContext("2d").getImageData(0,0,c,l).data;else if(r||n)u=t.data;else if(i||a||s){if(null==hp)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");hp=new OffscreenCanvas(1,1).getContext("2d")}else hp=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});hp.canvas.width=c,hp.canvas.height=l,hp.drawImage(t,0,0,c,l),u=hp.getImageData(0,0,c,l).data}if(4===e)h=new Int32Array(u);else{const t=c*l;h=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)h[n*e+t]=u[4*n+t]}return up(h,[l,c,e],"int32")}const fp=Dd({fromPixels_:dp}),pp=-2,mp=-1;function gp(t,e,n){const r=t.shape.length;ks(r===e.length,()=>"Error in slice".concat(r,"D: Length of begin ").concat(e," must ")+"match the rank of the array (".concat(r,").")),ks(r===n.length,()=>"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,")."));for(let a=0;a<r;++a)ks(e[a]+n[a]<=t.shape[a],()=>"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(e[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(t.shape[a],")"))}function yp(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function vp(t,e,n){const r=[];for(let a=0;a<t.length;a++)r[a]=Math.ceil((e[a]-t[a])/n[a]);return r}function bp(t,e,n,r){const a=[...t];for(let i=a.length;i<r.length;i++)a.push(1);for(let i=0;i<n;i++)0===i?a[e]=1:(a.splice(e,0,1),a.pop());return a}function wp(t,e,n){return n<=t?n:n-(e-1)}function xp(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function kp(t,e,n,r,a,i,o,s,c){const l=t.length;let u=new Array(l),h=new Array(l),d=new Array(l);if(e.length&&n>0){const c=e[0],l=n+1;u=_p(o,c,l,r,t),h=Sp(s,c,l,a,t),d=bp(i,c,l,t)}else for(let f=0;f<l;f++)u[f]=Ip(o,r,i,t,f,c),h[f]=Ep(s,a,i,t,f,c),d[f]=Tp(i,f,c);return{begin:u,end:h,strides:d}}function _p(t,e,n,r,a){const i=[...a],o=xp(n,e);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{const a=wp(e,n,s);let o=r[a];t&1<<a&&(o=0),i[s]=o}return i}function Sp(t,e,n,r,a){const i=[...a],o=xp(n,e);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=Number.MAX_SAFE_INTEGER;else{const a=wp(e,n,s);let o=r[a];t&1<<a&&(o=Number.MAX_SAFE_INTEGER),i[s]=o}for(let s=0;s<i.length;s++){const t=a[s];i[s]<0&&(i[s]+=t),i[s]=bs(0,i[s],a[s])}return i}function Tp(t,e,n){let r=t[e];return(n&1<<e||null==r)&&(r=1),r}function Ip(t,e,n,r,a,i){let o=e[a];const s=n[a]||1;(t&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const c=r[a];return o<0&&(o+=c),o=bs(0,o,c-1),o}function Ep(t,e,n,r,a,i){let o=e[a];const s=n[a]||1;(t&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const c=r[a];return o<0&&(o+=c),o=s>0?bs(0,o,c):bs(-1,o,c-1),o}function Np(t,e,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(e[a]>0||n[a]!==t[a])return!1;return!0}function Cp(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function Ap(t,e,n){let r;const a=t.shape.length;let i;return r="number"===typeof e?[e,...new Array(a-1).fill(0)]:e.length<a?e.concat(new Array(a-e.length).fill(0)):e.slice(),r.forEach(t=>{ks(-1!==t,()=>"slice() does not support negative begin indexing.")}),i=null==n?new Array(a).fill(-1):"number"===typeof n?[n,...new Array(a-1).fill(-1)]:n.length<a?n.concat(new Array(a-n.length).fill(-1)):n,i=i.map((e,n)=>e>=0?e:(ks(-1===e,()=>"Negative size values should be exactly -1 but got "+"".concat(e," for the slice() size at index ").concat(n,".")),t.shape[n]-r[n])),[r,i]}function Rp(t,e,n,r,a,i,o,s,c){let l;if(null==r?(l=new Array(e.length),l.fill(1)):l=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const h={dims:l.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:l.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:c};for(let v=0;v<h.dims;v++)u&&0!==(1<<v&s)&&h.numAddAxisAfterEllipsis++,1<<v&o&&(u=!0);u||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=null!=t.begin,e.endValid=null!=t.end,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const a=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<a;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(pp),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(e.dims," dims, ").concat(e.begin.length,"."));null!=t.begin&&(e.begin[n]=t.begin[r]),null!=t.end&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(mp),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}(h,d);let f=!0,p=!0,m=!0;const g=[],y=[];for(let v=0;v<t.length;++v){if(0===d.strides[v])throw Error("strides[".concat(v,"] must be non-zero"));const e=!!(d.shrinkAxisMask&1<<v),n=t[v];if(-1===n){g.push(e?1:-1);continue}const r=[d.beginMask&1<<v,d.endMask&1<<v],a=[d.strides[v]>0?0:-1,d.strides[v]>0?n:n-1];if(e&&d.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===d.strides[v];const i=!!(d.beginMask&1<<v&&d.endMask&1<<v);if(d.beginValid&&d.endValid){if(e){const t=d.begin[v]<0?n+d.begin[v]:d.begin[v];if(d.begin[v]=t,d.end[v]=d.begin[v]+1,t<0||t>=n)throw Error("slice index ".concat(d.begin[v]," of dimension ").concat(v," out of bounds."))}else d.begin[v]=Op(d.begin[v],0,d.strides[v],n,r,a),d.end[v]=Op(d.end[v],1,d.strides[v],n,r,a);const t=1===d.strides[v]&&0===d.begin[v]&&d.end[v]===n;f=f&&t,p=p&&(0===v&&1===d.strides[v]||t)}else f=f&&1===d.strides[v]&&i,p=p&&(0===v&&1===d.strides[v]||i);let o,s=!1;if(d.beginValid&&d.endValid?(o=d.end[v]-d.begin[v],s=!0):e?(o=1,s=!0):i&&n>=0&&(o=d.strides[v]<0?-n:n,s=!0),s){let t;t=0===o||o<0!==d.strides[v]<0?0:Math.trunc(o/d.strides[v])+(o%d.strides[v]!==0?1:0),g.push(t)}else g.push(-1)}for(let v=0;v<d.finalShapeGatherIndices.length;++v){const t=d.finalShapeGatherIndices[v];t>=0?y.push(g[t]):t===pp&&y.push(1)}return{finalShapeSparse:y.filter((t,e)=>d.finalShapeGatherIndices[e]!==pp),finalShape:y,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:d.begin,end:d.end,strides:d.strides}}function Op(t,e,n,r,a,i){if(a[e])return n>0?i[e]:i[e+1&1];{const e=t<0?r+t:t;return e<i[0]?i[0]:e>i[1]?i[1]:e}}class Dp{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class Mp{constructor(){this.classNameMap={}}static getMap(){return null==Mp.instance&&(Mp.instance=new Mp),Mp.instance}static register(t){Mp.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function Fp(t){ks(null!=t.className,()=>"Class being registered does not have the static className property defined."),ks("string"===typeof t.className,()=>"className is required to be a string, but got type "+typeof t.className),ks(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Mp.register(t)}function Pp(){return xd}function Lp(){return xd.memory()}function zp(t,e){return xd.tidy(t,e)}function Bp(t){md(t).forEach(t=>t.dispose())}function jp(t){return xd.keep(t)}function Up(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return xd.registerBackend(t,e,n)}function Vp(t){return xd.customGrad(t)}function Wp(t,e){if((zs(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&zs(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Fd(t,[],[],e)}ed=function(t){ac().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")};class Gp extends Dp{minimize(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{value:r,grads:a}=this.computeGradients(t,n);if(null!=n){const t=n.map(t=>({name:t.name,tensor:a[t.name]}));this.applyGradients(t)}else this.applyGradients(a);return Bp(a),e?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return function(t,e){ks(Ws(t),()=>"The f passed in variableGrads(f) must be a function"),ks(null==e||Array.isArray(e)&&e.every(t=>t instanceof ad),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=null!=e;if(!n){e=[];for(const t in xd.registeredVariables)e.push(xd.registeredVariables[t])}const r=n?e.filter(t=>!t.trainable):null,a=e.length;e=e.filter(t=>t.trainable),ks(e.length>0,()=>"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(a," variables is ")+"trainable.");const{value:i,grads:o}=xd.gradients(t,e,null,!0);ks(o.some(t=>null!=t),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),ks(0===i.rank,()=>"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(i.rank," tensor"));const s={};return e.forEach((t,e)=>{null!=o[e]&&(s[t.name]=o[e])}),null!=r&&r.forEach(t=>s[t.name]=null),{value:i,grads:s}}(t,e)}dispose(){null!=this.iterations_&&Bp(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:Wp(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()))}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Gp,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});const Hp=Dd({abs_:function(t){const e=Ad(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return xd.runKernel(Fc,t)}{const t={x:e};return xd.runKernel(lc,t)}}});const qp=Dd({acos_:function(t){const e={x:Ad(t,"x","acos")};return xd.runKernel(uc,e)}});const Kp=Dd({acosh_:function(t){const e={x:Ad(t,"x","acosh")};return xd.runKernel(hc,e)}});const Xp=Dd({add_:function(t,e){let n=Ad(t,"a","add"),r=Ad(e,"b","add");[n,r]=fd(n,r);const a={a:n,b:r};return xd.runKernel(dc,a)}});const Yp=Dd({addN_:function(t){ks(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),ks(t.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+"".concat(t.length));const e=t.map((t,e)=>Ad(t,"tensors".concat(e),"addN")),n=e[0];e.forEach(t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(t=>{if(!Es(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return xd.runKernel(fc,r)}});const Qp=Dd({all_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:Ad(t,"x","all","bool")},a={axis:e,keepDims:n};return xd.runKernel(pc,r,a)}});const Jp=Dd({any_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:Ad(t,"x","any","bool")},a={axis:e,keepDims:n};return xd.runKernel(mc,r,a)}});const $p=Dd({argMax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:Ad(t,"x","argMax")},r={axis:e};return xd.runKernel(gc,n,r)}});const Zp=Dd({argMin_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:Ad(t,"x","argMin")},r={axis:e};return xd.runKernel(yc,n,r)}});const tm=Dd({asin_:function(t){const e={x:Ad(t,"x","asin")};return xd.runKernel(vc,e)}});const em=Dd({asinh_:function(t){const e={x:Ad(t,"x","asinh")};return xd.runKernel(bc,e)}});const nm=Dd({atan_:function(t){const e={x:Ad(t,"x","atan")};return xd.runKernel(wc,e)}});const rm=Dd({atan2_:function(t,e){let n=Ad(t,"a","atan2"),r=Ad(e,"b","atan2");[n,r]=fd(n,r);const a={a:n,b:r};return xd.runKernel(kc,a)}});const am=Dd({atanh_:function(t){const e={x:Ad(t,"x","atanh")};return xd.runKernel(xc,e)}});function im(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5?arguments[5]:void 0;return cm(t,[...e,t[3]],n,i,r,null,null,ym(a))}function om(t,e,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast";const[s,c]=hm(e);let l;if("channelsLast"===o)l=[s,c,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));l=[s,c,t[1],t[1]]}return cm(t,l,n,r,a,i,!1,o)}function sm(t,e,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC";const[s,c,l]=dm(e);let u,h;if("NDHWC"===o)h="channelsLast",u=[s,c,l,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat ".concat(o));h="channelsFirst",u=[s,c,l,t[1],t[1]]}return lm(t,u,n,r,a,!1,h,i)}function cm(t,e,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",[c,l,u,h]=[-1,-1,-1,-1];if("channelsLast"===s)[c,l,u,h]=t;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));[c,h,l,u]=t}const[d,f,,p]=e,[m,g]=hm(n),[y,v]=hm(r),b=fm(d,y),w=fm(f,v),{padInfo:x,outHeight:k,outWidth:_}=function(t,e,n,r,a,i,o,s,c){let l,u,h;if("number"===typeof t){l={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const a=function(t,e,n,r,a){null==r&&(r=um(t,e,n));const i=t[0],o=t[1],s=pm((i-e+2*r)/n+1,a),c=pm((o-e+2*r)/n+1,a);return[s,c]}([e,n],i,r,t,s);u=a[0],h=a[1]}else if("same"===t){u=Math.ceil(e/r),h=Math.ceil(n/a);const t=Math.max(0,(u-1)*r+i-e),s=Math.max(0,(h-1)*a+o-n),c=Math.floor(t/2),d=t-c,f=Math.floor(s/2);l={top:c,bottom:d,left:f,right:s-f,type:"SAME"}}else if("valid"===t)l={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-i+1)/r),h=Math.ceil((n-o+1)/a);else{if("object"!==typeof t)throw Error("Unknown padding parameter: ".concat(t));{const d="channelsLast"===c?t[1][0]:t[2][0],f="channelsLast"===c?t[1][1]:t[2][1],p="channelsLast"===c?t[2][0]:t[3][0],m="channelsLast"===c?t[2][1]:t[3][1];l={top:d,bottom:f,left:p,right:m,type:0===d&&0===f&&0===p&&0===m?"VALID":"EXPLICIT"},u=pm((e-i+d+f)/r+1,s),h=pm((n-o+p+m)/a+1,s)}}return{padInfo:l,outHeight:u,outWidth:h}}(a,l,u,m,g,b,w,i,s),S=o?p*h:p;let T;return"channelsFirst"===s?T=[c,S,k,_]:"channelsLast"===s&&(T=[c,k,_,S]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:u,inChannels:h,outHeight:k,outWidth:_,outChannels:S,padInfo:x,strideHeight:m,strideWidth:g,filterHeight:d,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:w,dilationHeight:y,dilationWidth:v,inShape:t,outShape:T,filterShape:e}}function lm(t,e,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,[c,l,u,h,d]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[c,l,u,h,d]=t;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));[c,d,l,u,h]=t}const[f,p,m,,g]=e,[y,v,b]=dm(n),[w,x,k]=dm(r),_=fm(f,w),S=fm(p,x),T=fm(m,k),{padInfo:I,outDepth:E,outHeight:N,outWidth:C}=function(t,e,n,r,a,i,o,s,c,l,u){let h,d,f,p;if("number"===typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const i=function(t,e,n,r,a,i){null==a&&(a=um(t,e,r));const o=t[0],s=t[1],c=t[2],l=pm((o-e+2*a)/r+1,i),u=pm((s-e+2*a)/r+1,i),h=pm((c-e+2*a)/r+1,i);return[l,u,h,n]}([e,n,r,1],s,1,a,t,u);d=i[0],f=i[1],p=i[2]}else if("same"===t){d=Math.ceil(e/a),f=Math.ceil(n/i),p=Math.ceil(r/o);const t=(d-1)*a+s-e,u=(f-1)*i+c-n,m=(p-1)*o+l-r,g=Math.floor(t/2),y=t-g,v=Math.floor(u/2),b=u-v,w=Math.floor(m/2);h={top:v,bottom:b,left:w,right:m-w,front:g,back:y,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: ".concat(t));h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-s+1)/a),f=Math.ceil((n-c+1)/i),p=Math.ceil((r-l+1)/o)}return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}(a,l,u,h,y,v,b,_,S,T,s),A=i?g*d:g;let R;return"channelsFirst"===o?R=[c,A,E,N,C]:"channelsLast"===o&&(R=[c,E,N,C,A]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:u,inWidth:h,inChannels:d,outDepth:E,outHeight:N,outWidth:C,outChannels:A,padInfo:I,strideDepth:y,strideHeight:v,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:_,effectiveFilterHeight:S,effectiveFilterWidth:T,dilationDepth:w,dilationHeight:x,dilationWidth:k,inShape:t,outShape:R,filterShape:e}}function um(t,e,n){const r=fm(e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:1);return Math.floor((t[0]*(n-1)-n+r)/2)}function hm(t){return"number"===typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function dm(t){return"number"===typeof t?[t,t,t]:t}function fm(t,e){return e<=1?t:t+(t-1)*(e-1)}function pm(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode ".concat(e))}}function mm(t){const[e,n,r]=hm(t);return 1===e&&1===n&&1===r}function gm(t,e){return mm(t)||mm(e)}function ym(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(t))}function vm(t,e,n){if(null!=n){if("string"===typeof e)throw Error("Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,"."));if("number"===typeof e)ks(Ns(e),()=>"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,"."));else{if("object"!==typeof e)throw Error("Error in ".concat(t,": Unknown padding parameter: ").concat(e));e.forEach(e=>{e.forEach(e=>{ks(Ns(e),()=>"Error in ".concat(t,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(e,"."))})})}}}const bm=Dd({reshape_:function(t,e){const n={x:Ad(t,"x","reshape","string_or_numeric")},r={shape:e};return xd.runKernel(yu,n,r)}});const wm=Dd({avgPool_:function(t,e,n,r,a){const i=Ad(t,"x","avgPool","float32");ks(gm(n,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'"));let o=i,s=!1;3===i.rank&&(s=!0,o=bm(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ks(4===o.rank,()=>"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")),vm("avgPool",r,a);const c={x:o},l={filterSize:e,strides:n,pad:r,dimRoundingMode:a};let u=xd.runKernel(_c,c,l);return u=zf(u,i.dtype),s?bm(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const xm=Dd({avgPool3d_:function(t,e,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=Ad(t,"x","avgPool3d","float32");let s=o,c=!1;4===o.rank&&(c=!0,s=bm(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ks(5===s.rank,()=>"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")),ks("NDHWC"===i,()=>"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)),vm("avgPool3d",r,a);const l={x:s},u={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:i};let h=xd.runKernel(Tc,l,u);return h=zf(h,s.dtype),c?bm(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const km=Dd({concat_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;ks(t.length>=1,()=>"Pass at least one tensor to concat");const n=Rd(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach(t=>{if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(t.dtype,". "))}),1===n.length)return Bf(n[0]);const r=n,a={axis:e};return xd.runKernel(Pc,r,a)}});const _m=Dd({matMul_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Ad(t,"a","matMul"),i=Ad(e,"b","matMul");[a,i]=fd(a,i);const o={a:a,b:i},s={transposeA:n,transposeB:r};return xd.runKernel(Ec,o,s)}});const Sm=Dd({mul_:function(t,e){let n=Ad(t,"a","mul"),r=Ad(e,"b","mul");[n,r]=fd(n,r);const a={a:n,b:r};return xd.runKernel($l,a)}});const Tm=Dd({sigmoid_:function(t){const e={x:Ad(t,"x","sigmoid","float32")};return xd.runKernel(Mu,e)}});const Im=Dd({slice_:function(t,e,n){const r=Ad(t,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const a={x:r},i={begin:e,size:n};return xd.runKernel(Au,a,i)}});const Em=Dd({tanh_:function(t){const e={x:Ad(t,"x","tanh","float32")};return xd.runKernel(th,e)}});const Nm=Dd({basicLSTMCell_:function(t,e,n,r,a,i){const o=Ad(t,"forgetBias","basicLSTMCell"),s=Ad(e,"lstmKernel","basicLSTMCell"),c=Ad(n,"lstmBias","basicLSTMCell"),l=Ad(r,"data","basicLSTMCell"),u=Ad(a,"c","basicLSTMCell"),h=Ad(i,"h","basicLSTMCell"),d=km([l,h],1),f=_m(d,s),p=Xp(f,c),m=p.shape[0],g=p.shape[1]/4,y=[m,g],v=Im(p,[0,0],y),b=Im(p,[0,g],y),w=Im(p,[0,2*g],y),x=Im(p,[0,3*g],y),k=Xp(Sm(Tm(v),Em(b)),Sm(u,Tm(Xp(o,w))));return[k,Sm(Em(k),Tm(x))]}});const Cm=Dd({batchToSpaceND_:function(t,e,n){const r=Ad(t,"x","batchToSpaceND"),a=e.reduce((t,e)=>t*e);ks(r.rank>=1+e.length,()=>"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(e.length)),ks(n.length===e.length,()=>"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(e.length)),ks(r.shape[0]%a===0,()=>"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(e.join(" * ")," === ").concat(a));const i={x:r},o={blockShape:e,crops:n};return xd.runKernel(Nc,i,o)}});const Am=Dd({batchNorm_:function(t,e,n,r,a,i){null==i&&(i=.001);const o=Ad(t,"x","batchNorm"),s=Ad(e,"mean","batchNorm"),c=Ad(n,"variance","batchNorm");let l,u;null!=a&&(l=Ad(a,"scale","batchNorm")),null!=r&&(u=Ad(r,"offset","batchNorm")),ks(s.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ks(null==u||s.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ks(null==l||s.rank===l.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h=function(t){let e;return e=0===t.rank||1===t.rank?bm(t,[1,1,1,t.size]):2===t.rank?bm(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?bm(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}(o),d={x:h,scale:l,offset:u,mean:s,variance:c},f={varianceEpsilon:i},p=xd.runKernel(yl,d,f);return bm(p,o.shape)}});const Rm=Dd({batchNorm2d_:function(t,e,n,r,a,i){const o=Ad(t,"x","batchNorm"),s=Ad(e,"mean","batchNorm"),c=Ad(n,"variance","batchNorm");let l,u;return null!=a&&(l=Ad(a,"scale","batchNorm")),null!=r&&(u=Ad(r,"offset","batchNorm")),ks(2===o.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(o.rank,".")),ks(2===s.rank||1===s.rank,()=>"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(s.rank,".")),ks(2===c.rank||1===c.rank,()=>"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=l&&ks(2===l.rank||1===l.rank,()=>"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=u&&ks(2===u.rank||1===u.rank,()=>"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")),Am(o,s,c,u,l,i)}});const Om=Dd({batchNorm3d_:function(t,e,n,r,a,i){const o=Ad(t,"x","batchNorm"),s=Ad(e,"mean","batchNorm"),c=Ad(n,"variance","batchNorm");let l,u;return null!=a&&(l=Ad(a,"scale","batchNorm")),null!=r&&(u=Ad(r,"offset","batchNorm")),ks(3===o.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(o.rank,".")),ks(3===s.rank||1===s.rank,()=>"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(s.rank,".")),ks(3===c.rank||1===c.rank,()=>"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=l&&ks(3===l.rank||1===l.rank,()=>"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=u&&ks(3===u.rank||1===u.rank,()=>"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")),Am(o,s,c,u,l,i)}});const Dm=Dd({batchNorm4d_:function(t,e,n,r,a,i){const o=Ad(t,"x","batchNorm"),s=Ad(e,"mean","batchNorm"),c=Ad(n,"variance","batchNorm");let l,u;return null!=a&&(l=Ad(a,"scale","batchNorm")),null!=r&&(u=Ad(r,"offset","batchNorm")),ks(4===o.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(o.rank,".")),ks(4===s.rank||1===s.rank,()=>"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(s.rank,".")),ks(4===c.rank||1===c.rank,()=>"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,".")),null!=l&&ks(4===l.rank||1===l.rank,()=>"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")),null!=u&&ks(4===u.rank||1===u.rank,()=>"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")),Am(o,s,c,u,l,i)}});const Mm=Dd({bincount_:function(t,e,n){const r=Ad(t,"x","bincount"),a=Ad(e,"weights","bincount");ks("int32"===r.dtype,()=>"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)),ks(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),ks(a.size===r.size||0===a.size,()=>"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,"."));const i={x:r,weights:a},o={size:n};return xd.runKernel(Cc,i,o)}});const Fm=Dd({broadcastArgs_:function(t,e){const n=Ad(t,"s0","broadcastArgs","int32"),r=Ad(e,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));const a={s0:n,s1:r};return xd.runKernel(Ac,a)}});const Pm=Dd({broadcastTo_:function(t,e){let n=Ad(t,"broadcastTo","x");const r=n.shape;if(e.some(t=>!(t>0)||t%1!==0))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(e,"]."));if(e.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(e.length," < input.rank=").concat(n.rank,"."));if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=bm(n,t)}const a=n.shape,i=Array.from(e);for(let l=e.length-1;l>=0;l--)if(a[l]===e[l])i[l]=1;else if(1!==n.shape[l])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(e,"]."));const o=i.map((t,e)=>t>1?e:-1).filter(t=>t>=0);if(0===o.length)return Bf(n);const s={x:n},c={reps:i};return xd.runKernel(eh,s,c)}});const Lm=Dd({ceil_:function(t){const e={x:Ad(t,"x","ceil","float32")};return xd.runKernel(Oc,e)}});function zm(t,e,n){const r={shape:t,value:e,dtype:n};return xd.runKernel(fl,{},r)}const Bm=Dd({clipByValue_:function(t,e,n){const r=Ad(t,"x","clipByValue");if(ks(e<=n,()=>"Error in clip: min (".concat(e,") must be ")+"less than or equal to max (".concat(n,").")),e===n)return zm(r.shape,e,r.dtype);const a={x:r},i={clipValueMin:e,clipValueMax:n};return xd.runKernel(Dc,a,i)}});const jm=Dd({concat1d_:function(t){return km(t,0)}});const Um=Dd({concat2d_:function(t,e){return km(t,e)}});const Vm=Dd({concat3d_:function(t,e){return km(t,e)}});const Wm=Dd({concat4d_:function(t,e){return km(t,e)}});const Gm=Dd({conv2d_:function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const s=Ad(t,"x","conv2d","float32"),c=Ad(e,"filter","conv2d","float32");let l=s,u=!1;3===s.rank&&(u=!0,l=bm(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ks(4===l.rank,()=>"Error in conv2d: input must be rank 4, but got rank ".concat(l.rank,".")),ks(4===c.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+"".concat(c.rank,".")),vm("conv2d",r,o);const h="NHWC"===a?l.shape[3]:l.shape[1];ks(h===c.shape[2],()=>"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(c.shape[2],".")),ks(gm(n,i),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'"));const d={x:l,filter:c},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=xd.runKernel(Lc,d,f);return u?bm(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});const Hm=Dd({conv1d_:function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0;const s=Ad(t,"x","conv1d"),c=Ad(e,"filter","conv1d");let l=s,u=!1;2===s.rank&&(u=!0,l=bm(s,[1,s.shape[0],s.shape[1]])),ks(3===l.rank,()=>"Error in conv1d: input must be rank 3, but got rank ".concat(l.rank,".")),ks(3===c.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+"".concat(c.rank,".")),vm("conv1d",r,o),ks(l.shape[2]===c.shape[1],()=>"Error in conv1d: depth of input (".concat(l.shape[2],") must match ")+"input depth for filter ".concat(c.shape[1],".")),ks(gm(n,i),()=>"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")),ks("NWC"===a,()=>"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported."));const h=bm(c,[1,c.shape[0],c.shape[1],c.shape[2]]),d=bm(l,[l.shape[0],1,l.shape[1],l.shape[2]]),f=Gm(d,h,[1,n],r,"NHWC",[1,i],o);return bm(f,u?[f.shape[2],f.shape[3]]:[f.shape[0],f.shape[2],f.shape[3]])}});const qm=Dd({conv2DBackpropInput_:function(t,e,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;ks(t.length===e.rank,()=>"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match"));let s=t,c=e,l=!1;3===e.rank&&(l=!0,c=bm(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,t[0],t[1],t[2]]),ks(4===s.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")),ks(4===c.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(c.rank)),ks(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank));const u="NHWC"===i?s[3]:s[1],h="NHWC"===i?c.shape[3]:c.shape[1];ks(u===n.shape[2],()=>"Error in conv2dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[2],".")),ks(h===n.shape[3],()=>"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")),vm("conv2dDerInput",a,o);const d={dy:c,filter:n},f={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},p=xd.runKernel(Bc,d,f);return l?bm(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});const Km=Dd({conv2dTranspose_:function(t,e,n,r,a,i){const o=Ad(t,"x","conv2dTranspose"),s=Ad(e,"filter","conv2dTranspose");return qm(n,o,s,r,a,"NHWC",i)}});const Xm=Dd({conv3d_:function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1];const o=Ad(t,"x","conv3d"),s=Ad(e,"filter","conv3d");let c=o,l=!1;4===o.rank&&(l=!0,c=bm(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ks(5===c.rank,()=>"Error in conv3d: input must be rank 5, but got rank ".concat(c.rank,".")),ks(5===s.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")),ks(c.shape[4]===s.shape[3],()=>"Error in conv3d: depth of input (".concat(c.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")),ks(gm(n,i),()=>"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")),ks("NDHWC"===a,()=>"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported."));const u={x:c,filter:s},h={strides:n,pad:r,dataFormat:a,dilations:i},d=xd.runKernel(jc,u,h);return l?bm(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const Ym=Dd({conv3DBackpropInput_:function(t,e,n,r,a){ks(t.length===e.rank,()=>"Length of inShape "+"(".concat(t.length,") and rank of dy (").concat(e.rank,") must match"));let i=t,o=e,s=!1;4===e.rank&&(s=!0,o=bm(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const c=i[4],l=o.shape[4];ks(5===i.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,".")),ks(5===o.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)),ks(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)),ks(c===n.shape[3],()=>"Error in conv3dDerInput: depth of input (".concat(c,") must ")+"match input depth for filter ".concat(n.shape[3],".")),ks(l===n.shape[4],()=>"Error in conv3dDerInput: depth of output (".concat(l,") must ")+"match output depth for filter ".concat(n.shape[4],"."));const u={dy:o,filter:n},h={pad:a,strides:r,inputShape:i},d=xd.runKernel(Vc,u,h);return s?bm(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});const Qm=Dd({conv3dTranspose_:function(t,e,n,r,a){const i=Ad(t,"x","conv3dTranspose"),o=Ad(e,"filter","conv3dTranspose");return Ym(n,i,o,r,a)}});const Jm=Dd({cos_:function(t){const e={x:Ad(t,"x","cos","float32")};return xd.runKernel(Wc,e)}});const $m=Dd({cosh_:function(t){const e={x:Ad(t,"x","cosh","float32")};return xd.runKernel(Gc,e)}});const Zm=Dd({cumprod_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a={x:Ad(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:r};return xd.runKernel(Hc,a,i)}});const tg=Dd({cumsum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a={x:Ad(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:r};return xd.runKernel(qc,a,i)}});const eg=Dd({denseBincount_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=Ad(t,"x","denseBincount"),i=Ad(e,"weights","denseBincount");ks("int32"===a.dtype,()=>"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)),ks(a.rank<=2,()=>"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")),ks(n>=0,()=>"size must be non-negative, but got ".concat(n,".")),ks(i.size===a.size||0===i.size,()=>"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(i.shape,"."));const o={x:a,weights:i},s={size:n,binaryOutput:r};return xd.runKernel(Xc,o,s)}});const ng=Dd({depthToSpace_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC";const r=Ad(t,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];ks(e>1,()=>"blockSize should be > 1 for depthToSpace, but was: ".concat(e)),ks(a*e>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(e,"  for depthToSpace with input shape\n    ").concat(r.shape)),ks(i*e>=0,()=>"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(e," for depthToSpace with input shape\n        ").concat(r.shape)),ks(o%(e*e)===0,()=>"Dimension size must be evenly divisible by ".concat(e*e," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape));const s={x:r},c={blockSize:e,dataFormat:n};return xd.runKernel(Yc,s,c)}});const rg=Dd({depthwiseConv2d_:function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0;const s=Ad(t,"x","depthwiseConv2d","float32"),c=Ad(e,"filter","depthwiseConv2d","float32");let l=s,u=!1;3===s.rank&&(u=!0,l=bm(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ks(4===l.rank,()=>"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")),ks(4===c.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(c.rank,"."));const h="NHWC"===a?l.shape[3]:l.shape[1];ks(h===c.shape[2],()=>"Error in depthwiseConv2d: number of input channels "+"(".concat(h,") must match the inChannels dimension in ")+"filter ".concat(c.shape[2],".")),vm("depthwiseConv2d",r,o);const d={x:l,filter:c},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},p=xd.runKernel(Qc,d,f);return u?bm(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});const ag=Dd({diag_:function(t){const e={x:Ad(t,"x","diag")};return xd.runKernel(Zc,e)}});const ig=Dd({dilation2d_:function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC";const o=Ad(t,"x","dilation2d"),s=Ad(e,"filter","dilation2d");ks(3===o.rank||4===o.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(o.rank,".")),ks(3===s.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(s.rank,".")),ks("NHWC"===i,()=>"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(i));let c=o,l=!1;3===o.rank&&(c=bm(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=!0);const u={x:c,filter:s},h={strides:n,pad:r,dilations:a},d=xd.runKernel(tl,u,h);return l?bm(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});const og=Dd({floorDiv_:function(t,e){let n=Ad(t,"a","floorDiv"),r=Ad(e,"b","floorDiv");[n,r]=fd(n,r);const a={a:n,b:r};return xd.runKernel(gl,a)}});const sg=Dd({div_:function(t,e){let n=Ad(t,"a","div"),r=Ad(e,"b","div");if([n,r]=fd(n,r),"int32"===n.dtype&&"int32"===r.dtype)return og(n,r);const a={a:n,b:r};return xd.runKernel(rl,a,{})}});const cg=Dd({equal_:function(t,e){let n=Ad(t,"a","equal","string_or_numeric"),r=Ad(e,"b","equal","string_or_numeric");[n,r]=fd(n,r),lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(cl,a)}});const lg=Dd({where_:function(t,e,n){const r=Ad(e,"a","where"),a=Ad(n,"b","where"),i=Ad(t,"condition","where","bool"),o=lp(lp(i.shape,r.shape),a.shape),s={condition:Pm(i,o),t:Pm(r,o),e:Pm(a,o)};return xd.runKernel(Nu,s)}});const ug=Dd({zerosLike_:function(t){const e={x:Ad(t,"x","zerosLike")};return xd.runKernel(ch,e)}});const hg=Dd({divNoNan_:function(t,e){let n=Ad(t,"a","div"),r=Ad(e,"b","div");[n,r]=fd(n,r);const a=sg(n,r),i=ug(a),o=cg(r,i);return lg(o,i,a)}});const dg=Dd({dot_:function(t,e){const n=Ad(t,"t1","dot"),r=Ad(e,"t2","dot");ks((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),()=>"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,"."));const a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(ks(a===i,()=>"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,".")),1===n.rank&&1===r.rank){const t=bm(n,[1,-1]),e=bm(r,[-1,1]),a=_m(t,e);return bm(a,[])}if(1===n.rank&&2===r.rank){const t=bm(n,[1,-1]),e=bm(r,[r.shape[0],r.shape[1]]),a=_m(t,e);return bm(a,[a.size])}if(2===n.rank&&1===r.rank){const t=bm(r,[-1,1]),e=_m(n,t);return bm(e,[e.size])}{const t=bm(r,[r.shape[0],r.shape[1]]);return _m(n,t)}}});const fg=Dd({einsum_:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const a=n.map((t,e)=>Ad(t,"tensors".concat(e),"einsum")),i={equation:t};return xd.runKernel(al,a,i)}});const pg=Dd({elu_:function(t){const e={x:Ad(t,"x","elu","float32")};return xd.runKernel(il,e)}});const mg=Dd({erf_:function(t){let e=Ad(t,"x","erf");ks("int32"===e.dtype||"float32"===e.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===e.dtype&&(e=zf(e,"float32"));const n={x:e};return xd.runKernel(sl,n)}});function gg(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function yg(t,e,n){const r=t.length+e.length,a=[];let i=0,o=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?a.push(t[i++]):a.push(e[o++]);return a}function vg(t,e){const n=[],r=t.length;for(let a=0;a<r;a++)-1===e.indexOf(a)&&n.push(t[a]);return[n,e.map(e=>t[e])]}function bg(t,e){return yg(t,e.map(t=>1),e)}function wg(t,e,n){ks(gg(e,n),()=>"".concat(t," supports only inner-most axes for now. ")+"Got axes ".concat(e," and rank-").concat(n," input."))}function xg(t,e){if(gg(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach(t=>n.push(t)),n}function kg(t){return t.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function _g(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}const Sg=Dd({max_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:Ad(t,"x","max")},a={reductionIndices:e,keepDims:n};return xd.runKernel(Bl,r,a)}});const Tg=Dd({min_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:Ad(t,"x","min")},a={axis:e,keepDims:n};return xd.runKernel(Kl,r,a)}});const Ig=Dd({pow_:function(t,e){let n=Ad(t,"base","pow"),r=Ad(e,"exp","pow");[n,r]=fd(n,r);const a={a:n,b:r};return xd.runKernel(cu,a)}});const Eg=Dd({sqrt_:function(t){const e={x:Ad(t,"x","sqrt","float32")};return xd.runKernel(Pu,e)}});const Ng=Dd({square_:function(t){const e=Ad(t,"x","square");return xd.runKernel("Square",{x:e},{})}});const Cg=Dd({sum_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Ad(t,"x","sum");"bool"===r.dtype&&(r=zf(r,"int32"));const a={x:r},i={axis:e,keepDims:n};return xd.runKernel(Lu,a,i)}});function Ag(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===t.rank)return Hp(t);if(1!==t.rank&&null===n)return Ag(bm(t,[-1]),e,n);if(1===t.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===e)return Cg(Hp(t),n);if(e===1/0)return Sg(Hp(t),n);if(e===-1/0)return Tg(Hp(t),n);if("euclidean"===e||2===e)return Eg(Cg(Ig(Hp(t),Wp(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}if(Array.isArray(n)&&2===n.length){if(1===e)return Sg(Cg(Hp(t),n[0]),n[1]-1);if(e===1/0)return Sg(Cg(Hp(t),n[1]),n[0]);if(e===-1/0)return Tg(Cg(Hp(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return Eg(Cg(Ng(t),n));throw new Error("Error in norm: invalid ord value: ".concat(e))}throw new Error("Error in norm: invalid axis: ".concat(n))}const Rg=Dd({norm_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=Ag(t=Ad(t,"x","norm"),e,n);let i=a.shape;if(r){const e=Ds(n,t.shape);i=bg(a.shape,e)}return bm(a,i)}});const Og=Dd({euclideanNorm_:function(t){return Rg(t,"euclidean",arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}});const Dg=Dd({exp_:function(t){const e={x:Ad(t,"x","exp")};return xd.runKernel(ll,e)}});const Mg=Dd({expandDims_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Ad(t,"x","expandDims","string_or_numeric");ks(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},a={dim:e};return xd.runKernel(ul,r,a)}});const Fg=Dd({expm1_:function(t){const e={x:Ad(t,"x","expm1")};return xd.runKernel(hl,e)}});const Pg=Dd({tile_:function(t,e){const n=Ad(t,"x","tile","string_or_numeric");ks(n.rank===e.length,()=>"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(e,"."));const r={x:n},a={reps:e};return xd.runKernel(eh,r,a)}});const Lg=Dd({eye_:function(t,e,n){null==e&&(e=t);const r=Lf([t,e],arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),a=t<=e?t:e;for(let o=0;o<a;++o)r.set(1,o,o);const i=bm(r.toTensor(),[t,e]);if(null==n)return i;if(1===n.length)return Pg(Mg(i,0),[n[0],1,1]);if(2===n.length)return Pg(Mg(Mg(i,0),0),[n[0],n[1],1,1]);if(3===n.length)return Pg(Mg(Mg(Mg(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});const zg=Dd({floor_:function(t){const e={x:Ad(t,"x","floor","float32")};return xd.runKernel(ml,e)}});const Bg=Dd({gather_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a={x:Ad(t,"x","gather"),indices:Ad(e,"indices","gather","int32")},i={axis:n,batchDims:r};return xd.runKernel(vl,a,i)}});const jg=Dd({greater_:function(t,e){let n=Ad(t,"a","greater","string_or_numeric"),r=Ad(e,"b","greater","string_or_numeric");[n,r]=fd(n,r),lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(wl,a)}});const Ug=Dd({greaterEqual_:function(t,e){let n=Ad(t,"a","greaterEqual","string_or_numeric"),r=Ad(e,"b","greaterEqual","string_or_numeric");[n,r]=fd(n,r),lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(xl,a)}});const Vg=Dd({imag_:function(t){const e={input:Ad(t,"input","imag")};return xd.runKernel(Sl,e)}});const Wg=Dd({isFinite_:function(t){const e={x:Ad(t,"x","isFinite")};return xd.runKernel(Tl,e)}});const Gg=Dd({isInf_:function(t){const e={x:Ad(t,"x","isInf")};return xd.runKernel(Il,e)}});const Hg=Dd({isNaN_:function(t){const e={x:Ad(t,"x","isNaN")};return xd.runKernel(El,e)}});const qg=Dd({leakyRelu_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2;const n={x:Ad(t,"x","leakyRelu")},r={alpha:e};return xd.runKernel(Nl,n,r)}});const Kg=Dd({less_:function(t,e){let n=Ad(t,"a","less","string_or_numeric"),r=Ad(e,"b","less","string_or_numeric");[n,r]=fd(n,r),lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(Cl,a)}});const Xg=Dd({lessEqual_:function(t,e){let n=Ad(t,"a","lessEqual","string_or_numeric"),r=Ad(e,"b","lessEqual","string_or_numeric");[n,r]=fd(n,r),lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(Al,a)}});function Yg(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return xd.runKernel(Rl,{},r)}const Qg=Dd({localResponseNormalization_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;const i=Ad(t,"x","localResponseNormalization");ks(4===i.rank||3===i.rank,()=>"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")),ks(Ns(e),()=>"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(e,"."));let o=i,s=!1;3===i.rank&&(s=!0,o=bm(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const c={x:o},l={depthRadius:e,bias:n,alpha:r,beta:a},u=xd.runKernel(Ll,c,l);return s?bm(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const Jg=Dd({log_:function(t){const e={x:Ad(t,"x","log","float32")};return xd.runKernel(Ol,e)}});const $g=Dd({log1p_:function(t){const e={x:Ad(t,"x","log1p")};return xd.runKernel(Dl,e)}});const Zg=Dd({neg_:function(t){const e={x:Ad(t,"x","neg")};return xd.runKernel(Zl,e)}});const ty=Dd({softplus_:function(t){const e={x:Ad(t,"x","softplus")};return xd.runKernel(Fu,e)}});const ey=Dd({logSigmoid_:function(t){const e=Ad(t,"x","logSigmoid"),n=Vp(t=>({value:Zg(ty(Zg(t))),gradFunc:e=>Sm(e,Tm(Zg(t)))}));return n(e)}});const ny=Dd({sub_:function(t,e){let n=Ad(t,"a","sub"),r=Ad(e,"b","sub");[n,r]=fd(n,r);const a={a:n,b:r};return xd.runKernel($u,a)}});const ry=Dd({logSoftmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=Ad(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(e));const r=Vp((t,n)=>{const r=Sg(t,e,!0),a=ny(t,r),i=ny(zf(a,"float32"),Jg(Cg(Dg(a),e,!0)));n([i]);return{value:i,gradFunc:(t,n)=>{const[r]=n,a=Dg(r);return ny(t,Sm(Cg(t,e,!0),a))}}});return r(n)}});const ay=Dd({logSumExp_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=Ad(t,"x","logSumExp"),a=Ds(e,r.shape),i=Sg(r,a,!0),o=ny(r,i),s=Dg(o),c=Cg(s,a),l=Jg(c),u=Xp(bm(i,l.shape),l);if(n){const t=bg(u.shape,a);return bm(u,t)}return u}});const iy=Dd({logicalAnd_:function(t,e){const n=Ad(t,"a","logicalAnd","bool"),r=Ad(e,"b","logicalAnd","bool");lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(Ml,a)}});const oy=Dd({logicalNot_:function(t){const e={x:Ad(t,"x","logicalNot","bool")};return xd.runKernel(Fl,e)}});const sy=Dd({logicalOr_:function(t,e){const n=Ad(t,"a","logicalOr","bool"),r=Ad(e,"b","logicalOr","bool");lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(Pl,a)}});const cy=Dd({logicalXor_:function(t,e){const n=Ad(t,"a","logicalXor","bool"),r=Ad(e,"b","logicalXor","bool");return lp(n.shape,r.shape),iy(sy(t,e),oy(iy(t,e)))}}),ly=2147483648;const uy=Dd({searchSorted_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left";const r=Ad(t,"sortedSequence","searchSorted"),a=Ad(e,"values","searchSorted"),i=r.shape[r.shape.length-1],o=a.shape[a.shape.length-1],s=bm(r,[-1,i]),c=bm(a,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==c.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Is(c.shape)>=ly)throw new Error("values tensor size must less than ".concat(ly));if(s.shape[1]>=ly)throw new Error("trailing dim_size must less than ".concat(ly," for int32 output type, was ").concat(s.shape[1]));const l={sortedSequence:s,values:c},u={side:n};return xd.runKernel(Eu,l,u)}});function hy(t,e){return uy(t,e,"left")}const dy=Dd({maxPool_:function(t,e,n,r,a){const i=Ad(t,"x","maxPool");let o=i,s=!1;3===i.rank&&(s=!0,o=bm(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ks(4===o.rank,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")),ks(gm(n,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")),vm("maxPool",r,a);const c={x:o},l={filterSize:e,strides:n,pad:r,dimRoundingMode:a},u=xd.runKernel(Ul,c,l);return s?bm(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});const fy=Dd({maxPool3d_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC";const o=Ad(t,"x","maxPool3d");let s=o,c=!1;4===o.rank&&(c=!0,s=bm(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),ks(5===s.rank,()=>"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")),ks("NDHWC"===i,()=>"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)),vm("maxPool3d",r,a);const l={x:s},u={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},h=xd.runKernel(Wl,l,u);return c?bm(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}});const py=Dd({maxPoolWithArgmax_:function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i={x:Ad(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:r,includeBatchInIndex:a},s=xd.runKernel(Hl,i,o);return{result:s[0],indexes:s[1]}}});const my=Dd({maximum_:function(t,e){let n=Ad(t,"a","maximum"),r=Ad(e,"b","maximum");[n,r]=fd(n,r),"bool"===n.dtype&&(n=zf(n,"int32"),r=zf(r,"int32")),lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(jl,a)}});const gy=Dd({mean_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r={x:Ad(t,"x","mean")},a={axis:e,keepDims:n};return xd.runKernel(ql,r,a)}});function yy(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){const e=yy(t,"float32"),n=yy(t,"float32");return Md(e,n)}const n=Ys(Is(t),e);return xd.makeTensor(n,t,e)}function vy(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===e){const e=vy(t,"float32"),n=yy(t,"float32");return Md(e,n)}const n=Xs(Is(t),e);return xd.makeTensor(n,t,e)}function by(t,e){let{indexing:n="xy"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("xy"!==n&&"ij"!==n)throw new TypeError("".concat(n," is not a valid third argument to meshgrid"));if(void 0===t)return[];let r=Ad(t,"x","meshgrid",t instanceof nd?t.dtype:"float32");if(void 0===e)return[r];let a=Ad(e,"y","meshgrid",e instanceof nd?e.dtype:"float32");const i=Is(r.shape),o=Is(a.shape);return"xy"===n?(r=bm(r,[1,-1]),a=bm(a,[-1,1]),[_m(vy([o,1],r.dtype),r),_m(a,vy([1,i],a.dtype))]):(r=bm(r,[-1,1]),a=bm(a,[1,-1]),[_m(r,vy([1,o],r.dtype)),_m(vy([i,1],a.dtype),a)])}const wy=Dd({minimum_:function(t,e){let n=Ad(t,"a","minimum"),r=Ad(e,"b","minimum");[n,r]=fd(n,r),"bool"===n.dtype&&(n=zf(n,"int32"),r=zf(r,"int32")),lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(Xl,a)}});const xy=Dd({mirrorPad_:function(t,e,n){ks("reflect"===n||"symmetric"===n,()=>"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,"."));const r=Ad(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");ks(e.length===r.rank,()=>"Padding doesn't match input. Must be ".concat(r.rank,". ")+"Got ".concat(e.length,"."));const a="reflect"===n?1:0;for(let s=0;s<r.rank;s++)ks(2===e[s].length,()=>"Invalid number of paddings. Must be length of 2 each."),ks(e[s][0]>=0&&e[s][0]<=r.shape[s]-a&&e[s][1]>=0&&e[s][1]<=r.shape[s]-a,()=>"Padding in dimension ".concat(s," cannot be greater than or equal ")+"to ".concat(r.shape[s]-a," or less than 0 for input of ")+"shape ".concat(r.shape));const i={paddings:e,mode:n},o={x:r};return xd.runKernel(Yl,o,i)}});const ky=Dd({mod_:function(t,e){let n=Ad(t,"a","mod"),r=Ad(e,"b","mod");[n,r]=fd(n,r);const a={a:n,b:r};return xd.runKernel(Ql,a)}});const _y=Dd({moments_:function(t){let e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=Ds(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,(t=Ad(t,"x","moments")).shape),r=gy(t,n,e);let a=r.shape;e||(a=bg(r.shape,n));const i=Ng(ny(zf(t,"float32"),bm(r,a)));return{mean:r,variance:gy(i,n,e)}}});const Sy=Dd({multiRNNCell_:function(t,e,n,r){const a=Ad(e,"data","multiRNNCell"),i=Rd(n,"c","multiRNNCell"),o=Rd(r,"h","multiRNNCell");let s=a;const c=[];for(let h=0;h<t.length;h++){const e=t[h](s,i[h],o[h]);c.push(e[0]),c.push(e[1]),s=e[1]}const l=[],u=[];for(let h=0;h<c.length;h+=2)l.push(c[h]),u.push(c[h+1]);return[l,u]}});const Ty=Dd({multinomial_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=Ad(t,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(i,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();const s={logits:1===o?bm(a,[1,-1]):a},c={numSamples:e,seed:n,normalized:r},l=xd.runKernel(Jl,s,c);return 1===o?bm(l,[l.size]):l}});const Iy=Dd({notEqual_:function(t,e){let n=Ad(t,"a","notEqual","string_or_numeric"),r=Ad(e,"b","notEqual","string_or_numeric");[n,r]=fd(n,r),lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(tu,a)}});const Ey=Dd({oneHot_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(e));const i={indices:Ad(t,"indices","oneHot","int32")},o={dtype:a,depth:e,onValue:n,offValue:r};return xd.runKernel(iu,i,o)}});const Ny=Dd({onesLike_:function(t){const e={x:Ad(t,"x","onesLike")};return xd.runKernel(au,e)}});const Cy=Dd({outerProduct_:function(t,e){const n=Ad(t,"v1","outerProduct"),r=Ad(e,"v2","outerProduct");ks(1===n.rank&&1===r.rank,()=>"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,"."));const a=bm(n,[-1,1]),i=bm(r,[1,-1]);return _m(a,i)}});const Ay=Dd({pad_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=Ad(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:e,constantValue:n},i={x:r};return xd.runKernel(su,i,a)}});const Ry=Dd({pad1d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ks(2===e.length,()=>"Invalid number of paddings. Must be length of 2."),Ay(t,[e],n)}});const Oy=Dd({pad2d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ks(2===e.length&&2===e[0].length&&2===e[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),Ay(t,e,n)}});const Dy=Dd({pad3d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ks(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),Ay(t,e,n)}});const My=Dd({pad4d_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return ks(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),Ay(t,e,n)}});const Fy=Dd({spaceToBatchND_:function(t,e,n){const r=Ad(t,"x","spaceToBatchND");ks(r.rank>=1+e.length,()=>"input rank ".concat(r.rank," should be > than [blockShape] ").concat(e.length)),ks(n.length===e.length,()=>"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(e.length)),ks(r.shape.reduce((t,r,a)=>a>0&&a<=e.length?t&&(r+n[a-1][0]+n[a-1][1])%e[a-1]===0:t,!0),()=>"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(e.toString()));const a={x:r},i={blockShape:e,paddings:n};return xd.runKernel(zu,a,i)}});const Py=Dd({pool_:function(t,e,n,r,a,i,o){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");const s=Ad(t,"x","maxPool");let c=s,l=!1;3===s.rank&&(l=!0,c=bm(s,[1,s.shape[0],s.shape[1],s.shape[2]])),ks(gm(i,a),()=>"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'"));const u=om(c.shape,e,i,a,r),h=[u.dilationHeight,u.dilationWidth];let d;d="same"===r?function(t,e){const n=t.map((t,n)=>t+(t-1)*(e[n]-1)),r=n.map(t=>t-1),a=r.map(t=>Math.floor(t/2)),i=r.map((t,e)=>t-a[e]);return r.map((t,e)=>[a[e],i[e]])}([u.filterHeight,u.filterWidth],h):[[0,0],[0,0]];const f=1===h[0]&&1===h[1],[p,m]=function(t,e,n){const r=n.map(t=>t[0]),a=n.map(t=>t[1]),i=t.concat(r,a),o=e.map((t,e)=>(t-i[e]%t)%t),s=a.map((t,e)=>t+o[e]),c=e.map((t,e)=>[r[e],s[e]]),l=e.map((t,e)=>[0,o[e]]);return[c,l]}([u.inHeight,u.inWidth],h,d),g=f?r:"valid",y=f?c:Fy(c,h,p),v=("avg"===n?()=>wm(y,e,i,g,o):()=>dy(y,e,i,g,o))(),b=f?v:Cm(v,h,m);return l?bm(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});const Ly=Dd({prelu_:function(t,e){const n={x:Ad(t,"x","prelu"),alpha:Ad(e,"alpha","prelu")};return xd.runKernel(lu,n)}});const zy=Dd({prod_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Ad(t,"x","prod");"bool"===r.dtype&&(r=zf(r,"int32"));const a={x:r},i={axis:e,keepDims:n};return xd.runKernel(uu,a,i)}});const By=Dd({raggedGather_:function(t,e,n,r){const a={paramsNestedSplits:t.map((t,e)=>Ad(t,"tensors".concat(e),"raggedGather","int32")),paramsDenseValues:Ad(e,"paramsDenseValues","raggedGather"),indices:Ad(n,"indices","raggedGather","int32")},i={outputRaggedRank:r},o=xd.runKernel(hu,a,i);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}});const jy=Dd({raggedTensorToTensor_:function(t,e,n,r,a){const i=Ad(t,"shape","raggedTensorToTensor","int32"),o=Ad(e,"values","raggedTensorToTensor"),s={shape:i,values:o,defaultValue:Ad(n,"defaultValue","raggedTensorToTensor",o.dtype),rowPartitionTensors:r.map((t,e)=>Ad(t,"tensors".concat(e),"raggedTensorToTensor","int32"))},c={rowPartitionTypes:a};return xd.runKernel(du,s,c)}});const Uy=Dd({rand_:function(t,e,n){const r=Is(t);let a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(let i=0;i<r;i++)a[i]=e();return xd.makeTensor(a,t,n)}});var Vy=n(4334);class Wy{constructor(t,e,n,r,a){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const i=a||Math.random();this.random=Vy.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;for(;!n;){let r,a,i;do{r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a}while(i>=1||0===i);const o=Math.sqrt(-2*Math.log(i)/i);t=this.mean+this.stdDev*r*o,e=this.mean+this.stdDev*a*o,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Gy{constructor(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;const a=r||Math.random();this.randu=Vy.alea(a.toString()),this.randn=new Wy(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,r,a,i;for(;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=r*r,e=1-.331*t*t,n=.5*t+this.d*(1-i+Math.log(i)),a=this.randu(),a<e||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class Hy{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(t," - ").concat(e," <= 1 and dtype is not float"));this.random=Vy.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const qy=Dd({randomGamma_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));const i=new Gy(e,n,r,a),o=Lf(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});const Ky=Dd({randomNormal_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));const i=new Wy(e,n,r,!1,a),o=Lf(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});const Xy=Dd({randomStandardNormal_:function(t,e,n){if(null!=e&&"bool"===e)throw new Error("Unsupported data type ".concat(e));return Ky(t,0,1,e,n)}});const Yy=Dd({randomUniform_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>4?arguments[4]:void 0;const a=Lf(t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32"),i=new Hy(e,n,null,r);for(let o=0;o<a.values.length;o++)a.values[o]=i.nextValue();return a.toTensor()}});function Qy(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");const a={start:t,stop:e,step:n,dtype:r};return xd.runKernel(fu,{},a)}const Jy=Dd({real_:function(t){const e={input:Ad(t,"input","real")};return xd.runKernel(pu,e)}});const $y=Dd({reciprocal_:function(t){const e={x:Ad(t,"x","reciprocal")};return xd.runKernel(mu,e)}});const Zy=Dd({relu_:function(t){const e={x:Ad(t,"x","relu")};return xd.runKernel(gu,e)}});const tv=Dd({relu6_:function(t){const e={x:Ad(t,"x","relu6")};return xd.runKernel(ku,e)}});const ev=Dd({reverse_:function(t,e){const n={x:Ad(t,"x","reverse")},r={dims:e};return xd.runKernel(_u,n,r)}});const nv=Dd({reverse1d_:function(t){const e=Ad(t,"x","reverse");return ks(1===e.rank,()=>"Error in reverse1D: x must be rank 1 but got rank ".concat(e.rank,".")),ev(e,0)}});const rv=Dd({reverse2d_:function(t,e){const n=Ad(t,"x","reverse");return ks(2===n.rank,()=>"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")),ev(n,e)}});const av=Dd({reverse3d_:function(t,e){const n=Ad(t,"x","reverse");return ks(3===n.rank,()=>"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")),ev(n,e)}});const iv=Dd({reverse4d_:function(t,e){const n=Ad(t,"x","reverse");return ks(4===n.rank,()=>"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")),ev(n,e)}});const ov=Dd({round_:function(t){const e={x:Ad(t,"x","round")};return xd.runKernel(Su,e)}});const sv=Dd({rsqrt_:function(t){const e={x:Ad(t,"x","rsqrt","float32")};return xd.runKernel(Tu,e)}});const cv=Dd({selu_:function(t){const e={x:Ad(t,"x","selu")};return xd.runKernel(Cu,e)}});const lv=Dd({separableConv2d_:function(t,e,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC";const s=Ad(t,"x","separableConv2d"),c=Ad(e,"depthwiseFilter","separableConv2d"),l=Ad(n,"pointwiseFilter","separableConv2d");let u=s,h=!1;if(3===s.rank&&(h=!0,u=bm(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");ks(4===u.rank,()=>"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(u.rank,".")),ks(4===c.rank,()=>"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(c.rank,".")),ks(4===l.rank,()=>"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(c.rank,".")),ks(1===l.shape[0],()=>"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(l.shape[0],".")),ks(1===l.shape[1],()=>"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(l.shape[1],"."));const d=c.shape[2],f=c.shape[3];ks(l.shape[2]===d*f,()=>"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(d*f,", ")+"but got ".concat(l.shape[2],"."));const p=rg(u,c,r,a,o,i),m=Gm(p,l,1,"valid",o);return h?bm(m,[m.shape[1],m.shape[2],m.shape[3]]):m}});const uv=async function(t,e){const n=Ad(t,"x","setdiff1d"),r=Ad(e,"y","setdiff1d");ks(n.dtype===r.dtype,()=>"x and y should have the same dtype, but got x (".concat(n.dtype,") and y (").concat(r.dtype,").")),ks(1===n.rank,()=>"x should be 1D tensor, but got x (".concat(n.shape,").")),ks(1===r.rank,()=>"y should be 1D tensor, but got y (".concat(r.shape,")."));const a=await n.data(),i=await r.data(),o=new Set(i);let s=0;for(let u=0;u<a.length;u++)o.has(a[u])||s++;const c=new $h([s],n.dtype),l=new $h([s],"int32");for(let u=0,h=0;u<a.length;u++)o.has(a[u])||(c.values[h]=a[u],l.values[h]=u,h++);return[c.toTensor(),l.toTensor()]};const hv=Dd({sign_:function(t){const e={x:Ad(t,"x","sign")};return xd.runKernel(Du,e)}});const dv=Dd({sin_:function(t){const e={x:Ad(t,"x","sin","float32")};return xd.runKernel(Ru,e)}});const fv=Dd({sinh_:function(t){const e={x:Ad(t,"x","sinh")};return xd.runKernel(Ou,e)}});const pv=Dd({slice1d_:function(t,e,n){const r=Ad(t,"x","slice1d");return ks(1===r.rank,()=>"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")),Im(r,[e],[n])}});const mv=Dd({slice2d_:function(t,e,n){const r=Ad(t,"x","slice2d");return ks(2===r.rank,()=>"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")),Im(r,e,n)}});const gv=Dd({slice3d_:function(t,e,n){const r=Ad(t,"x","slice3d");return ks(3===r.rank,()=>"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")),Im(r,e,n)}});const yv=Dd({slice4d_:function(t,e,n){const r=Ad(t,"x","slice4d");return ks(4===r.rank,()=>"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")),Im(r,e,n)}});const vv=Dd({softmax_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=Ad(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(e));const r={logits:n},a={dim:e};return xd.runKernel(ju,r,a)}});const bv=Dd({fft_:function(t){ks("complex64"===t.dtype,()=>"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(t.dtype,"."));const e={input:t};return xd.runKernel(dl,e)}});const wv=Dd({ifft_:function(t){ks("complex64"===t.dtype,()=>"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(t.dtype,"."));const e={input:t};return xd.runKernel(_l,e)}});const xv=Dd({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const a=bm(t,[n,e]);r=wv(a)}else{const a=[n,2*(e-1)],i=bm(Jy(t),[n,e]),o=bm(Vg(t),[n,e]),s=ev(Im(i,[0,1],[n,e-2]),1),c=Sm(ev(Im(o,[0,1],[n,e-2]),1),Wp(-1)),l=km([i,s],1),u=km([o,c],1),h=bm(Md(l,u),[a[0],a[1]]);r=wv(h)}if(r=Jy(r),3===t.rank&&0!==t.shape[0]){const e=r,n=t.shape[0];r=bm(r,[n,r.shape[0]/n,r.shape[1]]),e.dispose()}return r}});const kv=Dd({split_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={x:Ad(t,"x","split")},a={numOrSizeSplits:e,axis:n};return xd.runKernel(Bu,r,a)}});const _v=Dd({rfft_:function(t,e){ks("float32"===t.dtype,()=>"The dtype for rfft() must be real value but got ".concat(t.dtype));let n=t.shape[t.shape.length-1];const r=t.size/n;let a;if(null!=e&&e<n){const r=t.shape.map(t=>0),i=t.shape.map(t=>t);i[t.shape.length-1]=e,a=Im(t,r,i),n=e}else if(null!=e&&e>n){const r=t.shape.map(t=>t);r[t.shape.length-1]=e-n,a=km([t,yy(r)],t.shape.length-1),n=e}else a=t;const i=ug(a),o=bm(Md(a,i),[r,n]),s=bv(o),c=Math.floor(n/2)+1,l=Jy(s),u=Vg(s),h=kv(l,[c,n-c],l.shape.length-1),d=kv(u,[c,n-c],u.shape.length-1),f=a.shape.slice();return f[a.shape.length-1]=c,bm(Md(h[0],d[0]),f)}});const Sv=Dd({squaredDifference_:function(t,e){let n=Ad(t,"a","squaredDifference"),r=Ad(e,"b","squaredDifference");[n,r]=fd(n,r),lp(n.shape,r.shape);const a={a:n,b:r};return xd.runKernel(qu,a,{})}});const Tv=Dd({squeeze_:function(t,e){const n=Ad(t,"x","squeeze","string_or_numeric");return bm(n,Ms(n.shape,e).newShape)}});const Iv=Dd({stack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Rd(t,"tensors","stack","string_or_numeric");ks(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&ks(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,a={axis:e};return xd.runKernel(ou,r,a)}});const Ev=Dd({step_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n={x:Ad(t,"x","step")},r={alpha:e};return xd.runKernel(lh,n,r)}});const Nv=Dd({stridedSlice_:function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;const l={x:Ad(t,"x","stridedSlice","string_or_numeric")},u={begin:e,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:c};return xd.runKernel(Xu,l,u)}});const Cv=Dd({tan_:function(t){const e={x:Ad(t,"x","tan","float32")};return xd.runKernel(Zu,e)}});function Av(t,e){Ss(t);const n=Ed(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Fd(t,null,n,e)}function Rv(t,e,n){if(Ss(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=Ed(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Fd(t,e,r,n)}function Ov(t,e,n){if(Ss(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const r=Ed(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Fd(t,e,r,n)}function Dv(t,e,n){if(Ss(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const r=Ed(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Fd(t,e,r,n)}function Mv(t,e,n){if(Ss(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const r=Ed(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Fd(t,e=e||r,r,n)}const Fv=Dd({topk_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Ad(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(e));if(e>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(e));const i={x:r},o={k:e,sorted:n},[s,c]=xd.runKernel(nh,i,o);return{values:s,indices:c}}});const Pv=Dd({truncatedNormal_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const i=new Wy(e,n,r,!0,a),o=Lf(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}});const Lv=Dd({unique_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Ad(t,"x","unique","string_or_numeric");ks(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},a={axis:e},[i,o]=xd.runKernel(ih,r,a);return{values:i,indices:o}}});const zv=Dd({unsortedSegmentSum_:function(t,e,n){const r=Ad(t,"x","unsortedSegmentSum"),a=Ad(e,"segmentIds","unsortedSegmentSum","int32");ks(Ns(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:a},o={numSegments:n};return xd.runKernel(sh,i,o)}});const Bv=Dd({unstack_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Ad(t,"x","unstack","string_or_numeric");ks(e>=-n.shape.length&&e<n.shape.length,()=>"Axis = ".concat(e," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")"));const r={value:n},a={axis:e};return xd.runKernel(oh,r,a)}});function jv(t,e){return uy(t,e,"right")}function Uv(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return xd.makeVariable(t,e,n,r)}function Vv(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=Lf(t,"int32"),a=Lf([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const e=r.indexToLoc(n[i]),o=i*t.length;a.values.set(e,o)}return a.toTensor()}const Wv=async function(t){const e=Ad(t,"condition","whereAsync","bool"),n=await e.data(),r=Vv(e.shape,n);return t!==e&&e.dispose(),r};const Gv=async function(t,e,n){const r=Ad(t,"tensor","boolMask"),a=Ad(e,"mask","boolMask","bool"),i=null==n?0:n,o=a.rank,s=r.shape;ks(o>0,()=>"mask cannot be scalar"),_s(s.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let m=i;m<i+o;m++)c*=s[m];const l=s.slice(0,i).concat([c],s.slice(i+o)),u=bm(r,l),h=bm(a,[-1]),d=await Wv(h),f=Tv(d,[1]),p=Bg(u,f,i);return t!==r&&r.dispose(),e!==a&&a.dispose(),f.dispose(),u.dispose(),h.dispose(),d.dispose(),p};const Hv=Dd({transpose_:function(t,e,n){const r=Ad(t,"x","transpose");if(null==e&&(e=r.shape.map((t,e)=>e).reverse()),ks(r.rank===e.length,()=>"Error in transpose: rank of input ".concat(r.rank," ")+"must match length of perm ".concat(e,".")),e.forEach(t=>{ks(t>=0&&t<r.rank,()=>"All entries in 'perm' must be between 0 and ".concat(r.rank-1)+" but got ".concat(e))}),r.rank<=1)return r.clone();const a={x:r},i={perm:e};return"complex64"===r.dtype?zp(()=>{let t=Jy(r),e=Vg(r);return t=xd.runKernel(ah,{x:t},i),e=xd.runKernel(ah,{x:e},i),n&&(e=Zg(e)),Md(t,e)}):xd.runKernel(ah,a,i)}});const qv=Dd({movingAverage_:function(t,e,n,r){let a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const i=Ad(t,"v","movingAverage"),o=Ad(e,"x","movingAverage"),s=Ad(n,"decay","movingAverage");var c,l;l=o,ks((c=i).dtype===l.dtype,()=>"The dtypes of the first(".concat(c.dtype,") and")+" second(".concat(l.dtype,") input must match")),ks(Es(i.shape,o.shape),()=>"Shape mismatch in v and x");const u=Wp(1),h=ny(u,s);let d=Sm(ny(o,i),h);if(a){ks(null!=r,()=>"When using zeroDebias: true, step is required.");const t=Ad(r,"step","movingAverage");d=sg(d,ny(u,Ig(s,t)))}return Xp(i,d)}});function Kv(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(e.shape,", shape: ").concat(t)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(t.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+t.length-r)throw new Error(i+" update.rank != ".concat(a+t.length-r));for(let o=0;o<a;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(e.shape[o],")."));for(let o=0;o<n.rank-a;++o)if(n.shape[o+a]!==t[o+r])throw new Error(i+" updates.shape[".concat(o+a,"] (").concat(n.shape[o+a],") != shape[").concat(o+a,"] (").concat(t[o+a],")"))}function Xv(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(e.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: ".concat(e.shape));if(0===t.size)throw new Error("Updates specified for empty output. updates shape: ".concat(t.shape))}Kv(n,e,t)}function Yv(t,e,n){const r=e.shape.length,a=r>1?e.shape[r-1]:1,i=n.length;let o=1;for(let c=a;c<i;++c)o*=n[c];const s=a<1?1:a;return{sliceRank:a,numUpdates:Is(e.shape)/s,sliceSize:o,strides:[...Hs(n.slice(0,a)),1],outputSize:Is(n)}}const Qv=Dd({scatterND_:function(t,e,n){const r=Ad(t,"indices","scatterND","int32"),a=Ad(e,"updates","scatterND");Xv(a,r,n);const i={indices:r,updates:a},o={shape:n};return xd.runKernel(Iu,i,o)}});const Jv=Dd({sparseToDense_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a=Ad(t,"sparseIndices","sparseToDense","int32"),i=Ad(e,"sparseValues","sparseToDense","string_or_numeric"),o=Ad(r,"defaultValue","sparseToDense",i.dtype);!function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(t.shape,"."));const a=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));const o=e.size;if(0!==e.rank&&(1!==e.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(e.shape,", should be [] or [").concat(a,"]"));if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o);const s={sparseIndices:a,sparseValues:i,defaultValue:o},c={outputShape:n};return xd.runKernel(Hu,s,c)}});const $v=Dd({gatherND_:function(t,e){const n=Ad(e,"indices","gatherND","int32"),r={params:Ad(t,"x","gatherND","string_or_numeric"),indices:n};return xd.runKernel(bl,r)}});const Zv=Dd({dropout_:function(t,e,n,r){const a=Ad(t,"x","dropout");if(ks("float32"===a.dtype,()=>"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")),ks(e>=0&&e<1,()=>"rate must be a float in the range [0, 1), but got ".concat(e,".")),0===e)return t instanceof nd?a.clone():a;const i=function(t,e){if(null==e)return t.shape.slice();if(Es(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(a,n),o=1-e,s=sg(zg(Xp(Yy(i,0,1,"float32",r),o)),o);return Sm(a,s)}});function tb(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function eb(t,e,n){const r=1-t%2,a=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+r-1);a[i]=e-n*Math.cos(o)}return Av(a,"float32")}const nb=async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const r=Ad(t,"predictions","inTopK"),a=Ad(e,"targets","inTopK");ks(r.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(r.rank)),ks(r.rank-1===a.rank,()=>"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(r.rank," and targets rank ").concat(a.rank)),_s(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];ks(n>0&&n<=i,()=>"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(i,"), but got ").concat(n));const o=await r.data(),s=await a.data(),[c,l]=[o.length/i,i],u=Fs("bool",c);for(let h=0;h<c;h++){const t=h*l,e=o.subarray(t,t+l),r=[];for(let n=0;n<e.length;n++)r.push({value:e[n],index:n});r.sort((t,e)=>e.value-t.value),u[h]=0;for(let a=0;a<n;a++)if(r[a].index===s[h]){u[h]=1;break}}return t!==r&&r.dispose(),e!==a&&a.dispose(),Pd(u,a.shape,"bool")};const rb=Dd({conv2DBackpropFilter_:function(t,e,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=t;3===t.rank&&(s=bm(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;3===c.rank&&(c=bm(e,[1,e.shape[0],e.shape[1],e.shape[2]])),ks(4===s.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")),ks(4===c.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(c.shape,".")),ks(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,"."));const l="NHWC"===i?s.shape[3]:s.shape[1],u="NHWC"===i?c.shape[3]:c.shape[1];ks(l===n[2],()=>"Error in conv2dDerFilter: depth of input ".concat(l,") must ")+"match input depth in filter (".concat(n[2],".")),ks(u===n[3],()=>"Error in conv2dDerFilter: depth of dy (".concat(u,") must ")+"match output depth for filter (".concat(n[3],").")),vm("conv2dDerFilter",a,o);const h={x:s,dy:c},d={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return xd.runKernel(zc,h,d)}});function ab(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return Sm(t,Ev(e));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function ib(t,e){let n=e;const r=cp(t.shape,e.shape);return r.length>0&&(n=Cg(n,r)),bm(n,t.shape)}function ob(t,e,n,r){if("linear"===e)return t;if("relu"===e)return Zy(t);if("elu"===e)return pg(t);if("relu6"===e)return tv(t);if("prelu"===e)return Ly(t,n);if("leakyrelu"===e)return qg(t,r);if("sigmoid"===e)return Tm(t);throw new Error("Unknown fused activation ".concat(e,"."))}const sb=(t,e)=>!(t>0)||"linear"===e;const cb=Dd({fusedConv2d_:function(t){let{x:e,filter:n,strides:r,pad:a,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:c,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}=t;if(l=l||"linear",!1===sb(xd.state.gradientDepth,l)){ks("NHWC"===i,()=>"Error in fused conv2d: got dataFormat of ".concat(i," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.");let t=Gm(e,n,r,a,i,o,s);return null!=c&&(t=Xp(t,c)),ob(t,l,u,h)}const d=Ad(e,"x","conv2d","float32"),f=Ad(n,"filter","conv2d","float32");let p=d,m=!1;3===d.rank&&(m=!0,p=bm(d,[1,d.shape[0],d.shape[1],d.shape[2]])),ks(4===p.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(p.rank,".")),ks(4===f.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(f.rank,".")),vm("fused conv2d",a,s);const g="NHWC"===i?p.shape[3]:p.shape[1];ks(f.shape[2]===g,()=>"Error in conv2d: depth of input (".concat(g,") must match ")+"input depth for filter ".concat(f.shape[2],".")),ks(gm(r,o),()=>"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(o,"'"));const y=cm(p.shape,f.shape,r,o,a,s);let v,b;if(null!=c&&(v=Ad(c,"bias","fused conv2d"),[v]=fd(v,d),"NHWC"===i?lp(y.outShape,v.shape):(ks(v.shape.length<=1,()=>"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(v.shape.length,".")),ks(0===v.shape.length||v.shape[0]===y.outChannels||1===v.shape[0],()=>"Error in fused conv2d: bias shape (".concat(v.shape,") is not ")+"compatible with the number of output channels "+"(".concat(y.outChannels,")")))),null!=u){const t=u.shape;if(ks(t.length<=1||3===t.length,()=>"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(t.length,".")),1===t.length)ks(1===t[0]||t[0]===y.outChannels,()=>"Error in fused conv2d: PReLU activation weights "+"(".concat(t,") is not compatible with the number of output ")+"channels (".concat(y.outChannels,")."));else if(3===t.length)try{lp(t,y.outShape)}catch(Grt){const n="Error in fused conv2d: PReLU activation weights (".concat(t,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(y.outShape,").");throw Error(n)}b=Ad(u,"prelu weights","fused conv2d")}const w=(t,e)=>{ks("NHWC"===i,()=>"Error in gradient of fused conv2D: got dataFormat of ".concat(i," but only NHWC is currently supported."));const[n,s,c,u]=e,h=ab(t,c,l);ks(mm(o),()=>"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'"));const d=[qm(s.shape,h,n,r,a),rb(s,h,n.shape,r,a)];if(null!=u){const t=ib(u,h);d.push(t)}return d},x={x:p,filter:f,bias:v,preluActivationWeights:b},k={strides:r,pad:a,dataFormat:i,dilations:o,dimRoundingMode:s,activation:l,leakyreluAlpha:h};if(null==c){const t=Vp((t,e,n)=>{let r=xd.runKernel(fh,x,k);return n([e,t,r]),m&&(r=bm(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:w}});return t(p,f)}{const t=Vp((t,e,n,r)=>{let a=xd.runKernel(fh,x,k);return r([e,t,a,n]),m&&(a=bm(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:w}});return t(p,f,v)}}});const lb=Dd({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=t;3===t.rank&&(s=bm(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;3===c.rank&&(c=bm(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const l={x:s,dy:c},u={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return xd.runKernel(Jc,l,u)}});const ub=Dd({depthwiseConv2dNativeBackpropInput_:function(t,e,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=e,c=!1;3===e.rank&&(c=!0,s=bm(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const l={dy:s,filter:n},u={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:t},h=xd.runKernel($c,l,u);return c?bm(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});const hb=Dd({fusedDepthwiseConv2d_:function(t){let{x:e,filter:n,strides:r,pad:a,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:c,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}=t;if(!1===sb(xd.state.gradientDepth,l)){let t=rg(e,n,r,a,i,o,s);return null!=c&&(t=Xp(t,c)),ob(t,l,u,h)}const d=Ad(e,"x","depthwiseConv2d","float32"),f=Ad(n,"filter","depthwiseConv2d","float32");let p=d,m=!1;3===d.rank&&(m=!0,p=bm(d,[1,d.shape[0],d.shape[1],d.shape[2]])),ks(4===p.rank,()=>"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(p.rank,".")),ks(4===f.rank,()=>"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(f.rank,".")),ks(p.shape[3]===f.shape[2],()=>"Error in fused depthwiseConv2d: number of input channels "+"(".concat(p.shape[3],") must match the inChannels dimension in ")+"filter ".concat(f.shape[2],".")),null==o&&(o=[1,1]),ks(gm(r,o),()=>"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(o,"'")),vm("fused depthwiseConv2d",a,s);const g=cm(p.shape,f.shape,r,o,a,s,!0);let y,v;null!=c&&(y=Ad(c,"bias","fused conv2d"),[y]=fd(y,d),lp(g.outShape,y.shape)),null!=u&&(v=Ad(u,"prelu weights","fused depthwiseConv2d"));const b=(t,e)=>{ks(mm(o),()=>"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(o,"'"));const[n,i,c,u]=e,h=ab(t,c,l),d=ub(i.shape,h,n,r,a,o,s),f=lb(i,h,n.shape,r,a,o,s);if(null!=u){return[d,f,ib(y,h)]}return[d,f]},w={x:p,filter:f,bias:y,preluActivationWeights:v},x={strides:r,pad:a,dataFormat:i,dilations:o,dimRoundingMode:s,activation:l,leakyreluAlpha:h};if(null==c){const t=Vp((t,e,n)=>{let r=xd.runKernel(ph,w,x);return n([e,t,r]),m&&(r=bm(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:b}});return t(p,f)}{const t=Vp((t,e,n,r)=>{let a=xd.runKernel(ph,w,x);return r([e,t,a,n]),m&&(a=bm(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:b}});return t(p,f,y)}}});const db=Dd({fusedMatMul_:function(t){let{a:e,b:n,transposeA:r=!1,transposeB:a=!1,bias:i,activation:o="linear",preluActivationWeights:s,leakyreluAlpha:c=.2}=t;if(!1===sb(xd.state.gradientDepth,o)){let t=_m(e,n,r,a);return null!=i&&(t=Xp(t,i)),ob(t,o,s,c)}let l=Ad(e,"a","fused matMul"),u=Ad(n,"b","fused matMul");[l,u]=fd(l,u);const h=r?l.shape[l.rank-2]:l.shape[l.rank-1],d=a?u.shape[u.rank-1]:u.shape[u.rank-2],f=r?l.shape[l.rank-1]:l.shape[l.rank-2],p=a?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),g=u.shape.slice(0,-2),y=Is(m),v=Is(g);ks(h===d,()=>"Error in fused matMul: inner shapes (".concat(h,") and (")+"".concat(d,") of Tensors with shapes ").concat(l.shape," and ")+"".concat(u.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match."));const b=lp(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([f,p]),w=bm(l,r?[y,h,f]:[y,f,h]),x=bm(u,a?[v,p,d]:[v,d,p]);let k,_;null!=i&&(k=Ad(i,"bias","fused matMul"),[k]=fd(k,l),lp(b,k.shape)),null!=s&&(_=Ad(s,"prelu weights","fused matMul"));const S=(t,e)=>{const[n,s,c,l]=e,u=ab(bm(t,c.shape),c,o);let h,d;if(r||a?!r&&a?(h=_m(u,s,!1,!1),d=_m(u,n,!0,!1)):r&&!a?(h=_m(s,u,!1,!0),d=_m(n,u,!1,!1)):(h=_m(s,u,!0,!0),d=_m(u,n,!0,!0)):(h=_m(u,s,!1,!0),d=_m(n,u,!0,!1)),null!=i){return[h,d,ib(l,u)]}return[h,d]},T={a:w,b:x,bias:k,preluActivationWeights:_},I={transposeA:r,transposeB:a,activation:o,leakyreluAlpha:c};if(null==i){const t=Vp((t,e,n)=>{const r=xd.runKernel(dh,T,I);return n([t,e,r]),{value:bm(r,b),gradFunc:S}});return t(w,x)}{const t=Vp((t,e,n,r)=>{const a=xd.runKernel(dh,T,I);return r([t,e,a,n]),{value:bm(a,b),gradFunc:S}});return t(w,x,k)}}});const fb=Dd({hammingWindow_:function(t){return eb(t,.54,.46)}});const pb=Dd({hannWindow_:function(t){return eb(t,.5,.5)}});const mb=Dd({frame_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0;const o=[];for(;i+e<=t.size;)o.push(Im(t,i,e)),i+=n;if(r)for(;i<t.size;){const r=i+e-t.size,s=km([Im(t,i,e-r),zm([r],a)]);o.push(s),i+=n}return 0===o.length?Rv([],[0,e]):bm(km(o),[o.length,e])}});const gb=Dd({stft_:function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:pb;null==r&&(r=tb(e));const i=mb(t,e,n),o=Sm(i,a(e));return _v(o,r)}});const yb=Dd({cropAndResize_:function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=Ad(t,"image","cropAndResize"),s=Ad(e,"boxes","cropAndResize","float32"),c=Ad(n,"boxInd","cropAndResize","int32"),l=s.shape[0];ks(4===o.rank,()=>"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")),ks(2===s.rank&&4===s.shape[1],()=>"Error in cropAndResize: boxes must be have size [".concat(l,",4] ")+"but had shape ".concat(s.shape,".")),ks(1===c.rank&&c.shape[0]===l,()=>"Error in cropAndResize: boxInd must be have size [".concat(l,"] ")+"but had shape ".concat(s.shape,".")),ks(2===r.length,()=>"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")),ks(r[0]>=1&&r[1]>=1,()=>"cropSize must be atleast [1,1], but was ".concat(r)),ks("bilinear"===a||"nearest"===a,()=>"method must be bilinear or nearest, but was ".concat(a));const u={image:o,boxes:s,boxInd:c},h={method:a,extrapolationValue:i,cropSize:r};return xd.runKernel(Kc,u,h)}});const vb=Dd({flipLeftRight_:function(t){const e=Ad(t,"image","flipLeftRight","float32");ks(4===e.rank,()=>"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(e.rank,"."));const n={image:e};return xd.runKernel(pl,n,{})}});const bb=Dd({grayscaleToRGB_:function(t){const e=Ad(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];ks(e.rank>=2,()=>"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(e.rank,".")),ks(1===r,()=>"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,"."));const a=new Array(e.rank);return a.fill(1,0,n),a[n]=3,Pg(e,a)}});const wb=Dd({rotateWithOffset_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const a=Ad(t,"image","rotateWithOffset","float32");ks(4===a.rank,()=>"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,"."));const i={image:a},o={radians:e,fillValue:n,center:r};return xd.runKernel(hh,i,o)}});function xb(t,e,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);const o=t.shape[0];return n=Math.min(n,o),ks(0<=r&&r<=1,()=>"iouThreshold must be in [0, 1], but was '".concat(r,"'")),ks(2===t.rank,()=>"boxes must be a 2D tensor, but was of rank '".concat(t.rank,"'")),ks(4===t.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was ".concat(t.shape[1])),ks(1===e.rank,()=>"scores must be a 1D tensor"),ks(e.shape[0]===o,()=>"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(e.shape[0])),ks(0<=i&&i<=1,()=>"softNmsSigma must be in [0, 1], but was '".concat(i,"'")),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}const kb=Dd({nonMaxSuppression_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const i=Ad(t,"boxes","nonMaxSuppression","float32"),o=Ad(e,"scores","nonMaxSuppression","float32"),s=xb(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const c={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return xd.runKernel(eu,{boxes:i,scores:o},c)}});function _b(t,e,n){const r=function(t,e,n){return function(t,e,n){let r=0,a=t.length,i=0,o=!1;for(;r<a;){i=r+(a-r>>>1);const s=n(e,t[i]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(t,e,n||Sb)}(t,e,n),a=r<0?-(r+1):r;t.splice(a,0,e)}function Sb(t,e){return t>e?1:t<e?-1:0}function Tb(t,e,n,r,a){return Nb(t,e,n,r,a,0)}function Ib(t,e,n,r,a,i){return Nb(t,e,n,r,a,0,!1,i,!0)}function Eb(t,e,n,r,a,i){return Nb(t,e,n,r,a,i,!0)}function Nb(t,e,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];const l=[];for(let g=0;g<e.length;g++)e[g]>a&&l.push({score:e[g],boxIndex:g,suppressBeginIndex:0});l.sort(Rb);const u=i>0?-.5/i:0,h=[],d=[];for(;h.length<n&&l.length>0;){const e=l.pop(),{score:n,boxIndex:i,suppressBeginIndex:o}=e;if(n<a)break;let s=!1;for(let c=h.length-1;c>=o;--c){const n=Cb(t,i,h[c]);if(n>=r){s=!0;break}if(e.score=e.score*Ab(r,u,n),e.score<=a)break}e.suppressBeginIndex=h.length,s||(e.score===n?(h.push(i),d.push(e.score)):e.score>a&&_b(l,e,Rb))}const f=h.length,p=n-f;s&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const m={selectedIndices:h};return o&&(m.selectedScores=d),c&&(m.validOutputs=f),m}function Cb(t,e,n){const r=t.subarray(4*e,4*e+4),a=t.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),l=Math.min(a[0],a[2]),u=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),f=(s-i)*(c-o),p=(h-l)*(d-u);if(f<=0||p<=0)return 0;const m=Math.max(i,l),g=Math.max(o,u),y=Math.min(s,h),v=Math.min(c,d),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(f+p-b)}function Ab(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function Rb(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}const Ob=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY;const i=Ad(t,"boxes","nonMaxSuppressionAsync"),o=Ad(e,"scores","nonMaxSuppressionAsync"),s=xb(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const c=await Promise.all([i.data(),o.data()]),l=c[0],u=c[1],{selectedIndices:h}=Tb(l,u,n,r,a);return i!==t&&i.dispose(),o!==e&&o.dispose(),Av(h,"int32")};const Db=Dd({nonMaxSuppressionWithScore_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=Ad(t,"boxes","nonMaxSuppression"),s=Ad(e,"scores","nonMaxSuppression"),c=xb(o,s,n,r,a,i);n=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma;const l={boxes:o,scores:s},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i},h=xd.runKernel(ru,l,u);return{selectedIndices:h[0],selectedScores:h[1]}}});const Mb=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;const o=Ad(t,"boxes","nonMaxSuppressionAsync"),s=Ad(e,"scores","nonMaxSuppressionAsync"),c=xb(o,s,n,r,a,i);n=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma;const l=await Promise.all([o.data(),s.data()]),u=l[0],h=l[1],{selectedIndices:d,selectedScores:f}=Eb(u,h,n,r,a,i);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:Av(d,"int32"),selectedScores:Av(f)}};const Fb=Dd({nonMaxSuppressionPadded_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=Ad(t,"boxes","nonMaxSuppression"),s=Ad(e,"scores","nonMaxSuppression"),c=xb(o,s,n,r,a,null),l={boxes:o,scores:s},u={maxOutputSize:c.maxOutputSize,iouThreshold:c.iouThreshold,scoreThreshold:c.scoreThreshold,padToMaxOutputSize:i},h=xd.runKernel(nu,l,u);return{selectedIndices:h[0],validOutputs:h[1]}}});const Pb=async function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=Ad(t,"boxes","nonMaxSuppressionAsync"),s=Ad(e,"scores","nonMaxSuppressionAsync"),c=xb(o,s,n,r,a,null),l=c.maxOutputSize,u=c.iouThreshold,h=c.scoreThreshold,[d,f]=await Promise.all([o.data(),s.data()]),{selectedIndices:p,validOutputs:m}=Ib(d,f,l,u,h,i);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:Av(p,"int32"),validOutputs:Wp(m,"int32")}};const Lb=Dd({resizeBilinear_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=Ad(t,"images","resizeBilinear");ks(3===a.rank||4===a.rank,()=>"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")),ks(2===e.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(e,".")),ks(!1===r||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=a,o=!1;3===a.rank&&(o=!0,i=bm(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=e,s={images:i},c={alignCorners:n,halfPixelCenters:r,size:e},l=xd.runKernel(wu,s,c);return o?bm(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const zb=Dd({resizeNearestNeighbor_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=Ad(t,"images","resizeNearestNeighbor");ks(3===a.rank||4===a.rank,()=>"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")),ks(2===e.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(e,".")),ks("float32"===a.dtype||"int32"===a.dtype,()=>"`images` must have `int32` or `float32` as dtype"),ks(!1===r||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=a,o=!1;3===a.rank&&(o=!0,i=bm(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=e,s={images:i},c={alignCorners:n,halfPixelCenters:r,size:e},l=xd.runKernel(vu,s,c);return o?bm(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});const Bb=Dd({threshold_:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;const a=Ad(t,"image","threshold"),i=a.shape[0]*a.shape[1];let o,s,c,l,u=Sm(Av([r]),255);if(ks(3===a.rank,()=>"Error in threshold: image must be rank 3,"+"but got rank ".concat(a.rank,".")),ks(3===a.shape[2]||1===a.shape[2],()=>"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(a.shape[2],".")),ks("int32"===a.dtype||"float32"===a.dtype,()=>"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(a.dtype,".")),ks("otsu"===e||"binary"===e,()=>"Method must be binary or otsu, but was ".concat(e)),3===a.shape[2]){[o,s,c]=kv(a,[1,1,1],-1);const t=Sm(o,.2989),e=Sm(s,.587),n=Sm(c,.114);l=Xp(Xp(t,e),n)}else l=t;if("otsu"===e){u=function(t,e){let n,r,a,i,o,s,c=Av([-1]),l=Av([0]),u=Av([0]);for(let h=0;h<t.size-1;h++){n=Im(t,0,h+1),r=Im(t,h+1),o=sg(Cg(n),e),s=sg(Cg(r),e);const d=Cg(Sm(n,Qy(0,n.size)));a=sg(d,Cg(n));const f=zm(r.shape,n.size),p=Xp(Qy(0,r.size),f),m=Sm(r,p);i=sg(Cg(m),Cg(r));const g=ny(a,i),y=ny(a,i),v=Sm(o,s);u=Sm(Sm(v,g),y);const b=jg(u,l);l=lg(b,u,l),c=lg(b,Av([h]),c)}return c}(Mm(zf(ov(l),"int32"),Pd([]),256),i)}const h=n?Xg(l,u):jg(l,u);return zf(Sm(h,255),"int32")}});const jb=Dd({transform_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0;const o=Ad(t,"image","transform","float32"),s=Ad(e,"transforms","transform","float32");ks(4===o.rank,()=>"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")),ks(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),ks(null==i||2===i.length,()=>"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,"."));const c={image:o,transforms:s},l={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return xd.runKernel(rh,c,l)}});const Ub=Dd({bandPart_:function(t,e,n){ks(e%1===0,()=>"bandPart(): numLower must be an integer, got ".concat(e,".")),ks(n%1===0,()=>"bandPart(): numUpper must be an integer, got ".concat(n,"."));const r=Ad(t,"a","bandPart");ks(r.rank>=2,()=>"bandPart(): Rank must be at least 2, got ".concat(r.rank,"."));const a=r.shape,[i,o]=r.shape.slice(-2);if(!(e<=i))throw new Error("bandPart(): numLower (".concat(e,")")+" must not be greater than the number of rows (".concat(i,")."));if(!(n<=o))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(o,")."));e<0&&(e=i),n<0&&(n=o);const s=bm(Qy(0,i,1,"int32"),[-1,1]),c=Qy(0,o,1,"int32"),l=ny(s,c),u=iy(Xg(l,Wp(+e,"int32")),Ug(l,Wp(-n,"int32"))),h=yy([i,o],r.dtype);return bm(Iv(Bv(bm(r,[-1,i,o])).map(t=>lg(u,t,h))),a)}});const Vb=Dd({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,ks(null!=t&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const n=t[0].shape[0];for(let e=1;e<t.length;++e)ks(t[e].shape[0]===n,()=>"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(t[e].shape[0]," vs. ").concat(n,")"))}else e=!0,t=kv(t,t.shape[0],0).map(t=>Tv(t,[0]));ks(t.length<=t[0].shape[0],()=>"Gram-Schmidt: Number of vectors (".concat(t.length,") exceeds ")+"number of dimensions (".concat(t[0].shape[0],")."));const n=[],r=t;for(let a=0;a<t.length;++a)n.push(xd.tidy(()=>{let t=r[a];if(a>0)for(let e=0;e<a;++e){const r=Sm(Cg(Sm(n[e],t)),n[e]);t=ny(t,r)}return sg(t,Rg(t,"euclidean"))}));return e?Iv(n,0):n}});function Wb(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return xd.tidy(()=>{ks(2===t.shape.length,()=>"qr2d() requires a 2D Tensor, but got a ".concat(t.shape.length,"D Tensor."));const n=t.shape[0],r=t.shape[1];let a=Lg(n),i=Bf(t);const o=Rv([[1]],[1,1]);let s=Bf(o);const c=n>=r?r:n;for(let t=0;t<c;++t){const e=i,c=s,l=a;[s,i,a]=xd.tidy(()=>{const e=Im(i,[t,t],[n-t,1]),c=Rg(e),l=Im(i,[t,t],[1,1]),u=lg(jg(l,0),Rv([[-1]]),Rv([[1]])),h=ny(l,Sm(u,c)),d=sg(e,h);s=1===d.shape[0]?Bf(o):km([o,Im(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const f=Zg(sg(_m(u,h),c)),p=Im(i,[t,0],[n-t,r]),m=Sm(f,s),g=Hv(s);if(0===t)i=ny(p,_m(m,_m(g,p)));else{const e=ny(p,_m(m,_m(g,p)));i=km([Im(i,[0,0],[t,r]),e],0)}const y=Hv(m),v=Im(a,[0,t],[n,a.shape[1]-t]);if(0===t)a=ny(v,_m(_m(v,s),y));else{const e=ny(v,_m(_m(v,s),y));a=km([Im(a,[0,0],[n,t]),e],1)}return[s,i,a]}),Bp([e,c,l])}return!e&&n>r&&(a=Im(a,[0,0],[n,r]),i=Im(i,[0,0],[r,r])),[a,i]})}const Gb=Dd({qr_:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(ks(t.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank ".concat(t.rank)),2===t.rank)return Wb(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((t,e)=>t*e),r=Bv(bm(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],i=[];r.forEach(t=>{const[n,r]=Wb(t,e);a.push(n),i.push(r)});return[bm(Iv(a,0),t.shape),bm(Iv(i,0),t.shape)]}}});var Hb;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Hb||(Hb={}));const qb=Dd({computeWeightedLoss_:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Hb.SUM_BY_NONZERO_WEIGHTS;const r=Ad(t,"losses","computeWeightedLoss");let a=null;null!=e&&(a=Ad(e,"weights","computeWeightedLoss"));const i=null==a?r:Sm(r,a);if(n===Hb.NONE)return i;if(n===Hb.SUM)return Cg(i);if(n===Hb.MEAN){if(null==a)return gy(i);{const t=r.size/a.size,e=sg(Cg(i),Cg(a));return t>1?sg(e,Wp(t)):e}}if(n===Hb.SUM_BY_NONZERO_WEIGHTS){if(null==a)return sg(Cg(i),Wp(r.size));{const t=Sm(a,vy(r.shape)),e=zf(Cg(Iy(t,Wp(0))),"float32");return sg(Cg(i),e)}}throw Error("Unknown reduction: ".concat(n))}});const Kb=Dd({absoluteDifference_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Hb.SUM_BY_NONZERO_WEIGHTS;const a=Ad(t,"labels","absoluteDifference"),i=Ad(e,"predictions","absoluteDifference");let o=null;null!=n&&(o=Ad(n,"weights","absoluteDifference")),_s(a.shape,i.shape,"Error in absoluteDifference: ");const s=Hp(ny(a,i));return qb(s,o,r)}});const Xb=Dd({cosineDistance_:function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Hb.SUM_BY_NONZERO_WEIGHTS;const i=Ad(t,"labels","cosineDistance"),o=Ad(e,"predictions","cosineDistance");let s=null;null!=r&&(s=Ad(r,"weights","cosineDistance")),_s(i.shape,o.shape,"Error in cosineDistance: ");const c=Wp(1),l=ny(c,Cg(Sm(i,o),n,!0));return qb(l,s,a)}});const Yb=Dd({hingeLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Hb.SUM_BY_NONZERO_WEIGHTS,a=Ad(t,"labels","hingeLoss");const i=Ad(e,"predictions","hingeLoss");let o=null;null!=n&&(o=Ad(n,"weights","hingeLoss")),_s(a.shape,i.shape,"Error in hingeLoss: ");const s=Wp(1);a=ny(Sm(Wp(2),a),s);const c=Zy(ny(s,Sm(a,i)));return qb(c,o,r)}});const Qb=Dd({huberLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Hb.SUM_BY_NONZERO_WEIGHTS;const i=Ad(t,"labels","huberLoss"),o=Ad(e,"predictions","huberLoss");let s=null;null!=n&&(s=Ad(n,"weights","huberLoss")),_s(i.shape,o.shape,"Error in huberLoss: ");const c=Wp(r),l=Hp(ny(o,i)),u=wy(l,c),h=ny(l,u),d=Xp(Sm(Wp(.5),Ng(u)),Sm(c,h));return qb(d,s,a)}});const Jb=Dd({logLoss_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Hb.SUM_BY_NONZERO_WEIGHTS;const i=Ad(t,"labels","logLoss"),o=Ad(e,"predictions","logLoss");let s=null;null!=n&&(s=Ad(n,"weights","logLoss")),_s(i.shape,o.shape,"Error in logLoss: ");const c=Wp(1),l=Wp(r),u=Zg(Sm(i,Jg(Xp(o,l)))),h=Sm(ny(c,i),Jg(Xp(ny(c,o),l))),d=ny(u,h);return qb(d,s,a)}});const $b=Dd({meanSquaredError_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Hb.SUM_BY_NONZERO_WEIGHTS;const a=Ad(t,"labels","meanSquaredError"),i=Ad(e,"predictions","meanSquaredError");let o=null;null!=n&&(o=Ad(n,"weights","meanSquaredError")),_s(a.shape,i.shape,"Error in meanSquaredError: ");const s=Sv(a,i);return qb(s,o,r)}});const Zb=Dd({sigmoidCrossEntropy_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Hb.SUM_BY_NONZERO_WEIGHTS,i=Ad(t,"multiClassLabels","sigmoidCrossEntropy");const o=Ad(e,"logits","sigmoidCrossEntropy");let s=null;if(null!=n&&(s=Ad(n,"weights","sigmoidCrossEntropy")),_s(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const t=Wp(r),e=Wp(1),n=Wp(.5);i=Xp(Sm(i,ny(e,t)),Sm(n,t))}const c=function(t,e){const n=Ad(t,"labels","sigmoidCrossEntropyWithLogits"),r=Ad(e,"logits","sigmoidCrossEntropyWithLogits");_s(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=Zy(r),i=Sm(r,n),o=$g(Dg(Zg(Hp(r))));return Xp(ny(a,i),o)}(i,o);return qb(c,s,a)}});const tw=Dd({softmaxCrossEntropy_:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Hb.SUM_BY_NONZERO_WEIGHTS,i=Ad(t,"onehotLabels","softmaxCrossEntropy");const o=Ad(e,"logits","softmaxCrossEntropy");let s=null;if(null!=n&&(s=Ad(n,"weights","softmaxCrossEntropy")),_s(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const t=Wp(r),e=Wp(1),n=Wp(i.shape[1]);i=Xp(Sm(i,ny(e,t)),sg(t,n))}const c=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(e.rank," ")+"and dim was ".concat(n));const r=Vp((t,e,r)=>{const a=ay(e,[n],!0),i=ny(zf(e,"float32"),a);r([t,i]);const o=Zg(Sm(i,t));return{value:Cg(o,[n]),gradFunc:(t,e)=>{const[r,a]=e,i=bg(t.shape,[n]);return[Sm(bm(t,i),ny(zf(r,"float32"),Dg(a))),Sm(bm(t,i),ny(Dg(a),zf(r,"float32")))]}}});return r(t,e)}(i,o);return qb(c,s,a)}});const ew=Dd({sparseFillEmptyRows_:function(t,e,n,r){const a=Ad(t,"indices","sparseFillEmptyRows","int32"),i=Ad(e,"values","sparseFillEmptyRows"),o=Ad(n,"denseShape","sparseFillEmptyRows","int32"),s=Ad(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==i.rank)throw new Error("Values should be Tensor1D but received shape ".concat(i.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==s.rank)throw new Error("Default value should be a scalar but received shape ".concat(s.shape));const c={indices:a,values:i,denseShape:o,defaultValue:s},l=xd.runKernel(Uu,c);return{outputIndices:l[0],outputValues:l[1],emptyRowIndicator:l[2],reverseIndexMap:l[3]}}});const nw=Dd({sparseReshape_:function(t,e,n){const r=Ad(t,"inputIndices","sparseReshape","int32"),a=Ad(e,"inputShape","sparseReshape","int32"),i=Ad(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==i.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(i.shape));const o={inputIndices:r,inputShape:a,newShape:i},s=xd.runKernel(Vu,o);return{outputIndices:s[0],outputShape:s[1]}}});const rw=Dd({sparseSegmentMean_:function(t,e,n){const r=Ad(t,"data","sparseSegmentMean"),a=Ad(e,"indices","sparseSegmentMean","int32"),i=Ad(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(i.shape));const o={data:r,indices:a,segmentIds:i};return xd.runKernel(Wu,o)}});const aw=Dd({sparseSegmentSum_:function(t,e,n){const r=Ad(t,"data","sparseSegmentSum"),a=Ad(e,"indices","sparseSegmentSum","int32"),i=Ad(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(i.shape));const o={data:r,indices:a,segmentIds:i};return xd.runKernel(Gu,o)}});const iw=Dd({stringNGrams_:function(t,e,n,r,a,i,o,s){const c=Ad(t,"data","stringNGrams","string");if("string"!==c.dtype)throw new Error("Data must be of datatype string");if(1!==c.shape.length)throw new Error("Data must be a vector, saw: ".concat(c.shape));const l=Ad(e,"dataSplits","stringNGrams");if("int32"!==l.dtype)throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:s},h={data:c,dataSplits:l},d=xd.runKernel(Yu,h,u);return{nGrams:d[0],nGramsSplits:d[1]}}});const ow=Dd({stringSplit_:function(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Ad(t,"input","stringSplit","string"),a=Ad(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));const i={skipEmpty:n},o={input:r,delimiter:a},s=xd.runKernel(Qu,o,i);return{indices:s[0],values:s[1],shape:s[2]}}});const sw=Dd({stringToHashBucketFast_:function(t,e){const n=Ad(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return xd.runKernel(Ju,a,r)}}),cw={fft:bv,ifft:wv,rfft:_v,irfft:xv},lw={hammingWindow:fb,hannWindow:pb,frame:mb,stft:gb},uw={flipLeftRight:vb,grayscaleToRGB:bb,resizeNearestNeighbor:zb,resizeBilinear:Lb,rotateWithOffset:wb,cropAndResize:yb,nonMaxSuppression:kb,nonMaxSuppressionAsync:Ob,nonMaxSuppressionWithScore:Db,nonMaxSuppressionWithScoreAsync:Mb,nonMaxSuppressionPadded:Fb,nonMaxSuppressionPaddedAsync:Pb,threshold:Bb,transform:jb},hw={bandPart:Ub,gramSchmidt:Vb,qr:Gb},dw={absoluteDifference:Kb,computeWeightedLoss:qb,cosineDistance:Xb,hingeLoss:Yb,huberLoss:Qb,logLoss:Jb,meanSquaredError:$b,sigmoidCrossEntropy:Zb,softmaxCrossEntropy:tw},fw={sparseFillEmptyRows:ew,sparseReshape:nw,sparseSegmentMean:rw,sparseSegmentSum:aw},pw={stringNGrams:iw,stringSplit:ow,stringToHashBucketFast:sw};class mw extends Gp{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=xd.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=xd.registeredVariables[e],a=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:"".concat(e,"/accum_grad"),variable:zp(()=>ug(r).variable(a))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:"".concat(e,"/accum_var"),variable:zp(()=>ug(r).variable(a))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const o=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;zp(()=>{const t=Xp(Sm(o,this.rho),Sm(Ng(i),1-this.rho)),e=Sm(sg(Eg(Xp(s,this.epsilon)),Eg(Xp(o,this.epsilon))),i),n=Xp(Sm(s,this.rho),Sm(Ng(e),1-this.rho));o.assign(t),s.assign(n);const a=Xp(Sm(e,-this.learningRate),r);r.assign(a)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(Bp(this.accumulatedGrads.map(t=>t.variable)),Bp(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2,n=!1;this.accumulatedGrads=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedUpdates=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}mw.className="Adadelta",Fp(mw);class gw extends Gp{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=xd.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:"".concat(e,"/accumulator"),variable:zp(()=>zm(r.shape,this.initialAccumulatorValue).variable(t))}}const a=Array.isArray(t)?t[n].tensor:t[e];if(null==a)return;const i=this.accumulatedGrads[n].variable;zp(()=>{const t=Xp(i,Ng(a));i.assign(t);const e=Xp(Sm(sg(a,Eg(Xp(t,xd.backend.epsilon()))),-this.learningRate),r);r.assign(e)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&Bp(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);this.accumulatedGrads=t.map(t=>({originalName:t.name,variable:t.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}gw.className="Adagrad",Fp(gw);class yw extends Gp{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],zp(()=>{this.accBeta1=Wp(e).variable(),this.accBeta2=Wp(n).variable()}),null==r&&(this.epsilon=xd.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);zp(()=>{const n=ny(1,this.accBeta1),r=ny(1,this.accBeta2);e.forEach((e,a)=>{const i=xd.registeredVariables[e],o=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:"".concat(e,"/m"),variable:zp(()=>ug(i).variable(o))}),null==this.accumulatedSecondMoment[a]&&(this.accumulatedSecondMoment[a]={originalName:"".concat(e,"/v"),variable:zp(()=>ug(i).variable(o))});const s=Array.isArray(t)?t[a].tensor:t[e];if(null==s)return;const c=this.accumulatedFirstMoment[a].variable,l=this.accumulatedSecondMoment[a].variable,u=Xp(Sm(c,this.beta1),Sm(s,1-this.beta1)),h=Xp(Sm(l,this.beta2),Sm(Ng(s),1-this.beta2)),d=sg(u,n),f=sg(h,r);c.assign(u),l.assign(h);const p=Xp(Sm(sg(d,Xp(Eg(f),this.epsilon)),-this.learningRate),i);i.assign(p)}),this.accBeta1.assign(Sm(this.accBeta1,this.beta1)),this.accBeta2.assign(Sm(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Bp(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&Bp(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),zp(()=>{this.accBeta1.assign(Ig(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ig(this.beta2,this.iterations_+1))});const e=t.length/2,n=!1;this.accumulatedFirstMoment=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedSecondMoment=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}yw.className="Adam",Fp(yw);class vw extends Gp{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],zp(()=>{this.iteration=Wp(0).variable(),this.accBeta1=Wp(e).variable()}),null==r&&(this.epsilon=xd.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);zp(()=>{const n=ny(1,this.accBeta1),r=sg(-this.learningRate,Xp(Sm(this.iteration,this.decay),1));e.forEach((e,a)=>{const i=xd.registeredVariables[e],o=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:"".concat(e,"/m"),variable:ug(i).variable(o)}),null==this.accumulatedWeightedInfNorm[a]&&(this.accumulatedWeightedInfNorm[a]={originalName:"".concat(e,"/v"),variable:ug(i).variable(o)});const s=Array.isArray(t)?t[a].tensor:t[e];if(null==s)return;const c=this.accumulatedFirstMoment[a].variable,l=this.accumulatedWeightedInfNorm[a].variable,u=Xp(Sm(c,this.beta1),Sm(s,1-this.beta1)),h=Sm(l,this.beta2),d=Hp(s),f=my(h,d);c.assign(u),l.assign(f);const p=Xp(Sm(sg(r,n),sg(u,Xp(f,this.epsilon))),i);i.assign(p)}),this.iteration.assign(Xp(this.iteration,1)),this.accBeta1.assign(Sm(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Bp(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&Bp(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}vw.className="Adamax",Fp(vw);class bw extends Gp{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const a=xd.registeredVariables[e];zp(()=>{const t=Xp(Sm(this.c,r),a);a.assign(t)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=jp(Wp(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}bw.className="SGD",Fp(bw);class ww extends bw{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=Wp(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=xd.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:"".concat(e,"/momentum"),variable:zp(()=>ug(r).variable(t))}}const a=this.accumulations[n].variable,i=Array.isArray(t)?t[n].tensor:t[e];null!=i&&zp(()=>{let t;const e=Xp(Sm(this.m,a),i);t=this.useNesterov?Xp(Sm(this.c,Xp(i,Sm(e,this.m))),r):Xp(Sm(this.c,e),r),a.assign(e),r.assign(t)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&Bp(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);this.accumulations=t.map(t=>({originalName:t.name,variable:t.tensor.variable(false)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}ww.className="Momentum",Fp(ww);class xw extends Gp{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,null==r&&(this.epsilon=xd.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(t=>t.name):Object.keys(t)).forEach((e,n)=>{const r=xd.registeredVariables[e],a=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:"".concat(e,"/rms"),variable:zp(()=>ug(r).variable(a))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:"".concat(e,"/momentum"),variable:zp(()=>ug(r).variable(a))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:"".concat(e,"/mg"),variable:zp(()=>ug(r).variable(a))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const o=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;zp(()=>{const t=Xp(Sm(o,this.decay),Sm(Ng(i),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,a=Xp(Sm(e,this.decay),Sm(i,1-this.decay)),c=sg(Sm(i,this.learningRate),Eg(ny(t,Xp(Ng(a),this.epsilon)))),l=Xp(Sm(s,this.momentum),c);o.assign(t),e.assign(a),s.assign(l);const u=ny(r,l);r.assign(u)}else{const t=Xp(Sm(o,this.decay),Sm(Ng(i),1-this.decay)),e=Xp(Sm(s,this.momentum),sg(Sm(i,this.learningRate),Eg(Xp(t,this.epsilon))));o.assign(t),s.assign(e);const n=ny(r,e);r.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&Bp(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&Bp(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&Bp(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedMoments=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}xw.className="RMSProp",Fp(xw);class kw{static sgd(t){return new bw(t)}static momentum(t,e){return new ww(t,e,arguments.length>2&&void 0!==arguments[2]&&arguments[2])}static rmsprop(t){return new xw(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]&&arguments[4])}static adam(){return new yw(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null)}static adadelta(){return new mw(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}static adamax(){return new vw(arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0)}static adagrad(t){return new gw(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1)}}const _w={sgd:kw.sgd,momentum:kw.momentum,adadelta:kw.adadelta,adagrad:kw.adagrad,rmsprop:kw.rmsprop,adamax:kw.adamax,adam:kw.adam},Sw="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:t=>t();function Tw(){return new Promise(t=>Sw(()=>t()))}function Iw(t,e){const n=t[0].length;t.forEach((t,e)=>{ks(t.length===n,()=>"Error in concat".concat(n,"D: rank of tensors[").concat(e,"] must be the same ")+"as the rank of the rest (".concat(n,")"))}),ks(e>=0&&e<n,()=>"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,"."));const r=t[0];t.forEach((t,a)=>{for(let i=0;i<n;i++)ks(i===e||t[i]===r[i],()=>"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(t,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,"."))})}function Ew(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}var Nw;function Cw(t,e,n){let r=new Array;if(null==n&&null==e)return r;if(null==e)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(null==n)return r;if(t+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.rank = ").concat(t+n.length,", but shape.rank = ").concat(r.length));for(let a=1;a<n.length;++a){const i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error("rt input.shape and shape=".concat(e," are incompatible: rt input.shape[").concat(a+t,"] = ").concat(i," but shape[").concat(a+t,"] = ").concat(s))}else r[o]=i}return r}function Aw(t){const e={FIRST_DIM_SIZE:Nw.FIRST_DIM_SIZE,VALUE_ROWIDS:Nw.VALUE_ROWIDS,ROW_LENGTHS:Nw.ROW_LENGTHS,ROW_SPLITS:Nw.ROW_SPLITS,ROW_LIMITS:Nw.ROW_LIMITS,ROW_STARTS:Nw.ROW_STARTS},n=[];for(const r of t){if(!(r in e))break;n.push(e[r])}return n}function Rw(t){return 0===t.length?0:t[0]===Nw.FIRST_DIM_SIZE?t.length-1:t.length}function Ow(t,e){if(null==t||null==e)return;const n=t.length,r=e.length;if(n>=r)throw new Error("defaultValue.shape=".concat(t," and ragged tensor flatValues.shape=").concat(e,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(let a=0;a<Math.min(n,r-1);++a){const n=t[a],r=e[a+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error("defaultValue.shape=".concat(t,", and ragged tensor input flatValues.shape=").concat(e," are incompatible: defaultValue.shape[").concat(a-t.length,"] = ").concat(n," but ragged tensor input.flatValues.shape[").concat(a-t.length,"] = ").concat(r))}}!function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"}(Nw||(Nw={}));const Dw=30;function Mw(t){return t<=Dw?t:Gs(t,Math.floor(Math.sqrt(t)))}function Fw(t,e,n){return[n*("number"===typeof t?t:t[0]),e*("number"===typeof t?t:t[1])]}function Pw(t,e,n){let r=[];if(!(arguments.length>3&&void 0!==arguments[3])||arguments[3])r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const n=e.length;for(let a=0;a<n;++a)r=r.concat([t[a+1]/e[a],e[a]]);r=r.concat(t.slice(n+1))}return r}function Lw(t,e){const n=[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]){n.push(e);for(let r=e+1;r<t;++r)r<=2*e?(n.push(r),n.push(r-(e+1))):n.push(r)}else{const r=[],a=[];for(let n=1;n<t;++n)n>=2*e+1||n%2===1?a.push(n):r.push(n);n.push(...r),n.push(0),n.push(...a)}return n}function zw(t,e,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const a=[];r?a.push(t[0]/n):a.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?a.push(e[i-1]*t[i]):a.push(t[i]/e[i-1]):a.push(t[i]);return a}function Bw(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function jw(t,e,n){const r=t.slice(0,1);for(let a=0;a<n;++a)r.push(t[a+1]-e[a][0]-e[a][1]);return r}function Uw(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(e.shape[r-1]," vs. ").concat(n));if(0===Is(t.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(t.shape,"."));const a=e.shape,i=a[a.length-1];let o=1;for(let h=0;h<a.length-1;++h)o*=a[h];const s=t.shape,c=a.slice();c.pop();let l=1;for(let h=i;h<n;++h)l*=s[h],c.push(s[h]);const u=[...Hs(t.shape).map(t=>t/l),1].slice(0,i);return[c,o,l,u]}const Vw=1.7580993408473768,Ww=1.0507009873554805,Gw=.3275911,Hw=.254829592,qw=-.284496736,Kw=1.421413741,Xw=-1.453152027,Yw=1.061405429;function Qw(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(t.length,", imag: ").concat(e.length,"."));const n=new Float32Array(2*t.length);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Jw(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function $w(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function Zw(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function tx(t,e){return{real:t[2*e],imag:t[2*e+1]}}function ex(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function nx(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let a=0;a<Math.ceil(t/2);a++){const i=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function rx(t,e,n){const r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}const ax="->",ix=/->/g,ox=",",sx="...";function cx(t,e){const n=((t=t.replace(/\s/g,"")).length-t.replace(ix,"").length)/ax.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(ax,'").'));const[r,a]=t.split(ax);ks(-1===r.indexOf(sx),()=>'The ellipsis notation ("'.concat(sx,'") is not supported yet.'));const i=r.split(ox),o=i.length;if(e!==o)throw new Error("Expected ".concat(o," input tensors, received ").concat(e));if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let h=0;h<a.length;++h){const t=a[h];if(!i.some(e=>-1!==e.indexOf(t)))throw new Error("Output subscripts contain the label ".concat(t," ")+"not present in the input subscripts.");-1===s.indexOf(t)&&s.push(t)}for(let h=0;h<r.length;++h){const t=r[h];-1===s.indexOf(t)&&t!==ox&&s.push(t)}const c=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error("Found duplicate axes in input component ".concat(i[h],". ")+"Support for duplicate axes in input is not implemented yet.");c[h]=[];for(let t=0;t<i[h].length;++t)c[h].push(s.indexOf(i[h][t]))}const l=s.length,u=[];for(let h=a.length;h<l;++h)u.push(h);return{allDims:s,summedDims:u,idDims:c}}function lx(t,e){let n=new Array(t);n.fill(-1);for(let a=0;a<e.length;++a)n[e[a]]=a;const r=[];for(let a=0;a<t;++a)-1===n[a]&&r.push(a);return n=n.filter(t=>-1!==t),{permutationIndices:n,expandDims:r}}function ux(t,e,n){const r=new Array(t);for(let a=0;a<n.length;++a){const t=n[a].shape;for(let n=0;n<e[a].length;++n)void 0===r[e[a][n]]?r[e[a][n]]=t[n]:ks(r[e[a][n]]===t[n],()=>"Expected dimension ".concat(r[e[a][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(t),", ")+"but got dimension ".concat(t[n]))}}function hx(t,e){const n=t,r=[];let a=0;0===t.length&&n.push(-1),a=t.length+1;for(let o=0;o<a;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const t=fx(e,n[o]);for(const e of t)-1===i.indexOf(e)&&(r[o].push(e),i.push(e))}return{path:n,steps:r}}function dx(t){return t.every((t,e)=>t===e)}function fx(t,e){const n=[];for(let r=0;r<t.length;++r)0!==t[r].length&&-1===t[r].indexOf(e)&&-1!==e||n.push(r);return n}function px(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof e)ks(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const a=e.reduce((t,e)=>(-1===e&&(t+=1),t),0);ks(a<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(-1!==i){const r=e.reduce((t,e)=>e>0?t+e:t);e[i]=t.shape[n]-r}ks(t.shape[n]===e.reduce((t,e)=>t+e),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}function mx(t){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(t)}function gx(t,e){return"indices(".concat(t,", 0) is invalid: ").concat(e," < 0")}function yx(t,e,n){return"indices(".concat(t,", 0) is invalid: ").concat(e," >= ").concat(n)}function vx(t,e){return"only one output dimension may be -1, not both ".concat(t," and ").concat(e)}function bx(t,e){return"size ".concat(t," must be non-negative, not ").concat(e)}function wx(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function xx(t,e){const n=Is(t),r=Is(e);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(t," outputShape= ").concat(e)}function kx(t,e){const n=Is(t),r=Is(e);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(t," outputShape=").concat(e)}function _x(){return"segment ids must be >= 0"}function Sx(){return"segment ids are not increasing"}function Tx(t,e){return"Segment id ".concat(t," out of range [0, ").concat(e,"), possibly because segmentIds input is not sorted.")}function Ix(t,e,n){return"Bad: indices[".concat(t,"] == ").concat(e," out of range [0, ").concat(n,")")}function Ex(t,e){let n,r=!1;for(t<=Dw?(n=t,r=!0):n=Gs(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=Gs(t,n+1);return n}function Nx(t,e,n){const r=[],a=t.length;for(let i=0;i<a;i++)i!==e?r.push(t[i]):r.push(n);return r}function Cx(t,e,n,r){const a=e.shape.length,i=t.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(let h=0;h<r;++h)if(t.shape[h]!==e.shape[h])throw new Error("x.shape[".concat(h,"]: ").concat(t.shape[h]," should be equal to indices.shape[").concat(h,"]: ").concat(e.shape[h],"."));const o=t.shape[n],s=[];let c=1,l=1,u=1;for(let h=0;h<r;++h)s.push(t.shape[h]),c*=t.shape[h];for(let h=r;h<n;h++)s.push(t.shape[h]),l*=t.shape[h];for(let h=r;h<a;h++)s.push(e.shape[h]);for(let h=n+1;h<i;h++)s.push(t.shape[h]),u*=t.shape[h];return{batchSize:c,sliceSize:u,outerSize:l,dimSize:o,outputShape:s}}function Ax(t){try{return t.map(t=>Wh(t))}catch(Hrt){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(Hrt))}}function Rx(t){return t.map(t=>Vh(t))}const Ox={kernelName:lc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(t,Ev(zf(n,"float32"),-1))}}},Dx={kernelName:uc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Ng(zf(n,"float32")),r=Eg(ny(Wp(1),e));return Zg(sg(t,r))}}}},Mx={kernelName:hc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Eg(ny(Ng(zf(n,"float32")),1));return sg(t,e)}}}},Fx={kernelName:dc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=lp(n.shape,r.shape);return{a:()=>{let e=t;const r=cp(n.shape,a);return r.length>0&&(e=Cg(e,r)),bm(e,n.shape)},b:()=>{let e=t;const n=cp(r.shape,a);return n.length>0&&(e=Cg(e,n)),bm(e,r.shape)}}}},Px={kernelName:fc,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((e,r)=>{n[r]=()=>t.clone()}),n}},Lx={kernelName:gc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ug(n)}}},zx={kernelName:yc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ug(n)}}},Bx={kernelName:vc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>sg(t,Eg(ny(Wp(1),Ng(zf(n,"float32")))))}}},jx={kernelName:bc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Eg(Xp(Wp(1),Ng(zf(n,"float32"))));return sg(t,e)}}}},Ux={kernelName:kc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=lp(n.shape,r.shape);return{a:()=>{const e=Xp(Ng(n),Ng(r));let i=Sm(t,sg(r,e));const o=cp(n.shape,a);return o.length>0&&(i=Cg(i,o)),bm(i,n.shape)},b:()=>{const e=Xp(Ng(n),Ng(r));let i=Zg(Sm(t,sg(n,e)));const o=cp(r.shape,a);return o.length>0&&(i=Cg(i,o)),bm(i,r.shape)}}}},Vx={kernelName:wc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>sg(t,Xp(Ng(zf(n,"float32")),1))}}},Wx={kernelName:xc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>sg(t,ny(Wp(1),Ng(zf(n,"float32"))))}}};const Gx=Dd({avgPool3dGrad_:function(t,e,n,r,a,i){const o=Ad(t,"dy","avgPool3dGrad"),s=Ad(e,"input","avgPool3dGrad");let c=o,l=s,u=!1;4===s.rank&&(u=!0,c=bm(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),l=bm(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),ks(5===c.rank,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(c.rank,".")),ks(5===l.rank,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(l.rank,".")),vm("avgPool3dGrad",a,i);const h={dy:c,input:l},d={filterSize:n,strides:r,pad:a,dimRoundingMode:i},f=xd.runKernel(Ic,h,d);return u?bm(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),Hx={kernelName:Tc,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:s}=n;return{x:()=>Gx(t,r,a,i,o,s)}}};const qx=Dd({avgPoolGrad_:function(t,e,n,r,a){const i=Ad(t,"dy","avgPoolGrad"),o=Ad(e,"input","avgPoolGrad");ks(o.rank===i.rank,()=>"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")"));let s=o,c=i,l=!1;3===o.rank&&(l=!0,s=bm(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=bm(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ks(4===c.rank,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(c.rank,".")),ks(4===s.rank,()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,"."));const u={dy:c,input:s},h={filterSize:n,strides:r,pad:a},d=xd.runKernel(Sc,u,h);return l?bm(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Kx={kernelName:_c,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:a,strides:i,pad:o}=n;return{x:()=>qx(t,r,a,i,o)}}},Xx={kernelName:Ec,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,a]=e,{transposeA:i,transposeB:o}=n;return i||o?!i&&o?{a:()=>_m(t,a,!1,!1),b:()=>_m(t,r,!0,!1)}:i&&!o?{a:()=>_m(a,t,!1,!0),b:()=>_m(r,t,!1,!1)}:{a:()=>_m(a,t,!0,!0),b:()=>_m(t,r,!0,!0)}:{a:()=>_m(t,a,!1,!0),b:()=>_m(r,t,!0,!1)}}},Yx={kernelName:Nc,gradFunc:(t,e,n)=>{const{blockShape:r,crops:a}=n;return{x:()=>Fy(t,r,a)}}},Qx={kernelName:"BroadcastTo",gradFunc:(t,e,n)=>{const r=n,a=r.inputShape,i=r.shape,o=Array.from(i);for(let c=a.length-1;c>=0;c--)if(a[c]===i[c])o[c]=1;else if(1!==a[c])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));const s=[];for(let c=0;c<o.length;c++)o[c]>1&&s.push(c);return{x:()=>Cg(t,s,!0)}}},Jx={kernelName:Rc,gradFunc:t=>({x:()=>t.clone()})},$x={kernelName:Oc,gradFunc:t=>({x:()=>ug(t)})},Zx={kernelName:Dc,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:a,clipValueMax:i}=n;return{x:()=>lg(iy(Ug(r,a),Xg(r,i)),t,ug(t))}}},tk={kernelName:Fc,inputsToSave:["x"],gradFunc:Ox.gradFunc},ek={kernelName:Pc,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(t=>t.shape),{axis:a}=n,i=Ds(a,e[0].shape)[0],o=r.map(t=>t[i]);return kv(t,o,i).map(t=>()=>t)}},nk={kernelName:Lc,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,a]=e,{dilations:i,strides:o,pad:s,dataFormat:c}=n;return ks(mm(i),()=>"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(i,"'")),{x:()=>qm(r.shape,t,a,o,s,c),filter:()=>rb(r,t,a.shape,o,s,c)}}},rk={kernelName:Bc,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,a]=e,{strides:i,pad:o,dataFormat:s,dimRoundingMode:c}=n;return{dy:()=>Gm(t,a,i,o,s,1,c),filter:()=>rb(t,r,a.shape,i,o,s,c)}}};const ak=Dd({conv3DBackpropFilter_:function(t,e,n,r,a){let i=t;4===t.rank&&(i=bm(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;4===o.rank&&(o=bm(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),ks(5===i.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")),ks(5===o.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")),ks(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")),ks(i.shape[4]===n[3],()=>"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")),ks(o.shape[4]===n[4],()=>"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],")."));const s={x:i,dy:o},c={strides:r,pad:a,filterShape:n};return xd.runKernel(Uc,s,c)}}),ik={kernelName:jc,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:a,pad:i}=n;ks(mm(r),()=>"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'"));const[o,s]=e;return{x:()=>Ym(o.shape,t,s,a,i),filter:()=>ak(o,t,s.shape,a,i)}}},ok={kernelName:Wc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(Zg(dv(zf(n,"float32"))),t)}}},sk={kernelName:Gc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(fv(zf(n,"float32")),t)}}},ck={kernelName:qc,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:a,exclusive:i,reverse:o}=n;return{x:()=>{const e=xg([a],r.rank);let n=tg(t,a,i,!o);return null!=e&&(n=Hv(n,e)),n}}}},lk={kernelName:Qc,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:a,pad:i,dimRoundingMode:o}=n,s=null==r?[1,1]:r;ks(mm(s),()=>"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'"));const[c,l]=e;return ks(4===c.rank,()=>"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,".")),ks(4===l.rank,()=>"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(l.rank,".")),ks(c.shape[3]===l.shape[2],()=>"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(l.shape[2],".")),ks(gm(a,s),()=>"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(s,"'.")),vm("depthwiseConv2d",i,o),{x:()=>ub(c.shape,t,l,a,i,s,o),filter:()=>lb(c,t,l.shape,a,i,s,o)}}},uk={kernelName:tl,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,a]=e,i={x:r,filter:a,dy:t},o={x:r,filter:a,dy:t};return{x:()=>xd.runKernel(el,i,n),filter:()=>xd.runKernel(nl,o,n)}}},hk={kernelName:il,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>xd.runKernel(ol,r)}}},dk={kernelName:sl,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=Sm(Dg(Zg(Ng(n))),2/Math.sqrt(Math.PI));return{x:()=>Sm(t,r)}}},fk={kernelName:ll,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(t,n)}}},pk={kernelName:ul,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>bm(t,n.shape)}}},mk={kernelName:hl,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(t,Dg(n))}}},gk={kernelName:ml,gradFunc:t=>({x:()=>ug(t)})},yk={kernelName:gl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=lp(n.shape,r.shape);return{a:()=>{const e=sg(t,zf(r,"float32")),i=cp(n.shape,a);return i.length>0?bm(Cg(e,i),n.shape):e},b:()=>{let e=Sm(t,zf(n,"float32"));const i=cp(r.shape,a);i.length>0&&(e=bm(Cg(e,i),r.shape));const o=Ng(r);return Zg(sg(e,zf(o,"float32")))}}}},vk={kernelName:yl,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[a,i,o,s]=e,c=null==s?Wp(1):s,l=cp(i.shape,a.shape),u=[];if(1===i.rank){for(let t=0;t<a.shape.length-1;++t)u.push(a.shape[t]);u.push(1)}const h=ny(a,i),d=Sm(t,c),f=sv(Xp(o,Wp(r))),p=Sm(Sm(Sm(f,f),f),Wp(-.5));return{x:()=>1===i.rank?bm(Sm(Sm(t,Pg(bm(f,[1,1,1,i.shape[0]]),u)),c),a.shape):bm(Sm(Sm(t,f),c),a.shape),mean:()=>{let t=Sm(Sm(f,Wp(-1)),d);return 1===i.rank&&(t=Cg(t,l)),bm(t,i.shape)},variance:()=>{let t=Sm(Sm(p,h),d);return 1===i.rank&&(t=Cg(t,l)),bm(t,i.shape)},scale:()=>{const e=Sm(h,f);let n=Sm(t,e);return 1===i.rank&&(n=Cg(n,l)),bm(n,i.shape)},offset:()=>{let e=t;return 1===i.rank&&(e=Cg(e,l)),bm(e,i.shape)}}}},bk={kernelName:vl,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,a]=e,{axis:i}=n,o=Ds(i,r.shape)[0];return{x:()=>{const e=r.shape,n=a.size,s=e.slice(0,o),c=s.length,l=e.slice(i,e.length).slice(1),u=l.length,h=wk(0,c),d=wk(c+1,c+1+u),f=xk([s,[n],l]),p=bm(t,f),m=bm(a,[n]),g=xk([[c],h,d]),y=Hv(p,g);let v=zv(y,m,r.shape[o]);const b=kg(g);return v=Hv(v,b),v},indices:()=>a}}};function wk(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function xk(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}const kk={kernelName:xl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>ug(n),b:()=>ug(r)}}},_k={kernelName:kl,gradFunc:t=>({x:()=>zf(t,"float32")})},Sk={kernelName:Tl,gradFunc:t=>({x:()=>ug(t)})},Tk={kernelName:Il,gradFunc:t=>({x:()=>ug(t)})},Ik={kernelName:El,gradFunc:t=>({x:()=>ug(t)})},Ek={kernelName:Nl,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:a}=n,i=jg(r,0);return{x:()=>lg(i,t,Sm(t,a))}}},Nk={kernelName:Dl,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>sg(t,Xp(n,1))}}},Ck={kernelName:Ol,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>sg(t,zf(n,"float32"))}}},Ak={kernelName:"LogSoftmax",inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:a}=n;return{logits:()=>{const e=Dg(r);return ny(t,Sm(Cg(t,a,!0),e))}}}};const Rk=Dd({localResponseNormalizationBackprop_:function(t,e,n){const r={x:t,y:e,dy:n},a={depthRadius:arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,bias:arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,alpha:arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,beta:arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5};return xd.runKernel(zl,r,a)}}),Ok={kernelName:Ll,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{depthRadius:i,bias:o,alpha:s,beta:c}=n;return{x:()=>Rk(r,a,t,i,o,s,c)}}};function Dk(t,e,n,r){return e.rank<n.rank&&(e=bm(e,bg(e.shape,r))),t.rank<n.rank&&(t=bm(t,bg(t.shape,r))),{x:()=>Sm(t,zf(cg(n,e),t.dtype))}}const Mk={kernelName:Bl,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:a}=r,i=e[0],o=Dk(t,e[1],i,Ds(a,i.shape));return{x:()=>o.x()}}},Fk={kernelName:jl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Sm(t,zf(Ug(n,r),"float32")),b:()=>Sm(t,zf(Kg(n,r),"float32"))}}};const Pk=Dd({maxPool3dGrad_:function(t,e,n,r,a,i,o){const s=Ad(t,"dy","maxPool3dGrad"),c=Ad(e,"input","maxPool3dGrad"),l=Ad(n,"output","maxPool3dGrad");let u=s,h=c,d=l,f=!1;4===c.rank&&(f=!0,u=bm(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),h=bm(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),d=bm(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),ks(5===u.rank,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(u.rank,".")),ks(5===h.rank,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(h.rank,".")),ks(5===d.rank,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(d.rank,".")),vm("maxPool3dGrad",i,o);const p={dy:u,input:h,output:d},m={filterSize:r,strides:a,pad:i,dimRoundingMode:o},g=xd.runKernel(Gl,p,m);return f?bm(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),Lk={kernelName:Wl,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:c}=n;return{x:()=>Pk(t,r,a,i,o,s,c)}}};const zk=Dd({maxPoolGrad_:function(t,e,n,r,a,i,o){const s=Ad(t,"dy","maxPoolGrad"),c=Ad(e,"input","maxPoolGrad"),l=Ad(n,"output","maxPoolGrad");ks(c.rank===s.rank,()=>"Rank of input (".concat(c.rank,") does not match rank of dy ")+"(".concat(s.rank,")")),ks(4===s.rank,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")),ks(4===c.rank,()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(c.rank,".")),vm("maxPoolGrad",i,o);const u={dy:s,input:c,output:l},h={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return xd.runKernel(Vl,u,h)}}),Bk={kernelName:Ul,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{filterSize:i,strides:o,pad:s}=n;return{x:()=>zk(t,r,a,i,o,s)}}},jk={kernelName:ql,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:a}=n,i=Ds(a,r.shape),o=Is(vg(r.shape,i)[1]);return{x:()=>{const e=r.shape.slice();i.forEach(t=>{e[t]=1});const n=bm(t,e);return sg(Sm(n,vy(r.shape,"float32")),o)}}}},Uk={kernelName:Kl,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:a}=r,[i,o]=e,s=Dk(t,o,i,Ds(a,i.shape));return{x:()=>s.x()}}},Vk={kernelName:Yl,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:a}=n,i=a.map(t=>t[0]);return{x:()=>Im(t,i,r.shape)}}},Wk={kernelName:Ql,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=lp(n.shape,r.shape);return{a:()=>{const e=cp(n.shape,a);return e.length>0?bm(Cg(t,e),n.shape):t},b:()=>{const e=Sm(t,Zg(zg(sg(n,r)))),i=cp(r.shape,a);return i.length>0?bm(Cg(e,i),r.shape):e}}}},Gk={kernelName:$l,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=lp(n.shape,r.shape);return{a:()=>{const e=Sm(t,zf(r,"float32")),i=cp(n.shape,a);return i.length>0?bm(Cg(e,i),n.shape):e},b:()=>{const e=Sm(t,zf(n,"float32")),i=cp(r.shape,a);return i.length>0?bm(Cg(e,i),r.shape):e}}}},Hk={kernelName:ou,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return Bv(t,r).map(t=>()=>t)}},qk={kernelName:su,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:a}=n,i=a.map(t=>t[0]);return{x:()=>Im(t,i,r.shape)}}},Kk={kernelName:cu,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,a]=e,i=n,o=r,s=lp(i.shape,o.shape);return{a:()=>{const e=zf(o,"float32");let n=Sm(t,Sm(e,Ig(i,ny(e,Wp(1)))));const r=cp(i.shape,s);return r.length>0&&(n=Cg(n,r)),bm(n,i.shape)},b:()=>{const e=jg(i,0),n=lg(e,Jg(i),ug(i));let r=Sm(t,Sm(a,n));const c=cp(o.shape,s);return c.length>0&&(r=Cg(r,c)),bm(r,o.shape)}}}},Xk={kernelName:lu,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,a=jg(n,0);return{x:()=>lg(a,t,Sm(t,r)),alpha:()=>{let e=lg(a,ug(t),Sm(t,n));const i=cp(r.shape,t.shape);return i.length>0&&(e=Cg(e,i)),bm(e,r.shape)}}}};function Yk(t,e,n){const r=t.shape.length,a=r-n.length,i=xg(n,r);let o=t;null!=i&&(o=Hv(t,i));const s=o.shape.slice(),c=s.splice(r-n.length,n.length).reduce((t,e)=>t*e,1);s.push(c);let l=function(t,e,n){const r=t.shape.slice();r[n]=1;const a=bm(e,r),i=Zm(t,n,!0,!1),o=Zm(t,n,!0,!0),s=Sm(i,o);return Sm(a,s)}(o.reshape(s),e,a);if(l=l.reshape(o.shape),null!=i){const t=kg(i);l=Hv(l,t)}return l}const Qk={kernelName:uu,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:a}=n;let i=[];return i=void 0===a||null===a?r.shape.map((t,e)=>e):"number"===typeof a?[a]:a,{x:()=>Yk(r,t,i)}}},Jk={kernelName:rl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=lp(n.shape,r.shape);return{a:()=>{const e=sg(t,zf(r,"float32")),i=cp(n.shape,a);return i.length>0?bm(Cg(e,i),n.shape):e},b:()=>{let e=Sm(t,zf(n,"float32"));const i=cp(r.shape,a);i.length>0&&(e=bm(Cg(e,i),r.shape));const o=Ng(r);return Zg(sg(e,zf(o,"float32")))}}}},$k={kernelName:mu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>sg(t,Zg(Ng(n)))}}},Zk={kernelName:ku,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=Sm(Xg(n,6),Ev(n));return{x:()=>Sm(t,zf(r,"float32"))}}},t_={kernelName:gu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(t,zf(Ev(n),"float32"))}}},e_={kernelName:yu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>bm(t,n.shape)}}},n_={kernelName:Tu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Zg(sg(t,Sm(Ig(n,1.5),2)))}}},r_={kernelName:Cu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=jg(n,Wp(0)),r=Wp(Vw),a=Wp(Ww),i=Sm(t,a),o=Sm(Sm(t,r),Dg(zf(n,"float32")));return lg(e,i,o)}}}},a_={kernelName:Ru,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(Jm(zf(n,"float32")),t)}}},i_={kernelName:Ou,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm($m(zf(n,"float32")),t)}}},o_={kernelName:Au,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:a,size:i}=n,o=r.shape,[s,c]=Ap(r,a,i),l=[];for(let u=0;u<t.rank;u++)l.push([s[u],o[u]-s[u]-c[u]]);return{x:()=>Ay(t,l)}}},s_={kernelName:Fu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(t,Tm(n))}}},c_={kernelName:zu,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:a}=n;return{x:()=>Cm(t,r,a)}}},l_={kernelName:Bu,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>km(t,r)}}},u_={kernelName:Pu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>sg(t,Sm(Eg(zf(n,"float32")),2))}}},h_={kernelName:Ku,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(t,Sm(zf(n,"float32"),2))}}},d_={kernelName:$u,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=lp(n.shape,r.shape);return{a:()=>{let e=t;const r=cp(n.shape,a);return r.length>0&&(e=Cg(e,r)),bm(e,n.shape)},b:()=>{let e=t;const n=cp(r.shape,a);return n.length>0&&(e=Cg(e,n)),bm(Zg(e),r.shape)}}}},f_={kernelName:Lu,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,a=r.shape.slice(),{axis:i}=n;Ds(i,r.shape).forEach(t=>{a[t]=1});const o=bm(t,a),s=Sm(o,vy(r.shape,"float32"));return{x:()=>s}}},p_={kernelName:Zu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>sg(t,Ng(Jm(n)))}}},m_={kernelName:eh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:a}=n;return{x:()=>{let e=ug(r);if(1===r.rank)for(let n=0;n<a[0];++n)e=Xp(e,Im(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)e=Xp(e,Im(t,[n*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let o=0;o<a[2];++o)e=Xp(e,Im(t,[n*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let o=0;o<a[2];++o)for(let s=0;s<a[3];++s)e=Xp(e,Im(t,[n*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},g_={kernelName:sh,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>function(t,e){const n=my(e,ug(e)),r=Bg(t,n);let a=Ug(e,Wp(0,"int32"));const i=r.rank-a.rank;for(let s=0;s<i;++s)a=Mg(a,s+1);a=iy(a,vy(r.shape,"bool"));const o=ug(r);return lg(a,r,o)}(t,n)}}};const y_=[Ox,Dx,Mx,Fx,Px,Lx,zx,Bx,jx,Ux,Vx,Wx,Hx,Kx,Xx,Yx,Qx,Jx,$x,Zx,tk,ek,rk,nk,ik,ok,sk,ck,lk,uk,Jk,hk,dk,fk,pk,mk,yk,gk,vk,bk,kk,_k,Sk,Tk,Ik,Ek,Nk,Ck,Ak,Ok,Mk,Mk,Fk,Lk,Bk,jk,Uk,{kernelName:Xl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Sm(t,zf(Xg(n,r),"float32")),b:()=>Sm(t,zf(jg(n,r),"float32"))}}},Vk,Wk,Gk,{kernelName:Zl,gradFunc:t=>({x:()=>Zg(t)})},{kernelName:iu,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>yy(n.shape,"float32")}}},{kernelName:au,gradFunc:t=>({x:()=>ug(t)})},Hk,qk,qk,Kk,Xk,Qk,$k,Zk,t_,e_,{kernelName:wu,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,a={dy:t,images:r};return{images:()=>xd.runKernel(xu,a,n)}}},{kernelName:vu,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,a={dy:t,images:r};return{images:()=>xd.runKernel(bu,a,n)}}},{kernelName:_u,gradFunc:(t,e,n)=>{const{dims:r}=n,a=Ds(r,t.shape);return{x:()=>ev(t,a)}}},{kernelName:Su,gradFunc:t=>({x:()=>ug(t)})},n_,{kernelName:Nu,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>zf(ug(n),"float32"),t:()=>Sm(t,zf(n,t.dtype)),e:()=>Sm(t,zf(oy(n),t.dtype))}}},r_,{kernelName:Mu,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(t,Sm(n,ny(Wp(1),n)))}}},{kernelName:Du,gradFunc:t=>({x:()=>ug(t)})},a_,i_,o_,{kernelName:ju,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:a}=n,i=Sm(t,r);return{logits:()=>ny(i,Sm(Cg(i,[a],true),r))}}},s_,c_,c_,l_,l_,u_,{kernelName:qu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Wp(2);return{a:()=>Sm(t,Sm(a,ny(n,r))),b:()=>Sm(t,Sm(a,ny(r,n)))}}},h_,{kernelName:lh,gradFunc:t=>({x:()=>ug(t)})},d_,f_,p_,{kernelName:th,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sm(ny(Wp(1),Ng(n)),t)}}},m_,{kernelName:ah,gradFunc:(t,e,n)=>{const r=n,{perm:a}=r,i=kg(a);return{x:()=>Hv(t,i)}}},{kernelName:oh,gradFunc:(t,e,n)=>{const r=n,{axis:a}=r;return{value:()=>Iv(t,a)}}},g_,{kernelName:ch,gradFunc:t=>({x:()=>ug(t)})}];for(const n of y_)_h(n);rd().prototype.abs=function(){return this.throwIfDisposed(),Hp(this)},rd().prototype.acos=function(){return this.throwIfDisposed(),qp(this)},rd().prototype.acosh=function(){return this.throwIfDisposed(),Kp(this)},rd().prototype.add=function(t){return this.throwIfDisposed(),Xp(this,t)},rd().prototype.all=function(t,e){return this.throwIfDisposed(),Qp(this,t,e)},rd().prototype.any=function(t,e){return this.throwIfDisposed(),Jp(this,t,e)},rd().prototype.argMax=function(t){return this.throwIfDisposed(),$p(this,t)},rd().prototype.argMin=function(t){return this.throwIfDisposed(),Zp(this,t)},rd().prototype.asScalar=function(){return this.throwIfDisposed(),ks(1===this.size,()=>"The array must have only 1 element."),bm(this,[])},rd().prototype.asType=function(t){return this.throwIfDisposed(),zf(this,t)},rd().prototype.as1D=function(){return this.throwIfDisposed(),bm(this,[this.size])},rd().prototype.as2D=function(t,e){return this.throwIfDisposed(),bm(this,[t,e])},rd().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),bm(this,[t,e,n])},rd().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),bm(this,[t,e,n,r])},rd().prototype.as5D=function(t,e,n,r,a){return this.throwIfDisposed(),bm(this,[t,e,n,r,a])},rd().prototype.asin=function(){return this.throwIfDisposed(),tm(this)},rd().prototype.asinh=function(){return this.throwIfDisposed(),em(this)},rd().prototype.atan=function(){return this.throwIfDisposed(),nm(this)},rd().prototype.atan2=function(t){return this.throwIfDisposed(),rm(this,t)},rd().prototype.atanh=function(){return this.throwIfDisposed(),am(this)},rd().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),wm(this,t,e,n,r)},rd().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Cm(this,t,e)},rd().prototype.batchNorm=function(t,e,n,r,a){return this.throwIfDisposed(),Am(this,t,e,n,r,a)},rd().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Pm(this,t)},rd().prototype.cast=function(t){return this.throwIfDisposed(),zf(this,t)},rd().prototype.ceil=function(){return this.throwIfDisposed(),Lm(this)},rd().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Bm(this,t,e)},rd().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof nd&&(t=[t]),km([this,...t],e)},rd().prototype.conv1d=function(t,e,n,r,a,i){return this.throwIfDisposed(),Hm(this,t,e,n,r,a,i)},rd().prototype.conv2dTranspose=function(t,e,n,r,a){return this.throwIfDisposed(),Km(this,t,e,n,r,a)},rd().prototype.conv2d=function(t,e,n,r,a,i){return this.throwIfDisposed(),Gm(this,t,e,n,r,a,i)},rd().prototype.cos=function(){return this.throwIfDisposed(),Jm(this)},rd().prototype.cosh=function(){return this.throwIfDisposed(),$m(this)},rd().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Zm(this,t,e,n)},rd().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),tg(this,t,e,n)},rd().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),ng(this,t,e)},rd().prototype.depthwiseConv2d=function(t,e,n,r,a,i){return this.throwIfDisposed(),rg(this,t,e,n,r,a,i)},rd().prototype.dilation2d=function(t,e,n,r,a){return this.throwIfDisposed(),ig(this,t,e,n,r,a)},rd().prototype.divNoNan=function(t){return this.throwIfDisposed(),hg(this,t)},rd().prototype.div=function(t){return this.throwIfDisposed(),sg(this,t)},rd().prototype.dot=function(t){return this.throwIfDisposed(),dg(this,t)},rd().prototype.elu=function(){return this.throwIfDisposed(),pg(this)},rd().prototype.equal=function(t){return this.throwIfDisposed(),cg(this,t)},rd().prototype.erf=function(){return this.throwIfDisposed(),mg(this)},rd().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),Og(this,t,e)},rd().prototype.exp=function(){return this.throwIfDisposed(),Dg(this)},rd().prototype.expandDims=function(t){return this.throwIfDisposed(),Mg(this,t)},rd().prototype.expm1=function(){return this.throwIfDisposed(),Fg(this)},rd().prototype.fft=function(){return this.throwIfDisposed(),bv(this)},rd().prototype.flatten=function(){return this.throwIfDisposed(),bm(this,[this.size])},rd().prototype.floor=function(){return this.throwIfDisposed(),zg(this)},rd().prototype.floorDiv=function(t){return this.throwIfDisposed(),og(this,t)},rd().prototype.gather=function(t,e){return this.throwIfDisposed(),Bg(this,t,e)},rd().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Ug(this,t)},rd().prototype.greater=function(t){return this.throwIfDisposed(),jg(this,t)},rd().prototype.ifft=function(){return this.throwIfDisposed(),wv(this)},rd().prototype.irfft=function(){return this.throwIfDisposed(),xv(this)},rd().prototype.isFinite=function(){return this.throwIfDisposed(),Wg(this)},rd().prototype.isInf=function(){return this.throwIfDisposed(),Gg(this)},rd().prototype.isNaN=function(){return this.throwIfDisposed(),Hg(this)},rd().prototype.leakyRelu=function(t){return this.throwIfDisposed(),qg(this,t)},rd().prototype.lessEqual=function(t){return this.throwIfDisposed(),Xg(this,t)},rd().prototype.less=function(t){return this.throwIfDisposed(),Kg(this,t)},rd().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),Qg(this,t,e,n,r)},rd().prototype.logSigmoid=function(){return this.throwIfDisposed(),ey(this)},rd().prototype.logSoftmax=function(t){return this.throwIfDisposed(),ry(this,t)},rd().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),ay(this,t,e)},rd().prototype.log=function(){return this.throwIfDisposed(),Jg(this)},rd().prototype.log1p=function(){return this.throwIfDisposed(),$g(this)},rd().prototype.logicalAnd=function(t){return this.throwIfDisposed(),iy(this,t)},rd().prototype.logicalNot=function(){return this.throwIfDisposed(),oy(this)},rd().prototype.logicalOr=function(t){return this.throwIfDisposed(),sy(this,t)},rd().prototype.logicalXor=function(t){return this.throwIfDisposed(),cy(this,t)},rd().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),_m(this,t,e,n)},rd().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),dy(this,t,e,n,r)},rd().prototype.max=function(t,e){return this.throwIfDisposed(),Sg(this,t,e)},rd().prototype.maximum=function(t){return this.throwIfDisposed(),my(this,t)},rd().prototype.mean=function(t,e){return this.throwIfDisposed(),gy(this,t,e)},rd().prototype.min=function(t,e){return this.throwIfDisposed(),Tg(this,t,e)},rd().prototype.minimum=function(t){return this.throwIfDisposed(),wy(this,t)},rd().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),xy(this,t,e)},rd().prototype.mod=function(t){return this.throwIfDisposed(),ky(this,t)},rd().prototype.mul=function(t){return this.throwIfDisposed(),Sm(this,t)},rd().prototype.neg=function(){return this.throwIfDisposed(),Zg(this)},rd().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Rg(this,t,e,n)},rd().prototype.notEqual=function(t){return this.throwIfDisposed(),Iy(this,t)},rd().prototype.oneHot=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),Ey(this,t,e,n)},rd().prototype.onesLike=function(){return this.throwIfDisposed(),Ny(this)},rd().prototype.pad=function(t,e){return this.throwIfDisposed(),Ay(this,t,e)},rd().prototype.pool=function(t,e,n,r,a,i){return this.throwIfDisposed(),Py(this,t,e,n,r,a,i)},rd().prototype.pow=function(t){return this.throwIfDisposed(),Ig(this,t)},rd().prototype.prelu=function(t){return this.throwIfDisposed(),Ly(this,t)},rd().prototype.prod=function(t,e){return this.throwIfDisposed(),zy(this,t,e)},rd().prototype.reciprocal=function(){return this.throwIfDisposed(),$y(this)},rd().prototype.relu=function(){return this.throwIfDisposed(),Zy(this)},rd().prototype.relu6=function(){return this.throwIfDisposed(),tv(this)},rd().prototype.reshapeAs=function(t){return this.throwIfDisposed(),bm(this,t.shape)},rd().prototype.reshape=function(t){return this.throwIfDisposed(),bm(this,t)},rd().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),Lb(this,t,e,n)},rd().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),zb(this,t,e,n)},rd().prototype.reverse=function(t){return this.throwIfDisposed(),ev(this,t)},rd().prototype.rfft=function(){return this.throwIfDisposed(),_v(this)},rd().prototype.round=function(){return this.throwIfDisposed(),ov(this)},rd().prototype.rsqrt=function(){return this.throwIfDisposed(),sv(this)},rd().prototype.selu=function(){return this.throwIfDisposed(),cv(this)},rd().prototype.separableConv2d=function(t,e,n,r,a,i){return this.throwIfDisposed(),lv(this,t,e,n,r,a,i)},rd().prototype.sigmoid=function(){return this.throwIfDisposed(),Tm(this)},rd().prototype.sign=function(){return this.throwIfDisposed(),hv(this)},rd().prototype.sin=function(){return this.throwIfDisposed(),dv(this)},rd().prototype.sinh=function(){return this.throwIfDisposed(),fv(this)},rd().prototype.slice=function(t,e){return this.throwIfDisposed(),Im(this,t,e)},rd().prototype.softmax=function(t){return this.throwIfDisposed(),vv(this,t)},rd().prototype.softplus=function(){return this.throwIfDisposed(),ty(this)},rd().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Fy(this,t,e)},rd().prototype.split=function(t,e){return this.throwIfDisposed(),kv(this,t,e)},rd().prototype.sqrt=function(){return this.throwIfDisposed(),Eg(this)},rd().prototype.square=function(){return this.throwIfDisposed(),Ng(this)},rd().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Sv(this,t)},rd().prototype.squeeze=function(t){return this.throwIfDisposed(),Tv(this,t)},rd().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof nd?[this,t]:[this,...t];return Iv(n,e)},rd().prototype.step=function(t){return this.throwIfDisposed(),Ev(this,t)},rd().prototype.stridedSlice=function(t,e,n,r,a,i,o,s){return this.throwIfDisposed(),Nv(this,t,e,n,r,a,i,o,s)},rd().prototype.sub=function(t){return this.throwIfDisposed(),ny(this,t)},rd().prototype.sum=function(t,e){return this.throwIfDisposed(),Cg(this,t,e)},rd().prototype.tan=function(){return this.throwIfDisposed(),Cv(this)},rd().prototype.tanh=function(){return this.throwIfDisposed(),Em(this)},rd().prototype.tile=function(t){return this.throwIfDisposed(),Pg(this,t)},rd().prototype.toBool=function(){return this.throwIfDisposed(),zf(this,"bool")},rd().prototype.toFloat=function(){return this.throwIfDisposed(),zf(this,"float32")},rd().prototype.toInt=function(){return this.throwIfDisposed(),zf(this,"int32")},rd().prototype.topk=function(t,e){return this.throwIfDisposed(),Fv(this,t,e)},rd().prototype.transpose=function(t){return this.throwIfDisposed(),Hv(this,t)},rd().prototype.unique=function(t){return this.throwIfDisposed(),Lv(this,t)},rd().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),zv(this,t,e)},rd().prototype.unstack=function(t){return this.throwIfDisposed(),Bv(this,t)},rd().prototype.where=function(t,e){return this.throwIfDisposed(),lg(t,this,e)},rd().prototype.zerosLike=function(){return this.throwIfDisposed(),ug(this)};class v_ extends Error{constructor(t){super(t),Object.setPrototypeOf(this,v_.prototype)}}class b_ extends Error{constructor(t){super(t),Object.setPrototypeOf(this,b_.prototype)}}class w_ extends Error{constructor(t){super(t),Object.setPrototypeOf(this,w_.prototype)}}class x_ extends Error{constructor(t){super(t),Object.setPrototypeOf(this,x_.prototype)}}class k_ extends Error{constructor(t){super(t),Object.setPrototypeOf(this,k_.prototype)}}Error;class __{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e}put(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const t=this.cache.keys().next().value;this.cache.delete(t)}this.cache.set(t,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(t,"."));if(this.maxEntries>t)for(let e=0;e<this.maxEntries-t;e++){const t=this.cache.keys().next().value;this.cache.delete(t)}this.maxEntries=t}}function S_(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function T_(t,e){if(!t)throw new k_(e)}function I_(t,e){let n=0;for(const r of t)r===e&&n++;return n}function E_(t){return 1===t.length?t[0]:t}function N_(t){return Array.isArray(t)?t:[t]}function C_(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function A_(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}let R_={};function O_(t){if(null===t||void 0===t)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function D_(t){if(null!=t&&"object"===typeof t)if(Array.isArray(t))t.forEach(t=>D_(t));else{const e=Object.keys(t);for(const n of e){const e=t[n];null!=e&&"object"===typeof e&&(Array.isArray(e)||"ndarray"!==e.type||"number"!==typeof e.value?D_(e):t[n]=e.value)}}}function M_(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof t){const a=t;let i;if(a in n)i=n[a];else if(a in R_)i=R_[a];else if(i=e[a],null==i)throw new w_("Unknown ".concat(r,": ").concat(t,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}{const i=t;if(null==i.className||null==i.config)throw new w_("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(i),".\n")+"'className' and 'config' must set.");const o=i.className;let s,c;if(o in n?[s,c]=n[o]:o in R_?[s,c]=R_.className:o in e&&([s,c]=e[o]),null==s)throw new w_("Unknown ".concat(r,": ").concat(o,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=c){const t={};for(const n of Object.keys(R_))t[n]=R_[n];for(const a of Object.keys(n))t[a]=n[a];i.config.customObjects=t;const e=Object.assign({},R_);for(const a of Object.keys(n))R_[a]=n[a];D_(i.config);const r=c(s,i.config,n,a);return R_=Object.assign({},e),r}{const t=Object.assign({},R_);for(const r of Object.keys(n))R_[r]=n[r];const e=new s(i.config);return R_=Object.assign({},t),e}}}function F_(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function P_(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function L_(t){if(null==t)throw new w_("Invalid value in obj: ".concat(JSON.stringify(t)));for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function z_(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new w_("".concat(n," is not a valid ").concat(e,".  Valid values are ").concat(t," or null/undefined."))}function B_(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return T_(n>=0),T_(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(t=>typeof t===e)}function j_(t,e){Array.isArray(t)?(ks(t.length>0,()=>"".concat(e," is unexpectedly an empty array.")),t.forEach((t,n)=>j_(t,"element ".concat(n+1," of ").concat(e)))):ks(Number.isInteger(t)&&t>0,()=>"Expected ".concat(e," to be a positive integer, but got ")+"".concat(U_(t),"."))}function U_(t){return null===t?"null":Array.isArray(t)?"["+t.map(t=>U_(t)).join(",")+"]":"string"===typeof t?'"'.concat(t,'"'):"".concat(t)}function V_(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}let W_=0;function G_(){return W_++}const H_={};function q_(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t in H_||(H_[t]=0),H_[t]+=1,t+H_[t].toString()}const K_=["channelsFirst","channelsLast"],X_=["nearest","bilinear"],Y_=["valid","same","causal"],Q_=["max","avg"],J_=["sum","mul","concat","ave"],$_=new Map;function Z_(t){z_(K_,"DataFormat",t)}function tS(t){z_(Y_,"PaddingMode",t)}function eS(t){z_(Q_,"PoolMode",t)}const nS=[];function rS(t,e){nS.push(t);try{const t=e();return nS.pop(),t}catch(Grt){throw nS.pop(),Grt}}function aS(t){if(!sS(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===nS.length?"":nS.join("/")+"/")+t}function iS(t){if(!sS(t))throw new Error("Not a valid tensor name: '"+t+"'");$_.has(t)||$_.set(t,0);const e=$_.get(t);if($_.set(t,$_.get(t)+1),e>0){const n="".concat(t,"_").concat(e);return $_.set(n,1),n}return t}const oS=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function sS(t){return!!t.match(oS)}function cS(t){return t===parseInt(t.toString(),10)}function lS(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let r=1;for(let a=e;a<n;++a)r*=t[a];return r}function uS(t){if(0===t.length)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function hS(t){if(0===t.length)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function dS(t,e){if(e<t)throw new w_("end (".concat(e,") < begin (").concat(t,") is forbidden."));const n=[];for(let r=t;r<e;++r)n.push(r);return n}let fS;function pS(){return null==fS&&(fS=xd.backend.epsilon()),fS}function mS(t,e){return zf(t,e)}function gS(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),bm(t,n)}function yS(t,e,n){return zp(()=>{switch(t.rank){case 1:return pv(t,e,n);case 2:return mv(t,[e,0],[n,t.shape[1]]);case 3:return gv(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return yv(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Im(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Im(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new w_("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(t.rank))}})}function vS(t,e,n){return zp(()=>{switch(t.rank){case 1:return pv(t,e,n);case 2:return mv(t,[0,e],[t.shape[0],n]);case 3:return gv(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return yv(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new w_("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}})}function bS(t,e,n,r){return zp(()=>{switch(t.rank){case 1:return pv(t,e,n);case 2:switch(r){case 1:return yS(t,e,n);case 2:return vS(t,e,n);default:throw new w_("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return yS(t,e,n);case 2:return gv(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return vS(t,e,n);default:throw new w_("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return yS(t,e,n);case 2:return yv(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return yv(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return vS(t,e,n);default:throw new w_("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new w_("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(t.rank))}})}function wS(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(e=t[0].rank,n=0!==e?e:0),n===t[0].rank&&(n=-1),km(t,n)}function xS(t,e){switch(t.rank){case 1:return jm([t,e]);case 2:return Um([t,e],0);case 3:return Vm([t,e],0);case 4:return Wm([t,e],0);default:throw new w_("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(t.rank))}}function kS(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new w_("The length of input n (".concat(e.length,") does not match ")+"the number of dimensions in input x (".concat(t.rank,")"));return Pg(t,e)}function _S(t){return Ky(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0)}function SS(t,e,n,r){if(t.rank<2||e.rank<2)throw new x_("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(t.shape," and y shape = ").concat(e.shape));if(e.rank>=3){if(t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new x_("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(t.shape," and ")+" y shape = ".concat(e.shape))}if(2===t.rank&&2===e.rank){return db({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?ES(t.rank,r,"channelsLast"):null,activation:n})}{const a=t.shape.slice(),i=a.pop();t=bm(t,[-1,i]);const o=e.shape.slice(),s=o.pop(),c=o.pop(),l=[...o,s],u=Array.from({length:e.rank},(t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n);e=bm(Hv(e,u),[c,-1]);const h=[...a,...l];return bm(db({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?ES(t.rank,r,"channelsLast"):null,activation:n}),h)}}function TS(t,e,n){return zp(()=>(e=Array.isArray(e)?Av(e,"int32"):zf(e,"int32"),Bg(t,e,n)))}function IS(t){return Sm(t,t)}function ES(t,e,n){const r=e.shape;if(1!==e.rank&&e.rank!==t)throw new w_("Unexpected bias dimensions: ".concat(e.rank)+"; expected it to be 1 or ".concat(t));if(5===t){if("channelsFirst"===n)return 1===r.length?bm(e,[1,r[0],1,1,1]):bm(e,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?bm(e,[1,1,1,1,r[0]]):bm(e,[1].concat(r))}else if(4===t){if("channelsFirst"===n)return 1===r.length?bm(e,[1,r[0],1,1]):bm(e,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?bm(e,[1,1,1,r[0]]):bm(e,[1].concat(r))}else if(3===t){if("channelsFirst"===n)return 1===r.length?bm(e,[1,r[0],1]):bm(e,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?bm(e,[1,1,r[0]]):bm(e,[1].concat(r))}else if(t<3)return e;throw new w_("Unsupported input rank by biasAdd: ".concat(e.rank))}function NS(t,e,n){return zp(()=>(null==n&&(n="channelsLast"),Z_(n),Xp(t,ES(t.rank,e,n))))}function CS(t,e,n,r){return zp(()=>Zv(t,e,n,r))}function AS(t,e){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?t():e()}const RS=["fanIn","fanOut","fanAvg"],OS=["normal","uniform","truncatedNormal"];class DS extends Dp{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class MS extends DS{apply(t,e){return yy(t,e)}}MS.className="Zeros",Fp(MS);class FS extends DS{apply(t,e){return vy(t,e)}}FS.className="Ones",Fp(FS);class PS extends DS{constructor(t){if(super(),"object"!==typeof t)throw new w_("Expected argument of type ConstantConfig but got ".concat(t));if(void 0===t.value)throw new w_("config must have value set but got ".concat(t));this.value=t.value}apply(t,e){return zp(()=>Sm(Wp(this.value),vy(t,e)))}getConfig(){return{value:this.value}}}PS.className="Constant",Fp(PS);class LS extends DS{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return Yy(t,this.minval,this.maxval,e)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}LS.className="RandomUniform",Fp(LS);class zS extends DS{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new x_("randomNormal does not support dType ".concat(e,"."));return _S(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}zS.className="RandomNormal",Fp(zS);class BS extends DS{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new x_("truncatedNormal does not support dType ".concat(e,"."));return Pv(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}BS.className="TruncatedNormal",Fp(BS);class jS extends DS{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return zp(()=>{if(2!==t.length||t[0]!==t[1])throw new w_("Identity matrix initializer can only be used for 2D square matrices.");return Sm(this.gain,Lg(t[0]))})}getConfig(){return{gain:this.gain}}}jS.className="Identity",Fp(jS);class US extends DS{constructor(t){if(super(),t.scale<0)throw new w_("scale must be a positive float. Got: ".concat(t.scale));var e;this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,e=this.mode,z_(RS,"FanMode",e),this.distribution=null==t.distribution?"normal":t.distribution,function(t){z_(OS,"Distribution",t)}(this.distribution),this.seed=t.seed}apply(t,e){const n=function(t){let e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(Z_(r),2===t.length)e=t[0],n=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===r){const r=lS(t,2);e=t[1]*r,n=t[0]*r}else if("channelsLast"===r){const r=lS(t,0,t.length-2);e=t[t.length-2]*r,n=t[t.length-1]*r}}else{const r=lS(t);e=Math.sqrt(r),n=Math.sqrt(r)}return[e,n]}(t),r=n[0],a=n[1];let i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){const n=Math.sqrt(i);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new x_("".concat(this.getClassName()," does not support dType ").concat(e,"."));return Pv(t,0,n,e,this.seed)}{const n=Math.sqrt(3*i);return Yy(t,-n,n,e)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}US.className="VarianceScaling",Fp(US);class VS extends US{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return US.className}}VS.className="GlorotUniform",Fp(VS);class WS extends US{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return US.className}}WS.className="GlorotNormal",Fp(WS);class GS extends US{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return US.className}}GS.className="HeNormal",Fp(GS);class HS extends US{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return US.className}}HS.className="HeUniform",Fp(HS);class qS extends US{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return US.className}}qS.className="LeCunNormal",Fp(qS);class KS extends US{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return US.className}}KS.className="LeCunNormal",Fp(KS);class XS extends DS{constructor(t){if(super(),this.DEFAULT_GAIN=1,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,null!=this.seed)throw new x_("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,e){return zp(()=>{if(t.length<2)throw new x_("Shape must be at least 2D.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(t[0]*t[1],") elements: ")+"Slowness may result.");const e=_S(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32");let n=hw.gramSchmidt(e);return t[0]>t[1]&&(n=Hv(n)),Sm(this.gain,n)})}getConfig(){return{gain:this.gain,seed:this.seed}}}XS.className="Orthogonal",Fp(XS);const YS={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function QS(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return M_(t,Mp.getMap().classNameMap,e,"initializer")}function JS(t){return O_(t)}function $S(t){if("string"===typeof t){const e=t in YS?YS[t]:t;if("GlorotNormal"===e)return new WS;if("GlorotUniform"===e)return new VS;if("HeNormal"===e)return new GS;if("HeUniform"===e)return new HS;if("LeCunNormal"===e)return new qS;if("LeCunUniform"===e)return new KS;{const t={};return t.className=e,t.config={},QS(t)}}return t instanceof DS?t:QS(t)}function ZS(t){return Array.isArray(t)&&Array.isArray(t[0])}function tT(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function eT(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new w_("Expected Tensor length to be 1; got ".concat(t.length));e=t[0]}else e=t;return e}function nT(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return t[0];throw new w_("Expected exactly 1 Shape; got ".concat(t.length))}return t}function rT(t){let e=0;for(const n of t)0===n.shape.length?e+=1:e+=n.shape.reduce((t,e)=>t*e);return e}const aT="Variable";class iT{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:aT,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=G_(),n=null==n?aT:n,this.originalName=aS(n),this.name=iS(this.originalName),this.trainable_=r,this.constraint=a,this.val=Uv(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function oT(t){return t.map(t=>t.read())}function sT(t){t.forEach(t=>{t[0].write(t[1])})}class cT{constructor(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class lT{constructor(t,e,n,r,a,i,o){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=a,this.outputTensorIndex=o,this.id=G_(),null!=i&&(this.originalName=aS(i),this.name=iS(this.originalName)),this.rank=e.length}}let uT=0;class hT{constructor(t,e){this.callArgs=e,this.id=uT++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const n of t.inboundLayers)null!=n&&n.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)null!=e?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let dT=0;class fT extends Dp{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=dT++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=C_(t)+"_"+q_(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}null!=t.weights?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new b_("The layer has never been called "+"and thus has no defined ".concat(e,"."));if(this.inboundNodes.length<=t)throw new w_("Asked to get ".concat(e," at node ").concat(t,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[t]}getInputAt(t){return E_(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return E_(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new v_("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new v_("Layer ".concat(this.name)+" is not connected, no input to return.");return E_(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new v_("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new v_("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return E_(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=N_(t),null==this.inputSpec||0===this.inputSpec.length)return;const e=N_(this.inputSpec);if(t.length!==e.length)throw new w_("Layer ".concat(this.name," expects ").concat(e.length," inputs, ")+"but it received ".concat(t.length," input tensors. ")+"Input received: ".concat(t));for(let n=0;n<t.length;n++){const r=t[n],a=e[n];if(null==a)continue;const i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new w_("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new w_("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new w_("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new w_("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){const t=r.shape;for(const e in a.axes){const r=Number(e),i=a.axes[e],o=r>=0?t[r]:t[t.length+r];if(null!=i&&-1===[i,null].indexOf(o))throw new w_("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(r," of input shape to ")+"have value ".concat(i," but got shape ").concat(t,"."))}}if(null!=a.shape)for(let t=0;t<a.shape.length;++t){const e=a.shape[t],i=r.shape[t];if(null!=e&&null!=i&&e!==i)throw new w_("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=N_(t);let r=!0;for(const i of n)if(!(i instanceof lT)){r=!1;break}let a=!0;for(const i of n)if(i instanceof lT){a=!1;break}if(r===a)throw new w_("Arguments to apply() must be all SymbolicTensors or all Tensors");return rS(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of N_(t))e.push(n.shape);this.build(E_(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&a&&(this._refCount=1)}if(this.assertInputCompatibility(t),a){let r=this.call(t,e);const a=N_(r),i=[];for(let t of a)-1!==n.indexOf(t)&&(t=t.clone()),i.push(t);if(r=E_(i),null!=this.activityRegularizer)throw new x_("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(t){t=N_(t);const e=[];for(const n of t)e.push(n.shape);return E_(e)}(t),r=this.computeOutputShape(n);let a;const i="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),a=null!=r&&r.length>0&&Array.isArray(r[0])?r.map((n,r)=>new lT(i,n,this,N_(t),e,this.name,r)):new lT(i,r,this,N_(t),e,this.name),this.addInboundNode(t,a,null,null,n,r,e),this._refCount++,null!=this.activityRegularizer)throw new x_("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}})}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(t),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{let e=!1;this.batchInputShape.forEach((n,r)=>{null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)}),e&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(t),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new v_("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new v_("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}countParams(){if(!this.built)throw new b_("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return rT(this.weights)}build(t){this.built=!0}getWeights(){return oT(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.trainableWeights:this.weights)}setWeights(t){zp(()=>{const e=this.weights;if(e.length!==t.length)throw new w_('You called setWeights(weights) on layer "'.concat(this.name,'" ')+"with a weight list of length ".concat(t.length,", ")+"but the layer was expecting ".concat(e.length," weights. ")+"Provided weights: ".concat(t,"..."));if(0===e.length)return;const n=[],r=oT(e);for(let a=0;a<r.length;++a){const i=r[a],o=e[a],s=t[a];if(!Es(i.shape,s.shape))throw new w_("Layer weight shape ".concat(i.shape," ")+"not compatible with provided weight shape ".concat(s.shape));n.push([o,s])}sT(n)})}addWeight(t,e,n,r,a,i,o,s){if(-1!==this._addedWeightNames.indexOf(t))throw new w_("Duplicate weight name ".concat(t," for layer ").concat(this.name));this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():$S("zeros"));const c=r.apply(e,n),l=new iT(c,n,t,i,o);return c.dispose(),null!=a&&this.addLoss(()=>a.apply(l.read())),null==i&&(i=!0),i?this._trainableWeights.push(l):this._nonTrainableWeights.push(l),l}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=N_(t),void 0!==this._losses&&null!==this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");e.forEach(t=>{if(null!=t)throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.")})}return null}return e}addInboundNode(t,e,n,r,a,i){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const s=N_(t);e=N_(e),n=N_(n),r=N_(r),a=tT(a),i=tT(i);const c=[],l=[],u=[];for(const h of s)c.push(h.sourceLayer),l.push(h.nodeIndex),u.push(h.tensorIndex);new hT({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:u,inputTensors:s,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(let h=0;h<e.length;h++)e[h].sourceLayer=this,e[h].nodeIndex=this.inboundNodes.length-1,e[h].tensorIndex=h}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}dispose(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();let t=0;return 0===--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function pT(t,e,n){if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];{const t=e.inboundNodes[n];if(0===t.inboundLayers.length)return t.inputTensors;{const e=[];for(let n=0;n<t.inboundLayers.length;n++){const r=pT(t.inputTensors[n],t.inboundLayers[n],t.nodeIndices[n]);for(const t of r)-1===e.indexOf(t)&&e.push(t)}return e}}}class mT extends fT{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:q_("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new w_("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new w_("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new w_("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const r=new lT(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new hT({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new w_("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}mT.className="InputLayer",Fp(mT);class gT{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof gT)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new w_("Duplicate key: name=".concat(t.name,", id=").concat(t.id));return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return zf(e,t.dtype)}catch(Hrt){throw new w_("The dtype of the feed (".concat(e.dtype,") can not be cast to the dtype ")+"of the key '".concat(t.name,"' (").concat(t.dtype,")."))}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof lT){if(null==this.id2Value[t.id])throw new w_("Nonexistent key: ".concat(t.name));return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new w_("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Value[e]}}getMask(t){if(t instanceof lT){if(null==this.id2Value[t.id])throw new w_("Nonexistent key: ".concat(t.name));return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new w_("Feed dict has no SymbolicTensor name: ".concat(t));return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&Bp(this.id2Mask)}}const yT=new __,vT=new __;function bT(t,e,n,r){const a=null!=n&&n.training,i=Array.isArray(t),o=i?t:[t],s=o.map(t=>t.name),c=[],l=e.names();for(const p of s)-1!==l.indexOf(p)?c.push(e.getValue(p)):c.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const u=s.join(",")+"|"+e.names().sort().join(",");let h,d=yT.get(u);if(null==d){const t=function(t,e){ks(null!=t&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(1===t.length){const a=xT(t[0],e);n=a.sorted,r=a.recipientMap}else{const a=new Set;for(const i of t){const{sorted:t,recipientMap:o}=xT(i,e);for(const e of t)a.has(e.name)||(n.push(e),a.add(e.name));for(const e in o)null==r[e]&&(r[e]=new Set),o[e].forEach(t=>r[e].add(t))}}return{sorted:n,recipientCounts:wT(r)}}(o,e);d=t.sorted,h=t.recipientCounts,yT.put(u,d),vT.put(u,h)}h={},a||Object.assign(h,vT.get(u));const f=new gT(e);for(let p=0;p<d.length;++p){if(null!=r){const t=Lp().numTensors;t>r.maxNumTensors&&(r.maxNumTensors=t),t<r.minNumTensors&&(r.minNumTensors=t)}const t=d[p],i=t.sourceLayer;if(i instanceof mT)continue;const o=[],l=[],u=[];let m=!1;for(const n of t.inputs){const t=f.getValue(n),r=f.getMask(n);o.push(t),l.push(r),null!=r&&(m=!0),a||(h[n.name]--,0!==h[n.name]||e.hasKey(n)||-1!==s.indexOf(n.name)||t.isDisposed||!0===n.sourceLayer.stateful||u.push(t))}m&&((n=n||{}).mask=l[0]);const g=N_(i.apply(o,n));let y=null;i.supportsMasking&&(y=i.computeMask(o,l));const v=kT(t),b=Array.isArray(v)?v:[v];for(let e=0;e<b.length;++e){f.hasKey(b[e])||f.add(b[e],g[e],Array.isArray(y)?y[0]:y);const t=s.indexOf(b[e].name);-1!==t&&(c[t]=g[e])}a||Bp(u)}return f.disposeMasks(),i?c:c[0]}function wT(t){const e={};for(const n in t)e[n]=t[n].size;return e}function xT(t,e){const n=new Set,r=[],a={};for(const s of e.names())n.add(s);const i=[],o=[];for(i.push(t);i.length>0;){const t=i[i.length-1];if(n.has(t.name)){i.pop();continue}const e=o[o.length-1]===i.length-1;if(0===t.inputs.length||e)i.pop(),r.push(t),n.add(t.name),e&&o.pop();else{o.push(i.length-1);for(const e of t.inputs)null==a[e.name]&&(a[e.name]=new Set),a[e.name].add(t.name),n.has(e.name)||i.push(e)}}return{sorted:r,recipientMap:a}}function kT(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const r of t.sourceLayer.inboundNodes[e].outputTensors)if(r.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}function _T(t,e){return zp(()=>Eg(Cg(Sm(t,t),e,!0)))}ac().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,function(t){null!=yT&&yT.setMaxEntries(t),null!=vT&&vT.setMaxEntries(t)});class ST extends Dp{getConfig(){return{}}}class TT extends ST{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return zp(()=>{const e=_T(t,this.axis),n=Bm(e,0,this.maxValue);return Sm(t,sg(n,Xp(pS(),e)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}TT.className="MaxNorm",Fp(TT);class IT extends ST{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return zp(()=>sg(t,Xp(pS(),_T(t,this.axis))))}getConfig(){return{axis:this.axis}}}IT.className="UnitNorm",Fp(IT);class ET extends ST{apply(t){return Zy(t)}}ET.className="NonNeg",Fp(ET);class NT extends ST{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return zp(()=>{const e=_T(t,this.axis),n=Xp(Sm(this.rate,Bm(e,this.minValue,this.maxValue)),Sm(1-this.rate,e));return Sm(t,sg(n,Xp(pS(),e)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}NT.className="MinMaxNorm",Fp(NT);const CT={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function AT(t){return O_(t)}function RT(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return M_(t,Mp.getMap().classNameMap,e,"constraint")}function OT(t){if(null==t)return null;if("string"===typeof t){return RT({className:t in CT?CT[t]:t,config:{}})}return t instanceof ST?t:RT(t)}async function DT(t){if(null==t)return;const e=[],n=[],r=[];for(const a in t){const i=t[a];if("number"!==typeof i){const t=i;e.push(t.data()),n.push(a),r.push(t)}}if(e.length>0){const a=await Promise.all(e);for(let e=0;e<a.length;++e)t[n[e]]=a[e][0];Bp(r)}}function MT(t){if(null!=t)for(const e in t){const n=t[e];"number"!==typeof n&&n.dispose()}}var FT;!function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(FT||(FT={}));class PT{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class LT{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class zT extends PT{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e.size?0:e.size;this.seen+=n;for(const r in e){const t=e[r];if("number"===typeof t)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+t*n;else{let e;r in this.totals?e=this.totals[r]:this.totals[r]=0;const a=zp(()=>Xp(this.totals[r],Sm(t,n)));this.totals[r]=a,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const n of this.params.metrics)null!=this.totals[n]&&("number"===typeof this.totals[n]?e[n]=this.totals[n]/this.seen:zp(()=>{const t=Sm(sg(1,this.seen),this.totals[n]);e[n]=t,this.totals[n].dispose(),jp(e[n])}))}}class BT extends PT{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const n in e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n])}async syncData(){const t=[],e=[],n=[];for(const a in this.history){const r=this.history[a];for(let i=0;i<r.length;++i)if("number"!==typeof r[i]){const o=r[i];t.push(o.data()),e.push(a),n.push(i)}}const r=await Promise.all(t);for(let a=0;a<r.length;++a){this.history[e[a]][n[a]].dispose(),this.history[e[a]][n[a]]=r[a][0]}}}class jT extends PT{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||Tw,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Us(this.yieldEvery)&&(this.maybeWait=function(t,e,n){let r,a=null!=n?n():Uh();return function(){const i=null!=n?n():Uh();return i-a<e||(a=i,r=t(...arguments)),r}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const r=[];null!=this.yield&&(await DT(n),r.push(this.yield(t,e,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await DT(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await DT(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await DT(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await DT(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):Us(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await DT(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await DT(t),await this.trainEnd(t))}}function UT(t,e){if(null==t&&(t={}),t instanceof PT)return[t];if(Array.isArray(t)&&t[0]instanceof PT)return t;return N_(t).map(t=>new jT(t,e))}class VT{constructor(){}static registerCallbackConstructor(t,e){ks(t>=0&&Number.isInteger(t),()=>"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)),VT.checkForDuplicate(e),null==VT.constructors[t]&&(VT.constructors[t]=[]),VT.constructors[t].push(e)}static checkForDuplicate(t){for(const e in VT.constructors){VT.constructors[+e].forEach(e=>{if(e===t)throw new w_("Duplicate callback constructor.")})}}static clear(){VT.constructors={}}static createCallbacks(t){const e=[];for(const n in VT.constructors){const r=+n;t>=r&&e.push(...VT.constructors[r])}return e.map(t=>new t)}}function WT(t,e,n,r,a,i,o,s,c){const l=new BT,u=[new zT,...VT.createCallbacks(e)];null!=t&&u.push(...t),u.push(l);const h=new LT(u);return h.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:e,doValidation:s,metrics:c}),{callbackList:h,history:l}}function GT(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return M_(t,Mp.getMap().classNameMap,e,"layer",n)}function HT(t,e){return zp(()=>{"float32"!==t.dtype&&(t=zf(t,"float32"));const n=Cg(IS(t),e,!0),r=zm(n.shape,pS()),a=Eg(my(n,r));return sg(t,a)})}function qT(t,e){return zp(()=>gy(IS(ny(e,t)),-1))}function KT(t,e){return zp(()=>gy(Hp(ny(e,t)),-1))}function XT(t,e){return zp(()=>{const n=ny(t,e),r=Bm(Hp(t),pS(),Number.MAX_VALUE),a=Hp(sg(n,r));return Sm(100,gy(a,-1))})}function YT(t,e){return zp(()=>{const n=Bm(e,pS(),Number.MAX_VALUE),r=Jg(Xp(1,n)),a=Bm(t,pS(),Number.MAX_VALUE),i=Jg(Xp(1,a));return gy(IS(ny(r,i)),-1)})}function QT(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return zp(()=>{if(n)e=vv(e);else{const t=Cg(e,e.shape.length-1,!0);e=sg(e,t)}return e=Bm(e,pS(),1-pS()),Zg(Cg(Sm(zf(t,"float32"),Jg(e)),e.shape.length-1))})}function JT(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return zp(()=>{const r=zf(zg(function(t){const e=[lS(t.shape)];return bm(t,e)}(t)),"int32"),a=(e=Bm(e,pS(),1-pS())).shape;return QT(bm(Ey(r,a[a.length-1]),a),e,n)})}function $T(t,e){return zp(()=>{let n;return n=Bm(e,pS(),1-pS()),n=Jg(sg(n,ny(1,n))),gy(function(t,e){if(!Es(t.shape,e.shape))throw new w_("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(t.shape)," and ").concat(JSON.stringify(e.shape)));return zp(()=>{const n=Zy(e),r=Zg(Hp(e));return Xp(ny(n,Sm(e,t)),$g(Dg(r)))})}(t,n),-1)})}function ZT(t,e){return zp(()=>{const n=Bm(t,pS(),1),r=Bm(e,pS(),1);return Cg(Sm(t,Jg(sg(n,r))),-1)})}function tI(t,e){return zp(()=>{const n=HT(t,-1),r=HT(e,-1),a=Sm(n,r);return Zg(Cg(a,-1))})}VT.constructors={};const eI={meanSquaredError:qT,meanAbsoluteError:KT,meanAbsolutePercentageError:XT,meanSquaredLogarithmicError:YT,squaredHinge:function(t,e){return zp(()=>{const n=my(0,ny(1,Sm(t,e)));return gy(IS(n),-1)})},hinge:function(t,e){return zp(()=>{const n=my(0,ny(1,Sm(t,e)));return gy(n,-1)})},categoricalHinge:function(t,e){return zp(()=>{const n=Cg(Sm(t,e),-1),r=Sg(Sm(ny(1,t),e),-1);return my(0,Xp(1,ny(r,n)))})},logcosh:function(t,e){return zp(()=>{const n=Math.log(2),r=ny(e,t),a=ny(Xp(r,ty(Sm(-2,r))),n);return gy(a,-1)})},categoricalCrossentropy:QT,sparseCategoricalCrossentropy:JT,binaryCrossentropy:$T,kullbackLeiblerDivergence:ZT,poisson:function(t,e){return zp(()=>{const n=Jg(Xp(pS(),e));return gy(ny(e,Sm(t,n)),-1)})},cosineProximity:tI};function nI(t){if("string"===typeof t){if(t in eI)return eI[t];let e="Unknown loss ".concat(t);throw t.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss ".concat(t,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new w_(e)}return t}function rI(t,e){return zp(()=>{const n=Sm(.5,Ny(e)),r=mS(jg(e,n),t.dtype);return gy(cg(t,r),-1)})}function aI(t,e){return zp(()=>mS(cg($p(t,-1),$p(e,-1)),"float32"))}function iI(t,e){return zp(()=>zf(Cg(iy(cg(t,1),cg(e,1))),"float32"))}function oI(t,e){return $T(t,e)}function sI(t,e){return t.rank===e.rank&&(t=Tv(t,[t.rank-1])),(e=$p(e,-1)).dtype!==t.dtype&&(e=zf(e,t.dtype)),zf(cg(t,e),"float32")}const cI=QT,lI=JT,uI={binaryAccuracy:rI,categoricalAccuracy:aI,precision:function(t,e){return zp(()=>{const n=iI(t,e),r=function(t,e){return zp(()=>zf(Cg(iy(cg(t,0),cg(e,1))),"float32"))}(t,e),a=Xp(n,r);return zf(lg(jg(a,0),sg(n,a),0),"float32")})},categoricalCrossentropy:cI,sparseCategoricalCrossentropy:lI,mse:qT,MSE:qT,mae:KT,MAE:KT,mape:XT,MAPE:XT,cosine:tI};function hI(t){if("string"===typeof t&&t in uI)return uI[t];if("string"!==typeof t&&null!=t)return t;throw new w_("Unknown metric ".concat(t))}function dI(t){if(T_(null!==t,"Unknown LossOrMetricFn ".concat(t)),"string"===typeof t)return t;{let e;for(const n of Object.keys(eI))if(eI[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(uI))if(uI[n]===t){e=n;break}return void 0!==e?e:t.name}}const fI=1048576;function pI(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t||"object"!==typeof t||Object.getPrototypeOf(t)!==Object.prototype||!mI(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>fI&&console.warn('User-defined metadata of model "'.concat(e,'" is too large in ')+"size (length=".concat(n.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(fI,"."))}}function mI(t){if(null===t)return!0;if("object"===typeof t){if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e){if("string"!==typeof n)return!1;if(!mI(t[n]))return!1}return!0}if(Array.isArray(t)){for(const e of t)if(!mI(e))return!1;return!0}return!1}{const e=typeof t;return"string"===e||"number"===e||"boolean"===e}}function gI(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log;const a=function(t){let e=!0;const n=[],r=[];for(const a in t.nodesByDepth)n.push(t.nodesByDepth[a]);for(const a of n){if(a.length>1||1===a.length&&a[0].inboundLayers.length>1){e=!1;break}r.push(...a)}if(e)for(const a of t.layers){let t=!1;for(const n of a.inboundNodes)if(-1!==r.indexOf(n)){if(t){e=!1;break}t=!0}if(!e)break}return e}(t),i=["Layer (type)","Input Shape","Output shape","Param #"];let o;if(a?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(t=>Math.floor(e*t))),!a){i.push("Receives inputs"),o=[];for(const e in t.nodesByDepth)o.push(...t.nodesByDepth[e])}r("_".repeat(e)),yI(i,n,r),r("=".repeat(e));const s=t.layers;for(let u=0;u<s.length;++u)a?vI(s[u],n,r):bI(s[u],n,o,r),r((u===s.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const c=function(t){let e;e=null!=t.collectedTrainableWeights?rT(t.collectedTrainableWeights):rT(t.trainableWeights);return e}(t),l=rT(t.nonTrainableWeights);r("Total params: ".concat(c+l)),r("Trainable params: ".concat(c)),r("Non-trainable params: ".concat(l)),r("_".repeat(e))}function yI(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="";for(let a=0;a<t.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r+=t[a],r=r.slice(0,e[a]),r+=" ".repeat(e[a]-r.length);n(r)}function vI(t,e,n){let r,a;try{a=t.inboundNodes.map(t=>JSON.stringify(t.inputShapes)).join(",")}catch(Hrt){a="multiple"}try{r=JSON.stringify(t.outputShape)}catch(Hrt){r="multiple"}const i=t.name,o=t.getClassName();yI(["".concat(i," (").concat(o,")"),a,r,t.countParams().toString()],e,n)}function bI(t,e,n,r){let a,i;try{i=t.inboundNodes.map(t=>JSON.stringify(t.inputShapes)).join(",")}catch(Hrt){i="multiple"}try{a=JSON.stringify(t.outputShape)}catch(Hrt){a="multiple"}const o=[];for(const u of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(let t=0;t<u.inboundLayers.length;++t){const e=u.inboundLayers[t].name,n=u.nodeIndices[t],r=u.tensorIndices[t];o.push("".concat(e,"[").concat(n,"][").concat(r,"]"))}const s=t.name,c=t.getClassName(),l=0===o.length?"":o[0];yI(["".concat(s," (").concat(c,")"),i,a,t.countParams().toString(),l],e,r);for(let u=1;u<o.length;++u)yI(["","","","",o[u]],e,r)}function wI(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"===typeof n}function xI(t,e){if(null===t)return null;if("string"===typeof t)return A_(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let a=0;a<r;++a){const r=t[a];wI(e,a,r)?n.push(r):n.push(xI(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n];if("name"===n&&"string"===typeof r)e[n]=r;else{const t=A_(n);e[t]=xI(r,t)}}return e}}function kI(t,e){if(null===t||void 0===t)return null;if("string"===typeof t)return C_(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let a=0;a<r;++a){const r=t[a];wI(e,a,r)?n.push(r):n.push(kI(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n],a=C_(n);e[a]="name"!==n&&"className"!==n||"string"!==typeof r?kI(r,n):r}return e}}const _I="3.21.0";class SI extends fT{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=q_(t)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],P_(this.inputs).length!==this.inputs.length)throw new w_("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(this.inputs.map(t=>t.name)));P_(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(this.outputs.map(t=>t.name))),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const t=y.sourceLayer,e=y.nodeIndex,n=y.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(e),this.outputLayersTensorIndices.push(n)}for(const y of this.inputs){const t=y.sourceLayer,e=y.nodeIndex,n=y.tensorIndex;T_(0===e,"input layer has >1 nodes"),T_(0===n,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(e),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const e=this.inputLayers[y];if(!(e instanceof mT))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(t.inputs,". ")+"Input ".concat(y," (0-based) originates ")+"from layer type ".concat(e.getClassName(),"."));this.inputNames.push(e.name),this.feedInputShapes.push(e.batchInputShape),this.feedInputNames.push(e.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(t=>t.shape),this.internalOutputShapes=this.outputs.map(t=>t.shape);const e={},n={},r={},a={},i={},o=[],s=(t,e,n,r,a,c)=>{null!=r&&null!=a&&null!=c||(r=t.sourceLayer,a=t.nodeIndex,c=t.tensorIndex);const l=r.inboundNodes[a];if(-1!==n.indexOf(l))throw new b_("The tensor ".concat(t.name,' at layer "').concat(r.name,'" ')+"is part of a cycle.");if(-1!==e.indexOf(l))return;this.containerNodes.add(SI.nodeKey(r,a)),r.id in i||(i[r.id]=Object.keys(i).length),-1===n.indexOf(l)&&n.push(l);const u=l.inboundLayers.length;for(let i=0;i<u;i++){const t=l.inputTensors[i],r=l.inboundLayers[i],a=l.nodeIndices[i],o=l.tensorIndices[i];s(t,e,n,r,a,o)}for(e.push(l);n.indexOf(l)>=0;)n.splice(n.indexOf(l),1);o.push(l)},c=[],l=[];for(const y of this.outputs)s(y,c,l);const u=o.slice().reverse();for(const y of u){n[y.id]=y,y.id in e||(e[y.id]=0);let t=e[y.id];const i=null==r[y.outboundLayer.id]?0:r[y.outboundLayer.id];t=Math.max(t,i),r[y.outboundLayer.id]=t,a[y.outboundLayer.id]=y.outboundLayer,e[y.id]=t;for(let r=0;r<y.inboundLayers.length;r++){const a=y.inboundLayers[r],i=y.nodeIndices[r],o=a.inboundNodes[i],s=null==e[o.id]?0:e[o.id];e[o.id]=Math.max(t+1,s),n[o.id]=o}}const h={};for(const y in e){const t=e[y];t in h||(h[t]=[]),h[t].push(n[y])}const d={};for(const y in r){const t=r[y];t in d||(d[t]=[]),d[t].push(a[y])}let f=Object.keys(d).map(t=>parseInt(t,10)).sort(F_);this.layers=[];for(const y of f){const t=d[y];t.sort((t,e)=>{const n=i[t.id],r=i[e.id];return n<r?-1:n>r?1:0});for(const e of t)e instanceof SI&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=d,f=Object.keys(h).map(t=>parseInt(t,10)).sort(F_);const p=this.inputs.slice(),m=[];for(const y of f)for(const t of h[y]){const e=t.outboundLayer;if(null!=e){for(const n of t.inputTensors)if(-1===p.indexOf(n))throw new b_("Graph disconnected: cannot obtain value for tensor ".concat(n)+' at layer "'.concat(e.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(m));for(const e of t.outputTensors)p.push(e);m.push(e.name)}}this.nodesByDepth=h;const g=this.layers.map(t=>t.name);for(const y of g){const t=g.filter(t=>t===y).length;if(1!==t)throw new b_('The name "'.concat(y,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new hT({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(t=>null),outputMasks:this.outputs.map(t=>null),inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs.map(t=>t.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(e=>e.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new w_("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n={};let r=0;for(const i of this.layers)for(const t of i.weights){if(null!=n[t.originalName])throw new w_("Duplicate weight name: ".concat(t.originalName));n[t.originalName]=t,r++}const a=[];for(const i in t){let r=i;if(null==n[i]){const t=i.split("/");r=t.slice(0,-2).concat([t[t.length-1]]).join("/")}if(null!=n[r])a.push([n[r],t[i]]);else if(e)throw new w_("Provided weight data has no target variable: ".concat(i));delete n[r]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new w_("".concat(t.length," of ").concat(r," weights are not set: ")+"".concat(t))}sT(a)}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers ".concat(_I),e.backend="TensorFlow.js",e}toJSON(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=kI(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return zp(()=>{t=N_(t);const n=new gT;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return bT(this.outputs,n,e)})}computeMask(t,e){return zp(()=>{let n;return t=N_(t),n=null==e?S_(null,t.length):N_(e),this.runInternalGraph(t,n)[1]})}computeOutputShape(t){const e=tT(t);if(e.length!==this.inputLayers.length)throw new w_("Invalid inputShape argument ".concat(t,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));const n={};for(let o=0;o<e.length;o++){const t=this.inputLayers[o],r=e[o];n[t.name+"_0_0"]=r}const r=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(F_);if(r.length>1)for(const o of r){const t=this.nodesByDepth[o];for(const e of t){const t=e.outboundLayer;if(-1!==this.inputLayers.map(t=>t.id).indexOf(t.id))continue;const r=[];for(let o=0;o<e.inboundLayers.length;o++){const t=e.inboundLayers[o],a=e.nodeIndices[o],i=e.tensorIndices[o],s=n["".concat(t.name,"_").concat(a,"_").concat(i)];r.push(s)}const a=tT(t.computeOutputShape(E_(r))),i=t.inboundNodes.indexOf(e);for(let e=0;e<a.length;e++){n["".concat(t.name,"_").concat(i,"_").concat(e)]=a[e]}}}const a=[],i=[];for(let o=0;o<this.outputLayers.length;o++){const t=this.outputLayers[o],e=this.outputLayersNodeIndices[o],n=this.outputLayersTensorIndices[o],r="".concat(t.name,"_").concat(e,"_").concat(n);i.push(r)}for(let o=0;o<i.length;o++){const t=i[o];T_(t in n),a.push(n[t])}return E_(a)}runInternalGraph(t,e){null==e&&(e=S_(null,t.length));const n={};for(let s=0;s<this.inputs.length;++s){const r=this.inputs[s],a=t[s],i=e[s];n[r.id]=[a,i]}const r=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(F_);for(const s of r){const t=this.nodesByDepth[s];for(const e of t){const t=e.outboundLayer,r=e.inputTensors,a=e.outputTensors,i=new Array;for(const e of r)e.id in n&&i.push(n[e.id]);if(i.length===r.length){let r,o,s,c,l={};if(null!=e.callArgs&&(l=e.callArgs),1===i.length){const[e,n]=i[0];null==l.mask&&(l.mask=n),s=N_(t.call(e,l)),c=N_(t.computeMask(e,n)),r=[e],o=[n]}else r=i.map(t=>t[0]),o=i.map(t=>t[1]),null==l.mask&&(l.mask=o),s=N_(t.call(r,l)),c=N_(t.computeMask(r,o));if(t.activityRegularizer)throw new x_("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<a.length;++t){const e=a[t],r=s[t],i=c[t];n[e.id]=[r,i]}}}}const a=[],i=[],o=[];for(const s of this.outputs){T_(s.id in n,"Could not compute output ".concat(s.name," : ").concat(s.id));const[t,e]=n[s.id];o.push(t.shape),a.push(t),i.push(e)}return[a,i,o]}buildNodeConversionMap(t){const e={};let n;for(const r of this.layers){n=r instanceof SI?1:0;for(let t=0;t<r.inboundNodes.length;t++){const a=SI.nodeKey(r,t);this.containerNodes.has(a)&&(e[a]=n,n+=1)}}return e}getLayer(t,e){if(null!=e){if(this.layers.length<=e)throw new w_("Was asked to retrieve layer at index ".concat(e,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[e]}if(null==t)throw new w_("Provide either a layer name or layer index");for(const n of this.layers)if(n.name===t)return n;throw new w_("No such layer: ".concat(t))}calculateLosses(){return zp(()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const r=SI.nodeKey(e,n);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const i of this.layers){const t=i.getClassName(),r=i.getConfig(),a=[];for(let n=0;n<i.inboundNodes.length;n++){const t=i.inboundNodes[n],r=SI.nodeKey(i,n);let o={};if(this.containerNodes.has(r)){if(t.callArgs)try{JSON.stringify(t.callArgs),o=t.callArgs}catch(Hrt){console.warn("Layer ".concat(i.name," was passed ")+"non-serializable keyword arguments: "+"".concat(t.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),o={}}if(t.inboundLayers.length>0){const n=[];for(let r=0;r<t.inboundLayers.length;r++){const a=t.inboundLayers[r],i=t.nodeIndices[r],s=t.tensorIndices[r];let c=e[SI.nodeKey(a,i)];null==c&&(c=0),n.push([a.name,c,s,o])}a.push(n)}}}const o={};o.name=i.name,o.className=t,o.config=r,o.inboundNodes=a,n.push(o)}t.layers=n;const r=[];for(let i=0;i<this.inputLayers.length;i++){const t=this.inputLayers[i],n=this.inputLayersNodeIndices[i],a=SI.nodeKey(t,n);if(!this.containerNodes.has(a))continue;let o=e[a];null!==o&&void 0!==o||(o=0);const s=this.inputLayersTensorIndices[i];r.push([t.name,o,s])}t.inputLayers=r;const a=[];for(let i=0;i<this.outputLayers.length;i++){const t=this.outputLayers[i],n=this.outputLayersNodeIndices[i],r=SI.nodeKey(t,n);if(!this.containerNodes.has(r))continue;let o=e[r];null!==o&&void 0!==o||(o=0);const s=this.outputLayersTensorIndices[i];a.push([t.name,o,s])}return t.outputLayers=a,t}static fromConfig(t,e){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r={},a={};function i(t,e){t.name in a?a[t.name].push(e):a[t.name]=[e]}function o(t,e){const n=[];let a;for(const o of e){const s=o[0],c=o[1],l=o[2];if(a=null==o[3]?{}:o[3],!(s in r))return void i(t,e);const u=r[s];if(u.inboundNodes.length<=c)return void i(t,e);const h=u.inboundNodes[c];n.push(h.outputTensors[l])}n.length>0&&t.apply(E_(n),a)}function s(t){const a=t.name,o=GT(t,null!=e.customObjects?e.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o;t.inboundNodes.forEach(t=>{if(!(t instanceof Array))throw new w_("Corrupted configuration, expected array for nodeData: ".concat(t));i(o,t)})}const c=e.name,l=e.layers;for(const p of l)s(p);for(;!L_(a);)for(const t of l){const e=r[t.name];if(e.name in a){const t=a[e.name];delete a[e.name];for(const n of t)o(e,n)}}const u=[],h=[],d=e.inputLayers;for(const p of d){const t=p[0],e=p[1],n=p[2];T_(t in r);const a=r[t].inboundNodes[e].outputTensors;u.push(a[n])}const f=e.outputLayers;for(const p of f){const t=p[0],e=p[1],n=p[2];T_(t in r);const a=r[t].inboundNodes[e].outputTensors;h.push(a[n])}return new t({inputs:u,outputs:h,name:c})}get stateful(){if(this._stateful)throw new w_("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){zp(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}function TI(t,e,n){const r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>null);if(1===r)return Array.isArray(t)&&1===t.length?t:"object"===typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(t.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return t}if("object"===typeof t&&Object.keys(t).length>0&&"object"===typeof t[Object.keys(t)[0]]){const n=[];return e.forEach(e=>{e in t?n.push(t[e]):n.push(null)}),n}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(e," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(t)))}function II(t,e){return TI(t,e,"classWeight")}async function EI(t,e,n,r){if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=zp(()=>{if(1===t.shape.length)return Bf(t);if(2===t.shape.length){if(t.shape[1]>1){return $p(t,1)}if(1===t.shape[1])return bm(t,[t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")}),r=Array.from(await e.data());Bp(e);const a=[];return r.forEach(t=>{if(null==n[t])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(t," exists in the data but not in ")+"classWeight");a.push(n[t])}),Av(a,"float32")}return null}function NI(t,e){return Sm(t,e)}function CI(t,e){let n,r;const a=e;n=a.xs,r=a.ys,ks(null!=n&&null!=r,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(e));const i=AI("input",t.inputNames,n),o=AI("output",t.outputNames,r),s=i[0].shape[0];ks(i.length===t.inputs.length,()=>"LayersModel has ".concat(t.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(t.inputNames),")")),ks(o.length===t.outputs.length,()=>"LayersModel has ".concat(t.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(t.outputNames),")"));for(let c=0;c<i.length;c++)ks(i[c].shape[0]===s,()=>"Batch size mismatch: input "+"".concat(t.inputNames[c]," has ").concat(i[c].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(t.inputNames[0],"."));for(let c=0;c<o.length;c++)ks(o[c].shape[0]===s,()=>"Batch size mismatch: output "+"".concat(t.outputNames[c]," has ").concat(o[c].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(t.inputNames[0],"."));return{xs:i,ys:o}}function AI(t,e,n){if(n instanceof nd)return[n];if(Array.isArray(n))return ks(n.length===e.length,()=>"Received an array of ".concat(n.length," Tensors, but expected ").concat(e.length," to match the ").concat(t," keys ").concat(e,".")),n;{const r=[];for(const a of e){if(null==n[a])throw new w_("The feature data generated by the dataset lacks the required "+"".concat(t," key '").concat(a,"'."));r.push(n[a])}return r}}async function RI(t,e,n){const r=null!=n.batchesPerEpoch;if(ks(null!=t.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),ks(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),ks(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(n.epochs)),ks(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(n.batchesPerEpoch)),ks(null==n.validationSplit,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const a=null!=n.validationData;let i,o;if(a)if(OI(n.validationData))ks(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(n.validationBatches));else{const t=function(t){if(3===t.length)throw new x_("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData);i=t.xs,o=t.ys}const s=t.makeTrainFunction(),c=t.getDedupedMetricsNames();let l;l=a?c.slice().concat(c.map(t=>"val_"+t)):c.slice();const u=UT(n.callbacks,n.yieldEvery),h=null==n.verbose?1:n.verbose,{callbackList:d,history:f}=WT(u,h,n.epochs,null,null,function(t,e){let n=null;null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size);return n}(e,n),null,a,l);d.setModel(t),t.history=f,await d.onTrainBegin(),t.stopTraining_=!1;let p=null==n.initialEpoch?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const l={};await d.onEpochBegin(p);let u=0,h=0;for(r||(m=await e.iterator());!r||u<n.batchesPerEpoch;){const e=await m.next();if(r&&e.done){console.warn("You provided `batchesPerEpoch` as "+"".concat(n.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(u," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(n.batchesPerEpoch*n.epochs," batches). ")+"You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:r,ys:a}=CI(t,e.value),i={};i.batch=h,i.size=r[0].shape[0],await d.onBatchBegin(h,i);const o=[];if(null!=n.classWeight){const e=II(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)o.push(await EI(a[t],null,e[t]))}const l=r.concat(a).concat(o),f=s(l);Bp(l);for(let t=0;t<c.length;++t){const e=c[t],n=f[t];i[e]=n,jp(n)}await d.onBatchEnd(h,i),MT(i),h++,u++}if(r?u>=n.batchesPerEpoch:e.done){if(a){let e;e=OI(n.validationData)?N_(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):N_(t.evaluate(i,o,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)l["val_".concat(t.metricsNames[n])]=e[n]}break}if(t.stopTraining_)break}if(await d.onEpochEnd(p,l),p++,t.stopTraining_)break}return await d.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function OI(t){return"function"===typeof t.iterator}function DI(t){ks(t>0&&Number.isInteger(t),()=>"batchSize is required to be a positive integer, but got ".concat(t))}function MI(t,e,n){return null==t?[null]:Array.isArray(t)?t.map(t=>yS(t,e,n-e)):yS(t,e,n-e)}function FI(t,e){return zp(()=>null==t?null:Array.isArray(t)?t.map(t=>FI(t,e)):TS(t,"int32"===e.dtype?e:zf(e,"int32")))}function PI(t,e){const n=[];let r=0,a=null;for(;r<t;)a=r+e,a>=t&&(a=t),n.push([r,a]),r=a;return n}async function LI(t,e,n){let r,a,i,o,s,c,l,u,h,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const f=null==d.batchSize?32:d.batchSize;DI(f);const p=!1,m=await t.standardizeUserData(e,n,d.sampleWeight,d.classWeight,p,f);r=m[0],a=m[1],h=m[2];let g,y=!1;if(null!=d.validationData&&d.validationData.length>0){if(y=!0,2!==d.validationData.length)throw 3===d.validationData.length?new x_("validationData including sample weights is not supported yet."):new w_("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(d.validationData," is invalid."));s=d.validationData[0],c=d.validationData[1];const e=!0,n=await t.standardizeUserData(s,c,null,null,e,f);l=n[0],u=n[1],g=l.concat(u)}else if(null!=d.validationSplit&&d.validationSplit>0&&d.validationSplit<1){y=!0;const t=Math.floor(r[0].shape[0]*(1-d.validationSplit)),e=r[0].shape[0];l=MI(r,t,e),i=r,r=MI(r,0,t),u=MI(a,t,e),o=a,a=MI(a,0,t),g=l.concat(u)}else null!=d.validationSteps&&(y=!0);const v=r.concat(a).concat(h);t.checkTrainableWeightsConsistency();const b=t.makeTrainFunction(),w=t.getDedupedMetricsNames();let x,k;y?(t.makeTestFunction(),x=t.testFunction,k=w.slice().concat(w.map(t=>"val_"+t))):(x=null,g=[],k=w.slice());const _=UT(d.callbacks,d.yieldEvery),S=await async function(t,e,n,r,a,i,o,s,c,l,u,h,d,f,p){null==a&&(a=32),null==i&&(i=1),null==u&&(u=!0),null==d&&(d=0);let m=!1;if(null!=c&&null!=l&&(m=!0),null!=p&&(m=!0,null==f))throw new w_("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const g=t.checkNumSamples(n,a,f,"steps_per_epoch");let y;null!=g&&(y=dS(0,g)),null==o&&(o=1);const{callbackList:v,history:b}=WT(s,o,i,d,g,f,a,m,h);v.setModel(t),t.history=b,await v.onTrainBegin(),t.stopTraining_=!1;for(let w=d;w<i;++w){await v.onEpochBegin(w);const i={};if(null!=f)throw new x_("stepsPerEpoch mode is not implemented yet.");{if("batch"===u)throw new x_("batch shuffling is not implemneted yet");u&&vs(y);const o=Av(y),s=PI(g,a);for(let u=0;u<s.length;++u){const h={};if(await v.onBatchBegin(u,h),zp(()=>{const d=s[u][0],f=s[u][1],p=yS(o,d,f-d);h.batch=u,h.size=f-d;const g=FI(n,p),y=e(g);for(let t=0;t<r.length;++t){const e=r[t],n=y[t];h[e]=n,jp(n)}if(u===s.length-1&&m){const e=t.testLoop(c,l,a);for(let t=0;t<r.length;++t){const n=r[t],a=e[t];jp(a),i["val_"+n]=a}}}),await v.onBatchEnd(u,h),MT(h),t.stopTraining_)break}o.dispose()}if(await v.onEpochEnd(w,i),t.stopTraining_)break}return await v.onTrainEnd(),await t.history.syncData(),t.history}(t,b,v,w,f,d.epochs,d.verbose,_,x,g,d.shuffle,k,d.initialEpoch,null,null);return S}finally{t.isTraining=!1,BI(r,e),BI(a,n),BI(i,e),BI(o,n),BI(l,s),BI(u,c),null!=h&&Bp(h)}}function zI(t){const e=[];t instanceof nd&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(1===r.rank)e.push(gS(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function BI(t,e){if(null==t)return;const n=[];if(e instanceof nd)n.push(e.id);else if(Array.isArray(e))e.forEach(t=>n.push(t.id));else if(null!=e)for(const a in e){const t=e[a];n.push(t.id)}const r=[];if(t instanceof nd)-1===n.indexOf(t.id)&&r.push(t);else if(Array.isArray(t))t.forEach(t=>{-1===n.indexOf(t.id)&&r.push(t)});else if(null!=t)for(const a in t){const e=t[a];-1===n.indexOf(e.id)&&r.push(e)}r.forEach(t=>{t.isDisposed||t.dispose()})}function jI(t){return Array.isArray(t)}function UI(t){return!function(t){return t instanceof nd}(t)&&!jI(t)}function VI(t,e,n){let r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==e||0===e.length){if(null!=t){let e=!1;if(jI(t)&&t.length>0)e=!0;else if(UI(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new w_("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(t))}return[]}if(null==t)return e.map(t=>null);if(UI(t)){r=[];for(const n of e){if(null==t[n])throw new w_('No data provided for "'.concat(n,'". Need data for each key in: ')+"".concat(e));r.push(t[n])}}else if(jI(t)){if(t.length!==e.length)throw new w_("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(e.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(t));r=t}else{if(e.length>1)throw new w_("The model ".concat(i," expects ").concat(e.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(t.shape));r=[t]}if(r=zI(r),null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=r[o];if(t.shape.length!==n[o].length)throw new w_("Error when checking ".concat(i,": expected ").concat(e[o]," ")+"to have ".concat(n[o].length," dimension(s). but got array with ")+"shape ".concat(t.shape));for(let e=0;e<n[o].length;++e){if(0===e&&!a)continue;const r=t.shape[e],s=n[o][e];if(null!=s&&s>=0&&r!==s)throw new w_("".concat(i," expected a batch of elements where each ")+"example has shape [".concat(n[o].slice(1,n[o].length),"] ")+"(i.e.,tensor shape [*,".concat(n[o].slice(1,n[o].length),"])")+" but the ".concat(i," received an input with ").concat(t.shape[0])+" examples, each with shape [".concat(t.shape.slice(1,t.shape.length),"]")+" (tensor shape [".concat(t.shape,"])"))}}return r}function WI(t,e,n){let r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(t)){if(t.length!==e.length)throw new w_("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(e.length," Tensor(s),")+" but instead got ".concat(t.length," Tensors(s)."));r=t}else{if(e.length>1)throw new w_("The model expects ".concat(e.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(t.shape),"."));r=[t]}if(null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=r[o];if(t.shape.length!==n[o].length)throw new w_("Error when checking ".concat(i,": expected ").concat(e[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(t.shape)));for(let r=0;r<n[o].length;++r){if(0===r&&!a)continue;const s=t.shape[r],c=n[o][r];if(null!=c&&c!==s)throw new w_("Error when checking ".concat(i,": expected ")+"".concat(e[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(t.shape),"."))}}}class GI extends SI{constructor(t){super(t),this.isTraining=!1}summary(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new w_("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");gI(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"===typeof t.optimizer)this.optimizer_=function(t){const e={Adagrad:()=>_w.adagrad(.01),Adadelta:()=>_w.adadelta(1,.95,pS()),Adam:()=>_w.adam(.001,.9,.999,pS()),Adamax:()=>_w.adamax(.002,.9,.999,pS(),0),RMSProp:()=>_w.rmsprop(.001,.9,0,pS()),SGD:()=>_w.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new w_("Unknown Optimizer ".concat(t))}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof Gp))throw new w_("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"===typeof t.loss||"function"===typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new w_("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(t.loss,"."));const n=t.loss;e=n.map(t=>nI(t))}else{const n=nI(t.loss);this.outputs.forEach(t=>{e.push(n)})}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new w_('Unknown entry in loss dictionary: "'.concat(e,'". ')+"Only expected the following keys: ".concat(this.outputNames));for(const n of this.outputNames)null==t.loss[n]&&console.warn('Output "'.concat(n,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(n," during training")),e.push(nI(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const t=this.internalOutputShapes[i],e=this.outputNames[i];this.feedOutputNames.push(e),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[i])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],rS("loss",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}});const r=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>[]);let n;if("string"===typeof t||"function"===typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!==typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(t));n=t}if(Array.isArray(n))return e.map(t=>n);{const t=[];for(const r of e){let e=n.hasOwnProperty(r)?n[r]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}(t.metrics,this.outputNames),a=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};rS("metric",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;(e=>{let n,r,i;for(const o of e){if("string"===typeof o&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(o)){const e=this.internalOutputShapes[t];let a;1===e[e.length-1]||this.lossFunctions[t]===$T?-1!==["accuracy","acc"].indexOf(o)?r=rI:-1!==["crossentropy","ce"].indexOf(o)&&(r=oI):this.lossFunctions[t]===JT?-1!==["accuracy","acc"].indexOf(o)?r=sI:-1!==["crossentropy","ce"].indexOf(o)&&(r=lI):-1!==["accuracy","acc"].indexOf(o)?r=aI:-1!==["crossentropy","ce"].indexOf(o)&&(r=cI),-1!==["accuracy","acc"].indexOf(o)?a="acc":-1!==["crossentropy","ce"].indexOf(o)&&(a="ce"),i=r,n=""+a}else{const t=hI(o);i=t,n=""+dI(o)}let e;rS(n,()=>{e=i}),a(t,n,e)}})(r[t])}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=null==n.batchSize?32:n.batchSize;DI(r);const a=this.standardizeUserDataXY(t,e,!0,r);try{const t=a[0].concat(a[1]);this.makeTestFunction();const e=this.testFunction;return E_(this.testLoop(e,t,r,n.verbose,n.steps))}finally{BI(a[0],t),BI(a[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),async function(t,e,n){const r=null!=(n=n||{}).batches,a=t.testFunction;let i=[];if(n.verbose>0)throw new x_("Verbose mode is not implemented yet.");ks(!r||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(n.batches)));const o=function(t){return"function"===typeof t.next}(e)?e:await e.iterator();let s=0,c=0;for(;!r||c<n.batches;){const e=await o.next();if(i=zp(()=>{if(e.value){const{xs:n,ys:r}=CI(t,e.value),o=n.concat(r),l=zp(()=>a(o));if(Bp(o),0===c)for(let t=0;t<l.length;++t)i.push(Wp(0));const u=o[0].shape[0];for(let t=0;t<l.length;++t){const e=l[t],n=i[t];i[t]=zp(()=>Xp(i[t],Sm(u,e))),c>0&&Bp(n)}Bp(l),s+=u,++c}return i}),e.done){r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(n.batches," batches). ")+"You may need to use the repeat() function when building your dataset.");break}}for(let l=0;l<i.length;++l){const t=i[l];i[l]=sg(i[l],s),Bp(t)}return E_(i)}(this,t,e)}checkNumSamples(t,e,n){let r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=e)throw new w_("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(e))}else{if(null==t)throw new w_("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return r}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new w_("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),r=n?e:[e],a=this.retrieveSymbolicTensors(r),i=new gT;if(t instanceof nd&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new w_("The number of inputs provided (".concat(t.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(let e=0;e<this.inputs.length;++e)i.add(this.inputs[e],t[e])}else for(const s of this.inputs){const e=t[s.name];if(null==e)throw new w_("No value is provided for the model's input ".concat(s.name));i.add(s,e)}const o=bT(a,i);return n?o:o[0]}retrieveSymbolicTensors(t){const e=S_(null,t.length);let n=t.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],i=a.map(t=>t.name);for(let r=0;r<t.length;++r){const o=i.indexOf(t[r]);if(-1!==o&&(e[r]=a[o],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach((e,r)=>{null==e&&n.push(t[r])}),new w_("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(n)))}return e}predictLoop(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return zp(()=>{const r=this.checkNumSamples(t);if(n)throw new x_("Verbose predictLoop() is not implemented yet.");const a=PI(r,e),i=this.outputs.map(t=>[]);for(let e=0;e<a.length;++e){zp(()=>{const n=a[e][0],r=a[e][1],i=MI(t,n,r),o=[];if(Array.isArray(i))for(let t=0;t<i.length;++t)o.push({key:this.inputs[t],value:i[t]});else o.push({key:this.inputs[0],value:i});const s=new gT(o);return bT(this.outputs,s)}).forEach((t,e)=>i[e].push(t))}return E_(i.map(t=>km(t,0)))})}predict(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=zI(t);WI(n,this.inputNames,this.feedInputShapes,!1);try{const t=null==e.batchSize?32:e.batchSize;return DI(t),this.predictLoop(n,t)}finally{BI(n,t)}}predictOnBatch(t){WI(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e){let n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new b_("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let a=0;a<this.feedOutputShapes.length;++a){const t=this.feedOutputShapes[a];this.feedLossFns[a]===JT?r.push(t.slice(0,t.length-1).concat([1])):r.push(t)}if(function(t,e){const n=P_(t.map(t=>t.shape[0]));n.sort();const r=P_(e.map(t=>t.shape[0]));if(r.sort(),n.length>1)throw new w_("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map(t=>t.shape))));if(r.length>1)throw new w_("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map(t=>t.shape))));if(n.length>0&&r.length>0&&!Es(n,r))throw new w_("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(n[0]," input sample(s) and ").concat(r[0]," target ")+"sample(s).")}(t=VI(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=VI(e,this.feedOutputNames,r,!1,"target")),function(t,e,n){const r=[qT,$T,QT];for(let a=0;a<t.length;++a){const i=t[a],o=e[a],s=n[a];if(null!=o){if(o===QT&&1===i.shape[i.shape.length-1])throw new w_("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o)){const t=i.shape.slice(1),e=s.slice(1);for(let n=0;n<t.length;++n){const r=t[n],a=e[n];if(null!=a&&r!==a)throw new w_("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&t[0].shape[0]%n!==0)throw new w_("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(t[0].shape[0]," sample(s)."));return[t,e]}async standardizeUserData(t,e,n,r){let a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5?arguments[5]:void 0;const[o,s]=this.standardizeUserDataXY(t,e,a,i);if(null!=n)throw new Error("sample weight is not supported yet.");let c=null;if(null!=r){const t=II(r,this.outputNames);c=[];for(let e=0;e<t.length;++e)c.push(await EI(s[e],null,t[e]))}return[o,s,c]}testLoop(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0;return zp(()=>{const i=this.checkNumSamples(e,n,a,"steps"),o=[];if(r>0)throw new x_("Verbose mode is not implemented yet.");if(null!=a)throw new x_("steps mode in testLoop() is not implemented yet");{const r=PI(i,n),a=Av(dS(0,i));for(let n=0;n<r.length;++n){const i=r[n][0],s=r[n][1],c=yS(a,i,s-i),l=FI(e,c),u=t(l);if(0===n)for(let t=0;t<u.length;++t)o.push(Wp(0));for(let t=0;t<u.length;++t){const e=u[t];o[t]=Xp(o[t],Sm(s-i,e))}}for(let t=0;t<o.length;++t)o[t]=sg(o[t],i)}return o})}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const r=t[n];let a=r;if(I_(t,r)>1){const e=I_(t.slice(0,n),r);a+="_".concat(e)}e.push(a)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),i=[],o=this.collectedTrainableWeights.map(t=>t.read());return[this.optimizer_.minimize(()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const o=new gT(t),s=bT(this.outputs,o,{training:!0});let c;for(let n=0;n<this.lossFunctions.length;++n){let t=(0,this.lossFunctions[n])(r[n],s[n]);null!=a[n]&&(t=NI(t,a[n]));const i=gy(t);e.push(i),c=0===n?t:Xp(c,t)}for(let n=0;n<this.metricsTensors.length;++n){let t;if(this.outputs.length>1&&n<this.outputs.length)t=e[n];else{const e=this.metricsTensors[n][0],a=this.metricsTensors[n][1];t=gy(e(r[a],s[a]))}jp(t),i.push(t)}return c=gy(c),this.calculateLosses().forEach(t=>{c=Xp(c,t)}),c},!0,o)].concat(i)}}makeTestFunction(){this.testFunction=t=>zp(()=>{const e=[];let n;const r=t.slice(0,this.inputs.length),a=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let t=0;t<this.inputs.length;++t)i.push({key:this.inputs[t],value:r[t]});const o=new gT(i),s=bT(this.outputs,o);for(let t=0;t<this.lossFunctions.length;++t){const r=this.lossFunctions[t],i=gy(r(a[t],s[t]));n=0===t?i:Xp(n,i),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][0],r=this.metricsTensors[t][1],i=gy(n(a[r],s[r]));e.push(i)}return e})}async fit(t,e){return LI(this,t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}async fitDataset(t,e){return RI(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),r=n[0],a=n[1],i=this.makeTrainFunction()(r.concat(a)),o=[];for(const s of i){const t=await s.data();o.push(t[0])}return Bp(i),BI(n[0],t),BI(n[1],e),E_(o)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n);for(let i=0;i<r.length;++i)n&&!r[i].trainable||e.push({name:r[i].originalName,tensor:a[i]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=Lp().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-Lp().numTensors}return t}getLossIdentifiers(){let t;if("string"===typeof this.loss)t=C_(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!==typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(t=>C_(t))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const r of e){if("string"!==typeof n[r])throw new Error("Serialization of non-string loss is not supported.");t[r]=C_(n[r])}}return t}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[C_(dI(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>C_(dI(t)));{const t={};for(const e in this.metrics)t[e]=C_(dI(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=GT(xI(t.optimizer_config));let n,r;if("string"===typeof t.loss)n=A_(t.loss);else if(Array.isArray(t.loss))n=t.loss.map(t=>A_(t));else if(null!=t.loss){n={};for(const e in t.loss)n[e]=A_(t.loss[e])}if(Array.isArray(t.metrics))r=t.metrics.map(t=>A_(t));else if(null!=t.metrics){r={};for(const e in t.metrics)r[e]=A_(t.metrics[e])}this.compile({loss:n,metrics:r,optimizer:e})}async save(t,e){if("string"===typeof t){const e=ef(t);if(0===e.length)throw new w_("Cannot find any save handlers for URL '".concat(t,"'"));if(e.length>1)throw new w_("Found more than one (".concat(e.length,") save handlers for ")+"URL '".concat(t,"'"));t=e[0]}if(null==t.save)throw new w_("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await Bd(this.getNamedWeights(e)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(_I),convertedBy:null};if(null!=e&&e.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:a}=await Bd(await this.optimizer.getWeights(),t);n.specs.push(...a),n.data=Gd([n.data,e])}if(null!=this.userDefinedMetadata){const t=!0;pI(this.userDefinedMetadata,this.name,t),r.userDefinedMetadata=this.userDefinedMetadata}return r.weightData=n.data,r.weightSpecs=n.specs,t.save(r)}setUserDefinedMetadata(t){pI(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}GI.className="Model",Fp(GI);class HI extends GI{}HI.className="Functional",Fp(HI);class qI extends GI{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:q_("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(t=>t<0))throw new w_("Negative dimension size caused by adding layer "+"".concat(t.name," with input shape [")+"".concat(t.inboundNodes[0].inputTensors[0].shape,"]"))}add(t){const e=t instanceof qI||t instanceof GI;let n;if(e){if(n=t,1!==n.outputs.length)throw new w_("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new w_("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new w_("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=function(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new w_("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;return null==n&&(n="float32"),new mT({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new w_("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(t.name," ")+"which has ".concat(t.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new w_("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=pT(this.outputs[0])}this.inboundNodes=[],new hT({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:S_(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(nT(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new GI({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new b_("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new b_("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new b_("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new b_("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e){let n,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new w_("Legacy serialization format not supported yet.");n=e}else ks(null!=e.layers,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),n=e.layers,delete e.layers,a=e;const i=new t(a);if(!(i instanceof qI))throw new x_("Sequential.fromConfig called on non-Sequential input: ".concat(i));for(const o of n){const t=GT(o,void 0,r);r&&t.setFastWeightInitDuringBuild(!0),i.add(t)}return i}set stopTraining(t){if(null==this.model)throw new w_("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new w_("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n.className=e.getClassName(),n.config=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}qI.className="Sequential",Fp(qI);class KI extends Dp{getConfig(){return{}}}class XI extends KI{apply(t){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==e)throw new x_("Support for alpha values other than 1 (".concat(e,") is not implemented ")+"yet.");return pg(t)}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}}XI.className="elu",Fp(XI);class YI extends KI{apply(t){return cv(t)}}YI.className="selu",Fp(YI);class QI extends KI{apply(t){return Zy(t)}}QI.className="relu",Fp(QI);class JI extends KI{apply(t){return zp(()=>wy(6,Zy(t)))}}JI.className="relu6",Fp(JI);class $I extends KI{apply(t){return t}}$I.className="linear",Fp($I);class ZI extends KI{apply(t){return Tm(t)}}ZI.className="sigmoid",Fp(ZI);class tE extends KI{apply(t){return function(t){return zp(()=>{const e=Xp(.5,Sm(.2,t));return Bm(e,0,1)})}(t)}}tE.className="hardSigmoid",Fp(tE);class eE extends KI{apply(t){return ty(t)}}eE.className="softplus",Fp(eE);class nE extends KI{apply(t){return function(t){return zp(()=>sg(t,Xp(Hp(t),1)))}(t)}}nE.className="softsign",Fp(nE);class rE extends KI{apply(t){return Em(t)}}rE.className="tanh",Fp(rE);class aE extends KI{apply(t){return vv(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}aE.className="softmax",Fp(aE);class iE extends KI{apply(t){return ry(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)}}iE.className="logSoftmax",Fp(iE);class oE extends KI{apply(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return zp(()=>Sm(Tm(Sm(t,e)),t))}}oE.className="swish",Fp(oE);class sE extends KI{apply(t){return zp(()=>Sm(t,Em(ty(t))))}}function cE(t){return t.getClassName()}function lE(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return M_(t,Mp.getMap().classNameMap,e,"activation")}function uE(t){if(null==t){const t={className:"linear",config:{}};return lE(t)}if("string"===typeof t){const e={};return e.className=t,e.config={},lE(e)}return t instanceof KI?t:lE(t)}function hE(t){if(null!=t&&"object"!==typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(t))}sE.className="mish",Fp(sE);class dE extends Dp{}class fE extends dE{constructor(t){super(),hE(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return zp(()=>{let e=yy([1]);return this.hasL1&&(e=Xp(e,Cg(Sm(this.l1,Hp(t))))),this.hasL2&&(e=Xp(e,Cg(Sm(this.l2,IS(t))))),bm(e,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}fE.className="L1L2",Fp(fE);const pE={l1l2:"L1L2"};function mE(t){return O_(t)}function gE(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return M_(t,Mp.getMap().classNameMap,e,"regularizer")}function yE(t){if(null==t)return null;if("string"===typeof t){return gE({className:t in pE?pE[t]:t,config:{}})}return t instanceof dE?t:gE(t)}class vE extends fT{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=eT(t);let n=Zy(t);return null!=this.maxValue&&(n=Bm(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}vE.className="ReLU",Fp(vE);class bE extends fT{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=eT(t);return qg(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}bE.className="LeakyReLU",Fp(bE);class wE extends fT{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=$S(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=yE(t.alphaRegularizer),this.alphaConstraint=OT(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!==typeof t.sharedAxes)throw new w_("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(t.sharedAxes));this.sharedAxes=[t.sharedAxes]}}build(t){const e=(t=nT(t)).slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)e[r-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<t.length;++r)n[r]=t[r];this.inputSpec=[new cT({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=eT(t),Ly(t,this.alpha.read())}getConfig(){const t={alphaInitializer:JS(this.alphaInitializer),alphaRegularizer:mE(this.alphaRegularizer),alphaConstraint:AT(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}wE.className="PReLU",Fp(wE);class xE extends fT{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new x_("Non-default alpha value (".concat(t.alpha,") is not supported by the ")+"ELU layer yet.");this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=eT(t);return pg(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}xE.className="ELU",Fp(xE);class kE extends fT{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=eT(t);return Sm(n,zf(jg(n,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}kE.className="ThresholdedReLU",Fp(kE);class _E extends fT{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new aE).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){const n=eT(t);return this.softmax(n,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function SE(t,e,n){if("number"===typeof t)return S_(t,e);if(t.length!==e)throw new w_("The ".concat(n," argument must be an integer or tuple of ").concat(e," integers.")+" Received: ".concat(t.length," elements."));for(let r=0;r<e;++r){const a=t[r];if(!cS(a))throw new w_("The ".concat(n," argument must be an integer or tuple of ").concat(e)+" integers. Received: ".concat(JSON.stringify(t)," including a")+" non-integer number ".concat(a))}return t}function TE(t,e,n,r){if(null==t)return t;let a;return a="same"===n?t:t-(e+(e-1)*((arguments.length>4&&void 0!==arguments[4]?arguments[4]:1)-1))+1,Math.floor((a+r-1)/r)}function IE(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+hS([n-e,0]);else{if("same"!==r)throw new w_("Unsupport padding mode: ".concat(r,"."));t*=e}return t}function EE(t,e){return zp(()=>(Z_(e),"channelsFirst"===e?Hv(t,[0,2,3,1]):t))}function NE(t,e){return zp(()=>(Z_(e),"channelsFirst"===e?Hv(t,[0,2,3,4,1]):t))}function CE(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return zp(()=>{if(null==i&&(i="channelsLast"),Z_(i),3!==t.shape.length)throw new w_("The input of a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead."));if(3!==e.shape.length)throw new w_("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new w_("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(e.shape.length," instead"));if("channelsFirst"===i&&(t=Hv(t,[0,2,1])),"causal"===a)throw new x_("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let s=Hm(t,e,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=NS(s,n)),s})}function AE(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return zp(()=>{if(null==i&&(i="channelsLast"),Z_(i),3!==t.rank&&4!==t.rank)throw new w_("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));if(3!==e.rank&&4!==e.rank)throw new w_("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(t.rank,"."));let c=EE(t,i);if("causal"===a)throw new x_("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=cb({x:c,filter:e,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(c=Hv(c,[0,3,1,2])),c})}function RE(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return zp(()=>{if(null==i&&(i="channelsLast"),Z_(i),4!==t.rank&&5!==t.rank)throw new w_("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(t.rank,"."));if(4!==e.rank&&5!==e.rank)throw new w_("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(t.rank,"."));let s=NE(t,i);if("causal"===a)throw new x_("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=Xm(s,e,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=NS(s,n)),"channelsFirst"===i&&(s=Hv(s,[0,4,1,2,3])),s})}_E.className="Softmax",Fp(_E);class OE extends fT{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",OE.verifyArgs(e),this.rank=t,j_(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new x_("Convolution layer for rank other than 1, 2, or 3 (".concat(this.rank,") is ")+"not implemented yet.");if(this.kernelSize=SE(e.kernelSize,t,"kernelSize"),this.strides=SE(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,tS(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Z_(this.dataFormat),this.activation=uE(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=$S(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=OT(e.biasConstraint),this.biasRegularizer=yE(e.biasRegularizer),this.activityRegularizer=yE(e.activityRegularizer),this.dilationRate=SE(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new w_("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(this.dilationRate)));if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new w_("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new w_("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(this.dilationRate)))}static verifyArgs(t){if(T_("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!==typeof t.kernelSize&&!B_(t.kernelSize,"number",1,3))throw new w_("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(t.kernelSize),"."))}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:cE(this.activation),useBias:this.useBias,biasInitializer:JS(this.biasInitializer),biasRegularizer:mE(this.biasRegularizer),activityRegularizer:mE(this.activityRegularizer),biasConstraint:AT(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class DE extends OE{constructor(t,e){super(t,e),this.kernel=null,DE.verifyArgs(e),this.filters=e.filters,j_(this.filters,"filters"),this.kernelInitializer=$S(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=OT(e.kernelConstraint),this.kernelRegularizer=yE(e.kernelRegularizer)}build(t){t=nT(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new w_("The channel dimension of the input should be defined. "+"Found ".concat(t[e]));const n=t[e],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return zp(()=>{let e;t=eT(t);const n=null==this.bias?null:this.bias.read(),r=V_(this.activation.getClassName());if(null!=r&&2===this.rank)e=AE(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)e=CE(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=AE(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new x_("convolutions greater than 3D are not implemented yet.");e=RE(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e})}computeOutputShape(t){t=nT(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let a=0;a<n.length;++a){const t=TE(n[a],this.kernelSize[a],this.padding,this.strides[a],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[a]);e.push(t)}let r=[t[0]];return"channelsLast"===this.dataFormat?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:JS(this.kernelInitializer),kernelRegularizer:mE(this.kernelRegularizer),kernelConstraint:AT(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!==typeof t.filters||t.filters<1)throw new w_("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(t.filters)))}}class ME extends DE{constructor(t){super(2,t),ME.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!B_(t.kernelSize,"number",1,2))throw new w_("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(t.kernelSize),"."))}}ME.className="Conv2D",Fp(ME);class FE extends DE{constructor(t){super(3,t),FE.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new w_("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(t.kernelSize),"."))}}FE.className="Conv3D",Fp(FE);class PE extends ME{constructor(t){if(super(t),this.inputSpec=[new cT({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new w_("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(t){if(4!==(t=nT(t)).length)throw new w_("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new w_("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new cT({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return zp(()=>{let e=eT(t);if(4!==e.shape.length)throw new w_("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(e.shape.length));const n=e.shape,r=n[0];let a,i;"channelsFirst"===this.dataFormat?(a=2,i=3):(a=1,i=2);const o=n[a],s=n[i],c=this.kernelSize[0],l=this.kernelSize[1],u=this.strides[0],h=this.strides[1],d=[r,IE(o,u,c,this.padding),IE(s,h,l,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=Hv(e,[0,2,3,1]));let f=Km(e,this.kernel.read(),d,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(f=Hv(f,[0,3,1,2])),null!=this.bias&&(f=NS(f,this.bias.read(),this.dataFormat)),null!=this.activation&&(f=this.activation.apply(f)),f})}computeOutputShape(t){const e=(t=nT(t)).slice();let n,r,a;"channelsFirst"===this.dataFormat?(n=1,r=2,a=3):(n=3,r=1,a=2);const i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],c=this.strides[1];return e[n]=this.filters,e[r]=IE(e[r],s,i,this.padding),e[a]=IE(e[a],c,o,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}PE.className="Conv2DTranspose",Fp(PE);class LE extends FE{constructor(t){if(super(t),this.inputSpec=[new cT({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new w_("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(this.padding))}build(t){if(5!==(t=nT(t)).length)throw new w_("Input should have rank 5; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new w_("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new cT({ndim:5,axes:{[e]:n}})],this.built=!0}call(t,e){return zp(()=>{let e=eT(t);if(5!==e.shape.length)throw new w_("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(e.shape.length));const n=e.shape,r=n[0];let a,i,o;"channelsFirst"===this.dataFormat?(o=2,a=3,i=4):(o=1,a=2,i=3);const s=n[o],c=n[a],l=n[i],u=this.kernelSize[0],h=this.kernelSize[1],d=this.kernelSize[2],f=this.strides[0],p=this.strides[1],m=this.strides[2],g=[r,IE(s,f,u,this.padding),IE(c,p,h,this.padding),IE(l,m,d,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=Hv(e,[0,2,3,4,1]));let y=Qm(e,this.kernel.read(),g,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(y=Hv(y,[0,4,1,2,3])),null!==this.bias&&(y=NS(y,this.bias.read(),this.dataFormat)),null!==this.activation&&(y=this.activation.apply(y)),y})}computeOutputShape(t){const e=(t=nT(t)).slice();let n,r,a,i;"channelsFirst"===this.dataFormat?(n=1,r=2,a=3,i=4):(n=4,r=1,a=2,i=3);const o=this.kernelSize[0],s=this.kernelSize[1],c=this.kernelSize[2],l=this.strides[0],u=this.strides[1],h=this.strides[2];return e[n]=this.filters,e[r]=IE(e[r],l,o,this.padding),e[a]=IE(e[a],u,s,this.padding),e[i]=IE(e[i],h,c,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}LE.className="Conv3DTranspose",Fp(LE);class zE extends DE{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new w_("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new w_("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new w_("SeparableConv".concat(this.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(e.padding)));this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=$S(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=yE(e.depthwiseRegularizer),this.depthwiseConstraint=OT(e.depthwiseConstraint),this.pointwiseInitializer=$S(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=yE(e.pointwiseRegularizer),this.pointwiseConstraint=OT(e.pointwiseConstraint)}build(t){if((t=nT(t)).length<this.rank+2)throw new w_("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(t)));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new w_("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(t[e])));const n=t[e],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[];for(let o=0;o<this.rank;++o)a.push(1);a.push(n*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new cT({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return zp(()=>{let e;if(t=eT(t),1===this.rank)throw new x_("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=Hv(t,[0,2,3,1])),e=lv(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=NS(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=Hv(e,[0,3,1,2])),e})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=JS(this.depthwiseInitializer),t.pointwiseInitializer=JS(this.pointwiseInitializer),t.depthwiseRegularizer=mE(this.depthwiseRegularizer),t.pointwiseRegularizer=mE(this.pointwiseRegularizer),t.depthwiseConstraint=AT(this.depthwiseConstraint),t.pointwiseConstraint=AT(this.pointwiseConstraint),t}}zE.className="SeparableConv";class BE extends zE{constructor(t){super(2,t)}}BE.className="SeparableConv2D",Fp(BE);class jE extends DE{constructor(t){super(1,t),jE.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!B_(t.kernelSize,"number",1,1))throw new w_("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(t.kernelSize),"."))}}jE.className="Conv1D",Fp(jE);class UE extends fT{constructor(t){super(t),"number"===typeof t.cropping?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"===typeof t.cropping[0]?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return zp(()=>{if(t=eT(t),"channelsLast"===this.dataFormat){const e=bS(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return bS(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=bS(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return bS(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}UE.className="Cropping2D",Fp(UE);class VE extends fT{constructor(t){var e;super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Z_(this.dataFormat),this.interpolation=null==t.interpolation?"nearest":t.interpolation,e=this.interpolation,z_(X_,"InterpolationFormat",e)}computeOutputShape(t){if("channelsFirst"===this.dataFormat){const e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}{const e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2];return[t[0],e,n,t[3]]}}call(t,e){return zp(()=>{let e=eT(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=Hv(e,[0,2,3,1]);const t=this.size[0]*n[2],r=this.size[1]*n[3],a="nearest"===this.interpolation?uw.resizeNearestNeighbor(e,[t,r]):uw.resizeBilinear(e,[t,r]);return Hv(a,[0,3,1,2])}{const t=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?uw.resizeNearestNeighbor(e,[t,r]):uw.resizeBilinear(e,[t,r])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}}VE.className="UpSampling2D",Fp(VE);class WE extends OE{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=$S(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=OT(t.depthwiseConstraint),this.depthwiseRegularizer=yE(t.depthwiseRegularizer)}build(t){if((t=nT(t)).length<4)throw new w_("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(t),"."));const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new w_("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(t[e],")."));const n=t[e],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return zp(()=>{let e=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return zp(()=>{null==a&&(a="channelsLast"),Z_(a);let o=EE(t,a);if(4!==t.rank)throw new w_("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));if(4!==e.rank)throw new w_("depthwiseKernel is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));return o=rg(o,e,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=Hv(o,[0,3,1,2])),o})}(t=eT(t),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=NS(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e})}computeOutputShape(t){t=nT(t);const e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,a=TE(e,this.kernelSize[0],this.padding,this.strides[0]),i=TE(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],r,a,i]:[t[0],a,i,r]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=JS(this.depthwiseInitializer),t.depthwiseRegularizer=mE(this.depthwiseRegularizer),t.depthwiseConstraint=AT(this.depthwiseRegularizer),t}}function GE(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new w_("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function a(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=a(e),constants:n=a(n)}}function HE(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return zp(()=>{const c=e.shape.length;if(c<3)throw new w_("Input should be at least 3D, but is ".concat(c,"D."));const l=[1,0].concat(dS(2,c));if(e=Hv(e,l),null!=i)throw new x_("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&(a=zf(zf(a,"bool"),"float32"),a.rank===c-1&&(a=Mg(a,-1)),a=Hv(a,l)),r&&(e=ev(e,0),null!=a&&(a=ev(a,0)));const u=[];let h,d=n;const f=e.shape[0],p=Bv(e);let m,g;null!=a&&(m=Bv(a));for(let e=0;e<f;++e){const n=p[e],r=zp(()=>t(n,d));if(null==a)h=r[0],d=r[1];else{const t=zp(()=>{const t=m[e],n=ny(Ny(t),t);return{output:Xp(Sm(r[0],t),Sm(d[0],n)),newStates:d.map((e,a)=>Xp(Sm(r[1][a],t),Sm(e,n)))}});h=t.output,d=t.newStates}s&&u.push(h)}if(s){g=Iv(u,1)}return[h,g,d]})}WE.className="DepthwiseConv2D",Fp(WE);class qE extends fT{constructor(t){let e;if(super(t),null==t.cell)throw new w_("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new tN({cells:t.cell}):t.cell,null==e.stateSize)throw new w_("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new cT({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){return dS(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map(t=>null)}return this.states_}setStates(t){this.states_=t}computeOutputShape(t){ZS(t)&&(t=t[0]);let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let r;if(r=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const r of e)n.push([t[0],r]);return[r].concat(n)}return r}computeMask(t,e){return zp(()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map(t=>null);return[t].concat(e)}return t})}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){if(null!=this.numConstants)throw new x_("Constants support is not implemented in RNN yet.");ZS(t)&&(t=t[0]);const e=this.stateful?t[0]:null,n=t.slice(2);this.inputSpec[0]=new cT({shape:[e,null,...n]});const r=[t[0]].concat(t.slice(2));let a;if(this.cell.build(r),a=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!Es(this.stateSpec.map(t=>t.shape[t.shape.length-1]),a))throw new w_("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=a.map(t=>new cT({shape:[null,t]}));this.stateful&&this.resetStates()}resetStates(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];zp(()=>{if(!this.stateful)throw new v_("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new w_("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>yy([n,t])):this.states_=[yy([n,this.cell.stateSize])];else if(null==t)Bp(this.states_),null!=this.keptStates&&(Bp(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>yy([n,t])):this.states_[0]=yy([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new w_("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));!0===e?this.keptStates.push(this.states_.slice()):Bp(this.states_);for(let e=0;e<this.states_.length;++e){const r=t[e],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,i=[n,a];if(!Es(r.shape,i))throw new w_("State ".concat(e," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(i,", received shape=").concat(r.shape));this.states_[e]=r}}this.states_=this.states_.map(t=>jp(t.clone()))})}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const a=GE(t,n,r,this.numConstants);t=a.inputs,n=a.initialState,r=a.constants;let i=[],o=[];if(null!=n){e.initialState=n,i=i.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new cT({shape:t.shape}));o=o.concat(this.stateSpec)}null!=r&&(e.constants=r,i=i.concat(r),this.numConstants=r.length);if(i[0]instanceof lT){const n=[t].concat(i),r=this.inputSpec.concat(o),a=this.inputSpec;this.inputSpec=r;const s=super.apply(n,e);return this.inputSpec=a,s}return super.apply(t,e)}call(t,e){return zp(()=>{const n=null==e?null:e.mask,r=null==e?null:e.training;let a=null==e?null:e.initialState;t=eT(t),null==a&&(a=this.stateful?this.states_:this.getInitialState(t));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new w_("RNN Layer has ".concat(i," state(s) but was passed ")+"".concat(a.length," initial state(s)."));this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},s=HE((t,e)=>{const n=this.cell.call([t].concat(e),o);return[n[0],n.slice(1)]},t,a,this.goBackwards,n,null,this.unroll,this.returnSequences),c=s[0],l=s[1],u=s[2];this.stateful&&this.resetStates(u,r);const h=this.returnSequences?l:c;return this.returnState?[h].concat(u):h})}getInitialState(t){return zp(()=>{let e=yy(t.shape);return e=Cg(e,[1,2]),e=gS(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(t=>t>1?kS(e,[1,t]):e):this.cell.stateSize>1?[kS(e,[1,this.cell.stateSize])]:[e]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===qE.className&&(e.cell={className:this.cell.getClassName(),config:n}),Object.assign({},n,t,e)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=GT(e.cell,n);return new t(Object.assign(e,{cell:r}))}}qE.className="RNN",Fp(qE);class KE extends fT{}class XE extends KE{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,j_(this.units,"units"),this.activation=uE(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=$S(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=$S(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=$S(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=yE(t.kernelRegularizer),this.recurrentRegularizer=yE(t.recurrentRegularizer),this.biasRegularizer=yE(t.biasRegularizer),this.kernelConstraint=OT(t.kernelConstraint),this.recurrentConstraint=OT(t.recurrentConstraint),this.biasConstraint=OT(t.biasConstraint),this.dropout=uS([1,hS([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=uS([1,hS([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=nT(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return zp(()=>{if(2!==t.length)throw new w_("SimpleRNNCell expects 2 input Tensors, got ".concat(t.length,"."));let n=t[1];t=t[0];const r=null!=e.training&&e.training;let a;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=eN({ones:()=>Ny(t),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=eN({ones:()=>Ny(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;a=SS(null!=i?Sm(t,i):t,this.kernel.read()),null!=this.bias&&(a=NS(a,this.bias.read())),null!=o&&(n=Sm(n,o));let s=Xp(a,SS(n,this.recurrentKernel.read()));return null!=this.activation&&(s=this.activation.apply(s)),[s,s]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:cE(this.activation),useBias:this.useBias,kernelInitializer:JS(this.kernelInitializer),recurrentInitializer:JS(this.recurrentInitializer),biasInitializer:JS(this.biasInitializer),kernelRegularizer:mE(this.kernelRegularizer),recurrentRegularizer:mE(this.recurrentRegularizer),biasRegularizer:mE(this.biasRegularizer),activityRegularizer:mE(this.activityRegularizer),kernelConstraint:AT(this.kernelConstraint),recurrentConstraint:AT(this.recurrentConstraint),biasConstraint:AT(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},t,e)}}XE.className="SimpleRNNCell",Fp(XE);class YE extends qE{constructor(t){t.cell=new XE(t),super(t)}call(t,e){return zp(()=>{null!=this.cell.dropoutMask&&(Bp(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Bp(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,a=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:a})})}static fromConfig(t,e){return new t(e)}}YE.className="SimpleRNN",Fp(YE);class QE extends KE{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new w_("GRUCell does not support reset_after parameter set to true.");this.units=t.units,j_(this.units,"units"),this.activation=uE(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=uE(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=$S(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=$S(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=$S(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=yE(t.kernelRegularizer),this.recurrentRegularizer=yE(t.recurrentRegularizer),this.biasRegularizer=yE(t.biasRegularizer),this.kernelConstraint=OT(t.kernelConstraint),this.recurrentConstraint=OT(t.recurrentConstraint),this.biasConstraint=OT(t.biasConstraint),this.dropout=uS([1,hS([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=uS([1,hS([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){const e=(t=nT(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return zp(()=>{if(2!==t.length)throw new w_("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));const n=null!=e.training&&e.training;let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=eN({ones:()=>Ny(t),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=eN({ones:()=>Ny(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let o,s,c;0<this.dropout&&this.dropout<1&&(t=Sm(t,a[0]));let l=SS(t,this.kernel.read());this.useBias&&(l=NS(l,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Sm(r,i[0]));const u=this.recurrentKernel.read(),[h,d]=kv(u,[2*this.units,this.units],u.rank-1),f=SS(r,h),[p,m,g]=kv(l,3,l.rank-1),[y,v]=kv(f,2,f.rank-1);o=this.recurrentActivation.apply(Xp(p,y)),s=this.recurrentActivation.apply(Xp(m,v));const b=SS(Sm(s,r),d);c=this.activation.apply(Xp(g,b));const w=Xp(Sm(o,r),Sm(Xp(1,Zg(o)),c));return[w,w]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:cE(this.activation),recurrentActivation:cE(this.recurrentActivation),useBias:this.useBias,kernelInitializer:JS(this.kernelInitializer),recurrentInitializer:JS(this.recurrentInitializer),biasInitializer:JS(this.biasInitializer),kernelRegularizer:mE(this.kernelRegularizer),recurrentRegularizer:mE(this.recurrentRegularizer),biasRegularizer:mE(this.biasRegularizer),activityRegularizer:mE(this.activityRegularizer),kernelConstraint:AT(this.kernelConstraint),recurrentConstraint:AT(this.recurrentConstraint),biasConstraint:AT(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},t,e)}}QE.className="GRUCell",Fp(QE);class JE extends qE{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new QE(t),super(t)}call(t,e){return zp(()=>{null!=this.cell.dropoutMask&&(Bp(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Bp(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,a=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:a})})}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}JE.className="GRU",Fp(JE);class $E extends KE{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,j_(this.units,"units"),this.activation=uE(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=uE(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=$S(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=$S(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=$S(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=yE(t.kernelRegularizer),this.recurrentRegularizer=yE(t.recurrentRegularizer),this.biasRegularizer=yE(t.biasRegularizer),this.kernelConstraint=OT(t.kernelConstraint),this.recurrentConstraint=OT(t.recurrentConstraint),this.biasConstraint=OT(t.biasConstraint),this.dropout=uS([1,hS([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=uS([1,hS([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;const n=(t=nT(t))[t.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,n=this.units;r=new((e=class extends DS{apply(e,r){const a=t.apply([n]),i=(new FS).apply([n]),o=t.apply([2*n]);return xS(xS(a,i),o)}}).className="CustomInit",e)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return zp(()=>{const n=null!=e.training&&e.training;if(3!==t.length)throw new w_("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));let r=t[1];const a=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=eN({ones:()=>Ny(t),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=eN({ones:()=>Ny(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let s,c,l,u;0<this.dropout&&this.dropout<1&&(t=Sm(t,i[0]));let h=SS(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=Sm(r,o[0])),h=Xp(h,SS(r,this.recurrentKernel.read())),this.useBias&&(h=NS(h,this.bias.read()));const[d,f,p,m]=kv(h,4,h.rank-1);s=this.recurrentActivation.apply(d),c=this.recurrentActivation.apply(f),l=Xp(Sm(c,a),Sm(s,this.activation.apply(p))),u=this.recurrentActivation.apply(m);const g=Sm(u,this.activation.apply(l));return[g,g,l]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:cE(this.activation),recurrentActivation:cE(this.recurrentActivation),useBias:this.useBias,kernelInitializer:JS(this.kernelInitializer),recurrentInitializer:JS(this.recurrentInitializer),biasInitializer:JS(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:mE(this.kernelRegularizer),recurrentRegularizer:mE(this.recurrentRegularizer),biasRegularizer:mE(this.biasRegularizer),activityRegularizer:mE(this.activityRegularizer),kernelConstraint:AT(this.kernelConstraint),recurrentConstraint:AT(this.recurrentConstraint),biasConstraint:AT(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},t,e)}}$E.className="LSTMCell",Fp($E);class ZE extends qE{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new $E(t),super(t)}call(t,e){return zp(()=>{null!=this.cell.dropoutMask&&(Bp(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Bp(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,a=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:a})})}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}ZE.className="LSTM",Fp(ZE);class tN extends KE{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return zp(()=>{let n=t.slice(1);const r=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?r.push(n.splice(0,t.stateSize.length)):r.push(n.splice(0,1));r.reverse();const a=[];let i;for(let o=0;o<this.cells.length;++o){const s=this.cells[o];n=r[o],i=0===o?[t[0]].concat(n):[i[0]].concat(n),i=s.call(i,e),a.push(i.slice(1))}n=[];for(const t of a.slice().reverse())n.push(...t);return[i[0]].concat(n)})}build(t){let e;ZS(t)&&(t=t[0]),this.cells.forEach((n,r)=>{rS("RNNCell_".concat(r),()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]})}),this.built=!0}getConfig(){const t=super.getConfig(),e={cells:this.cells.map(t=>({className:t.getClassName(),config:t.getConfig()}))};return Object.assign({},t,e)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[];for(const a of e.cells)r.push(GT(a,n));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return oT(t)}setWeights(t){const e=[];for(const n of this.cells){const r=n.weights.length,a=t.splice(r);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],a[t]])}sT(e)}}function eN(t){const{ones:e,rate:n,training:r=!1,count:a=1,dropoutFunc:i}=t,o=()=>null!=i?i(e(),n):CS(e(),n),s=()=>AS(o,e,r);if(!a||a<=1)return jp(s().clone());return Array(a).fill(void 0).map(s).map(t=>jp(t.clone()))}tN.className="StackedRNNCells",Fp(tN);var nN=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]])}return n};class rN extends qE{constructor(t){if(t.unroll)throw new x_("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new x_("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new cT({ndim:5})]}call(t,e){return zp(()=>{if(null!=this.cell.dropoutMask&&(Bp(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(Bp(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e.constants)throw new w_("ConvRNN2D cell does not support constants");const n=null==e?null:e.mask,r=null==e?null:e.training,a=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:a})})}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return zp(()=>{const{stateSize:e}=this.cell,n=t.shape,r=this.computeSingleOutputShape(n),a=yy([r[0],...r.slice(2)]);return Array.isArray(e)?Array(e.length).fill(a):[a]})}resetStates(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];zp(()=>{if(!this.stateful)throw new v_("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)];if(null==n[0])throw new w_("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>yy(a)):this.states_=[yy(a)];else if(null==t)Bp(this.states_),null!=this.keptStates&&(Bp(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>yy(a)):this.states_[0]=yy(a);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new w_("Layer ".concat(this.name," expects ").concat(this.states_.length," state(s), ")+"but it received ".concat(t.length," state value(s). Input ")+"received: ".concat(t));e?this.keptStates.push(this.states_.slice()):Bp(this.states_);for(let e=0;e<this.states_.length;++e){const n=t[e],r=a;if(!Es(n.shape,r))throw new w_("State ".concat(e," is incompatible with layer ").concat(this.name,": ")+"expected shape=".concat(r,", received shape=").concat(n.shape));this.states_[e]=n}}this.states_=this.states_.map(t=>jp(t.clone()))})}computeSingleOutputShape(t){const{dataFormat:e,filters:n,kernelSize:r,padding:a,strides:i,dilationRate:o}=this.cell,s="channelsFirst"===e,c=t[s?3:2],l=t[s?4:3],u=TE(c,r[0],a,i[0],o[0]),h=TE(l,r[1],a,i[1],o[1]);return[...t.slice(0,2),...s?[n,u,h]:[u,h,n]]}}rN.className="ConvRNN2D";class aN extends $E{constructor(t){const{filters:e,kernelSize:n,strides:r,padding:a,dataFormat:i,dilationRate:o}=t;super(Object.assign({},t,{units:e})),this.filters=e,j_(this.filters,"filters"),this.kernelSize=SE(n,2,"kernelSize"),this.kernelSize.forEach(t=>j_(t,"kernelSize")),this.strides=SE(r||1,2,"strides"),this.strides.forEach(t=>j_(t,"strides")),this.padding=a||"valid",tS(this.padding),this.dataFormat=i||"channelsLast",Z_(this.dataFormat),this.dilationRate=SE(o||1,2,"dilationRate"),this.dilationRate.forEach(t=>j_(t,"dilationRate"))}build(t){var e;t=nT(t);const n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new w_("The channel dimension of the input should be defined. "+"Found ".concat(t[n]));const r=t[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let t;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;t=new((e=class extends DS{apply(t,e){return wS([n.apply([r]),vy([r]),n.apply([2*r])])}}).className="CustomInit",e)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,t,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return zp(()=>{if(3!==t.length)throw new w_("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(t.length,"."));const n=e.training||!1,r=t[0],a=t[1],i=t[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=eN({ones:()=>Ny(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,s=(t,e,n)=>e&&e[n]?Sm(e[n],t):t;let c=s(r,o,0),l=s(r,o,1),u=s(r,o,2),h=s(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=eN({ones:()=>Ny(a),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const d=this.recurrentDropoutMask;let f=s(a,d,0),p=s(a,d,1),m=s(a,d,2),g=s(a,d,3);const[y,v,b,w]=kv(this.kernel.read(),4,3),[x,k,_,S]=this.useBias?kv(this.bias.read(),4):[null,null,null,null];c=this.inputConv(c,y,x,this.padding),l=this.inputConv(l,v,k,this.padding),u=this.inputConv(u,b,_,this.padding),h=this.inputConv(h,w,S,this.padding);const[T,I,E,N]=kv(this.recurrentKernel.read(),4,3);f=this.recurrentConv(f,T),p=this.recurrentConv(p,I),m=this.recurrentConv(m,E),g=this.recurrentConv(g,N);const C=this.recurrentActivation.apply(Xp(c,f)),A=this.recurrentActivation.apply(Xp(l,p)),R=Xp(Sm(A,i),Sm(C,this.activation.apply(Xp(u,m)))),O=Sm(this.recurrentActivation.apply(Xp(h,g)),this.activation.apply(R));return[O,O,R]})}getConfig(){const t=super.getConfig(),{units:e}=t,n=nN(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},n,r)}inputConv(t,e,n,r){const a=Gm(t,e,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?NS(a,n,this.dataFormat):a}recurrentConv(t,e){return Gm(t,e,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}aN.className="ConvLSTM2DCell",Fp(aN);class iN extends rN{constructor(t){const e=new aN(t);super(Object.assign({},t,{cell:e}))}static fromConfig(t,e){return new t(e)}}iN.className="ConvLSTM2D",Fp(iN);class oN extends fT{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n}call(t,e){return zp(()=>{this.invokeCallHook(t,e);const n=eT(t);if(0<this.rate&&this.rate<1){const t=null!=e.training&&e.training,r=this.getNoiseShape(n);return AS(()=>CS(n,this.rate,r,this.seed),()=>n,t)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}oN.className="Dropout",Fp(oN);class sN extends oN{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}sN.className="SpatialDropout1D",Fp(sN);class cN extends fT{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,j_(this.units,"units"),this.activation=uE(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=$S(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=$S(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=OT(t.kernelConstraint),this.biasConstraint=OT(t.biasConstraint),this.kernelRegularizer=yE(t.kernelRegularizer),this.biasRegularizer=yE(t.biasRegularizer),this.activityRegularizer=yE(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){const e=(t=nT(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){const e=(t=nT(t)).slice();return e[e.length-1]=this.units,e}call(t,e){return zp(()=>{this.invokeCallHook(t,e);const n=eT(t),r=V_(this.activation.getClassName());let a;return null!=r?a=SS(n,this.kernel.read(),r,this.bias?this.bias.read():null):(a=SS(n,this.kernel.read()),null!=this.bias&&(a=NS(a,this.bias.read())),null!=this.activation&&(a=this.activation.apply(a))),a})}getConfig(){const t={units:this.units,activation:cE(this.activation),useBias:this.useBias,kernelInitializer:JS(this.kernelInitializer),biasInitializer:JS(this.biasInitializer),kernelRegularizer:mE(this.kernelRegularizer),biasRegularizer:mE(this.biasRegularizer),activityRegularizer:mE(this.activityRegularizer),kernelConstraint:AT(this.kernelConstraint),biasConstraint:AT(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}cN.className="Dense",Fp(cN);class lN extends fT{constructor(t){super(t=t||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=nT(t);for(const e of t.slice(1))if(null==e)throw new w_('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(t.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],lS(t,1)]}call(t,e){return zp(()=>{this.invokeCallHook(t,e);let n=eT(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=Hv(n,t)}return function(t){if(t.rank<=1)throw new w_("batchFlatten requires a minimum rank of 2. Got rank: ".concat(t.rank,"."));const e=[t.shape[0],lS(t.shape,1)];return bm(t,e)}(n)})}getConfig(){const t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}lN.className="Flatten",Fp(lN);class uN extends fT{constructor(t){super(t),this.supportsMasking=!0,this.activation=uE(t.activation)}call(t,e){return zp(()=>{this.invokeCallHook(t,e);const n=eT(t);return this.activation.apply(n)})}getConfig(){const t={activation:cE(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}uN.className="Activation",Fp(uN);class hN extends fT{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return zp(()=>function(t,e){return zp(()=>{if(2!==t.shape.length)throw new w_("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return kS(gS(t,1),[1,e,1])})}(t=eT(t),this.n))}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}hN.className="RepeatVector",Fp(hN);class dN extends fT{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",r=e.slice();let a=1,i=null;for(let s=0;s<r.length;++s){const t=r[s];if(this.isUnknown(t)){if(null!==i)throw new w_("Can only specifiy one unknown dimension.");i=s}else a*=t}const o=lS(t);if(null!==i){if(0===a||o%a!==0)throw new w_(n);r[i]=o/a}else if(o!==a)throw new w_(n);return r}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return zp(()=>{this.invokeCallHook(t,e);const n=eT(t),r=n.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return bm(n,a)})}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}dN.className="Reshape",Fp(dN);class fN extends fT{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(t.dims," instead."));const e=dS(1,t.dims.length+1);if(!Es(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new cT({ndim:this.dims.length+1})]}computeOutputShape(t){const e=(t=nT(t)).slice();return this.dims.forEach((n,r)=>{e[r+1]=t[n]}),e}call(t,e){return Hv(eT(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}fN.className="Permute",Fp(fN);class pN extends fT{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=eT(t);return Jp(Iy(n,this.maskValue),-1)}call(t,e){return zp(()=>{this.invokeCallHook(t,e);const n=eT(t),r=Jp(Iy(n,this.maskValue),-1,!0);return Sm(n,zf(r,n.dtype))})}}pN.className="Masking",Fp(pN);class mN extends fT{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),null==t.inputLength?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(N_(t.inputLength))}this.inputDim=t.inputDim,j_(this.inputDim,"inputDim"),this.outputDim=t.outputDim,j_(this.outputDim,"outputDim"),this.embeddingsInitializer=$S(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=yE(t.embeddingsRegularizer),this.activityRegularizer=yE(t.activityRegularizer),this.embeddingsConstraint=OT(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return zp(()=>this.maskZero?(t=eT(t),Iy(t,ug(t))):null)}computeOutputShape(t){if(t=nT(t),null==this.inputLength)return[...t,this.outputDim];const e=N_(this.inputLength);if(e.length!==t.length-1)throw new w_('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));{let n=0;for(let r=0;r<e.length;++r){const a=e[r],i=t[r+1];if(null!=a&&null!=i&&a!==i)throw new w_('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(t));null==a&&(e[n]=i),n++}}return[t[0],...e,this.outputDim]}call(t,e){return zp(()=>{this.invokeCallHook(t,e);let n=eT(t);"int32"!==n.dtype&&(n=mS(n,"int32"));const r=TS(this.embeddings.read(),bm(n,[n.size]));return bm(r,nT(this.computeOutputShape(n.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:JS(this.embeddingsInitializer),embeddingsRegularizer:mE(this.embeddingsRegularizer),activityRegularizer:mE(this.activityRegularizer),embeddingsConstraint:AT(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}mN.className="Embedding",Fp(mN);class gN extends fT{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new x_}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const a=t[t.length-e.length+r],i=e[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new w_("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(a)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[nT(t)]),t.length<2)throw new w_("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(t.length," input(s)."));let e=[];for(const a of t)null!=a&&null!==a[0]&&e.push(a[0]);if(e=P_(e),e.length>1)throw new w_("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(t),"."));let n=null==t[0]?null:t[0].slice(1);for(let a=1;a<t.length;++a){const e=null==t[a]?null:t[a].slice(1);n=this.computeElementwiseOpOutputShape(n,e)}const r=t.map(t=>t.length);-1===t.indexOf(null)&&1===P_(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return zp(()=>{if(this.reshapeRequired){const e=[],n=t.map(t=>t.rank);if(-1===n.indexOf(null)){const r=hS(n);for(let n of t){const t=n.rank;for(let e=0;e<r-t;++e)n=gS(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const i of t){const t=i.rank;if(null==t){const t=i.shape,r=t[0],a=t.slice(1).concat([r]);let o=bm(i,[r].concat(lS(t.slice(1))));o=Hv(o,[1,0]),o=bm(o,a),e.push(o),n=!0}else if(t>1){const r=dS(1,t).concat([0]);e.push(Hv(i,r)),n=!0}else e.push(i)}let r=this.mergeFunction(e);const a=r.rank;if(n)if(null==a){const t=r.shape,e=t[t.length-1],n=[e].concat(t.slice(0,t.length-1));r=bm(Hv(bm(r,[-1,e]),[1,0]),n)}else if(a>1){const t=[a-1].concat(dS(0,a-1));r=Hv(r,t)}return r}}return this.mergeFunction(t)})}computeOutputShape(t){let e;e=null==t[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const n=null==t[r]?null:t[r].slice(1);e=this.computeElementwiseOpOutputShape(e,n)}let n=[];for(const r of t)null!=r&&null!==r[0]&&n.push(r[0]);return n=P_(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return zp(()=>{if(null==e)return null;if(!Array.isArray(e))throw new w_("`mask` should be an Array");if(!Array.isArray(t))throw new w_("`inputs` should be an Array");if(e.length!==t.length)throw new w_("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(t.length," vs ").concat(e.length,")"));if(e.every(t=>null==t))return null;let n=(e=e.map(t=>null==t?t:Mg(t,0)))[0];for(let t=1;t<e.length-1;++t)n=iy(n,e[t]);return n})}}class yN extends gN{constructor(t){super(t)}mergeFunction(t){return zp(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=Xp(e,t[n]);return e})}}yN.className="Add",Fp(yN);class vN extends gN{constructor(t){super(t)}mergeFunction(t){return zp(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=Sm(e,t[n]);return e})}}vN.className="Multiply",Fp(vN);class bN extends gN{constructor(t){super(t)}mergeFunction(t){return zp(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=Xp(e,t[n]);return Sm(1/t.length,e)})}}bN.className="Average",Fp(bN);class wN extends gN{constructor(t){super(t)}mergeFunction(t){return zp(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=my(e,t[n]);return e})}}wN.className="Maximum",Fp(wN);class xN extends gN{constructor(t){super(t)}mergeFunction(t){return zp(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=wy(e,t[n]);return e})}}xN.className="Minimum",Fp(xN);class kN extends gN{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new w_("A `Concatenate` layer should be called on a list of at least 2 inputs");let e=!0;for(const r of t)if(null!=r){e=!1;break}if(e)return;const n=[];for(let r=0;r<t.length;++r){const e=t[r].slice();e.splice(this.axis,1);let a=!1;for(const t of n)if(Es(t,e)){a=!0;break}a||n.push(e)}if(n.length>1)throw new w_("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return zp(()=>wS(t,this.axis))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new w_("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const a of e.slice(1)){if(null==n[r]||null==a[r]){n[r]=null;break}n[r]+=a[r]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new w_("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new w_("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new w_("Mismatch in the length of mask (".concat(e.length,") ")+"and the legnth of inputs (".concat(t.length,")"));return zp(()=>{let n=!0;if(e.forEach(t=>{null==t||(n=!1)}),n)return null;const r=[];for(let i=0;i<t.length;++i)null==e[i]?r.push(zf(Ny(t[i]),"bool")):e[i].rank<t[i].rank?r.push(Mg(e[i],-1)):r.push(e[i]);const a=km(r,this.axis);return Qp(a,-1,!1)})}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function _N(t,e){for(;t<0;)t+=e;return t}kN.className="Concatenate",Fp(kN);class SN extends gN{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){ks(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new x_("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new w_("Dimension incompatibility: "+"".concat(e[r[0]]," !== ").concat(n[r[1]]))}mergeFunction(t){if(2!==t.length)throw new w_("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(t.length," input(s)."));let e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map((e,n)=>_N(e,t[n].shape.length)):[_N(this.axes,n.shape.length),_N(this.axes,r.shape.length)],this.normalize&&(n=HT(n,e[0]),r=HT(r,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new x_("batchDot is not implemented for tensors of 4D or higher rank yet");if(ks(t.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, "+"but got ".concat(t.shape.length)),ks(t.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, "+"but got ".concat(e.shape.length)),"number"===typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new x_("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,a=e.shape.length;null==n&&(n=[r-1,a-2]);const i=n;return zp(()=>{let n,o;if(r>a){n=r-a;const t=[];for(let e=0;e<n;++e)t.push(1);e=bm(e,e.shape.concat(t))}else if(a>r){n=a-r;const e=[];for(let t=0;t<n;++t)e.push(1);t=bm(t,t.shape.concat(e))}else n=0;if(2===t.shape.length&&2===e.shape.length)o=i[0]===i[1]?Cg(Sm(t,e),i[0]):Cg(Sm(Hv(t,[1,0]),e),i[1]);else{const n=i[0]!==t.shape.length-1,r=i[1]===e.shape.length-1;o=_m(t,e,n,r)}if(n>0){let t;t=r>a?r+a-3:r-1;const e=[];for(let r=t;r<t+n;++r)e.push(r);o=Tv(o,e)}return 1===o.shape.length&&(o=Mg(o,1)),o})}(n,r,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[_N(this.axes,t.length),_N(this.axes,e.length)],n}computeOutputShape(t){ks(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new x_("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const a=e.concat(n);return 1===a.length&&a.push(1),a}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}SN.className="Dot",Fp(SN);class TN extends fT{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return zp(()=>{this.invokeCallHook(t,e);const n=eT(t);return AS(()=>Xp(_S(n.shape,0,this.stddev),n),()=>n,e.training||!1)})}}TN.className="GaussianNoise",Fp(TN);class IN extends fT{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return zp(()=>{this.invokeCallHook(t,e);const n=eT(t);if(this.rate>0&&this.rate<1){return AS(()=>{const t=Math.sqrt(this.rate/(1-this.rate));return Sm(n,_S(n.shape,1,t))},()=>n,e.training||!1)}return n})}}IN.className="GaussianDropout",Fp(IN);class EN extends fT{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||eT(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return zp(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t),r=()=>{const e=eT(t),r=-1.7580993408473766;let a=Ug(Yy(n),this.rate);a=mS(a,"float32");const i=((1-this.rate)*(1+this.rate*r**2))**-.5,o=-i*r*this.rate,s=Xp(Sm(e,a),Sm(Xp(a,-1),r));return Xp(Sm(s,i),o)};return AS(r,()=>eT(t),e.training||!1)}return t})}}function NN(t,e,n,r,a){let i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===t.rank)i=Rm(t,e,n,r,a,o);else if(3===t.rank)i=Om(t,e,n,r,a,o);else{if(4!==t.rank)throw new x_("batchNormalization is not implemented for array of rank ".concat(t.rank," ")+"yet");i=Dm(t,e,n,r,a,o)}return i}function CN(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Es(r.slice().sort(),dS(0,t.rank-1))?function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return zp(()=>{const i=_y(t,r),o=i.mean,s=i.variance;return[NN(t,o,s,n,e,a),o,s]})}(t,e,n,r,a):function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return zp(()=>{const i=_y(t,r),o=i.mean,s=i.variance,c=[];for(const e of dS(0,t.rank))-1!==r.indexOf(e)?c.push(1):c.push(t.shape[e]);const l=bm(o,c),u=bm(s,c),h=null==e?null:bm(e,c),d=null==n?null:bm(n,c);return[NN(t,l,u,d,h,a),o,s]})}(t,e,n,r,a)}EN.className="AlphaDropout",Fp(EN);class AN extends fT{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=$S(t.betaInitializer||"zeros"),this.gammaInitializer=$S(t.gammaInitializer||"ones"),this.movingMeanInitializer=$S(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=$S(t.movingVarianceInitializer||"ones"),this.betaConstraint=OT(t.betaConstraint),this.gammaConstraint=OT(t.gammaConstraint),this.betaRegularizer=yE(t.betaRegularizer),this.gammaRegularizer=yE(t.gammaRegularizer)}build(t){t=nT(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new w_("Axis ".concat(e," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(t),"."));this.inputSpec=[new cT({ndim:t.length,axes:{[e]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return zp(()=>{const n=null!=e.training&&e.training,r=eT(t),a=r.shape,i=a.length,o=dS(0,i),s=this.axis>=0?this.axis:this.axis+i;o.splice(s,1);const c=S_(1,i);c[s]=a[s];const l=o.slice();l.sort();const u=!Es(l,dS(0,i).slice(0,i-1));if(!n)return(()=>{if(u){const t=bm(this.movingMean.read(),c),e=bm(this.movingVariance.read(),c),n=this.center?bm(this.beta.read(),c):null,a=this.scale?bm(this.gamma.read(),c):null;return NN(r,t,e,n,a,this.epsilon)}return NN(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[h,d,f]=CN(r,this.gamma.read(),this.beta.read(),o,this.epsilon),p=(t,e,n)=>{zp(()=>{const r=1-n,a=t.read(),i=Sm(ny(a,e),r);t.write(ny(a,i))})};return(()=>{p(this.movingMean,d,this.momentum),p(this.movingVariance,f,this.momentum)})(),h})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:JS(this.betaInitializer),gammaInitializer:JS(this.gammaInitializer),movingMeanInitializer:JS(this.movingMeanInitializer),movingVarianceInitializer:JS(this.movingVarianceInitializer),betaRegularizer:mE(this.betaRegularizer),gammaRegularizer:mE(this.gammaRegularizer),betaConstraint:AT(this.betaConstraint),gammaConstraint:AT(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}AN.className="BatchNormalization",Fp(AN);class RN extends fT{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received ".concat(this.axis))}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(this.axis)));for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(this.axis)))}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=$S(t.betaInitializer||"zeros"),this.gammaInitializer=$S(t.gammaInitializer||"ones"),this.betaRegularizer=yE(t.betaRegularizer),this.gammaRegularizer=yE(t.gammaRegularizer),this.supportsMasking=!0}build(t){const e=(t=nT(t)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=e);for(const a of this.axis)if(a<0||a>=e)throw new Error("Invalid axis: ".concat(a));if(this.axis.length!==P_(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));const n=this.axis.map(e=>t[e]),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(t,e){const n=eT(t),r=n.shape,a=r.length;return zp(()=>{let{mean:t,variance:e}=_y(n,this.axis,!0);const i=S_(1,a);for(const n of this.axis)i[n]=r[n];const o=t=>null!=t&&t.shape.length!==a?bm(t,i):t;let s=this.scale?o(this.gamma.read()):null,c=this.center?o(this.beta.read()):null;const l=[],u=[];for(let n=0;n<a;++n)-1!==this.axis.indexOf(n)?(l.push(r[n]),u.push(1)):(l.push(1),u.push(r[n]));return t=Pg(t,l),e=Pg(e,l),null!=s&&(s=Pg(s,u)),null!=c&&(c=Pg(c,u)),NN(n,t,e,c,s,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:JS(this.betaInitializer),gammaInitializer:JS(this.gammaInitializer),betaRegularizer:mE(this.betaRegularizer),gammaRegularizer:mE(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}RN.className="LayerNormalization",Fp(RN);class ON extends fT{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new w_("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(t.padding.length," array."));let e,n;if("number"===typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new w_("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(t.padding[0].length," array."));if(e=t.padding[0],2!==t.padding[1].length)throw new w_("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(t.padding[1].length," array."));n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new cT({ndim:4})]}computeOutputShape(t){let e,n;return t=nT(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return zp(()=>function(t,e,n){return zp(()=>{if(4!==t.rank)throw new w_("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==e&&(e=[[1,1],[1,1]]),2!==e.length||2!==e[0].length||2!==e[1].length)throw new w_("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new w_("Unknown data format: ".concat(n,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");let r;return r="channelsFirst"===n?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]],Ay(t,r)})}(eT(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}function DN(t,e,n,r,a,i){return zp(()=>{let o;Z_(a),eS(i),tS(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),t=EE(t,a);const s="same"===r?"same":"valid";return o="max"===i?dy(t,e,n,s):wm(t,e,n,s),"channelsFirst"===a&&(o=Hv(o,[0,3,1,2])),o})}function MN(t,e,n,r,a,i){return zp(()=>{let o;Z_(a),eS(i),tS(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),t=NE(t,a);const s="same"===r?"same":"valid";return o="max"===i?fy(t,e,n,s):xm(t,e,n,s),"channelsFirst"===a&&(o=Hv(o,[0,4,1,2,3])),o})}ON.className="ZeroPadding2D",Fp(ON);class FN extends fT{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"===typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!==typeof t.poolSize[0])throw new w_("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(t.poolSize)));this.poolSize=t.poolSize}if(j_(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"===typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!==typeof t.strides[0])throw new w_("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(t.strides)));this.strides=t.strides}j_(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,tS(this.padding),this.inputSpec=[new cT({ndim:3})]}computeOutputShape(t){const e=TE((t=nT(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return zp(()=>{this.invokeCallHook(t,e),t=gS(eT(t),2);const n=this.poolingFunction(eT(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Tv(n,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class PN extends FN{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return Z_(a),tS(r),DN(t,e,n,r,a,"max")}}PN.className="MaxPooling1D",Fp(PN);class LN extends FN{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return Z_(a),tS(r),DN(t,e,n,r,a,"avg")}}LN.className="AveragePooling1D",Fp(LN);class zN extends fT{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new w_("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(t.strides.length,"."));this.strides=t.strides}else this.strides=[t.strides,t.strides];j_(this.poolSize,"poolSize"),j_(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Z_(this.dataFormat),tS(this.padding),this.inputSpec=[new cT({ndim:4})]}computeOutputShape(t){t=nT(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=TE(e,this.poolSize[0],this.padding,this.strides[0]),n=TE(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return zp(()=>(this.invokeCallHook(t,e),this.poolingFunction(eT(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class BN extends zN{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return Z_(a),tS(r),DN(t,e,n,r,a,"max")}}BN.className="MaxPooling2D",Fp(BN);class jN extends zN{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return Z_(a),tS(r),DN(t,e,n,r,a,"avg")}}jN.className="AveragePooling2D",Fp(jN);class UN extends fT{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new w_("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(t.strides.length,"."));this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];j_(this.poolSize,"poolSize"),j_(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Z_(this.dataFormat),tS(this.padding),this.inputSpec=[new cT({ndim:5})]}computeOutputShape(t){t=nT(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=TE(e,this.poolSize[0],this.padding,this.strides[0]),n=TE(n,this.poolSize[1],this.padding,this.strides[1]),r=TE(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]}call(t,e){return zp(()=>(this.invokeCallHook(t,e),this.poolingFunction(eT(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class VN extends UN{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return Z_(a),tS(r),MN(t,e,n,r,a,"max")}}VN.className="MaxPooling3D",Fp(VN);class WN extends UN{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return Z_(a),tS(r),MN(t,e,n,r,a,"avg")}}WN.className="AveragePooling3D",Fp(WN);class GN extends fT{constructor(t){super(t),this.inputSpec=[new cT({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new x_}}class HN extends GN{constructor(t){super(t||{})}call(t,e){return zp(()=>{const e=eT(t);return gy(e,1)})}}HN.className="GlobalAveragePooling1D",Fp(HN);class qN extends GN{constructor(t){super(t||{})}call(t,e){return zp(()=>{const e=eT(t);return Sg(e,1)})}}qN.className="GlobalMaxPooling1D",Fp(qN);class KN extends fT{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,Z_(this.dataFormat),this.inputSpec=[new cT({ndim:4})]}computeOutputShape(t){return"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new x_}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class XN extends KN{call(t,e){return zp(()=>{const e=eT(t);return"channelsLast"===this.dataFormat?gy(e,[1,2]):gy(e,[2,3])})}}XN.className="GlobalAveragePooling2D",Fp(XN);class YN extends KN{call(t,e){return zp(()=>{const e=eT(t);return"channelsLast"===this.dataFormat?Sg(e,[1,2]):Sg(e,[2,3])})}}YN.className="GlobalMaxPooling2D",Fp(YN);class QN extends fT{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=GT(e.layer,n);delete e.layer;const a={layer:r};return Object.assign(a,e),new t(a)}}class JN extends QN{constructor(t){super(t),this.supportsMasking=!0}build(t){if((t=nT(t)).length<3)throw new w_("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(t)));this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){const e=[(t=nT(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e),r=t[1];return[n[0],r].concat(n.slice(1))}call(t,e){return zp(()=>HE((t,n)=>[eT(this.layer.call(t,e)),[]],t=eT(t),[],!1,null,null,!1,!0)[1])}}JN.className="TimeDistributed",Fp(JN);class $N extends QN{constructor(t){super(t);const e=t.layer.getConfig(),n={};n.className=t.layer.getClassName(),n.config=e,this.forwardLayer=GT(n),e.goBackwards=!0!==e.goBackwards;const r={};var a;if(r.className=t.layer.getClassName(),r.config=e,this.backwardLayer=GT(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,a=this.mergeMode,z_(J_,"BidirectionalMergeMode",a),t.weights)throw new x_("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,n=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,n)),this.backwardLayer.setWeights(t.slice(n))}computeOutputShape(t){let e,n,r,a=this.forwardLayer.computeOutputShape(t);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),e=a[0]):e=a[0],"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):E_(n)}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const a=GE(t,n,r,this.numConstants);if(t=a.inputs,n=a.initialState,r=a.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==r)return super.apply(t,e);const i=[],o=[];if(null!=n){const t=n.length;if(t%2>0)throw new w_("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=n,i.push(...n);const r=n.map(t=>new cT({shape:t.shape}));this.forwardLayer.stateSpec=r.slice(0,t/2),this.backwardLayer.stateSpec=r.slice(t/2),o.push(...r)}if(null!=r)throw new x_("Support for constants in Bidirectional layers is not implemented yet.");const s=i[0]instanceof lT;for(const c of i)if(c instanceof lT!==s)throw new w_("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(s){const n=[t].concat(i),r=this.inputSpec.concat(o),a=this.inputSpec;this.inputSpec=r;const s=super.apply(n,e);return this.inputSpec=a,s}return super.apply(t,e)}call(t,e){return zp(()=>{const n=e.initialState;let r,a,i,o;if(null==n)r=this.forwardLayer.call(t,e),a=this.backwardLayer.call(t,e);else{const i=n.slice(0,n.length/2),o=n.slice(n.length/2);r=this.forwardLayer.call(t,Object.assign(e,{initialState:i})),a=this.backwardLayer.call(t,Object.assign(e,{initialState:o}))}return this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=ev(a,1)),"concat"===this.mergeMode?o=wS([r,a]):"sum"===this.mergeMode?o=Xp(r,a):"ave"===this.mergeMode?o=Sm(.5,Xp(r,a)):"mul"===this.mergeMode?o=Sm(r,a):null==this.mergeMode&&(o=[r,a]),this.returnState?null==this.mergeMode?o.concat(i):[o].concat(i):o})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){rS(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),rS(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states.map(t=>null);return Array.isArray(n)?n.concat(t).concat(t):[n].concat(t).concat(t)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=GT(e.layer);if(delete e.layer,null!=e.numConstants)throw new x_("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r.layer=n,new t(r)}}$N.className="Bidirectional",Fp($N);class ZN extends fT{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return zp(()=>("float32"!==(t=eT(t)).dtype&&(t=mS(t,"float32")),Xp(Sm(t,this.scale),this.offset)))}}ZN.className="Rescaling",Fp(ZN);var tC,eC;ac().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")}),function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"}(tC||(tC={})),function(t){let e;!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(eC||(eC={}));const nC={};function rC(t){return nC[t]}function aC(t,e,n,r,a){const i=e.inputParams[t];if(i&&void 0!==i.inputIndexStart){const t=i.inputIndexStart,o=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?t+1:i.inputIndexEnd;if("tensor"===i.type)return iC(e.inputNames[i.inputIndexStart],n,r,a);if("tensors"===i.type){return e.inputNames.slice(t,o).map(t=>iC(t,n,r,a))}const s=iC(e.inputNames.slice(t)[0],n,r,a),c=s.dataSync();return"number"===i.type?c[0]:Ks(s.shape,c)}const o=e.attrParams[t];return o&&o.value}function iC(t,e,n,r){const[a,i]=cC(t);if(null!=r){const t=r.getHashTableHandleByName(a);if(null!=t)return t}const o=n.currentContextIds.find(t=>!!e[sC(a,t)]);return void 0!==o?e[sC(a,o)][i]:void 0}function oC(t,e){const[n,r,a]=cC(t);return[sC(n,e&&e.currentContextId),r,a]}function sC(t,e){return e?"".concat(t,"-").concat(e):t}function cC(t){const e=t.split(":");if(1===e.length)return[t,0,void 0];const n=e[0],r=3===e.length?e[1]:void 0;return[n,Number(e[e.length-1]),r]}function lC(t,e,n){let r=aC("pad",t,e,n);if("explicit"===r){r=aC("explicitPaddings",t,e,n);const a=[[0,0],[0,0],[0,0],[0,0]];for(let t=0;t<4;t++)a[t][0]=r[2*t],a[t][1]=r[2*t+1];return a}return r}function uC(t){return t.kept?t:Bf(t)}const hC=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],dC=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],fC=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],pC=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],mC=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],gC=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],yC=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],vC=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],bC=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],wC=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],xC=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],kC=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],_C=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],SC=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],TC=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],IC=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],EC=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],NC=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],CC=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class AC{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[].concat(...[s,c,l,u,h,d,f,p,m,g,y,v,b,w,x,k,_,S,T].map(t=>t.json));this.opMappers=t.reduce((t,e)=>(t[e.tfOpName]=e,t),{})}transformGraph(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t.node,r=[],a=[],i=[],o=n.reduce((t,e)=>(t[e.name]=this.mapNode(e),e.op.startsWith("Placeholder")?r.push(t[e.name]):"Const"===e.op?a.push(t[e.name]):null!=e.input&&0!==e.input.length||i.push(t[e.name]),t),{});let s=[];const c=[];let l={},u={};null!=e&&(l=this.mapSignatureEntries(e.inputs),u=this.mapSignatureEntries(e.outputs));const h=Object.keys(o);h.forEach(t=>{const e=o[t];e.inputNames.forEach((t,n)=>{const[r,,a]=oC(t),i=o[r];if(null!=i.outputs){const t=i.outputs.indexOf(a);if(-1!==t){const a="".concat(r,":").concat(t);e.inputNames[n]=a}}e.inputs.push(i),i.children.push(e)})}),0===Object.keys(u).length?h.forEach(t=>{const e=o[t];0===e.children.length&&c.push(e)}):Object.keys(u).forEach(t=>{const[e]=oC(t),n=o[e];null!=n&&(n.signatureKey=u[t],c.push(n))}),Object.keys(l).length>0?Object.keys(l).forEach(t=>{const[e]=oC(t),n=o[e];n&&(n.signatureKey=l[t],s.push(n))}):s=r;let d={};null!=t.library&&null!=t.library.function&&(d=t.library.function.reduce((t,e)=>(t[e.signature.name]=this.mapFunction(e),t),{}));const f={nodes:o,inputs:s,outputs:c,weights:a,placeholders:r,signature:e,functions:d};return i.length>0&&(f.initNodes=i),f}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,n)=>(e[t[n].name]=n,e),{})}mapNode(t){const e=rC(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});const n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(t=>t.startsWith("^")?t.slice(1):t),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:e.outputs};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((t,e)=>(t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((e,n)=>{const r=n.type;let a;switch(n.type){case"string":a=OC(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=OC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":a=VC(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=VC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":a=MC(t.attr,n.tfName,n.defaultValue||0),void 0===a&&n.tfDeprecatedName&&(a=MC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":a=UC(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=UC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":a=DC(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=DC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":a=GC(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=GC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":a=jC(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=jC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":a=WC(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=WC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":a=LC(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=LC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":a=zC(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=zC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":a=PC(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=PC(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(t.op))}return e[n.name]={value:a,type:r},e},{})),n}mapFunction(t){const e=t.nodeDef,n=[];let r={};null!=e&&(r=e.reduce((t,e)=>(t[e.name]=this.mapNode(e),"Const"===e.op&&n.push(t[e.name]),t),{}));const a=[],i=[];t.signature.inputArg.forEach(t=>{const[e]=oC(t.name),n={name:e,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:FC(t.type),type:"dtype"}},children:[]};n.signatureKey=t.name,a.push(n),r[e]=n});Object.keys(r).forEach(t=>{const e=r[t];e.inputNames.forEach((t,n)=>{const[a,,i]=oC(t),o=r[a];if(null!=o.outputs){const t=o.outputs.indexOf(i);if(-1!==t){const r="".concat(a,":").concat(t);e.inputNames[n]=r}}e.inputs.push(o),o.children.push(e)})});const o=t.ret;t.signature.outputArg.forEach(t=>{const[e,n]=oC(o[t.name]),a=r[e];null!=a&&(a.defaultOutput=n,i.push(a))});const s=this.mapArgsToSignature(t);return{nodes:r,inputs:a,outputs:i,weights:n,placeholders:[],signature:s}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((t,e)=>(t[e.name]=this.mapArgToTensorInfo(e),t),{}),outputs:t.signature.outputArg.reduce((e,n)=>(e[n.name]=this.mapArgToTensorInfo(n,t.ret),e),{})}}mapArgToTensorInfo(t,e){let n=t.name;return null!=e&&(n=e[n]),{name:n,dtype:t.type}}}function RC(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){const e=ac().global;if("undefined"!==typeof e.atob)return e.atob(t);if("undefined"!==typeof Buffer)return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return e?n:n.toLowerCase()}function OC(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=t[e];return null!=a?RC(a.s,r):n}function DC(t,e,n){const r=t[e];return r?r.b:n}function MC(t,e,n){const r=t[e]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function FC(t){switch("string"===typeof t&&(t=tC[t]),t){case tC.DT_FLOAT:case tC.DT_HALF:return"float32";case tC.DT_INT32:case tC.DT_INT64:case tC.DT_INT8:case tC.DT_UINT8:return"int32";case tC.DT_BOOL:return"bool";case tC.DT_DOUBLE:return"float32";case tC.DT_STRING:return"string";default:return null}}function PC(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function LC(t,e,n){const r=t[e];return r&&r.type?FC(r.type):n}function zC(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(t=>FC(t)):n}function BC(t){if(!t.unknownRank)return null!=t.dim?t.dim.map(t=>"number"===typeof t.size?t.size:parseInt(t.size,10)):[]}function jC(t,e,n){const r=t[e];return r&&r.shape?BC(r.shape):n}function UC(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(t=>"number"===typeof t?t:parseInt(t,10)):n}function VC(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=t[e];return a&&a.list&&a.list.s?a.list.s.map(t=>RC(t,r)):n}function WC(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(t=>BC(t)):n}function GC(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}class HC{constructor(t,e,n){this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(t=>this.getInput(t)),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((t,e)=>(t[e]=this.getAttr(e),t),{}))}getInput(t){return iC(t,this.tensorMap,this.context)}getAttr(t,e){const n=this.node.rawAttrs[t];if(null!=n.tensor)return iC(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return MC(this.node.rawAttrs,t,e);if(null!=n.s)return OC(this.node.rawAttrs,t,e);if(null!=n.b)return DC(this.node.rawAttrs,t,e);if(null!=n.shape)return jC(this.node.rawAttrs,t,e);if(null!=n.type)return LC(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return UC(this.node.rawAttrs,t,e);if(null!=n.list.s)return VC(this.node.rawAttrs,t,e);if(null!=n.list.shape)return WC(this.node.rawAttrs,t,e);if(null!=n.list.b)return GC(this.node.rawAttrs,t,e);if(null!=n.list.type)return zC(this.node.rawAttrs,t,e)}return e}}function qC(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof t&&"number"!==typeof e){ks(t.length===e.length,()=>n+" Shapes ".concat(t," and ").concat(e," must match"));for(let r=0;r<t.length;r++){const a=t[r],i=e[r];ks(a<0||i<0||a===i,()=>n+" Shapes ".concat(t," and ").concat(e," must match"))}}}function KC(t){return"number"!==typeof t&&!t.some(t=>t<0)}function XC(t,e,n){let r=YC(t,n);const a=!KC(r);if(a&&0===e.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&e.forEach(t=>{r=YC(t.shape,r)}),!KC(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function YC(t,e){if("number"===typeof t)return e;if("number"===typeof e)return t;if(t.length!==e.length)throw new Error("Incompatible ranks during merge: ".concat(t," vs. ").concat(e));const n=[];for(let r=0;r<t.length;++r){const a=t[r],i=e[r];if(a>=0&&i>=0&&a!==i)throw new Error("Incompatible shape during merge: ".concat(t," vs. ").concat(e));n[r]=a>=0?a:i}return n}class QC{constructor(t,e,n,r,a,i,o){this.name=t,this.dtype=e,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=Wp(0),jp(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(e=>{null!=t&&t.has(e.tensor.id)||e.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||t>=this.size())throw new Error("Tried to read from index ".concat(t,", but array size is: ").concat(this.size()));const e=this.tensors[t];if(e.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(t," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(t=>this.read(t))}write(t,e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index ".concat(t,", but array is not resizeable and size is: ").concat(this.maxSize));const n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,",\n          because the value dtype is ").concat(e.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),qC(this.elementShape,e.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(t,", because it has already been written."));n.tensor=e,jp(e),n.written=!0,this.tensors[t]=n}writeMany(t,e){if(t.length!==e.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(t.length," is not the same as tensors size: ").concat(e.length,"."));t.forEach((t,n)=>this.write(t,e[n]))}gather(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(e));if(t)t=t.slice(0,this.size());else{t=[];for(let e=0;e<this.size();e++)t.push(e)}if(0===t.length)return Pd([],[0].concat(this.elementShape));const n=this.readMany(t);return qC(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Iv(n,0)}concat(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(t));if(0===this.size())return Pd([],[0].concat(this.elementShape));const e=[];for(let r=0;r<this.size();r++)e.push(r);const n=this.readMany(e);return qC(this.elementShape,n[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(n[0].shape,")")),km(n,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));const n=Math.max(...t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(t,Bv(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(e.dtype));let n=0;const r=t.map(t=>(n+=t,n));if(n!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(n,", and tensor's shape is: ").concat(e.shape));if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(t.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");const a=0===n?0:e.size/n,i=[];zp(()=>{e=bm(e,[1,n,a]);for(let n=0;n<t.length;++n){const o=[0,0===n?0:r[n-1],0],s=[1,t[n],a];i[n]=bm(Im(e,o,s),this.elementShape)}return i});const o=[];for(let s=0;s<t.length;s++)o[s]=s;this.writeMany(o,i)}}class JC{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;this.tensors=t,this.elementShape=e,this.elementDtype=n,null!=t&&t.forEach(t=>{if(n!==t.dtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(t.dtype));qC(e,t.shape,"TensorList shape mismatch: "),jp(t)}),this.idTensor=Wp(0),this.maxNumElements=r,jp(this.idTensor)}get id(){return this.idTensor.id}copy(){return new JC([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(e=>{null!=t&&t.has(e.id)||e.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(-1!==n&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));qC(t,this.elementShape,"TensorList shape mismatch: ");const r=XC(this.elementShape,this.tensors,t);return zp(()=>{const t=this.tensors.map(t=>bm(t,r));return Iv(t,0)})}popBack(t,e){if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=XC(this.elementShape,this.tensors,t),r=this.tensors.pop();return r.kept=!1,qC(r.shape,t,"TensorList shape mismatch: "),bm(r,n)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(qC(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");jp(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(t));if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error("TensorListResize input size ".concat(t," is greater maxNumElement ").concat(this.maxNumElements,"."));const e=new JC([],this.elementShape,this.elementDtype,this.maxNumElements);e.tensors.length=t;for(let n=0;n<Math.min(this.tensors.length,t);++n)e.tensors[n]=this.tensors[n];return e}getItem(t,e,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(t<0||t>this.tensors.length)throw new Error("Trying to access element ".concat(t," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[t])throw new Error("element at index ".concat(t," is null."));qC(this.tensors[t].shape,e,"TensorList shape mismatch: ");const r=XC(this.elementShape,this.tensors,e);return bm(this.tensors[t],r)}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error("Trying to set element ".concat(t," in a list with max ").concat(this.maxNumElements," elements."));qC(this.elementShape,e.shape,"TensorList shape mismatch: "),jp(e),null!=this.tensors[t]&&(this.tensors[t].kept=!1),this.tensors[t]=e}gather(t,e,n){if(e!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e,", but list elements ").concat(this.elementDtype));qC(this.elementShape,n,"TensorList shape mismatch: "),t=t.slice(0,this.size());const r=XC(this.elementShape,this.tensors,n);return 0===t.length?Pd([],[0].concat(r)):zp(()=>{const e=t.map(t=>bm(this.tensors[t],r));return Iv(e,0)})}concat(t,e){if(t&&t!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(t));qC(this.elementShape,e,"TensorList shape mismatch: ");const n=XC(this.elementShape,this.tensors,e);return 0===this.size()?Pd([],[0].concat(n)):zp(()=>{const t=this.tensors.map(t=>bm(t,n));return km(t,0)})}}const $C=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=aC("thenBranch",t,e,n),a=aC("elseBranch",t,e,n),i=aC("cond",t,e,n),o=aC("args",t,e,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=aC("body",t,e,n),a=aC("cond",t,e,n),i=aC("args",t,e,n),o=await n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),s=i.map(t=>t.id);let c=await o[0].data();o.forEach(t=>{t.kept||-1!==s.indexOf(t.id)||t.dispose()});let l=i;for(;c[0];){const t=l;l=await n.functionMap[r].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);const e=l.map(t=>t.id);t.forEach(t=>{t.kept||-1!==s.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()});const i=await n.functionMap[a].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);c=await i[0].data(),i.forEach(t=>{t.kept||-1!==s.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()})}return l}case"LoopCond":return[uC(aC("pred",t,e,n))];case"Switch":{const r=aC("pred",t,e,n);let a=aC("data",t,e,n);return a.kept||(a=uC(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const r=t.inputNames.find(t=>void 0!==iC(t,e,n));if(r){return[uC(iC(r,e,n))]}return}case"Enter":{const r=aC("frameName",t,e,n),a=aC("tensor",t,e,n);return n.enterFrame(r),[uC(a)]}case"Exit":{const r=aC("tensor",t,e,n);return n.exitFrame(),[uC(r)]}case"NextIteration":{const r=aC("tensor",t,e,n);return n.nextIteration(),[uC(r)]}case"TensorArrayV3":{const r=aC("size",t,e,n),a=aC("dtype",t,e,n),i=aC("elementShape",t,e,n),o=aC("dynamicSize",t,e,n),s=aC("clearAfterRead",t,e,n),c=aC("identicalElementShapes",t,e,n),l=aC("name",t,e,n),u=new QC(l,a,r,i,c,o,s);return n.addTensorArray(u),[u.idTensor,Wp(1)]}case"TensorArrayWriteV3":{const r=aC("tensorArrayId",t,e,n),a=aC("index",t,e,n),i=aC("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(a,i),[o.idTensor]}case"TensorArrayReadV3":{const r=aC("tensorArrayId",t,e,n),a=aC("index",t,e,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{const r=aC("tensorArrayId",t,e,n),a=aC("indices",t,e,n),i=aC("dtype",t,e,n);return[n.getTensorArray(r.id).gather(a,i)]}case"TensorArrayScatterV3":{const r=aC("tensorArrayId",t,e,n),a=aC("indices",t,e,n),i=aC("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(a,i),[o.idTensor]}case"TensorArrayConcatV3":{const r=aC("tensorArrayId",t,e,n),a=n.getTensorArray(r.id),i=aC("dtype",t,e,n);return[a.concat(i)]}case"TensorArraySplitV3":{const r=aC("tensorArrayId",t,e,n),a=aC("tensor",t,e,n),i=aC("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(i,a),[o.idTensor]}case"TensorArraySizeV3":{const r=aC("tensorArrayId",t,e,n);return[Wp(n.getTensorArray(r.id).size(),"int32")]}case"TensorArrayCloseV3":{const r=aC("tensorArrayId",t,e,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const r=aC("tensorListId",t,e,n),a=aC("index",t,e,n),i=aC("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(a,i),[o.idTensor]}case"TensorListGetItem":{const r=aC("tensorListId",t,e,n),a=aC("index",t,e,n),i=aC("elementShape",t,e,n),o=aC("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(a,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=aC("indices",t,e,n),a=function(t,e,n,r){if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));const a=Math.max(...e);if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));const i=new JC([],n,t.dtype,r),o=Bv(t,0);return e.forEach((t,e)=>{i.setItem(t,o[e])}),i}(aC("tensor",t,e,n),r,aC("elementShape",t,e,n),aC("numElements",t,e,n));return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=aC("elementShape",t,e,n),a=aC("elementDType",t,e,n);let i;i="TensorListReserve"===t.op?"numElements":"maxNumElements";const o=aC(i,t,e,n),s=function(t,e,n,r){return new JC([],t,e,r)}(r,a,0,"TensorListReserve"===t.op?-1:o);return n.addTensorList(s),[s.idTensor]}case"TensorListGather":{const r=aC("tensorListId",t,e,n),a=aC("indices",t,e,n),i=aC("elementShape",t,e,n),o=aC("elementDType",t,e,n);return[n.getTensorList(r.id).gather(a,o,i)]}case"TensorListStack":{const r=aC("tensorListId",t,e,n),a=aC("elementShape",t,e,n),i=aC("elementDType",t,e,n),o=aC("numElements",t,e,n);return[n.getTensorList(r.id).stack(a,i,o)]}case"TensorListFromTensor":{const r=function(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(t.shape));if(t.dtype!==n)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(n));qC(t.shape.slice(1),e,"TensorList shape mismatch: ");const a=Bv(t);return new JC(a,e,r)}(aC("tensor",t,e,n),aC("elementShape",t,e,n),aC("elementDType",t,e,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=aC("tensorListId",t,e,n),a=n.getTensorList(r.id),i=aC("dtype",t,e,n),o=aC("elementShape",t,e,n);return[a.concat(i,o)]}case"TensorListPushBack":{const r=aC("tensorListId",t,e,n),a=aC("tensor",t,e,n),i=n.getTensorList(r.id);return i.pushBack(a),[i.idTensor]}case"TensorListPopBack":{const r=aC("tensorListId",t,e,n),a=aC("elementShape",t,e,n),i=aC("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(a,i)]}case"TensorListSplit":{const r=aC("tensor",t,e,n),a=aC("elementShape",t,e,n),i=function(t,e,n){let r=0;const a=e.map(t=>(r+=t,r));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));const i=YC(t.shape.slice(1),n),o=0===r?0:t.size/r,s=zp(()=>{const n=[];t=bm(t,[1,r,o]);for(let r=0;r<e.length;++r){const s=[0,0===r?0:a[r-1],0],c=[1,e[r],o];n[r]=bm(Im(t,s,c),i)}return t.dispose(),n}),c=new JC([],n,t.dtype,e.length);for(let l=0;l<s.length;l++)c.setItem(l,s[l]);return c}(r,aC("lengths",t,e,n),a);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{const r=aC("tensorListId",t,e,n);return[Wp(n.getTensorList(r.id).size(),"int32")]}case"TensorListResize":{const r=aC("tensorListId",t,e,n),a=aC("size",t,e,n),i=n.getTensorList(r.id).resize(a);return n.addTensorList(i),[i.idTensor]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}};function ZC(t,e,n){const[r,a]=aC("fusedOps",t,e,n),i="biasadd"===r,o=!i,s="prelu"===a,c="fusedbatchnorm"===r,l=aC("numArgs",t,e,n);if(i){if(s&&2!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&i&&1!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=aC("strides",t,e,n),h=lC(t,e,n),d=aC("dataFormat",t,e,n).toUpperCase(),f=aC("dilations",t,e,n);let[p,m]=aC("args",t,e,n);o&&(m=p,p=void 0);return{stride:u,pad:h,dataFormat:d,dilations:f,biasArg:p,preluArg:m,activationFunc:a,leakyreluAlpha:aC("leakyreluAlpha",t,e,n)}}function tA(t,e,n){return{boxes:aC("boxes",t,e,n),scores:aC("scores",t,e,n),maxOutputSize:aC("maxOutputSize",t,e,n),iouThreshold:aC("iouThreshold",t,e,n),scoreThreshold:aC("scoreThreshold",t,e,n),softNmsSigma:aC("softNmsSigma",t,e,n)}}class eA{constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=Wp(0),this.tensorMap=new Map,jp(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Wp(this.size(),"int32")}async import(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),zp(()=>{const t=Bv(e),r=n.length,a=t.length;ks(r===a,()=>"The number of elements doesn't match, keys has "+"".concat(r," elements, the values has ").concat(a," ")+"elements.");for(let e=0;e<r;e++){const r=n[e],a=t[e];jp(a),this.tensorMap.set(r,a)}return this.handle})}async find(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return zp(()=>{const t=[];for(let r=0;r<n.length;r++){const a=n[r],i=this.findWithDefault(a,e);t.push(i)}return Iv(t)})}findWithDefault(t,e){const n=this.tensorMap.get(t);return null!=n?n:e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(t.dtype));if(e.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(e.dtype))}}function nA(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:zp;const i=((t,e,n)=>{switch(t.category){case"arithmetic":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(aC("a",t,e,n),aC("b",t,e,n))];case"AddN":return[r.addN(aC("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(aC("a",t,e,n),aC("b",t,e,n))];case"Mul":return[r.mul(aC("a",t,e,n),aC("b",t,e,n))];case"RealDiv":case"Div":return[r.div(aC("a",t,e,n),aC("b",t,e,n))];case"DivNoNan":return[r.divNoNan(aC("a",t,e,n),aC("b",t,e,n))];case"FloorDiv":return[r.floorDiv(aC("a",t,e,n),aC("b",t,e,n))];case"Sub":return[r.sub(aC("a",t,e,n),aC("b",t,e,n))];case"Minimum":return[r.minimum(aC("a",t,e,n),aC("b",t,e,n))];case"Maximum":return[r.maximum(aC("a",t,e,n),aC("b",t,e,n))];case"Pow":return[r.pow(aC("a",t,e,n),aC("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(aC("a",t,e,n),aC("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"basic_math":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(aC("x",t,e,n))];case"Acos":return[r.acos(aC("x",t,e,n))];case"Acosh":return[r.acosh(aC("x",t,e,n))];case"Asin":return[r.asin(aC("x",t,e,n))];case"Asinh":return[r.asinh(aC("x",t,e,n))];case"Atan":return[r.atan(aC("x",t,e,n))];case"Atan2":return[r.atan2(aC("x",t,e,n),aC("y",t,e,n))];case"Atanh":return[r.atanh(aC("x",t,e,n))];case"Ceil":return[r.ceil(aC("x",t,e,n))];case"Complex":return[r.complex(aC("real",t,e,n),aC("imag",t,e,n))];case"Cos":return[r.cos(aC("x",t,e,n))];case"Cosh":return[r.cosh(aC("x",t,e,n))];case"Elu":return[r.elu(aC("x",t,e,n))];case"Erf":return[r.erf(aC("x",t,e,n))];case"Exp":return[r.exp(aC("x",t,e,n))];case"Expm1":return[r.expm1(aC("x",t,e,n))];case"Floor":return[r.floor(aC("x",t,e,n))];case"Log":return[r.log(aC("x",t,e,n))];case"Log1p":return[r.log1p(aC("x",t,e,n))];case"Imag":return[r.imag(aC("x",t,e,n))];case"Neg":return[r.neg(aC("x",t,e,n))];case"Reciprocal":return[r.reciprocal(aC("x",t,e,n))];case"Real":return[r.real(aC("x",t,e,n))];case"Relu":return[r.relu(aC("x",t,e,n))];case"Round":return[r.round(aC("x",t,e,n))];case"Selu":return[r.selu(aC("x",t,e,n))];case"Sigmoid":return[r.sigmoid(aC("x",t,e,n))];case"Sin":return[r.sin(aC("x",t,e,n))];case"Sign":return[r.sign(aC("x",t,e,n))];case"Sinh":return[r.sinh(aC("x",t,e,n))];case"Softplus":return[r.softplus(aC("x",t,e,n))];case"Sqrt":return[r.sqrt(aC("x",t,e,n))];case"Square":return[r.square(aC("x",t,e,n))];case"Tanh":return[r.tanh(aC("x",t,e,n))];case"Tan":return[r.tan(aC("x",t,e,n))];case"ClipByValue":return[r.clipByValue(aC("x",t,e,n),aC("clipValueMin",t,e,n),aC("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(aC("x",t,e,n))];case"Rsqrt":return[r.rsqrt(iC(t.inputNames[0],e,n))];case"Prod":return[r.prod(aC("x",t,e,n),aC("axes",t,e,n))];case"LeakyRelu":return[r.leakyRelu(aC("x",t,e,n),aC("alpha",t,e,n))];case"Prelu":return[r.prelu(aC("x",t,e,n),aC("alpha",t,e,n))];case"IsNan":return[r.isNaN(iC(t.inputNames[0],e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"control":return $C(t,e,n);case"convolution":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"Conv1D":{const a=aC("stride",t,e,n),i=aC("pad",t,e,n),o=aC("dataFormat",t,e,n).toUpperCase(),s=aC("dilation",t,e,n);return[r.conv1d(aC("x",t,e,n),aC("filter",t,e,n),a,i,o,s)]}case"Conv2D":{const a=aC("strides",t,e,n),i=lC(t,e,n),o=aC("dataFormat",t,e,n).toUpperCase(),s=aC("dilations",t,e,n);return[r.conv2d(aC("x",t,e,n),aC("filter",t,e,n),[a[1],a[2]],i,o,[s[1],s[2]])]}case"_FusedConv2D":{const{stride:a,pad:i,dataFormat:o,dilations:s,biasArg:c,preluArg:l,activationFunc:u,leakyreluAlpha:h}=ZC(t,e,n);return[r.fused.conv2d({x:aC("x",t,e,n),filter:aC("filter",t,e,n),strides:[a[1],a[2]],pad:i,dataFormat:o,dilations:[s[1],s[2]],bias:c,activation:u,preluActivationWeights:l,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:i,dataFormat:o,dilations:s,biasArg:c,preluArg:l,activationFunc:u,leakyreluAlpha:h}=ZC(t,e,n);return[r.fused.depthwiseConv2d({x:aC("x",t,e,n),filter:aC("filter",t,e,n),strides:[a[1],a[2]],pad:i,dataFormat:o,dilations:[s[1],s[2]],bias:c,activation:u,preluActivationWeights:l,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=aC("outputShape",t,e,n),i=aC("strides",t,e,n),o=lC(t,e,n);return[r.conv2dTranspose(aC("x",t,e,n),aC("filter",t,e,n),a,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=aC("strides",t,e,n),i=lC(t,e,n),o=aC("dilations",t,e,n),s=aC("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(aC("input",t,e,n),aC("filter",t,e,n),[a[1],a[2]],i,s,[o[1],o[2]])]}case"Conv3D":{const a=aC("strides",t,e,n),i=aC("pad",t,e,n),o=aC("dataFormat",t,e,n).toUpperCase(),s=aC("dilations",t,e,n);return[r.conv3d(aC("x",t,e,n),aC("filter",t,e,n),[a[1],a[2],a[3]],i,o,[s[1],s[2],s[3]])]}case"AvgPool":{const a=aC("strides",t,e,n),i=aC("pad",t,e,n),o=aC("kernelSize",t,e,n);return[r.avgPool(aC("x",t,e,n),[o[1],o[2]],[a[1],a[2]],i)]}case"MaxPool":{const a=aC("strides",t,e,n),i=aC("pad",t,e,n),o=aC("kernelSize",t,e,n);return[r.maxPool(aC("x",t,e,n),[o[1],o[2]],[a[1],a[2]],i)]}case"MaxPoolWithArgmax":{const a=aC("strides",t,e,n),i=aC("pad",t,e,n),o=aC("kernelSize",t,e,n),s=aC("includeBatchInIndex",t,e,n),{result:c,indexes:l}=r.maxPoolWithArgmax(aC("x",t,e,n),[o[1],o[2]],[a[1],a[2]],i,s);return[c,l]}case"AvgPool3D":{const a=aC("strides",t,e,n),i=aC("pad",t,e,n),o=aC("kernelSize",t,e,n);return[r.avgPool3d(aC("x",t,e,n),[o[1],o[2],o[3]],[a[1],a[2],a[3]],i)]}case"MaxPool3D":{const a=aC("strides",t,e,n),i=aC("pad",t,e,n),o=aC("kernelSize",t,e,n);return[r.maxPool3d(aC("x",t,e,n),[o[1],o[2],o[3]],[a[1],a[2],a[3]],i)]}case"Dilation2D":{const a=aC("strides",t,e,n),i=aC("pad",t,e,n),o=aC("dilations",t,e,n),s=a[1],c=a[2],l=o[1],u=o[2];return[r.dilation2d(aC("x",t,e,n),aC("filter",t,e,n),[s,c],i,[l,u],"NHWC")]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"creation":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"Fill":{const a=aC("shape",t,e,n),i=aC("dtype",t,e,n),o=aC("value",t,e,n);return[r.fill(a,o,i)]}case"LinSpace":{const a=aC("start",t,e,n),i=aC("stop",t,e,n),o=aC("num",t,e,n);return[r.linspace(a,i,o)]}case"Multinomial":{const a=aC("logits",t,e,n),i=aC("numSamples",t,e,n),o=aC("seed",t,e,n);return[r.multinomial(a,i,o)]}case"OneHot":{const a=aC("indices",t,e,n),i=aC("depth",t,e,n),o=aC("onValue",t,e,n),s=aC("offValue",t,e,n),c=aC("dtype",t,e,n);return[r.oneHot(a,i,o,s,c)]}case"Ones":return[r.ones(aC("shape",t,e,n),aC("dtype",t,e,n))];case"OnesLike":return[r.onesLike(aC("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(aC("shape",t,e,n),aC("dtype",t,e,n),aC("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(aC("shape",t,e,n),aC("minval",t,e,n),aC("maxval",t,e,n),aC("dtype",t,e,n))];case"Range":{const a=aC("start",t,e,n),i=aC("stop",t,e,n),o=aC("step",t,e,n);return[r.range(a,i,o,aC("dtype",t,e,n))]}case"TruncatedNormal":{const a=aC("shape",t,e,n),i=aC("mean",t,e,n),o=aC("stdDev",t,e,n),s=aC("seed",t,e,n);return[r.truncatedNormal(a,i,o,aC("dtype",t,e,n),s)]}case"Zeros":return[r.zeros(aC("shape",t,e,n),aC("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(aC("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"dynamic":return async function(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:I;switch(t.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:s,scoreThreshold:c,softNmsSigma:l}=tA(t,e,n),u=await a.image.nonMaxSuppressionWithScoreAsync(r,i,o,s,c,l);return[u.selectedIndices,u.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:s,scoreThreshold:c}=tA(t,e,n),l=aC("padToMaxOutputSize",t,e,n),u=await a.image.nonMaxSuppressionPaddedAsync(r,i,o,s,c,l);return[u.selectedIndices,u.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:s,scoreThreshold:c}=tA(t,e,n);return[await a.image.nonMaxSuppressionAsync(r,i,o,s,c)]}case"Where":{const r=a.cast(aC("condition",t,e,n),"bool"),i=[await a.whereAsync(r)];return r.dispose(),i}case"ListDiff":return a.setdiff1dAsync(aC("x",t,e,n),aC("y",t,e,n));default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n);case"evaluation":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"LowerBound":{const a=aC("sortedSequence",t,e,n),i=aC("values",t,e,n);return[r.lowerBound(a,i)]}case"TopKV2":{const a=aC("x",t,e,n),i=aC("k",t,e,n),o=aC("sorted",t,e,n),s=r.topk(a,i,o);return[s.values,s.indices]}case"UpperBound":{const a=aC("sortedSequence",t,e,n),i=aC("values",t,e,n);return[r.upperBound(a,i)]}case"Unique":{const a=aC("x",t,e,n),i=r.unique(a);return[i.values,i.indices]}case"UniqueV2":{const a=aC("x",t,e,n),i=aC("axis",t,e,n),o=r.unique(a,i);return[o.values,o.indices]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"image":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"ResizeBilinear":{const a=aC("images",t,e,n),i=aC("size",t,e,n),o=aC("alignCorners",t,e,n),s=aC("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(a,[i[0],i[1]],o,s)]}case"ResizeNearestNeighbor":{const a=aC("images",t,e,n),i=aC("size",t,e,n),o=aC("alignCorners",t,e,n),s=aC("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(a,[i[0],i[1]],o,s)]}case"CropAndResize":{const a=aC("image",t,e,n),i=aC("boxes",t,e,n),o=aC("boxInd",t,e,n),s=aC("cropSize",t,e,n),c=aC("method",t,e,n),l=aC("extrapolationValue",t,e,n);return[r.image.cropAndResize(a,i,o,s,c,l)]}case"ImageProjectiveTransformV3":{const a=aC("images",t,e,n),i=aC("transforms",t,e,n),o=aC("outputShape",t,e,n),s=aC("fillValue",t,e,n),c=aC("interpolation",t,e,n),l=aC("fillMode",t,e,n);return[r.image.transform(a,i,c.toLowerCase(),l.toLowerCase(),s,o)]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"graph":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const a=aC("default",t,e,n);return[iC(t.name,e,n)||a];case"Placeholder":return[iC(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[uC(aC("x",t,e,n))];case"IdentityN":return aC("x",t,e,n).map(t=>uC(t));case"Shape":return[r.tensor1d(aC("x",t,e,n).shape,"int32")];case"ShapeN":return aC("x",t,e,n).map(t=>r.tensor1d(t.shape));case"Size":return[r.scalar(aC("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(aC("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const i=aC("x",t,e,n),o=aC("data",t,e,n),s=aC("message",t,e,n),c=aC("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(let t=0;t<o.length;t++)console.log(Array.prototype.slice.call(o[t].dataSync()).slice(0,c));return[i];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"logical":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"Equal":return[r.equal(aC("a",t,e,n),aC("b",t,e,n))];case"NotEqual":return[r.notEqual(aC("a",t,e,n),aC("b",t,e,n))];case"Greater":return[r.greater(aC("a",t,e,n),aC("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(aC("a",t,e,n),aC("b",t,e,n))];case"Less":return[r.less(aC("a",t,e,n),aC("b",t,e,n))];case"LessEqual":return[r.lessEqual(aC("a",t,e,n),aC("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(aC("a",t,e,n),aC("b",t,e,n))];case"LogicalNot":return[r.logicalNot(aC("a",t,e,n))];case"LogicalOr":return[r.logicalOr(aC("a",t,e,n),aC("b",t,e,n))];case"Select":case"SelectV2":return[r.where(aC("condition",t,e,n),aC("a",t,e,n),aC("b",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"matrices":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(aC("a",t,e,n),aC("b",t,e,n),aC("transposeA",t,e,n),aC("transposeB",t,e,n))];case"Einsum":return[r.einsum(aC("equation",t,e,n),...aC("tensors",t,e,n))];case"Transpose":return[r.transpose(aC("x",t,e,n),aC("perm",t,e,n))];case"_FusedMatMul":const[a,i]=aC("fusedOps",t,e,n),o="biasadd"===a,s="prelu"===i,c=aC("numArgs",t,e,n),l=aC("leakyreluAlpha",t,e,n);if(o){if(s&&2!==c)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==c)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,h]=aC("args",t,e,n);return[r.fused.matMul({a:aC("a",t,e,n),b:aC("b",t,e,n),transposeA:aC("transposeA",t,e,n),transposeB:aC("transposeB",t,e,n),bias:u,activation:i,preluActivationWeights:h,leakyreluAlpha:l})];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"normalization":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(aC("x",t,e,n),aC("axis",t,e,n),aC("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[r.batchNorm(aC("x",t,e,n),aC("mean",t,e,n),aC("variance",t,e,n),aC("offset",t,e,n),aC("scale",t,e,n),aC("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(aC("x",t,e,n),aC("radius",t,e,n),aC("bias",t,e,n),aC("alpha",t,e,n),aC("beta",t,e,n))];case"Softmax":return[r.softmax(aC("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(aC("x",t,e,n))];case"SparseToDense":return[r.sparseToDense(aC("sparseIndices",t,e,n),aC("outputShape",t,e,n),aC("sparseValues",t,e,n),aC("defaultValue",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"reduction":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"Max":{const a=aC("axis",t,e,n),i=aC("keepDims",t,e,n);return[r.max(aC("x",t,e,n),a,i)]}case"Mean":{const a=aC("axis",t,e,n),i=aC("keepDims",t,e,n);return[r.mean(aC("x",t,e,n),a,i)]}case"Min":{const a=aC("axis",t,e,n),i=aC("keepDims",t,e,n);return[r.min(aC("x",t,e,n),a,i)]}case"Sum":{const a=aC("axis",t,e,n),i=aC("keepDims",t,e,n);return[r.sum(aC("x",t,e,n),a,i)]}case"All":{const a=aC("axis",t,e,n),i=aC("keepDims",t,e,n);return[r.all(aC("x",t,e,n),a,i)]}case"Any":{const a=aC("axis",t,e,n),i=aC("keepDims",t,e,n);return[r.any(aC("x",t,e,n),a,i)]}case"ArgMax":{const a=aC("axis",t,e,n);return[r.argMax(aC("x",t,e,n),a)]}case"ArgMin":{const a=aC("axis",t,e,n);return[r.argMin(aC("x",t,e,n),a)]}case"Prod":{const a=aC("axis",t,e,n),i=aC("keepDims",t,e,n);return[r.prod(aC("x",t,e,n),a,i)]}case"Cumprod":{const a=aC("axis",t,e,n),i=aC("exclusive",t,e,n),o=aC("reverse",t,e,n);return[r.cumprod(aC("x",t,e,n),a,i,o)]}case"Cumsum":{const a=aC("axis",t,e,n),i=aC("exclusive",t,e,n),o=aC("reverse",t,e,n);return[r.cumsum(aC("x",t,e,n),a,i,o)]}case"Bincount":const a=aC("x",t,e,n),i=aC("weights",t,e,n),o=aC("size",t,e,n);return[r.bincount(a,i,o)];case"DenseBincount":{const a=aC("x",t,e,n),i=aC("weights",t,e,n),o=aC("size",t,e,n),s=aC("binaryOutput",t,e,n);return[r.denseBincount(a,i,o,s)]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"slice_join":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"ConcatV2":case"Concat":{const a=aC("n",t,e,n),i=aC("axis",t,e,n);let o=aC("tensors",t,e,n);return o=o.slice(0,a),[r.concat(o,i)]}case"Gather":{const a=aC("x",t,e,n),i=aC("indices",t,e,n);return[r.gather(a,r.cast(i,"int32"),0)]}case"GatherV2":{const a=aC("axis",t,e,n),i=aC("batchDims",t,e,n),o=aC("x",t,e,n),s=aC("indices",t,e,n);return[r.gather(o,r.cast(s,"int32"),a,i)]}case"Reverse":{const a=aC("dims",t,e,n),i=[];for(let t=0;t<a.length;t++)a[t]&&i.push(t);const o=aC("x",t,e,n);return[r.reverse(o,i)]}case"ReverseV2":{const a=aC("axis",t,e,n),i=aC("x",t,e,n);return[r.reverse(i,a)]}case"Slice":{const a=aC("begin",t,e,n),i=aC("size",t,e,n);return[r.slice(aC("x",t,e,n),a,i)]}case"StridedSlice":{const a=aC("begin",t,e,n),i=aC("end",t,e,n),o=aC("strides",t,e,n),s=aC("beginMask",t,e,n),c=aC("endMask",t,e,n),l=aC("ellipsisMask",t,e,n),u=aC("newAxisMask",t,e,n),h=aC("shrinkAxisMask",t,e,n),d=aC("x",t,e,n);return[r.stridedSlice(d,a,i,o,s,c,l,u,h)]}case"Pack":return zp(()=>{const a=aC("axis",t,e,n),i=aC("tensors",t,e,n),o=i[0].shape,s=r.squeeze(i[0]).shape,c=i.map(t=>{const e=Es(t.shape,o);if(!e&&!Es(r.squeeze(t).shape,s))throw new Error("the input tensors shape does not match");return e?t:r.reshape(t,o)});return[r.stack(c,a)]});case"Unpack":{const a=aC("axis",t,e,n),i=aC("tensor",t,e,n);return r.unstack(i,a)}case"Tile":{const a=aC("reps",t,e,n);return[r.tile(aC("x",t,e,n),a)]}case"Split":case"SplitV":{const a=aC("axis",t,e,n),i=aC("numOrSizeSplits",t,e,n),o=aC("x",t,e,n);return r.split(o,i,a)}case"ScatterNd":{const a=aC("indices",t,e,n),i=aC("values",t,e,n),o=aC("shape",t,e,n);return[r.scatterND(a,i,o)]}case"GatherNd":{const a=aC("x",t,e,n),i=aC("indices",t,e,n);return[r.gatherND(a,i)]}case"SparseToDense":{const a=aC("sparseIndices",t,e,n),i=aC("outputShape",t,e,n),o=aC("sparseValues",t,e,n),s=aC("defaultValue",t,e,n);return[r.sparseToDense(a,o,i,o.dtype===s.dtype?s:r.cast(s,o.dtype))]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"sparse":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:i,emptyRowIndicator:o,reverseIndexMap:s}=r.sparse.sparseFillEmptyRows(aC("indices",t,e,n),aC("values",t,e,n),aC("denseShape",t,e,n),aC("defaultValue",t,e,n));return[a,i,o,s]}case"SparseReshape":{const{outputIndices:a,outputShape:i}=r.sparse.sparseReshape(aC("inputIndices",t,e,n),aC("inputShape",t,e,n),aC("newShape",t,e,n));return[a,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(aC("data",t,e,n),aC("indices",t,e,n),aC("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(aC("data",t,e,n),aC("indices",t,e,n),aC("segmentIds",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"spectral":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"FFT":return[r.fft(aC("x",t,e,n))];case"IFFT":return[r.ifft(aC("x",t,e,n))];case"RFFT":return[r.rfft(aC("x",t,e,n))];case"IRFFT":return[r.irfft(aC("x",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"string":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"StringNGrams":{const{nGrams:a,nGramsSplits:i}=r.string.stringNGrams(aC("data",t,e,n),aC("dataSplits",t,e,n),aC("separator",t,e,n),aC("nGramWidths",t,e,n),aC("leftPad",t,e,n),aC("rightPad",t,e,n),aC("padWidth",t,e,n),aC("preserveShortSequences",t,e,n));return[a,i]}case"StringSplit":{const{indices:a,values:i,shape:o}=r.string.stringSplit(aC("input",t,e,n),aC("delimiter",t,e,n),aC("skipEmpty",t,e,n));return[a,i,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(aC("input",t,e,n),aC("numBuckets",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"transformation":return a(()=>function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;switch(t.op){case"Cast":return[r.cast(aC("x",t,e,n),aC("dtype",t,e,n))];case"ExpandDims":{const a=aC("axis",t,e,n);return[r.expandDims(aC("x",t,e,n),a)]}case"Squeeze":{const a=aC("axis",t,e,n);return[r.squeeze(aC("x",t,e,n),a)]}case"Reshape":return[r.reshape(aC("x",t,e,n),aC("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(aC("x",t,e,n),aC("padding",t,e,n),aC("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(aC("x",t,e,n),aC("padding",t,e,n),aC("constantValue",t,e,n))];case"SpaceToBatchND":{const a=aC("blockShape",t,e,n),i=aC("paddings",t,e,n);return[r.spaceToBatchND(aC("x",t,e,n),a,i)]}case"BatchToSpaceND":{const a=aC("blockShape",t,e,n),i=aC("crops",t,e,n);return[r.batchToSpaceND(aC("x",t,e,n),a,i)]}case"DepthToSpace":{const a=aC("blockSize",t,e,n),i=aC("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(aC("x",t,e,n),a,i)]}case"BroadcastTo":return[r.broadcastTo(aC("x",t,e,n),aC("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(aC("s0",t,e,n),aC("s1",t,e,n))];default:throw TypeError("Node type ".concat(t.op," is not implemented"))}}(t,e,n));case"hash_table":return(async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const a=aC("keyDType",t,e,n),i=aC("valueDType",t,e,n),o=new eA(a,i);return r.addHashTable(t.name,o),[o.handle]}case"LookupTableImport":case"LookupTableImportV2":{const a=aC("tableHandle",t,e,n,r),i=aC("keys",t,e,n),o=aC("values",t,e,n),s=r.getHashTableById(a.id);return[await s.import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const a=aC("tableHandle",t,e,n,r),i=aC("keys",t,e,n),o=aC("defaultValue",t,e,n),s=r.getHashTableById(a.id);return[await s.find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=aC("tableHandle",t,e,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError("Node type ".concat(t.op," is not implemented"))}})(t,e,n,r);case"custom":const i=rC(t.op);if(i&&i.customExecutor)return i.customExecutor(new HC(t,e,n));throw TypeError("Custom op ".concat(t.op," is not registered."));default:throw TypeError("Unknown op '".concat(t.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}})(t,e,n);return tc(i)?i.then(t=>[].concat(t)):[].concat(i)}class rA{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=n,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(t=>0===t.id&&0===t.iterationId?"":"".concat(t.frameName,"-").concat(t.iterationId)).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(const e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}function aA(t,e,n,r){const a=new Set,i=[];let o=null,s=null;const c=new Set,l=Object.keys(t).map(t=>cC(t)[0]);let u=[];null!=r&&(u=r.map(t=>cC(t.name)[0]));const h=[...e];for(;h.length>0;){const t=h.pop();(cA(t)||lA(t)||uA(t))&&null==o&&(o=t,s=o.children.map(t=>t.name).filter(t=>a.has(t))),a.add(t.name),null==n[t.name]&&(-1===l.indexOf(t.name)&&-1===u.indexOf(t.name)&&(0!==t.inputs.length?t.inputs.forEach(t=>{c.has(t.name)||(c.add(t.name),h.push(t))}):i.push(t.name)))}return{inputs:t,outputs:e,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:s}}const iA=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],oA=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],sA=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function cA(t){return iA.indexOf(t.op)>=0}function lA(t){return oA.indexOf(t.op)>=0}function uA(t){return sA.indexOf(t.op)>=0}class hA{constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach(e=>{this._functionExecutorMap[e]=new hA(t.functions[e],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map(e=>t[e].map(t=>t.id));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const e=t.signatureKey||t.name;return t.defaultOutput?"".concat(e,":").concat(t.defaultOutput):e})}get functions(){return Object.keys(this._functions).reduce((t,e)=>(t[e]=this._functions[e].signature,t),{})}getCompilationKey(t,e){const n=t.map(t=>t.name).sort(),r=e.map(t=>t.name).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(t,e){const n=aA(t,e,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=n;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(r.length>0){const n=e.map(t=>t.name),a=Object.keys(t);throw new Error("Cannot compute the outputs [".concat(n,"] from the provided inputs ")+"[".concat(a,"]. Missing the following inputs: [").concat(r,"]"))}return function(t,e,n){const{usedNodes:r,inputs:a}=n,i=[],o=Object.keys(a).map(t=>cC(t)[0]).map(e=>t.nodes[e]),s=t.initNodes;o.forEach(t=>{r.has(t.name)&&i.push(t)}),t.weights.forEach(t=>{r.has(t.name)&&i.push(t)}),null!=s&&s.forEach(t=>{r.has(t.name)&&i.push(t)});const c=new Set,l=[];for(;i.length>0;){const t=i.pop();c.add(t.name),e[t.name]||l.push(t),t.children.forEach(t=>{!c.has(t.name)&&r.has(t.name)&&t.inputs.every(t=>c.has(t.name))&&i.push(t)})}return l}(this.graph,this.weightMap,n)}execute(t,e){t=this.mapInputs(t);const n=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const r=n.map(t=>this.graph.nodes[cC(t)[0]]),a=e.map(t=>cC(t)[0]);let i=a.map(t=>this.graph.nodes[t]);this.resetIntermediateTensors(),0===i.length&&(i=this._outputs);const o=this.getCompilationKey(r,i);let s=this.compiledMap.get(o);null==s&&(s=this.compile(t,i),this.compiledMap.set(o,s));const c={},l={};return zp(()=>{const n=new rA(this.weightMap,c,l,this.functionExecutorMap),r=Object.assign({},this.weightMap);Object.keys(t).forEach(e=>{const[n,a]=cC(e),i=[];i[a]=t[e],r[n]=i});const i=this.getFrozenTensorIds(r),o={};for(let t=0;t<s.length;t++){const e=s[t];if(!r[e.name]){const t=nA(e,r,n,this._resourceManager);if(tc(t))throw new Error("The execution of the op '".concat(e.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");r[e.name]=t,this.checkTensorForDisposal(e.name,e,r,n,i,a,o)}}return null==this.parent&&n.dispose(i),e.map(t=>iC(t,r,n))})}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map(e=>t[e]).map(t=>t.map(t=>t.id)));return new Set(e)}checkTensorForDisposal(t,e,n,r,a,i,o){"control"!==e.category&&-1===i.indexOf(t)&&(n[t].forEach(t=>{null!=t&&(o[t.id]=(o[t.id]||0)+e.children.length)}),e.inputs.forEach(t=>{if("control"!==t.category){const i=function(t,e,n){return e[sC(t,n.currentContextId)]}(t.name,n,r);null!=i&&i.forEach(t=>{if(t&&!t.kept&&!a.has(t.id)){const n=o[t.id];if(1===n){if(this.keepTensorForDebug){const[n,a]=oC(e.name,r);this.intermediateTensors[n]||(this.intermediateTensors[n]=[]),this.intermediateTensors[n][a]=t}else t.dispose();delete o[t.id]}else null!=n&&o[t.id]--}})}}))}async executeAsync(t,e){return this._executeAsync(t,e)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach(t=>this.intermediateTensors[t].forEach(t=>t.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach(t=>{this.tensorsMap[t].forEach(t=>{!t||t.kept||t.isDisposed||this.keepIds.has(t.id)||t.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const t in this.intermediateTensors)this.intermediateTensors[t].forEach(t=>t.dispose()),delete this.intermediateTensors[t]}async _executeAsync(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};n||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e));try{this.keepTensorForDebug=ac().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(Grt){console.warn(Grt.message)}this.resetIntermediateTensors();const i=new rA(this.weightMap,r,a,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(t,i,e,n);const o=e.map(t=>iC(t,this.tensorsMap,i)),s=o.map(t=>t.id),c=Object.keys(t).map(e=>t[e].id);return this.keepIds=new Set([...s,...c,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),null==this.parent&&i.dispose(this.keepIds),o}async executeFunctionAsync(t,e,n){const r=t.reduce((t,e,n)=>(t[this.inputs[n].name]=e,t),{});return this._executeAsync(r,this.outputNodes,!0,e,n)}async executeWithControlFlow(t,e,n,r){const a=Object.keys(t),i=a.map(t=>this.graph.nodes[cC(t)[0]]),o=n.map(t=>cC(t)[0]);let s=o.map(t=>this.graph.nodes[t]);0===s.length&&(s=this._outputs);const{usedNodes:c,missingInputs:l,dynamicNode:u,syncInputs:h}=aA(t,s,this.weightMap,this._initNodes),d=[...i,...this.graph.weights,...this._initNodes||[]].map(t=>({node:t,contexts:e.currentContext})),f=Object.assign({},this.weightMap);Object.keys(t).forEach(e=>{const[n,r]=cC(e),a=[];a[r]=t[e],f[n]=a});const p={},m=this.getFrozenTensorIds(f),g={};for(;d.length>0;){const t=this.processStack(i,d,e,f,g,m,o,p,c);await Promise.all(t)}null!=u||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const y=s.filter(t=>!cA(t)&&!iC(t.name,f,e)).map(t=>t.name);if(y.length>0){let t="";throw null!=u&&(t="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(h,"]")),new Error("Cannot compute the outputs [".concat(y,"] from the provided ")+"inputs [".concat(a,"]. Consider providing the following inputs: ")+"[".concat(l,"]. ").concat(t))}return f}processStack(t,e,n,r,a,i,o,s,c){const l=[];for(;e.length>0;){const t=e.pop();n.currentContext=t.contexts;let u="";if("Enter"===t.node.op&&aC("isConstant",t.node,r,n)&&([u]=oC(t.node.name,n)),null==r[t.node.name]){const h=nA(t.node,r,n,this._resourceManager);u||([u]=oC(t.node.name,n));const d=n.currentContext;tc(h)?l.push(h.then(l=>(r[u]=l,n.currentContext=d,this.checkTensorForDisposal(u,t.node,r,n,i,o,s),this.processChildNodes(t.node,e,n,r,a,c),l))):(r[u]=h,this.checkTensorForDisposal(u,t.node,r,n,i,o,s),this.processChildNodes(t.node,e,n,r,a,c))}else this.processChildNodes(t.node,e,n,r,a,c)}return l}processChildNodes(t,e,n,r,a,i){t.children.forEach(t=>{const[o]=oC(t.name,n);!a[o]&&i.has(t.name)&&("Merge"===t.op?t.inputNames.some(t=>!!iC(t,r,n))&&(a[o]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every(t=>!!iC(t,r,n))&&(a[o]=!0,e.push({contexts:n.currentContext,node:t})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(t=>t.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(e=>{const n=t[e],[r]=cC(e),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const t=a.attrParams.shape.value;ks(t.length===n.shape.length&&n.shape.every((e,n)=>-1===t[n]||t[n]===e),()=>"The shape of dict['".concat(a.name,"'] provided in ")+"model.execute(dict) must be [".concat(t,"], but was ")+"[".concat(n.shape,"]"))}a.attrParams.dtype&&a.attrParams.dtype.value&&ks(n.dtype===a.attrParams.dtype.value,()=>"The dtype of dict['".concat(a.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(a.attrParams.dtype.value,", but was ").concat(n.dtype))})}mapInputs(t){const e={};for(const n in t)if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]){e[this._signature.inputs[n].name]=t[n]}else e[n]=t[n];return e}checkInputs(t){const e=Object.keys(t).filter(t=>{const[e]=cC(t);return null==this.graph.nodes[e]});if(e.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(e,"] that are not part of graph"))}mapOutputs(t){return t.map(t=>{if(null!=this._signature&&null!=this._signature.outputs&&null!=this._signature.outputs[t]){return this._signature.outputs[t].name}return t},{})}checkOutputs(t){t.forEach(t=>{const[e]=cC(t);if(!this.graph.nodes[e])throw new Error("The output '".concat(t,"' is not found in the graph"))})}}class dA{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}const fA="?tfjs-format=file",pA="model.json";class mA{constructor(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.modelUrl=t,this.loadOptions=n,this.version="n/a",this.io=r,null==n&&(this.loadOptions={}),this.resourceManager=new dA}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const e=this.io.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one (".concat(e.length,") load handlers for ")+"URL '".concat([t],"'"));this.handler=e[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return tc(t)?t.then(t=>this.loadSync(t)):this.loadSync(t)}loadSync(t){this.artifacts=t;const e=this.artifacts.modelTopology;let n=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const t=this.artifacts.userDefinedMetadata;null!=t.signature&&(n=t.signature),null!=t.structuredOutputKeys&&(this.structuredOutputKeys=t.structuredOutputKeys)}this.signature=n,this.version="".concat(e.versions.producer,".").concat(e.versions.minConsumer);const r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new hA(AC.Instance.transformGraph(e,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){const e=AC.Instance.transformGraph(t.modelInitializer);this.initializer=new hA(e),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(t,e){if("string"===typeof t){const e=this.io.getSaveHandlers(t);if(0===e.length)throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));if(e.length>1)throw new Error("Found more than one (".concat(e.length,") save handlers for ")+"URL '".concat(t,"'"));t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}predict(t,e){const n=this.execute(t,this.outputNodes);if(this.structuredOutputKeys){const t={};return(n instanceof nd?[n]:n).forEach((e,n)=>t[this.structuredOutputKeys[n]]=e),t}return n}normalizeInputs(t){if(!(t instanceof nd)&&!Array.isArray(t))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,"+"the graph model has ".concat(this.inputNodes.length," placeholders, ")+"while there are ".concat(t.length," input tensors."));return this.inputNodes.reduce((e,n,r)=>(e[n]=t[r],e),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}execute(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=this.executor.execute(t,e);return n.length>1?n:n[0]}async executeAsync(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=await this.executor.executeAsync(t,e);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((e,n)=>(e[n]=[t[n]],e),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function gA(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==n&&(n={}),n.fromTFHub&&"string"===typeof t&&(t=function(t){t.endsWith("/")||(t+="/");return"".concat(t).concat(pA).concat(fA)}(t));const a=new mA(t,n,r);return await a.load(),a}function yA(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==t)return null;if("function"===typeof Blob&&t instanceof Blob)return t.slice();if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const a=e(t);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(xA(t)){const a=Array.isArray(t)?[]:{};r.add(t);for(const i in t){const o=yA(t[i],e,n,r);a[i]=o}return r.delete(t),t.__proto__&&(a.__proto__=t.__proto__),a}throw new Error("Can't recurse into non-iterable type: ".concat(t))}return n.set(t,a.value),a.value}function vA(t){return bA(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:wA)}function bA(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;const r=t[0];if(n.has(r))throw new Error("Circular references are not supported.");const a=e(t);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(xA(r)){const a=Array.isArray(r)?[]:{};n.add(r);for(const i in r){const r=t.map(t=>t[i]),o=bA(r,e,n);a[i]=o}return n.delete(r),a}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function wA(t){return null===t?null:xA(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function xA(t){let e=!1;if(ac().get("IS_BROWSER"))e=t instanceof TextDecoder;else{const{StringDecoder:r}=n(551);e=t instanceof r}return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"===typeof t&&!(t instanceof nd)&&!(t instanceof Promise)&&!e)}function kA(t){return function(t,e){return yA(t,e)}(t,_A)}function _A(t){return t instanceof nd?{value:t.clone(),recurse:!1}:xA(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}class SA{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}class TA extends SA{constructor(){super(TA.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),n=this.length();for(let r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}function IA(t){return new AA(t)}function EA(t,e){return new UA(t,e)}TA.INITIAL_CAPACITY=32;class NA{async toArray(){const t=[];let e=await this.next();for(;!e.done;)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let n=await t.next();for(;!n.done;)e.push(n.value),n=await t.next();return e}async resolveFully(){let t=await this.next();for(;!t.done;)t=await this.next()}async resolveWhile(t){let e=await this.next(),n=t(e.value);for(;!e.done&&n;)e=await this.next(),n=t(e.value)}handleErrors(t){return new LA(this,t)}filter(t){return new FA(this,t)}map(t){return new PA(this,t)}mapAsync(t){return new zA(this,t)}serialMapAsync(t){return new zA(this,t).serial()}flatmap(t){return new jA(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile(t=>!0===t)}rowMajorBatch(t){return new MA(this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}columnMajorBatch(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wA;return this.rowMajorBatch(t,e).map(t=>vA(t,n))}concatenate(t,e){return new UA(new CA([this,t]),e)}take(t){return t<0||null==t?this:new DA(this,t)}skip(t){return t<0||null==t?this:new OA(this,t)}prefetch(t){return new WA(this,t)}shuffle(t,e){return new GA(this,t,e)}serial(){return new RA(this)}}class CA extends NA{constructor(t){super(),this.items=t,this.trav=0}summary(){return"Array of ".concat(this.items.length," items")}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:kA(t),done:!1}}}class AA extends NA{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(Grt){throw Grt.message="Error thrown while iterating through a dataset: ".concat(Grt.message),Grt}}}class RA extends NA{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Serial")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class OA extends NA{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Skip")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const t=await this.upstream.next();if(t.done)return t;Bp(t.value)}return this.upstream.next()}}class DA extends NA{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return"".concat(this.upstream.summary()," -> Take")}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class MA extends NA{constructor(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const t=[];for(;t.length<this.batchSize;){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class FA extends NA{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> Filter")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;Bp(t.value)}}}class PA extends NA{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> Map")}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=md(t.value),n=this.transform(t.value),r=md(n);for(const a of e)pd(a,r)||a.dispose();return{value:n,done:!1}}}class LA extends NA{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return"".concat(this.upstream.summary()," -> handleErrors")}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(Grt){if(!this.handler(Grt))return{value:null,done:!0}}}}class zA extends NA{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> AsyncMap")}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=md(t.value),n=await this.transform(t.value),r=md(n);for(const a of e)pd(a,r)||a.dispose();return{value:n,done:!1}}}class BA extends NA{constructor(){super(),this.outputQueue=new TA,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;0===this.outputQueue.length();)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class jA extends BA{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return"".concat(this.upstream.summary()," -> Flatmap")}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=md(t.value),n=this.transform(t.value),r=md(n);this.outputQueue.pushAll(n);for(const a of e)pd(a,r)||a.dispose();return!0}}class UA extends NA{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}var VA;!function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"}(VA||(VA={}));class WA extends NA{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new SA(e)}summary(){return"".concat(this.upstream.summary()," -> Prefetch")}refill(){for(;!this.buffer.isFull();){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class GA extends WA{constructor(t,e,n){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=Vy.alea(n||Uh().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}class HA{constructor(){this.size=null}batch(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=this;let r;return ks(t>0,()=>"batchSize needs to be positive, but it is\n      ".concat(t)),r=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),qA(async()=>(await n.iterator()).columnMajorBatch(t,e,KA),r)}concatenate(t){const e=this;let n;return n=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,qA(async()=>(await e.iterator()).concatenate(await t.iterator()),n)}filter(t){const e=this;let n;return n=this.size===1/0?1/0:null,qA(async()=>(await e.iterator()).filter(e=>zp(()=>t(e))),n)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return qA(async()=>(await e.iterator()).map(e=>zp(()=>t(e))),this.size)}mapAsync(t){const e=this;return qA(async()=>(await e.iterator()).mapAsync(t),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return qA(async()=>(await e.iterator()).prefetch(t),this.size)}repeat(t){const e=this;let n;return n=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,qA(async()=>EA(IA(async()=>({value:await e.iterator(),done:!1})).take(t)),n)}skip(t){const e=this;let n;return n=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,qA(async()=>(await e.iterator()).skip(t),n)}shuffle(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));const r=this,a=Vy.alea(e||Uh().toString());return qA(async()=>{let e=a.int32();return n&&(e+=a.int32()),(await r.iterator()).shuffle(t,e.toString())},this.size)}take(t){const e=this;let n;return n=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,qA(async()=>(await e.iterator()).take(t),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function qA(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new class extends HA{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function KA(t){if(null===t)return null;if(function(t){return null==t||null===(e=t)||"object"!==typeof e&&"function"!==typeof e||Array.isArray(t)||"object"===typeof t&&t instanceof nd||zs(t);var e}(t[0])){return{value:function(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof nd?Iv(t):Pd(t)}(t),recurse:!1}}return{value:null,recurse:!0}}HA.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function XA(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&ks("complex64"!==t.dtype,()=>"".concat(e," does not support complex64 tensors in the CPU backend."))})}const YA=Vv;class QA extends gs{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new ms(this,Pp())}nextDataId(){return QA.nextDataId++}write(t,e,n){this.firstUse&&(this.firstUse=!1,ac().get("IS_NODE")&&mh("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:n,refCount:1}),r}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&js(n[0])){const a=n.map(t=>Vh(t));r=this.write(a,t,e)}else r=this.write(n,t,e);return{dataId:r,shape:t,dtype:e}}refCount(t){if(this.data.has(t)){return this.data.get(t).refCount}return 0}incRef(t){this.data.get(t).refCount++}decRef(t){if(this.data.has(t)){this.data.get(t).refCount--}}move(t,e,n,r,a){this.data.set(t,{values:e,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:n}=this.data.get(t);if("complex64"===e){return Qw(this.readSync(n.real.dataId),this.readSync(n.imag.dataId))}return this.data.get(t).values}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map(t=>Wh(t));return Lf(t.shape,t.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Lf(t.shape,t.dtype,e)}makeOutput(t,e,n){return Pp().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,t),this)}disposeData(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(t)){if(this.data.get(t).refCount--,!e&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(t);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const e=Uh();t();return{kernelMs:Uh()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){XA([t],"where");const e=this.readSync(t.dataId);return YA(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}QA.nextDataId=0;function JA(t,e,n){return r=>{let{inputs:a,attrs:i,backend:o}=r;const{x:s}=a;if(XA(s,t),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const c=o,l=c.data.get(s.dataId).values,u=Is(s.shape),h=n||s.dtype,d=Ps(h,u);for(let t=0;t<u;++t)d[t]=e(l[t],i);return c.makeTensorInfo(s.shape,h,d)}}function $A(t,e,n){return r=>{let{inputs:a,attrs:i,backend:o}=r;const{x:s}=a;if(XA(s,t),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const c=o,l=c.data.get(s.dataId).values,u=n||s.dtype,h=e(l,u,i);return c.makeTensorInfo(s.shape,u,h)}}Up("cpu",()=>new QA,1);const ZA=JA(il,t=>t>=0?t:Math.exp(t)-1),tR={kernelName:il,backendName:"cpu",kernelFunc:ZA};function eR(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const nR={kernelName:kl,backendName:"cpu",kernelFunc:eR};function rR(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{alpha:i}=r;XA([a],"leakyRelu");const o=Is(a.shape),s=n.data.get(a.dataId).values,c=Fs("float32",o);for(let l=0;l<s.length;l++)c[l]=s[l]<0?i*s[l]:s[l];return n.makeTensorInfo(a.shape,"float32",c)}const aR={kernelName:Nl,backendName:"cpu",kernelFunc:rR};function iR(t){return(e,n,r,a,i)=>{const o=lp(e,n),s=o.length,c=Hs(o),l=Fs(i,Is(o)),u=e.length,h=n.length,d=Hs(e),f=Hs(n),p=sp(e,o),m=sp(n,o);if(p.length+m.length===0)for(let g=0;g<l.length;++g)l[g]=t(r[g%r.length],a[g%a.length]);else for(let g=0;g<l.length;++g){const e=Zs(g,s,c),n=e.slice(-u);p.forEach(t=>n[t]=0);const i=$s(n,u,d),o=e.slice(-h);m.forEach(t=>o[t]=0);const y=$s(o,h,f);l[g]=t(r[i],a[y])}return[l,o]}}const oR=iR((t,e)=>t<0?e*t:t);function sR(t){const{inputs:e,backend:n}=t,{x:r,alpha:a}=e;XA([r,a],"prelu");const i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,[s,c]=oR(r.shape,a.shape,i,o,"float32");return n.makeTensorInfo(c,"float32",s)}const cR={kernelName:lu,backendName:"cpu",kernelFunc:sR},lR=JA(gu,t=>Math.max(0,t)),uR={kernelName:gu,backendName:"cpu",kernelFunc:lR},hR=JA(ku,t=>Math.min(Math.max(0,t),6)),dR={kernelName:ku,backendName:"cpu",kernelFunc:hR};function fR(t){return(e,n,r)=>{const a=Fs(n,e.length);for(let i=0;i<e.length;++i)a[i]=t(e[i],r);return a}}const pR=fR(t=>1/(1+Math.exp(-t))),mR=JA(Mu,t=>1/(1+Math.exp(-t))),gR={kernelName:Mu,backendName:"cpu",kernelFunc:mR};function yR(t,e,n,r,a){if("linear"===n)return eR({inputs:{x:e},backend:t});if("relu"===n)return lR({inputs:{x:e},backend:t});if("elu"===n)return ZA({inputs:{x:e},backend:t});if("relu6"===n)return hR({inputs:{x:e},backend:t});if("prelu"===n)return sR({inputs:{x:e,alpha:r},backend:t});if("leakyrelu"===n)return rR({inputs:{x:e},backend:t,attrs:{alpha:a}});if("sigmoid"===n)return mR({inputs:{x:e},backend:t});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function vR(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}const bR={kernelName:Mc,backendName:"cpu",kernelFunc:vR};function wR(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){return vR({inputs:{real:wR(t,e,"float32"),imag:wR(t,e,"float32")},backend:t})}const r=Ys(Is(e),n);return t.makeTensorInfo(e,n,r)}function xR(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const kR={kernelName:pu,backendName:"cpu",kernelFunc:xR};function _R(t,e,n,r){if("int32"===r){return[e,"int32",Int32Array.from(t)]}if("bool"===r){const r=jh([0],n),[a,i]=iR((t,e)=>t!==e?1:0)(e,[],t,r,"bool");return[i,"bool",a]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function SR(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dtype:i}=r;if("complex64"===i){if("complex64"===a.dtype)return eR({inputs:{x:a},backend:n});const t=wR(n,a.shape,a.dtype),e=SR({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),r=vR({inputs:{real:e,imag:t},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),r}if("complex64"===a.dtype){const t=xR({inputs:{input:a},backend:n}),e=SR({inputs:{x:t},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(t),e}if(!Ls(a.dtype,i)){const t=eR({inputs:{x:a},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:i}}const o=n.data.get(a.dataId).values,[s,c,l]=_R(o,a.shape,a.dtype,i);return n.makeTensorInfo(s,c,l)}const TR={kernelName:Rc,backendName:"cpu",kernelFunc:SR};function IR(t,e,n,r){return null==n?n=>{let{inputs:a,backend:i}=n;const{a:o,b:s}=a,c=i;XA([o,s],t);const l=c.data.get(o.dataId).values,u=c.data.get(s.dataId).values,h="string"===o.dtype?Ax(l):l,d="string"===o.dtype?Ax(u):u,f=r||o.dtype,[p,m]=e(o.shape,s.shape,h,d,f);return c.makeTensorInfo(m,f,p)}:t=>{let{inputs:a,backend:i}=t;const{a:o,b:s}=a,c=i;if("complex64"===o.dtype||"complex64"===s.dtype){const t=SR({inputs:{x:o},backend:c,attrs:{dtype:"complex64"}}),e=c.data.get(t.dataId),r=e.complexTensorInfos.real,a=e.complexTensorInfos.imag,i=c.data.get(r.dataId).values,l=c.data.get(a.dataId).values,u=SR({inputs:{x:s},backend:c,attrs:{dtype:"complex64"}}),h=c.data.get(u.dataId),d=h.complexTensorInfos.real,f=h.complexTensorInfos.imag,p=c.data.get(d.dataId).values,m=c.data.get(f.dataId).values,[g,y,v]=n(o.shape,s.shape,i,l,p,m),b=c.makeTensorInfo(v,"float32",g),w=c.makeTensorInfo(v,"float32",y),x=vR({inputs:{real:b,imag:w},backend:c});return c.disposeIntermediateTensorInfo(t),c.disposeIntermediateTensorInfo(u),c.disposeIntermediateTensorInfo(b),c.disposeIntermediateTensorInfo(w),x}{const t=c.data.get(o.dataId).values,n=c.data.get(s.dataId).values,a=r||o.dtype,[i,l]=e(o.shape,s.shape,t,n,a);return c.makeTensorInfo(l,a,i)}}}function ER(t){return(e,n,r,a,i,o)=>{const s=lp(e,n),c=Is(s),l=s.length,u=Hs(s),h=Fs("float32",c),d=Fs("float32",c),f=sp(e,s),p=sp(n,s),m=Qw(r,a),g=Qw(i,o),y=e.length,v=Hs(e),b=n.length,w=Hs(n);if(f.length+p.length===0)for(let x=0;x<h.length;x++){const e=x%m.length,n=x%g.length,r=t(m[2*e],m[2*e+1],g[2*n],g[2*n+1]);h[x]=r.real,d[x]=r.imag}else for(let x=0;x<h.length;x++){const e=Zs(x,l,u),n=e.slice(-y);f.forEach(t=>n[t]=0);const r=$s(n,y,v),a=e.slice(-b);p.forEach(t=>a[t]=0);const i=$s(a,b,w),o=t(m[2*r],m[2*r+1],g[2*i],g[2*i+1]);h[x]=o.real,d[x]=o.imag}return[h,d,s]}}const NR=iR((t,e)=>t+e),CR=ER((t,e,n,r)=>({real:t+n,imag:e+r})),AR=IR(dc,NR,CR),RR={kernelName:dc,backendName:"cpu",kernelFunc:AR};function OR(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{shape:i}=r,o=Is(a.shape),s=Os(i,o),c=Is(s);ks(o===c,()=>"The new shape (".concat(s,") has ").concat(c," elements and the old ")+"shape (".concat(a.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements."),n.incRef(a.dataId);const l=n.data.get(a.dataId);if(null!=l.complexTensorInfos){const t=l.complexTensorInfos.real,e=l.complexTensorInfos.imag;t.shape=s,e.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}const DR={kernelName:yu,backendName:"cpu",kernelFunc:OR};function MR(t){const{inputs:e,backend:n,attrs:r}=t,{a:a,b:i}=e,{transposeA:o,transposeB:s}=r;XA([a,i],"matMul");const c=a.shape.length,l=i.shape.length,u=o?a.shape[c-2]:a.shape[c-1],h=s?i.shape[l-1]:i.shape[l-2],d=o?a.shape[c-1]:a.shape[c-2],f=s?i.shape[l-2]:i.shape[l-1],p=a.shape.slice(0,-2),m=i.shape.slice(0,-2),g=Is(p),y=Is(m),v=lp(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([d,f]);ks(u===h,()=>"Error in matMul: inner shapes (".concat(u,") and (")+"".concat(h,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(i.shape," and transposeA=").concat(o)+" and transposeB=".concat(s," must match."));const b=s?[y,f,h]:[y,h,f],w=OR({inputs:{x:a},backend:n,attrs:{shape:o?[g,u,d]:[g,d,u]}}),x=OR({inputs:{x:i},backend:n,attrs:{shape:b}}),k=o?w.shape[1]:w.shape[2],_=o?w.shape[2]:w.shape[1],S=s?x.shape[1]:x.shape[2],T=Math.max(g,y),I=n.data.get(w.dataId).values,E=n.data.get(x.dataId).values,N=Hs(w.shape),C=Hs(x.shape),[A,R,O]=o?[N[0],1,N[1]]:[N[0],N[1],1],[D,M,F]=s?[1,C[1],C[0]]:[C[1],1,C[0]],P=_*S,L=Lf([T,_,S],w.dtype),z=L.values,B=n.blockSize;for(let j=0;j<T;j++)for(let t=0;t<_;t+=B)for(let e=0;e<S;e+=B)for(let n=0;n<k;n+=B){const r=Math.min(t+B,_),a=Math.min(e+B,S),i=Math.min(n+B,k);for(let o=t;o<r;o++)for(let t=e;t<a;t++){let e=0;for(let r=n;r<i;r++){const n=Math.min(j,g-1)*A,a=Math.min(j,y-1)*F;e+=I[n+o*R+r*O]*E[r*D+t*M+a]}z[j*P+(o*S+t)]+=e}}return n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(x),n.makeTensorInfo(v,L.dtype,L.values)}const FR={kernelName:Ec,backendName:"cpu",kernelFunc:MR};const PR={kernelName:dh,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:a,b:i,bias:o,preluActivationWeights:s}=e,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:h}=r;let d,f,p;const m=[];d=MR({inputs:{a:a,b:i},attrs:{transposeA:c,transposeB:l},backend:n}),o&&(f=AR({inputs:{a:d,b:o},backend:n}),m.push(d),d=f),u&&(p=yR(n,d,u,s,h),m.push(d),d=p);for(const g of m)n.disposeIntermediateTensorInfo(g);return d}};function LR(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const zR={kernelName:lc,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend;XA(e,"abs");let r=new Float32Array(Is(e.shape));return r=LR(n.data.get(e.dataId).values),n.makeOutput(r,e.shape,e.dtype)}},BR=JA(uc,t=>Math.acos(t)),jR={kernelName:uc,backendName:"cpu",kernelFunc:BR},UR=JA(hc,t=>Math.acosh(t)),VR={kernelName:hc,backendName:"cpu",kernelFunc:UR};const WR={kernelName:fc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,r=e;XA(e,"addN");const a=r.map(t=>n.data.get(t.dataId).values),i=Lf(r[0].shape,r[0].dtype),o=i.values;for(let s=0;s<r.length;s++){const t=a[s];for(let e=0;e<o.length;e++)o[e]+=t[e]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function GR(t,e,n,r,a){const i=e.length,o=Is(e),s=Hs(e),c=Hs(a),l=Fs(n,Is(a));for(let u=0;u<o;++u){const e=Zs(u,i,s),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[r[t]];l[$s(n,i,c)]=t[u]}return l}function HR(t){const{inputs:e,attrs:n,backend:r}=t,{x:a}=e,{perm:i}=n;XA(a,"transpose");const o=a.shape.length,s=new Array(o);for(let l=0;l<s.length;l++)s[l]=a.shape[i[l]];const c=GR(r.data.get(a.dataId).values,a.shape,a.dtype,i,s);return{dataId:r.write(c,s,a.dtype),shape:s,dtype:a.dtype}}const qR={kernelName:ah,backendName:"cpu",kernelFunc:HR};const KR={kernelName:pc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;XA(a,"all");const s=Ds(i,a.shape);let c=s;const l=xg(c,a.shape.length);let u=a;null!=l&&(u=HR({inputs:{x:a},backend:n,attrs:{perm:l}}),c=_g(c.length,a.shape.length)),wg("all",c,u.shape.length);const[h,d]=vg(u.shape,c),f=Is(d),p=Ys(Is(h),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const t=y*f;let e=m[t];for(let n=0;n<f;++n){const r=m[t+n];e=e&&r}p[y]=e}null!=l&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(h,u.dtype,p);if(o){const t=OR({inputs:{x:g},backend:n,attrs:{shape:bg(h,s)}});return n.disposeIntermediateTensorInfo(g),t}return g}};const XR={kernelName:mc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;XA(a,"any");const s=Ds(i,a.shape);let c=s;const l=xg(c,a.shape.length);let u=a;null!=l&&(u=HR({inputs:{x:a},backend:n,attrs:{perm:l}}),c=_g(c.length,a.shape.length)),wg("any",c,u.shape.length);const[h,d]=vg(u.shape,c),f=Is(d),p=Ys(Is(h),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const t=y*f;let e=m[t];for(let n=0;n<f;++n){const r=m[t+n];e=e||r}p[y]=e}null!=l&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(h,u.dtype,p);if(o){const t=OR({inputs:{x:g},backend:n,attrs:{shape:bg(h,s)}});return n.disposeIntermediateTensorInfo(g),t}return g}};const YR={kernelName:gc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;XA(a,"argMax");let o=Ds(i,a.shape);const s=xg(o,a.shape.length);let c=a;const l=[];null!=s&&(c=HR({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(c),o=_g(o.length,c.shape.length)),o=[o[0]],wg("argMax",o,c.shape.length);const[u,h]=vg(c.shape,o),d=Ys(Is(u),"int32"),f=Is(h),p=n.data.get(c.dataId).values;for(let m=0;m<d.length;++m){const t=m*f;let e=p[t],n=0;for(let r=0;r<f;++r){const a=p[t+r];a>e&&(e=a,n=r)}d[m]=n}return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(u,"int32",d)}};const QR={kernelName:yc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;XA(a,"argMin");let o=Ds(i,a.shape);const s=xg(o,a.shape.length);let c=a;const l=[];null!=s&&(c=HR({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(c),o=_g(o.length,c.shape.length)),o=[o[0]],wg("argMin",o,c.shape.length);const[u,h]=vg(c.shape,o),d=Ys(Is(u),"int32"),f=Is(h),p=n.data.get(c.dataId).values;for(let m=0;m<d.length;++m){const t=m*f;let e=p[t],n=0;for(let r=0;r<f;++r){const a=p[t+r];a<e&&(e=a,n=r)}d[m]=n}return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(u,"int32",d)}},JR=JA(vc,t=>Math.asin(t)),$R={kernelName:vc,backendName:"cpu",kernelFunc:JR},ZR=JA(bc,t=>Math.asinh(t)),tO={kernelName:bc,backendName:"cpu",kernelFunc:ZR},eO=JA(wc,t=>Math.atan(t)),nO={kernelName:wc,backendName:"cpu",kernelFunc:eO},rO=iR((t,e)=>Math.atan2(t,e)),aO=IR(kc,rO),iO={kernelName:kc,backendName:"cpu",kernelFunc:aO},oO=JA(xc,t=>Math.atanh(t)),sO={kernelName:xc,backendName:"cpu",kernelFunc:oO};function cO(t,e,n,r,a,i){const o=a.strideHeight,s=a.strideWidth,c=a.dilationHeight,l=a.dilationWidth,u=a.effectiveFilterHeight,h=a.effectiveFilterWidth,d=a.padInfo.top,f=a.padInfo.left,p="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Lf(a.outShape,n),g=m.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3],v=a.outShape[2]*a.outShape[3],b=a.outShape[3];for(let w=0;w<a.batchSize;++w){const e=w*y,n=w*r[0];for(let m=0;m<a.inChannels;++m)for(let y=0;y<a.outHeight;++y){const w=y*o-d,x=Math.max(0,w),k=Math.min(a.inHeight,u+w),_=e+y*v;for(let e=0;e<a.outWidth;++e){const o=e*s-f,u=Math.max(0,o),d=Math.min(a.inWidth,h+o);let y=p,v=0,w=0;for(let e=x;e<k;e+=c){const a=n+e*r[1];for(let e=u;e<d;e+=l){const n=t[a+e*r[2]+m];"max"===i&&n>y?y=n:"avg"===i&&(v+=n,w++)}if(isNaN(y))break}g[_+e*b+m]="avg"===i?v/w:y}}}return m}function lO(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=Lf(r.outShape,"int32"),s=r.strideHeight,c=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,f=r.padInfo.top,p=r.padInfo.left,m=Lf(e,n,t);for(let g=0;g<r.batchSize;++g)for(let t=0;t<r.inChannels;++t)for(let e=0;e<r.outHeight;++e){const n=e*s-f;let y=n;for(;y<0;)y+=l;const v=Math.min(r.inHeight,h+n);for(let s=0;s<r.outWidth;++s){const h=s*c-p;let f=h;for(;f<0;)f+=u;const b=Math.min(r.inWidth,d+h);let w=Number.NEGATIVE_INFINITY,x=-1;for(let e=y;e<v;e+=l){const o=e-n;for(let n=f;n<b;n+=u){const s=n-h,c=m.get(g,e,n,t);c>w&&(w=c,x=a?i?((g*r.inHeight+e)*r.inWidth+n)*r.inChannels+t:(e*r.inWidth+n)*r.inChannels+t:o*d+s)}}o.set(x,g,e,s,t)}}return o}function uO(t,e,n,r,a,i){const o=a.strideDepth,s=a.strideHeight,c=a.strideWidth,l=a.dilationDepth,u=a.dilationHeight,h=a.dilationWidth,d=a.effectiveFilterDepth,f=a.effectiveFilterHeight,p=a.effectiveFilterWidth,m=a.padInfo.front,g=a.padInfo.top,y=a.padInfo.left,v="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Lf(a.outShape,n),w=b.values,x=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],k=a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[3]*a.outShape[4],S=a.outShape[4];for(let T=0;T<a.batchSize;++T){const e=T*x,n=T*r[0];for(let b=0;b<a.inChannels;++b)for(let x=0;x<a.outDepth;++x){const T=x*o-m;let I=T;for(;I<0;)I+=l;const E=Math.min(a.inDepth,d+T),N=e+x*k;for(let e=0;e<a.outHeight;++e){const o=e*s-g;let d=o;for(;d<0;)d+=u;const m=Math.min(a.inHeight,f+o),x=N+e*_;for(let e=0;e<a.outWidth;++e){const o=e*c-y;let s=o;for(;s<0;)s+=h;const f=Math.min(a.inWidth,p+o),g=x+e*S;let k=v,_=0,T=0;for(let e=I;e<E;e+=l){const a=n+e*r[1];for(let e=d;e<m;e+=u){const n=a+e*r[2];for(let e=s;e<f;e+=h){const a=t[n+e*r[3]+b];if("max"===i&&a>k?k=a:"avg"===i&&(_+=a,T++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}w[g+b]="avg"===i?_/T:k}}}}return b}const hO={kernelName:_c,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;XA(a,"avgPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:c}=r;ks(gm(o,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'"));const l=om(a.shape,i,o,1,s,c);let u;if(1===l.filterWidth&&1===l.filterHeight&&Es(l.inShape,l.outShape))u=eR({inputs:{x:a},backend:n});else{const t=n.data.get(a.dataId).values,e=Hs(a.shape),r=cO(t,a.shape,a.dtype,e,l,"avg");u=n.makeTensorInfo(l.outShape,a.dtype,r.values)}return u}};const dO={kernelName:Tc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:c,dataFormat:l}=r;XA(a,"avgPool3d");const u=sm(a.shape,i,o,1,s,c,l),h=uO(n.data.get(a.dataId).values,a.shape,a.dtype,Hs(a.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}};const fO={kernelName:Ic,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,{filterSize:o,strides:s,pad:c,dimRoundingMode:l}=r;XA([a,i],"avgPool3DGrad");const u=sm(i.shape,o,s,1,c,l),h=u.strideDepth,d=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,g=u.filterWidth,y=u.dilationDepth,v=u.dilationHeight,b=u.dilationWidth,w=u.effectiveFilterDepth,x=u.effectiveFilterHeight,k=u.effectiveFilterWidth,_=w-1-u.padInfo.front,S=k-1-u.padInfo.left,T=x-1-u.padInfo.top,I=Lf(i.shape,"float32"),E=1/(p*m*g),N=n.bufferSync(a);for(let C=0;C<u.batchSize;++C)for(let t=0;t<u.inChannels;++t)for(let e=0;e<u.inDepth;++e)for(let n=0;n<u.inHeight;++n)for(let r=0;r<u.inWidth;++r){const a=e-_,i=n-T,o=r-S;let s=0;for(let e=0;e<w;e+=y){const n=(a+e)/h;if(!(n<0||n>=u.outDepth||Math.floor(n)!==n))for(let e=0;e<x;e+=v){const r=(i+e)/d;if(!(r<0||r>=u.outHeight||Math.floor(r)!==r))for(let e=0;e<k;e+=b){const a=(o+e)/f;if(a<0||a>=u.outWidth||Math.floor(a)!==a)continue;s+=N.get(C,n,r,a,t)}}}I.set(s*E,C,e,n,r,t)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}};const pO={kernelName:Sc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i;XA([a,i],"avgPoolGrad");const{filterSize:s,strides:c,pad:l}=r,u=om(o.shape,s,c,1,l),h=u.strideHeight,d=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,g=u.dilationWidth,y=u.effectiveFilterHeight,v=u.effectiveFilterWidth,b=v-1-u.padInfo.left,w=y-1-u.padInfo.top,x=Lf(o.shape,"float32"),k=1/(f*p),_=n.data.get(a.dataId).values,S=Lf(a.shape,"float32",_);for(let T=0;T<u.batchSize;++T)for(let t=0;t<u.inChannels;++t)for(let e=0;e<u.inHeight;++e)for(let n=0;n<u.inWidth;++n){const r=e-w,a=n-b;let i=0;for(let e=0;e<y;e+=m){const n=(r+e)/h;if(!(n<0||n>=u.outHeight||Math.floor(n)!==n))for(let e=0;e<v;e+=g){const r=(a+e)/d;if(r<0||r>=u.outWidth||Math.floor(r)!==r)continue;i+=S.get(T,n,r,t)}}x.set(i*k,T,e,n,t)}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};const mO={kernelName:yl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,scale:i,offset:o,mean:s,variance:c}=e;ks(s.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ks(null==o||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ks(null==i||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),XA([a,s,c,i,o],"batchNorm");let{varianceEpsilon:l}=r;null==l&&(l=.001);const u=n.data.get(a.dataId).values,h=n.data.get(s.dataId).values,d=n.data.get(c.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),g=p.length,y=f.length,v=d.length,b=h.length;let w=0,x=0,k=0,_=0;for(let S=0;S<u.length;++S)m[S]=p[w++]+(u[S]-h[x++])*f[k++]/Math.sqrt(d[_++]+l),w>=g&&(w=0),x>=b&&(x=0),k>=y&&(k=0),_>=v&&(_=0);return n.makeTensorInfo(a.shape,a.dtype,m)}};function gO(t,e,n,r,a){const i=Np(r,e,n),o=Is(n),s=Hs(r);if(i){const n=Cp(e,s);return"string"===a?t.slice(n,n+o):t.subarray(n,n+o)}const c=Lf(r,a,"string"===a?Ax(t):t),l=Lf(n,a);for(let u=0;u<l.size;++u){const t=l.indexToLoc(u),n=t.map((t,n)=>t+e[n]);l.set(c.get(...n),...t)}return"string"===a?Rx(l.values):l.values}function yO(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,size:o}=r;XA(a,"slice");const[s,c]=Ap(a,i,o);gp(a,s,c);const l=gO(n.data.get(a.dataId).values,s,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,l)}const vO={kernelName:Au,backendName:"cpu",kernelFunc:yO};const bO={kernelName:Nc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,crops:o}=r;XA([a],"batchToSpaceND");const s=i.reduce((t,e)=>t*e),c=Pw(a.shape,i,s),l=Lw(c.length,i.length),u=zw(a.shape,i,s),h=Bw(o,i.length),d=jw(u,o,i.length),f=OR({inputs:{x:a},backend:n,attrs:{shape:c}}),p=HR({inputs:{x:f},backend:n,attrs:{perm:l}}),m=OR({inputs:{x:p},backend:n,attrs:{shape:u}}),g=yO({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}};function wO(t,e,n,r,a){const i=Is(r),o=Ys(a,n);for(let s=0;s<t.length;s++){const n=t[s];if(n<0)throw new Error("Input x must be non-negative!");n>=a||(o[n]+=i>0?e[s]:1)}return o}function xO(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=t.shape[0],i=t.shape[1],o=Lf([a,n],e.dtype);for(let s=0;s<a;s++)for(let a=0;a<i;a++){const i=t.get(s,a);if(i<0)throw new Error("Input x must be non-negative!");i>=n||(r?o.set(1,s,i):e.size>0?o.set(o.get(s,i)+e.get(s,a),s,i):o.set(o.get(s,i)+1,s,i))}return o}const kO={kernelName:Cc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o}=r,s=wO(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}};const _O={kernelName:Ac,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=lp(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},SO=fR(t=>Math.ceil(t)),TO=$A(Oc,SO),IO={kernelName:Oc,backendName:"cpu",kernelFunc:TO},EO=JA(Dc,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),NO={kernelName:Dc,backendName:"cpu",kernelFunc:EO},CO={kernelName:Fc,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(Is(e.shape)),a=n.data.get(e.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,s=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values;for(let l=0;l<s.length;l++){const t=s[l],e=c[l];r[l]=Math.hypot(t,e)}return n.makeOutput(r,e.shape,"float32")}};function AO(t,e,n,r){const a=Ps(n,Is(e));if(r&&"string"!==n){let e=0;t.forEach(t=>{const n=Is(t.shape);a.set(t.vals,e),e+=n})}else{let r=0;t.forEach(t=>{const i="string"===n?Ax(t.vals):t.vals;let o=0;for(let n=0;n<t.shape[0];++n){const s=n*e[1]+r;for(let e=0;e<t.shape[1];++e)a[s+e]=i[o++]}r+=t.shape[1]})}return a}function RO(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const OO={kernelName:Sl,backendName:"cpu",kernelFunc:RO};function DO(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r,i=Ds(a,e[0].shape)[0];Iw(e.map(t=>t.shape),i);let o=Ew(e.map(t=>t.shape),i);if(0===Is(o))return n.makeTensorInfo(o,e[0].dtype,[]);const s=e.filter(t=>Is(t.shape)>0);if(1===s.length)return eR({inputs:{x:s[0]},backend:n});if("complex64"===s[0].dtype){const t=s.map(t=>xR({inputs:{input:t},backend:n})),e=s.map(t=>RO({inputs:{input:t},backend:n})),r=DO({inputs:t,backend:n,attrs:{axis:i}}),a=DO({inputs:e,backend:n,attrs:{axis:i}}),o=vR({inputs:{real:r,imag:a},backend:n});return t.forEach(t=>n.disposeIntermediateTensorInfo(t)),e.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),o}const c=s.map(t=>{const e=Is(t.shape.slice(i));return OR({inputs:{x:t},backend:n,attrs:{shape:[-1,e]}})}),l=c.map(t=>({vals:n.data.get(t.dataId).values,shape:t.shape}));o=Ew(c.map(t=>t.shape),1);const u=1===c[0].shape[0],h=AO(l,o,e[0].dtype,u),d=Ew(s.map(t=>t.shape),i),f=n.makeTensorInfo(d,e[0].dtype,h);return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),f}const MO={kernelName:Pc,backendName:"cpu",kernelFunc:DO};function FO(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dataFormat:c,dilations:l,dimRoundingMode:u}=r;XA([a,i],"conv2d");const h=ym(c),d=cm(a.shape,i.shape,o,l,s,u,!1,h),f=d.filterHeight,p=d.filterWidth,m=d.dilationHeight,g=d.dilationWidth,y=d.padInfo.left,v=d.padInfo.top,b="channelsLast"===d.dataFormat,w=new $h(d.outShape,a.dtype),x=Hs(a.shape),k=Hs(i.shape),_=x[0],S=b?x[1]:x[2],T=b?x[2]:1,I=b?1:x[1],E=w.strides[0],N=b?w.strides[1]:w.strides[2],C=b?w.strides[2]:1,A=b?1:w.strides[1],R=n.data.get(a.dataId).values,O=n.data.get(i.dataId).values,D=w.values;for(let M=0;M<d.batchSize;++M){const t=M*_,e=M*E;for(let n=0;n<d.outHeight;++n){const r=e+n*N,a=n*d.strideHeight-v;for(let e=0;e<f;++e){const n=a+e*m;if(n<0||n>=d.inHeight)continue;const i=e*k[0],o=t+n*S;for(let t=0;t<d.outWidth;++t){const e=r+t*C,n=t*d.strideWidth-y;for(let t=0;t<p;++t){const r=n+t*g;if(r<0||r>=d.inWidth)continue;const a=o+r*T;let s=i+t*k[1];for(let t=0;t<d.inChannels;++t){const n=R[a+t*I];for(let t=0;t<d.outChannels;++t)D[e+t*A]+=n*O[s+t];s+=d.outChannels}}}}}}return n.makeTensorInfo(w.shape,w.dtype,D)}const PO={kernelName:Lc,backendName:"cpu",kernelFunc:FO};const LO={kernelName:zc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,dataFormat:c,dimRoundingMode:l,filterShape:u}=r;XA([a,i],"conv2dBackpropFilter");const h=ym(c),d=cm(a.shape,u,o,1,s,l,!1,h),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:g}=d,y="channelsLast"===d.dataFormat,v=new $h(d.filterShape,"float32"),b=d.padInfo.left,w=d.padInfo.top,x=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,_=new $h(a.shape,a.dtype,x),S=new $h(i.shape,i.dtype,k);for(let T=0;T<m;++T){const t=Math.max(0,Math.ceil((w-T)/f)),e=Math.min(d.outHeight,(d.inHeight+w-T)/f);for(let n=0;n<g;++n){const r=Math.max(0,Math.ceil((b-n)/p)),a=Math.min(d.outWidth,(d.inWidth+b-n)/p);for(let i=0;i<d.inChannels;++i)for(let o=0;o<d.outChannels;++o){let s=0;for(let c=0;c<d.batchSize;++c)for(let l=t;l<e;++l){const t=T+l*f-w;for(let e=r;e<a;++e){const r=n+e*p-b;s+=y?_.get(c,t,r,i)*S.get(c,l,e,o):_.get(c,i,t,r)*S.get(c,o,l,e)}}v.set(s,T,n,i,o)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const zO={kernelName:Bc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{inputShape:o,strides:s,pad:c,dataFormat:l,dimRoundingMode:u}=r;XA([a,i],"conv2dBackpropInput");const h=Hs(i.shape),d=Hs(a.shape);let f=ym(l);const p=cm(o,i.shape,s,1,c,u,!1,f),m=new $h(p.inShape,"float32"),g=m.values,y=n.data.get(a.dataId).values,v=n.data.get(i.dataId).values,[b,w,x]=h,{batchSize:k,filterHeight:_,filterWidth:S,inChannels:T,inHeight:I,inWidth:E,outChannels:N,outHeight:C,outWidth:A,strideHeight:R,strideWidth:O}=p;f=p.dataFormat;const D=_-1-p.padInfo.top,M=S-1-p.padInfo.left,F="channelsLast"===f,P=m.strides[0],L=F?m.strides[1]:m.strides[2],z=F?m.strides[2]:1,B=F?1:m.strides[1],j=d[0],U=F?d[1]:d[2],V=F?d[2]:1,W=F?1:d[1];for(let G=0;G<k;++G)for(let t=0;t<T;++t)for(let e=0;e<I;++e){const n=e-D,r=Math.max(0,Math.ceil(n/R)),a=Math.min(C,(_+n)/R);for(let i=0;i<E;++i){const o=i-M,s=Math.max(0,Math.ceil(o/O)),c=Math.min(A,(S+o)/O);let l=0;for(let e=r;e<a;++e){const r=e*R-n;for(let n=s;n<c;++n){const a=j*G+U*e+V*n,i=b*(_-1-r)+w*(S-1-(n*O-o))+x*t;for(let t=0;t<N;++t){l+=y[a+W*t]*v[i+t]}}}g[P*G+L*e+z*i+B*t]=l}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}};const BO={kernelName:jc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:c}=r;XA([a,i],"conv3d");const l=lm(a.shape,i.shape,o,c,s),{filterDepth:u,filterHeight:h,filterWidth:d,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:g}=l,y=g.front,v=g.left,b=g.top,w=new $h(l.outShape,a.dtype),x=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,_=w.values,S=Hs(a.shape),T=Hs(i.shape);for(let I=0;I<l.batchSize;++I){const t=I*S[0],e=I*w.strides[0];for(let n=0;n<l.outDepth;++n){const r=e+n*w.strides[1],a=n*l.strideDepth-y;for(let e=0;e<u;++e){const n=a+e*f;if(n<0||n>=l.inDepth)continue;const i=e*T[0],o=t+n*S[1];for(let t=0;t<l.outHeight;++t){const e=r+t*w.strides[2],n=t*l.strideHeight-b;for(let t=0;t<h;++t){const r=n+t*p;if(r<0||r>=l.inHeight)continue;const a=i+t*T[1],s=o+r*S[2];for(let t=0;t<l.outWidth;++t){const n=e+t*l.outChannels,r=t*l.strideWidth-v;for(let t=0;t<d;++t){const e=r+t*m;if(e<0||e>=l.inWidth)continue;const i=a+t*T[2],o=s+e*l.inChannels;let c=i;for(let t=0;t<l.inChannels;++t){const e=x[o+t];for(let t=0;t<l.outChannels;++t)_[n+t]+=e*k[c+t];c+=l.outChannels}}}}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};const jO={kernelName:Uc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,filterShape:c}=r;XA([a,i],"conv3dBackpropFilterV2");const l=Hs(a.shape),u=Hs(i.shape),h=lm(a.shape,c,o,1,s),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,m=h.filterDepth,g=h.filterHeight,y=h.filterWidth,v=new $h(h.filterShape,"float32"),b=v.values,[w,x,k,_]=v.strides,S=n.data.get(i.dataId).values,[T,I,E,N]=u,C=n.data.get(a.dataId).values,[A,R,O,D]=l,M=h.padInfo.front,F=h.padInfo.left,P=h.padInfo.top;for(let L=0;L<m;++L){const t=Math.max(0,Math.ceil((M-L)/d)),e=Math.min(h.outDepth,(h.inDepth+M-L)/d),n=L*w;for(let r=0;r<g;++r){const a=Math.max(0,Math.ceil((P-r)/f)),i=Math.min(h.outHeight,(h.inHeight+P-r)/f),o=r*x+n;for(let n=0;n<y;++n){const s=Math.max(0,Math.ceil((F-n)/p)),c=Math.min(h.outWidth,(h.inWidth+F-n)/p),l=n*k+o;for(let o=0;o<h.inChannels;++o){const u=o*_+l;for(let l=0;l<h.outChannels;++l){let m=0;for(let u=0;u<h.batchSize;++u){const h=u*A,g=u*T;for(let u=t;u<e;++u){const t=(L+u*d-M)*R+h,e=u*I+g;for(let u=a;u<i;++u){const a=(r+u*f-P)*O+t,i=u*E+e;for(let t=s;t<c;++t){const e=t*N+i;m+=C[(n+t*p-F)*D+a+o]*S[e+l]}}}}b[u+l]=m}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};const UO={kernelName:Vc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{pad:o,strides:s,inputShape:c}=r;XA([a],"conv3dBackpropInputV2");const l=Hs(a.shape),u=Hs(i.shape),h=lm(c,i.shape,s,1,o),d=new $h(h.inShape,"float32"),f=d.values,[p,m,g,y]=d.strides,v=n.data.get(a.dataId).values,[b,w,x,k]=l,_=n.data.get(i.dataId).values,[S,T,I,E]=u,{batchSize:N,filterDepth:C,filterHeight:A,filterWidth:R,inChannels:O,inDepth:D,inHeight:M,inWidth:F,outChannels:P,outDepth:L,outHeight:z,outWidth:B,strideDepth:j,strideHeight:U,strideWidth:V}=h,W=C-1-h.padInfo.front,G=A-1-h.padInfo.top,H=R-1-h.padInfo.left;for(let q=0;q<N;++q)for(let t=0;t<O;++t)for(let e=0;e<D;++e){const n=e-W,r=Math.max(0,Math.ceil(n/j)),a=Math.min(L,(C+n)/j);for(let i=0;i<M;++i){const o=i-G,s=Math.max(0,Math.ceil(o/U)),c=Math.min(z,(A+o)/U);for(let l=0;l<F;++l){const u=l-H,h=Math.max(0,Math.ceil(u/V)),d=Math.min(B,(R+u)/V);let N=0;for(let e=r;e<a;++e){const r=e*j-n;for(let n=s;n<c;++n){const a=n*U-o;for(let i=h;i<d;++i){const o=b*q+w*e+x*n+k*i,s=S*(C-1-r)+T*(A-1-a)+I*(R-1-(i*V-u))+E*t;for(let t=0;t<P;++t){N+=v[o+t]*_[s+t]}}}}f[p*q+m*e+g*i+y*l+t]=N}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}},VO=JA(Wc,t=>Math.cos(t)),WO={kernelName:Wc,backendName:"cpu",kernelFunc:VO},GO=JA(Gc,t=>Math.cosh(t)),HO={kernelName:Gc,backendName:"cpu",kernelFunc:GO};const qO={kernelName:Kc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:i,boxInd:o}=e,{cropSize:s,method:c,extrapolationValue:l}=r,[u,h,d,f]=a.shape,p=i.shape[0],[m,g]=s,y=Lf([p,m,g,f],"float32"),v=n.data.get(i.dataId).values,b=n.data.get(o.dataId).values,w=n.data.get(a.dataId).values,x=Hs(a.shape),k=Hs(y.shape);for(let _=0;_<p;_++){const t=4*_,e=v[t],n=v[t+1],r=v[t+2],a=v[t+3],i=b[_];if(i>=u)continue;const o=m>1?(r-e)*(h-1)/(m-1):0,s=g>1?(a-n)*(d-1)/(g-1):0;for(let u=0;u<m;u++){const t=m>1?e*(h-1)+u*o:.5*(e+r)*(h-1);if(t<0||t>h-1)for(let e=0;e<g;e++)for(let t=0;t<f;t++){const n=t+e*k[2]+u*k[1]+_*k[0];y.values[n]=l}else if("bilinear"===c){const e=Math.floor(t),r=Math.ceil(t),o=t-e;for(let t=0;t<g;t++){const c=g>1?n*(d-1)+t*s:.5*(n+a)*(d-1);if(c<0||c>d-1){for(let e=0;e<f;e++){const n=e+t*k[2]+u*k[1]+_*k[0];y.values[n]=l}continue}const h=Math.floor(c),p=Math.ceil(c),m=c-h;for(let n=0;n<f;n++){let a=n+h*x[2]+e*x[1]+i*x[0];const s=w[a];a=n+p*x[2]+e*x[1]+i*x[0];const c=w[a];a=n+h*x[2]+r*x[1]+i*x[0];const l=w[a];a=n+p*x[2]+r*x[1]+i*x[0];const d=s+(c-s)*m,f=l+(w[a]-l)*m;a=n+t*k[2]+u*k[1]+_*k[0],y.values[a]=d+(f-d)*o}}}else for(let e=0;e<g;++e){const r=g>1?n*(d-1)+e*s:.5*(n+a)*(d-1);if(r<0||r>d-1){for(let t=0;t<f;t++){const n=t+e*k[2]+u*k[1]+_*k[0];y.values[n]=l}continue}const o=Math.round(r),c=Math.round(t);for(let t=0;t<f;t++){const n=t+o*x[2]+c*x[1]+i*x[0],r=t+e*k[2]+u*k[1]+_*k[0];y.values[r]=w[n]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};const KO={kernelName:Hc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;XA(a,"cumprod");const c=xg([i],a.shape.length);let l=a;null!=c&&(l=HR({inputs:{x:a},backend:n,attrs:{perm:c}}));const u=_g(1,a.shape.length)[0];if(u!==l.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(u));const h=hd(l.dtype,"int32"),d=Xs(Is(l.shape),h),f=n.data.get(l.dataId).values,p=l.shape[l.shape.length-1],m=s?(t,e)=>t+p-e-1:(t,e)=>t+e;for(let y=0;y<f.length;y+=p)for(let t=0;t<p;t++){const e=m(y,t);if(0===t)d[e]=o?1:f[e];else{const n=m(y,t-1);d[e]=o?f[n]*d[n]:f[e]*d[n]}}const g=n.makeTensorInfo(l.shape,h,d);if(null!=c){const t=HR({inputs:{x:g},backend:n,attrs:{perm:kg(c)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(l),t}return g}};const XO={kernelName:qc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;XA(a,"cumsum");const c=xg([i],a.shape.length);let l=a;null!=c&&(l=HR({inputs:{x:a},backend:n,attrs:{perm:c}}));const u=_g(1,a.shape.length)[0];if(u!==l.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(l.shape.length-1," but got axis=").concat(u));const h=hd(l.dtype,"int32"),d=Ys(Is(l.shape),h),f=n.data.get(l.dataId).values,p=l.shape[l.shape.length-1],m=s?(t,e)=>t+p-e-1:(t,e)=>t+e;for(let y=0;y<f.length;y+=p)for(let t=0;t<p;t++){const e=m(y,t);if(0===t)d[e]=o?0:f[e];else{const n=m(y,t-1);d[e]=o?f[n]+d[n]:f[e]+d[n]}}const g=n.makeTensorInfo(l.shape,h,d);if(null!=c){const t=HR({inputs:{x:g},backend:n,attrs:{perm:kg(c)}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(l),t}return g}};const YO={kernelName:Xc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o,binaryOutput:s}=r;if(1===a.shape.length){const t=wO(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,t)}if(2===a.shape.length){const t=xO(n.bufferSync(a),n.bufferSync(i),o,s);return n.makeTensorInfo(t.shape,i.dtype,t.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};const QO={kernelName:Yc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:i,dataFormat:o}=r;ks("NHWC"===o,()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o));const s=a.shape[0],c=a.shape[1],l=a.shape[2],u=a.shape[3],h=c*i,d=l*i,f=u/(i*i),p=n.data.get(a.dataId).values,m=new Float32Array(s*h*d*f);let g=0;for(let y=0;y<s;++y)for(let t=0;t<h;++t){const e=Math.floor(t/i),n=t%i;for(let t=0;t<d;++t){const r=Math.floor(t/i),a=(n*i+t%i)*f;for(let t=0;t<f;++t){const n=t+a+u*(r+l*(e+c*y));m[g++]=p[n]}}}return n.makeTensorInfo([s,h,d,f],a.dtype,m)}};function JO(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:c,dimRoundingMode:l}=r;XA([a,i],"depthwiseConv2DNative");const u=Hs(a.shape),h=Hs(i.shape);let d=c;null==d&&(d=[1,1]),ks(gm(o,d),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(d,"'"));const f=cm(a.shape,i.shape,o,d,s,l,!0),{filterHeight:p,filterWidth:m,dilationHeight:g,dilationWidth:y,padInfo:v}=f,b=v.left,w=v.top,x=f.outChannels/f.inChannels,k=new $h(f.outShape,a.dtype),_=n.data.get(a.dataId).values,S=n.data.get(i.dataId).values,T=k.values;for(let I=0;I<f.batchSize;++I){const t=I*u[0],e=I*k.strides[0];for(let n=0;n<f.outHeight;++n){const r=e+n*k.strides[1],a=n*f.strideHeight-w;for(let e=0;e<p;++e){const n=a+e*g;if(n<0||n>=f.inHeight)continue;const i=e*h[0],o=t+n*u[1];for(let t=0;t<f.outWidth;++t){const e=r+t*k.strides[2],n=t*f.strideWidth-b;for(let t=0;t<m;++t){const r=n+t*y;if(r<0||r>=f.inWidth)continue;const a=i+t*h[1],s=o+r*f.inChannels;let c=e,l=a;for(let t=0;t<f.inChannels;++t){const e=_[s+t];for(let t=0;t<x;++t)T[c+t]+=e*S[l+t];c+=x,l+=x}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const $O={kernelName:Qc,backendName:"cpu",kernelFunc:JO};const ZO={kernelName:Jc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,dilations:s,pad:c,dimRoundingMode:l,filterShape:u}=r;XA([a,i],"depthwiseConv2dNativeBackpropFilter");const h=cm(a.shape,u,o,s,c,l,!0),{strideHeight:d,strideWidth:f,filterHeight:p,filterWidth:m}=h,g=new $h(h.filterShape,"float32"),y=h.padInfo.left,v=h.padInfo.top,b=h.outChannels/h.inChannels,w=n.data.get(a.dataId).values,x=new $h(a.shape,a.dtype,w),k=n.data.get(i.dataId).values,_=new $h(i.shape,i.dtype,k);for(let S=0;S<p;++S){const t=Math.max(0,Math.ceil((v-S)/d)),e=Math.min(h.outHeight,(h.inHeight+v-S)/d);for(let n=0;n<m;++n){const r=Math.max(0,Math.ceil((y-n)/f)),a=Math.min(h.outWidth,(h.inWidth+y-n)/f);for(let i=0;i<h.outChannels;++i){const o=Math.trunc(i/b),s=i%b;let c=0;for(let l=0;l<h.batchSize;++l)for(let s=t;s<e;++s){const t=S+s*d-v;for(let e=r;e<a;++e){const r=n+e*f-y;c+=x.get(l,t,r,o)*_.get(l,s,e,i)}}g.set(c,S,n,o,s)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};const tD={kernelName:$c,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{strides:o,dilations:s,pad:c,dimRoundingMode:l,inputShape:u}=r;XA([a,i],"depthwiseConv2DNativeBackpropInput");const h=Hs(a.shape),d=Hs(i.shape),f=cm(u,i.shape,o,s,c,l,!0),p=new $h(f.inShape,"float32"),m=p.values,[g,y,v]=p.strides,b=n.data.get(a.dataId).values,[w,x,k]=h,_=n.data.get(i.dataId).values,[S,T,I]=d,{batchSize:E,filterHeight:N,filterWidth:C,inChannels:A,inHeight:R,inWidth:O,outChannels:D,outHeight:M,outWidth:F,strideHeight:P,strideWidth:L}=f,z=N-1-f.padInfo.top,B=C-1-f.padInfo.left,j=D/A;for(let U=0;U<E;++U)for(let t=0;t<A;++t)for(let e=0;e<R;++e){const n=e-z,r=Math.max(0,Math.ceil(n/P)),a=Math.min(M,(N+n)/P);for(let i=0;i<O;++i){const o=i-B,s=Math.max(0,Math.ceil(o/L)),c=Math.min(F,(C+o)/L);let l=0;for(let e=r;e<a;++e){const r=e*P-n;for(let n=s;n<c;++n){const a=w*U+x*e+k*n,i=S*(N-1-r)+T*(C-1-(n*L-o))+I*t;for(let e=0;e<j;++e){l+=b[a+(t*j+e)]*_[i+e]}}}m[g*U+y*e+v*i+t]=l}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}};const eD={kernelName:Zc,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,a=Is(r.shape),i=n.data.get(r.dataId).values,o=Lf([a,a],r.dtype),s=o.values;for(let l=0;l<i.length;l++)s[l*a+l]=i[l];const c=[...r.shape,...r.shape];return n.makeTensorInfo(c,o.dtype,o.values)}},nD={kernelName:tl,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:a,filter:i}=e,{strides:o,pad:s,dilations:c}=r,l=n,u=l.data.get(a.dataId).values,h=a.shape.length,d=l.data.get(i.dataId).values,f=i.shape.length,{batchSize:p,inHeight:m,inWidth:g,inChannels:y,outHeight:v,outWidth:b,padInfo:w,strideHeight:x,strideWidth:k,filterHeight:_,filterWidth:S,dilationHeight:T,dilationWidth:I,outShape:E}=im(a.shape,i.shape,o,s,"NHWC",c),N=Is(E),C=E.length,A=Ps(a.dtype,N);for(let R=0;R<p;++R)for(let t=0;t<v;++t){const e=t*x-w.top;for(let n=0;n<b;++n){const r=n*k-w.left;for(let o=0;o<y;++o){let s=Number.MIN_SAFE_INTEGER;for(let t=0;t<_;++t){const n=e+t*T;if(n>=0&&n<m)for(let e=0;e<S;++e){const c=r+e*I;if(c>=0&&c<g){const r=$s([R,n,c,o],h,Hs(a.shape)),l=$s([t,e,o],f,Hs(i.shape)),p=u[r]+d[l];p>s&&(s=p)}}}A[$s([R,t,n,o],C,Hs(E))]=s}}}return{dataId:l.write(jh(A,a.dtype),E,a.dtype),shape:E,dtype:a.dtype}}},rD={kernelName:nl,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:a,filter:i,dy:o}=e,{strides:s,pad:c,dilations:l}=r,u=n,h=Ks(a.shape,u.data.get(a.dataId).values),d=Ks(i.shape,u.data.get(i.dataId).values),{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:y,outWidth:v,padInfo:b,strideHeight:w,strideWidth:x,filterHeight:k,filterWidth:_,dilationHeight:S,dilationWidth:T,outShape:I}=im(a.shape,i.shape,s,c,"NHWC",l);ks(o.rank===I.length,()=>"Error in ".concat(nl,", dy ")+"must have the same rank as output ".concat(I.length,", but got ")+"".concat(o.rank));const E=Ks(I,u.data.get(o.dataId).values),N=Qs(i.shape,i.dtype);for(let C=0;C<f;++C)for(let t=0;t<y;++t){const e=t*w-b.top;for(let n=0;n<v;++n){const r=n*x-b.left;for(let a=0;a<g;++a){let i=Number.MIN_SAFE_INTEGER,o=0,s=0;for(let t=0;t<k;++t){const n=e+t*S;if(n>=0&&n<p)for(let e=0;e<_;++e){const c=r+e*T;if(c>=0&&c<m){const r=h[C][n][c][a]+d[t][e][a];r>i&&(i=r,o=t,s=e)}}}N[o][s][a]+=E[C][t][n][a]}}}return{dataId:u.write(jh(N,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},aD={kernelName:el,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:a,filter:i,dy:o}=e,{strides:s,pad:c,dilations:l}=r,u=n,h=Ks(a.shape,u.data.get(a.dataId).values),d=Ks(i.shape,u.data.get(i.dataId).values),{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:y,outWidth:v,padInfo:b,strideHeight:w,strideWidth:x,filterHeight:k,filterWidth:_,dilationHeight:S,dilationWidth:T,outShape:I}=im(a.shape,i.shape,s,c,"NHWC",l);ks(o.rank===I.length,()=>"Error in ".concat(el,", dy ")+"must have the same rank as output ".concat(I.length,", but got ")+"".concat(o.rank));const E=Ks(I,u.data.get(o.dataId).values),N=Qs(a.shape,a.dtype);for(let C=0;C<f;++C)for(let t=0;t<y;++t){const e=t*w-b.top;for(let n=0;n<v;++n){const r=n*x-b.left;for(let a=0;a<g;++a){let i=Number.MIN_SAFE_INTEGER,o=e<0?0:e,s=r<0?0:r;for(let t=0;t<k;++t){const n=e+t*S;if(n>=0&&n<p)for(let e=0;e<_;++e){const c=r+e*T;if(c>=0&&c<m){const r=h[C][n][c][a]+d[t][e][a];r>i&&(i=r,o=n,s=c)}}}N[C][o][s][a]+=E[C][t][n][a]}}}return{dataId:u.write(jh(N,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},iD=iR((t,e)=>t*e),oD=ER((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),sD=IR($l,iD,oD),cD={kernelName:$l,backendName:"cpu",kernelFunc:sD};function lD(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;let s;XA(a,"sum"),s="bool"===a.dtype?SR({inputs:{x:a},backend:n,attrs:{dtype:"int32"}}):eR({inputs:{x:a},backend:n});const c=s.shape.length,l=Ds(i,s.shape),u=xg(l,c);let h=l,d=s;null!=u&&(d=HR({inputs:{x:s},backend:n,attrs:{perm:u}}),h=_g(h.length,c)),wg("sum",h,d.shape.length);const[f,p]=vg(d.shape,h);let m=wR(n,f,hd(d.dtype,"int32"));const g=Is(p),y=n.data.get(m.dataId).values,v=n.data.get(d.dataId).values;for(let b=0;b<y.length;++b){const t=b*g;let e=0;for(let n=0;n<g;++n)e+=v[t+n];y[b]=e}if(o){const t=m;m=OR({inputs:{x:m},backend:n,attrs:{shape:bg(m.shape,l)}}),n.disposeIntermediateTensorInfo(t)}return n.disposeIntermediateTensorInfo(s),null!=u&&n.disposeIntermediateTensorInfo(d),m}const uD={kernelName:Lu,backendName:"cpu",kernelFunc:lD};const hD={kernelName:al,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{equation:a}=r,i=e,{allDims:o,summedDims:s,idDims:c}=cx(a,i.length);ux(o.length,c,i);const{path:l,steps:u}=hx(s,c),h=u.length;let d=null,f=o.length;const p=[];for(let m=0;m<h;++m){for(const t of u[m]){const{permutationIndices:e,expandDims:r}=lx(f,c[t]);let a;dx(e)?a=i[t]:(a=HR({inputs:{x:i[t]},backend:n,attrs:{perm:e}}),p.push(a));const o=a.shape.slice();for(let t=0;t<r.length;++t)o.splice(r[t],0,1);Es(a.shape,o)||(a=OR({inputs:{x:a},backend:n,attrs:{shape:o}}),p.push(a)),null===d?d=a:(d=sD({inputs:{a:a,b:d},backend:n}),p.push(d))}m<h-1&&(l[m]>=0&&(d=lD({inputs:{x:d},backend:n,attrs:{axis:l[m]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const m of p)m!==d&&n.disposeIntermediateTensorInfo(m);return d}};const dD={kernelName:ol,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{dy:r,y:a}=e;XA([r,a],"eluGrad");const i=new Float32Array(Is(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values;for(let c=0;c<o.length;++c){const t=o[c];i[c]=t>=1?s[c]:s[c]*(t+1)}return n.makeTensorInfo(a.shape,"float32",i)}},fD=iR((t,e)=>t===e?1:0),pD=IR(cl,fD,null,"bool"),mD={kernelName:cl,backendName:"cpu",kernelFunc:pD},gD=Gw,yD=Hw,vD=qw,bD=Kw,wD=Xw,xD=Yw,kD=JA(sl,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+gD*n);return e*(1-((((xD*r+wD)*r+bD)*r+vD)*r+yD)*r*Math.exp(-n*n))}),_D={kernelName:sl,backendName:"cpu",kernelFunc:kD},SD=fR(t=>Math.exp(t)),TD=$A(ll,SD,"float32"),ID={kernelName:ll,backendName:"cpu",kernelFunc:TD};function ED(t){const{inputs:e,backend:n,attrs:r}=t,{input:a}=e,{dim:i}=r,o=a.shape.length,s=a.shape.slice();let c=i;return i<0&&(ks(-(o+1)<=i,()=>"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")),c=o+i+1),s.splice(c,0,1),OR({inputs:{x:a},backend:n,attrs:{shape:s}})}const ND={kernelName:ul,backendName:"cpu",kernelFunc:ED},CD=fR(t=>Math.expm1(t)),AD=$A(hl,CD),RD={kernelName:hl,backendName:"cpu",kernelFunc:AD},OD=iR((t,e)=>t/e),DD=IR(rl,OD),MD={kernelName:rl,backendName:"cpu",kernelFunc:DD},FD=iR((t,e)=>t-e),PD=ER((t,e,n,r)=>({real:t-n,imag:e-r})),LD=IR($u,FD,PD),zD={kernelName:$u,backendName:"cpu",kernelFunc:LD};function BD(t,e,n){const r=t.shape,a=r[0],i=r[1],o=n.data.get(t.dataId),s=o.complexTensorInfos.real,c=o.complexTensorInfos.imag,l=[a,i],u=Is(l),h=Fs("float32",u),d=Fs("float32",u);for(let g=0;g<a;g++){const t=yO({inputs:{x:s},backend:n,attrs:{begin:[g,0],size:[1,i]}}),r=yO({inputs:{x:c},backend:n,attrs:{begin:[g,0],size:[1,i]}}),a=vR({inputs:{real:t,imag:r},backend:n}),{real:o,imag:l}=jD(a,e,n),u=Qw(o,l);for(let e=0;e<i;e++){const t=tx(u,e);h[g*i+e]=t.real,d[g*i+e]=t.imag}n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a)}const f=n.makeTensorInfo(l,"float32",h),p=n.makeTensorInfo(l,"float32",d),m=vR({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function jD(t,e,n){const r=Is(t.shape),a=n.data.get(t.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((s=r)&s-1)){const a=UD(i,o,r,e,n),s=[t.shape[0],t.shape[1]];if(e){const t=n.makeTensorInfo(s,"float32",a.real),e=n.makeTensorInfo(s,"float32",a.imag),i=n.makeTensorInfo([],"float32",Bh(r,"float32")),o=eR({inputs:{x:i},backend:n}),c=MD.kernelFunc({inputs:{a:t,b:i},backend:n}),l=MD.kernelFunc({inputs:{a:e,b:o},backend:n}),u=n.data.get(c.dataId).values,h=n.data.get(l.dataId).values;return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),{real:u,imag:h}}return a}{const t=function(t,e,n){const r=new Float32Array(2*e);for(let a=0;a<e;a++){let i=0,o=0;for(let r=0;r<e;r++){const s=rx(a*r,e,n),c=tx(t,r);i+=c.real*s.real-c.imag*s.imag,o+=c.real*s.imag+c.imag*s.real}n&&(i/=e,o/=e),ex(r,i,o,a)}return r}(Qw(i,o),r,e);return Jw(t)}var s}function UD(t,e,n,r,a){if(1===n)return{real:t,imag:e};const i=Qw(t,e),o=n/2,s=$w(i),c=s.real,l=s.imag,u=[c.length],h=a.makeTensorInfo(u,"float32",c),d=a.makeTensorInfo(u,"float32",l),f=vR({inputs:{real:h,imag:d},backend:a}),p=Zw(i),m=p.real,g=p.imag,y=[m.length],v=a.makeTensorInfo(y,"float32",m),b=a.makeTensorInfo(y,"float32",g),w=vR({inputs:{real:v,imag:b},backend:a}),x=UD(c,l,o,r,a),k=x.real,_=x.imag,S=[k.length],T=a.makeTensorInfo(S,"float32",k),I=a.makeTensorInfo(S,"float32",_),E=vR({inputs:{real:T,imag:I},backend:a}),N=UD(m,g,o,r,a),C=N.real,A=N.imag,R=[C.length],O=a.makeTensorInfo(R,"float32",C),D=a.makeTensorInfo(R,"float32",A),M=vR({inputs:{real:O,imag:D},backend:a}),F=nx(n,r),P=[F.real.length],L=a.makeTensorInfo(P,"float32",F.real),z=a.makeTensorInfo(P,"float32",F.imag),B=vR({inputs:{real:L,imag:z},backend:a}),j=sD({inputs:{a:B,b:M},backend:a}),U=AR({inputs:{a:E,b:j},backend:a}),V=LD({inputs:{a:E,b:j},backend:a}),W=xR({inputs:{input:U},backend:a}),G=xR({inputs:{input:V},backend:a}),H=RO({inputs:{input:U},backend:a}),q=RO({inputs:{input:V},backend:a}),K=DO({inputs:[W,G],backend:a,attrs:{axis:0}}),X=DO({inputs:[H,q],backend:a,attrs:{axis:0}}),Y=a.data.get(K.dataId).values,Q=a.data.get(X.dataId).values;return a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(w),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(I),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(X),{real:Y,imag:Q}}const VD={kernelName:dl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e,a=Is(r.shape),i=r.shape[r.shape.length-1],o=OR({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=BD(o,!1,n),c=OR({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),c}};function WD(t){const{backend:e,attrs:n}=t,{shape:r,value:a,dtype:i}=n,o=i||Vs(a),s=Ps(o,Is(r));return function(t,e){t.fill(e)}(s,a),e.makeTensorInfo(r,o,s)}const GD={kernelName:fl,backendName:"cpu",kernelFunc:WD};const HD={kernelName:pl,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{image:a}=e,i=r,o=Fs(a.dtype,Is(a.shape)),[s,c,l,u]=a.shape,h=i.data.get(a.dataId).values;for(let d=0;d<s;d++){const t=d*l*c*u;for(let e=0;e<c;e++){const n=e*(l*u);for(let e=0;e<l;e++){const r=e*u;for(let a=0;a<u;a++){const i=Math.round(l-e-1),s=t+n+r+a;let c=h[s];if(i>=0&&i<l){c=h[t+n+i*u+a]}o[s]=c}}}}return{dataId:i.write(o,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},qD=fR(t=>Math.floor(t)),KD=$A(ml,qD),XD={kernelName:ml,backendName:"cpu",kernelFunc:KD},YD=iR((t,e)=>Math.floor(t/e)),QD=IR(gl,YD,null,"int32"),JD={kernelName:gl,backendName:"cpu",kernelFunc:QD};const $D={kernelName:fh,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:c,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let m=FO({inputs:{x:a,filter:i},backend:n,attrs:{strides:c,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const t=m;if("NCHW"===u&&1===o.shape.length&&1!==o.shape[0]){const t=OR({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=AR({inputs:{a:m,b:t},backend:n}),n.disposeIntermediateTensorInfo(t)}else m=AR({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(t)}if(f){const t=m;if("NCHW"===u&&"prelu"===f&&1===s.shape.length&&1!==s.shape[0]){const t=OR({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=yR(n,m,f,t,p),n.disposeIntermediateTensorInfo(t)}else m=yR(n,m,f,s,p);n.disposeIntermediateTensorInfo(t)}return m}};const ZD={kernelName:ph,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:c,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let m=JO({inputs:{x:a,filter:i},backend:n,attrs:{strides:c,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d}});if(o){const t=m;m=AR({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(t)}if(f){const t=m;m=yR(n,m,f,s,p),n.disposeIntermediateTensorInfo(t)}return m}};function tM(t,e,n,r,a,i,o,s,c){const l=Lf([r,i],n);for(let u=0;u<r;u++){const n=[];let r=0;for(let e=0;e<a;e++){const i=t[u*a+e];r+=i*o[e],n.push(i)}if(r<0||r>=c/i)throw new Error("Invalid indices: ".concat(n," does not index into ").concat(s));for(let t=0;t<i;t++)l.values[u*i+t]=e.get(...e.indexToLoc(r*i+t))}return l}const eM={kernelName:bl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:r,indices:a}=e,i=Is(r.shape),o=a.shape,s=o[o.length-1],[c,l,u,h]=Uw(r,a);if(0===l)return n.makeTensorInfo(c,r.dtype,[]);const d=tM(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,l,s,u,h,r.shape,i);return n.makeTensorInfo(c,r.dtype,d.values)}};function nM(t,e,n){const r=Lf(n,t.dtype);for(let a=0;a<r.size;++a){const n=r.indexToLoc(a).slice(),i=n[0],o=n[2],s=e.locToIndex([i,o]);n[2]=e.values[s];const c=t.locToIndex(n);0<=c&&c<t.values.length&&(r.values[a]=t.values[c])}return r}const rM={kernelName:vl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,indices:i}=e,{axis:o,batchDims:s}=r;XA([a,i],"gatherV2");const c=Ds(o,a.shape)[0],l=n.data.get(i.dataId).values,u=a.shape[c];for(let b=0;b<l.length;++b){const t=l[b];ks(t<=u-1&&t>=0,()=>"GatherV2: the index value ".concat(t," is not in [0, ").concat(u-1,"]"))}let h=s;null==s&&(h=0);const d=Is(i.shape),f=Cx(a,i,c,h),p=OR({inputs:{x:a},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=OR({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,d/f.batchSize]}}),g=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],y=n.bufferSync(m),v=nM(n.bufferSync(p),y,g);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,v.dtype,v.values)}},aM=iR((t,e)=>t>e?1:0),iM=IR(wl,aM,null,"bool"),oM={kernelName:wl,backendName:"cpu",kernelFunc:iM},sM=iR((t,e)=>t>=e?1:0),cM=IR(xl,sM,null,"bool"),lM={kernelName:xl,backendName:"cpu",kernelFunc:cM};const uM={kernelName:_l,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e,a=Is(r.shape),i=r.shape[r.shape.length-1],o=OR({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),s=BD(o,!0,n),c=OR({inputs:{x:s},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),c}},hM=JA(Tl,t=>Number.isFinite(t)?1:0,"bool"),dM={kernelName:Tl,backendName:"cpu",kernelFunc:hM},fM=JA(Il,t=>Math.abs(t)===1/0?1:0,"bool"),pM={kernelName:Il,backendName:"cpu",kernelFunc:fM},mM=JA(El,t=>Number.isNaN(t)?1:0,"bool"),gM={kernelName:El,backendName:"cpu",kernelFunc:mM},yM=iR((t,e)=>t<e?1:0),vM=IR(Cl,yM,null,"bool"),bM={kernelName:Cl,backendName:"cpu",kernelFunc:vM},wM=iR((t,e)=>t<=e?1:0),xM=IR(Al,wM,null,"bool"),kM={kernelName:Al,backendName:"cpu",kernelFunc:xM};function _M(t,e,n){const r=(e-t)/(n-1),a=Ys(n,"float32");a[0]=t;for(let i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}const SM={kernelName:Rl,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:i}=n,o=_M(r,a,i);return e.makeTensorInfo([o.length],"float32",o)}},TM=fR(t=>Math.log(t)),IM=$A(Ol,TM),EM={kernelName:Ol,backendName:"cpu",kernelFunc:IM},NM=JA(Dl,t=>Math.log1p(t)),CM={kernelName:Dl,backendName:"cpu",kernelFunc:NM},AM=iR((t,e)=>t&&e),RM=IR(Ml,AM,null,"bool"),OM={kernelName:Ml,backendName:"cpu",kernelFunc:RM},DM=JA(Fl,t=>t?0:1,"bool"),MM={kernelName:Fl,backendName:"cpu",kernelFunc:DM},FM=iR((t,e)=>t||e),PM=IR(Pl,FM,null,"bool"),LM={kernelName:Pl,backendName:"cpu",kernelFunc:PM};const zM={kernelName:Ll,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{depthRadius:i,bias:o,alpha:s,beta:c}=r;XA(a,"LRN");const l=a.shape[3],u=l-1,h=n.data.get(a.dataId).values,d=Is(a.shape),f=new Float32Array(d);function p(t){const e=t%l;let n=t-e+Math.max(0,e-i);const r=t-e+Math.min(e+i,u);let a=0;for(;n<=r;n++){const t=h[n];a+=t*t}return a}for(let m=0;m<d;m++){const t=p(m),e=h[m]*Math.pow(o+s*t,-c);f[m]=e}return n.makeTensorInfo(a.shape,a.dtype,f)}};const BM={kernelName:zl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,y:i,dy:o}=e,{depthRadius:s,bias:c,alpha:l,beta:u}=r;XA(o,"LRNGrad");const h=Is(o.shape),d=o.shape[3],f=n.data.get(o.dataId).values,p=n.data.get(a.dataId).values,m=n.data.get(i.dataId).values,g=new Float32Array(h),y=h;for(let v=0;v<y;v++){const t=v%d,e=v-t+Math.max(0,t-s),n=v-t+Math.min(d,t+s+1);let r=0;for(let a=e;a<n;a++)r+=Math.pow(p[a],2);r=l*r+c;for(let a=e;a<n;a++){let t=-2*l*u*p[a]*m[v]/r;v===a&&(t+=Math.pow(r,-u)),t*=f[v],g[a]+=t}}return n.makeTensorInfo(o.shape,a.dtype,g)}};function jM(t,e,n,r){const a=Fs(r,Is(n));for(let i=0;i<a.length;++i){const n=i*e;let r=t[n];for(let a=0;a<e;++a){const e=t[n+a];(Number.isNaN(e)||e>r)&&(r=e)}a[i]=r}return a}function UM(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reductionIndices:i,keepDims:o}=r,s=n;let c=a.shape;const l=c.length,u=Ds(i,c);let h=u;const d=xg(h,l);let f=s.data.get(a.dataId).values;if(null!=d){const t=new Array(l);for(let e=0;e<t.length;e++)t[e]=c[d[e]];f=GR(f,c,a.dtype,d,t),h=_g(h.length,l),c=t}XA(a,"max"),wg("max",h,l);const[p,m]=vg(c,h),g=jM(f,Is(m),p,a.dtype),y=s.write(g,p,a.dtype);let v=p;if(o){v=bg(p,u)}return{dataId:y,shape:v,dtype:a.dtype}}const VM={kernelName:Bl,backendName:"cpu",kernelFunc:UM},WM=iR((t,e)=>Math.max(t,e)),GM=IR(jl,WM),HM={kernelName:jl,backendName:"cpu",kernelFunc:GM};const qM={kernelName:Ul,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;XA(a,"maxPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:c}=r;ks(gm(o,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'"));const l=om(a.shape,i,o,1,s,c);let u;if(1===l.filterWidth&&1===l.filterHeight&&Es(l.inShape,l.outShape))u=eR({inputs:{x:a},backend:n});else{const t=n.data.get(a.dataId).values,e=Hs(a.shape),r=cO(t,a.shape,a.dtype,e,l,"max");u=n.makeTensorInfo(l.outShape,a.dtype,r.values)}return u}};const KM={kernelName:Wl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:c,dataFormat:l}=r;XA(a,"maxPool3d");const u=sm(a.shape,i,o,1,s,c,l),h=uO(n.data.get(a.dataId).values,a.shape,a.dtype,Hs(a.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}};const XM={kernelName:Gl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,{filterSize:o,strides:s,pad:c,dimRoundingMode:l}=r;XA([a,i],"maxPool3DGrad");const u=sm(i.shape,o,s,1,c,l),h=function(t,e){const n=Lf(e.outShape,"int32"),r=e.strideDepth,a=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let g=0;g<e.inChannels;++g)for(let y=0;y<e.outDepth;++y){const v=y*r-d;let b=v;for(;b<0;)b+=o;const w=Math.min(e.inDepth,l+v);for(let r=0;r<e.outHeight;++r){const l=r*a-f;let d=l;for(;d<0;)d+=s;const x=Math.min(e.inHeight,u+l);for(let a=0;a<e.outWidth;++a){const f=a*i-p;let k=f;for(;k<0;)k+=c;const _=Math.min(e.inWidth,h+f);let S=Number.NEGATIVE_INFINITY,T=-1;for(let e=b;e<w;e+=o){const n=e-v;for(let r=d;r<x;r+=s){const a=r-l;for(let i=k;i<_;i+=c){const o=i-f,s=t.get(m,e,r,i,g);s>=S&&(S=s,T=n*u*h+a*u+o)}}}n.set(T,m,y,r,a,g)}}}return n}(n.bufferSync(i),u),d=u.strideDepth,f=u.strideHeight,p=u.strideWidth,m=u.dilationDepth,g=u.dilationHeight,y=u.dilationWidth,v=u.effectiveFilterDepth,b=u.effectiveFilterHeight,w=u.effectiveFilterWidth,x=v-1-u.padInfo.front,k=w-1-u.padInfo.left,_=b-1-u.padInfo.top,S=Lf(i.shape,"float32"),T=n.bufferSync(a);for(let I=0;I<u.batchSize;++I)for(let t=0;t<u.inChannels;++t)for(let e=0;e<u.inDepth;++e)for(let n=0;n<u.inHeight;++n)for(let r=0;r<u.inWidth;++r){const a=e-x,i=n-_,o=r-k;let s=0;for(let e=0;e<v;e+=m){const n=(a+e)/d;if(!(n<0||n>=u.outDepth||Math.floor(n)!==n))for(let r=0;r<b;r+=g){const a=(i+r)/f;if(!(a<0||a>=u.outHeight||Math.floor(a)!==a))for(let i=0;i<w;i+=y){const c=(o+i)/p;if(c<0||c>=u.outWidth||Math.floor(c)!==c)continue;const l=v*b*w-1-h.get(I,n,a,c,t)===e*b*w+r*w+i?1:0;if(0===l)continue;s+=T.get(I,n,a,c,t)*l}}}S.set(s,I,e,n,r,t)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}};const YM={kernelName:Vl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i,output:o}=e,s=i;XA([i,o],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:h}=r,d=om(s.shape,c,l,1,u,h),f=n.data.get(s.dataId).values,p=Lf(d.outShape,s.dtype,lO(f,s.shape,s.dtype,d).values),m=d.strideHeight,g=d.strideWidth,y=d.dilationHeight,v=d.dilationWidth,b=d.effectiveFilterHeight,w=d.effectiveFilterWidth,x=w-1-d.padInfo.left,k=b-1-d.padInfo.top,_=Lf(s.shape,"float32"),S=n.data.get(a.dataId).values,T=Lf(a.shape,"float32",S);for(let I=0;I<d.batchSize;++I)for(let t=0;t<d.inChannels;++t)for(let e=0;e<d.inHeight;++e)for(let n=0;n<d.inWidth;++n){const r=e-k,a=n-x;let i=0;for(let e=0;e<b;e+=y){const n=(r+e)/m;if(!(n<0||n>=d.outHeight||Math.floor(n)!==n))for(let r=0;r<w;r+=v){const o=(a+r)/g;if(o<0||o>=d.outWidth||Math.floor(o)!==o)continue;const s=b*w-1-p.get(I,n,o,t)===e*w+r?1:0;if(0===s)continue;i+=T.get(I,n,o,t)*s}}_.set(i,I,e,n,t)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}};const QM={kernelName:Hl,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{x:a}=e,{filterSize:i,strides:o,pad:s,includeBatchInIndex:c}=n,l=r;XA(a,"MaxPoolWithArgmax");const u=l.data.get(a.dataId).values,h=om(a.shape,i,o,[1,1],s),[d,f]=function(t,e,n,r,a){const i=cO(t,0,n,Hs(e),a,"max"),o=lO(t,e,n,a,!0,r);return[i.values,o.values]}(u,a.shape,a.dtype,c,h),p=l.write(d,h.outShape,a.dtype),m=l.write(f,h.outShape,a.dtype);return[{dataId:p,shape:h.outShape,dtype:a.dtype},{dataId:m,shape:h.outShape,dtype:"int32"}]}};const JM={kernelName:ql,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=Ds(i,a.shape),c=Is(vg(a.shape,s)[1]),l=[],u=n.makeTensorInfo([],"float32",new Float32Array([c]));l.push(u);const h=SR({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});l.push(h);const d=DD({inputs:{a:h,b:u},backend:n});l.push(d);const f=lD({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:o}});return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),f}};const $M={kernelName:Kl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;XA(a,"min");const s=Ds(i,a.shape);let c=s;const l=xg(c,a.shape.length);let u=a;null!=l&&(u=HR({inputs:{x:a},backend:n,attrs:{perm:l}}),c=_g(c.length,a.shape.length)),wg("min",c,u.shape.length);const[h,d]=vg(u.shape,c),f=Is(d),p=Ys(Is(h),u.dtype),m=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const t=y*f;let e=m[t];for(let n=0;n<f;++n){const r=m[t+n];(Number.isNaN(r)||r<e)&&(e=r)}p[y]=e}null!=l&&n.disposeIntermediateTensorInfo(u);const g=n.makeTensorInfo(h,u.dtype,p);if(o){const t=OR({inputs:{x:g},backend:n,attrs:{shape:bg(h,s)}});return n.disposeIntermediateTensorInfo(g),t}return g}},ZM=iR((t,e)=>Math.min(t,e)),tF=IR(Xl,ZM),eF={kernelName:Xl,backendName:"cpu",kernelFunc:tF};const nF={kernelName:Yl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:i,mode:o}=r;XA(a,"mirrorPad");const s=i.map((t,e)=>t[0]+a.shape[e]+t[1]),c=i.map(t=>t[0]),l=i.map((t,e)=>t[0]+a.shape[e]),u="reflect"===o?0:1,h=n.data.get(a.dataId).values,d=a.shape.length,f=Hs(a.shape),p=Is(s),m=s.length,g=Hs(s),y=Fs(a.dtype,p);for(let v=0;v<p;v++){let t=Zs(v,m,g);for(let n=0;n<m;n++)t[n]<c[n]?t[n]=2*c[n]-t[n]-u:t[n]>=l[n]&&(t[n]=2*(l[n]-1)-t[n]+u);t=t.map((t,e)=>t-c[e]);const e=$s(t,d,f);y[v]=h[e]}return{dataId:n.write(y,s,a.dtype),shape:s,dtype:a.dtype}}},rF=iR((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),aF=IR(Ql,rF),iF={kernelName:Ql,backendName:"cpu",kernelFunc:aF};function oF(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{dim:i}=r,o=a.shape.length;let s=i;if(-1===s&&(s=o-1),s!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(s));const c=Ds([s],a.shape),l=UM({inputs:{x:a},backend:n,attrs:{reductionIndices:c,keepDims:!1}}),u=bg(l.shape,c),h=OR({inputs:{x:l},backend:n,attrs:{shape:u}}),d=LD({inputs:{a:a,b:h},backend:n}),f=TD({inputs:{x:d},backend:n}),p=lD({inputs:{x:f},backend:n,attrs:{axis:c,keepDims:!1}}),m=OR({inputs:{x:p},backend:n,attrs:{shape:u}}),g=DD({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),g}const sF={kernelName:ju,backendName:"cpu",kernelFunc:oF};const cF={kernelName:Jl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{numSamples:i,seed:o,normalized:s}=r;XA(a,"multinomial");const c=s?a:oF({inputs:{logits:a},backend:n,attrs:{dim:-1}}),l=c.shape[0],u=c.shape[1],h=n.data.get(c.dataId).values,d=[l,i],f=Ys(Is(d),"int32");for(let p=0;p<l;++p){const t=p*u,e=new Float32Array(u-1);e[0]=h[t];for(let a=1;a<e.length;++a)e[a]=e[a-1]+h[t+a];const n=Vy.alea(o.toString()),r=p*i;for(let a=0;a<i;++a){const t=n();f[r+a]=e.length;for(let n=0;n<e.length;n++)if(t<e[n]){f[r+a]=n;break}}}return s||n.disposeIntermediateTensorInfo(c),n.makeTensorInfo(d,"int32",f)}};function lF(t,e,n){const r=Bh(-1,n);return iD([],e,r,t,n)}const uF={kernelName:Zl,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;XA(r,"neg");const a=n.data.get(r.dataId).values,[i,o]=lF(a,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}},hF=Tb;const dF={kernelName:eu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c}=r;XA(a,"NonMaxSuppression");const l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,{selectedIndices:h}=hF(l,u,o,s,c);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},fF=Ib;const pF={kernelName:nu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c,padToMaxOutputSize:l}=r;XA(a,"NonMaxSuppressionPadded");const u=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,{selectedIndices:d,validOutputs:f}=fF(u,h,o,s,c,l);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}},mF=Eb;const gF={kernelName:ru,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c,softNmsSigma:l}=r;XA(a,"NonMaxSuppressionWithScore");const u=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values,d=o,f=s,p=c,m=l,{selectedIndices:g,selectedScores:y}=mF(u,h,d,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}},yF=iR((t,e)=>t!==e?1:0),vF=IR(tu,yF,null,"bool"),bF={kernelName:tu,backendName:"cpu",kernelFunc:vF};const wF={kernelName:iu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a}=e,{dtype:i,depth:o,onValue:s,offValue:c}=r;XA(a,"oneHot");const l=Is(a.shape),u=new Float32Array(l*o);u.fill(c);const h=n.data.get(a.dataId).values;for(let d=0;d<l;++d)h[d]>=0&&h[d]<o&&(u[d*o+h[d]]=s);return n.makeTensorInfo([...a.shape,o],i,u)}};function xF(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const t=xR({inputs:{input:r},backend:n}),e=xF({inputs:{x:t},backend:n}),a=RO({inputs:{input:r},backend:n}),i=xF({inputs:{x:a},backend:n}),o=vR({inputs:{real:e,imag:i},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}return WD({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const kF={kernelName:ch,backendName:"cpu",kernelFunc:xF};const _F={kernelName:au,backendName:"cpu",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:a}=n;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){const e=xR({inputs:{input:a},backend:r}),n=t({inputs:{x:e},backend:r}),i=RO({inputs:{input:a},backend:r}),o=xF({inputs:{x:i},backend:r}),s=vR({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}return WD({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function SF(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(1===e.length)return ED({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const i=e[0].shape,o=e[0].dtype;e.forEach(t=>{_s(i,t.shape,"All tensors passed to stack must have matching shapes"),ks(o===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],c=DO({inputs:e.map(t=>{const e=ED({inputs:{input:t},backend:n,attrs:{dim:a}});return s.push(e),e}),backend:n,attrs:{axis:a}});return s.forEach(t=>n.disposeIntermediateTensorInfo(t)),c}const TF={kernelName:ou,backendName:"cpu",kernelFunc:SF};const IF={kernelName:su,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:i,constantValue:o}=r;XA(a,"pad");const s=i.map((t,e)=>t[0]+a.shape[e]+t[1]),c=i.map(t=>t[0]),l=n.data.get(a.dataId).values,u=Is(a.shape),h=a.shape.length,d=Hs(a.shape),f=Is(s),p=s.length,m=Hs(s),g=Fs(a.dtype,f);0!==o&&g.fill(o);for(let y=0;y<u;y++){g[$s(Zs(y,h,d).map((t,e)=>t+c[e]),p,m)]=l[y]}return{dataId:n.write(g,s,a.dtype),shape:s,dtype:a.dtype}}},EF=iR((t,e)=>Math.pow(t,e)),NF=IR(cu,EF),CF={kernelName:cu,backendName:"cpu",kernelFunc:NF};function AF(t,e,n,r){const[a,i]=vg(t,r),o=hd(e,"int32"),s=Ys(Is(a),o),c=Is(i);for(let l=0;l<s.length;++l){const t=l*c;let e=1;for(let r=0;r<c;++r)e*=n[t+r];s[l]=e}return{outVals:s,outShape:a,outDtype:o}}const RF={kernelName:uu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;XA(a,"prod");const s=a.shape.length,c=Ds(i,a.shape),l=xg(c,s);let u=c,h=a;const d=[];null!=l&&(h=HR({inputs:{x:a},backend:n,attrs:{perm:l}}),d.push(h),u=_g(u.length,s));const f=n.data.get(h.dataId).values,{outVals:p,outShape:m,outDtype:g}=AF(h.shape,h.dtype,f,u);let y=m;return o&&(y=bg(m,c)),d.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(y,g,p)}};function OF(t,e,n,r){const a=[];let i=0;const o=e.length-1+n.length,s=new Array(o).fill(null).map(()=>[0]);!function(t,e){for(let n=0;n<t.length;++n){const r=t[n],a=n===t.length-1?e:t[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let t=1;t<r.length;++t)if(r[t-1]>r[t])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);let c=1;for(let l=0;l<e.length-1;++l){c*=e[l];const t=e[l+1];for(let e=1;e<c+1;++e)s[l].push(e*t)}for(let l=0;l<t.length;++l){let r=t[l],o=t[l]+1;for(let t=0;t<n.length;++t){const a=n[t],i=t+e.length-1;if(i>=0){const t=s[i],e=t[t.length-1]-a[r];for(let n=r;n<o;++n)s[i].push(a[n+1]+e)}r=a[r],o=a[o]}o!==r&&(a.push([r,o]),i+=o-r)}return{outSplits:s,valueSlices:a,numValues:i}}function DF(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function MF(t,e,n,r,a){const i=e.slice();i[0]=a;const o=Ps(n,Is(i)),s=t.length;return function(t,e,n,r,a,i){const o=DF(e,2)[1],s=DF(i,2)[1];let c=0;for(const l of n)for(let e=l[0];e<l[1];++e){for(let n=0;n<r;++n)a[c*s+n]=t[e*o+n];++c}}(t,e,r,0===s?0:s/e[0],o,i),[o,i]}function FF(t,e,n,r,a,i,o,s){if(0===t.length)throw new Error("paramsNestedSplits must be non empty");if(0===e[0].length)throw new Error("Split tensors must not be scalars");if(function(t,e,n){t.forEach((t,r)=>{if(t<0||t>=n){const a=Zs(r,e.length,Hs(e)).join(",");throw new Error("indices[".concat(a,"] = ").concat(t," is not in [0, ").concat(n,")"))}})}(i,o,e[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:l,valueSlices:u,numValues:h}=OF(i,o,t,c),d=function(t){const e=[];for(let n=0;n<t.length;++n){const r=Ps("int32",t[n].length);e.push(r),t[n].forEach((t,e)=>r[e]=t)}return e}(l),f=MF(n,r,a,u,h);return[d,f[0],f[1]]}const PF={kernelName:hu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:s}=r,c=a.map(t=>n.data.get(t.dataId).values),l=a.map(t=>t.shape),u=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,[d,f,p]=FF(c,l,u,i.shape,i.dtype,h,o.shape),m=d.map(t=>n.makeTensorInfo([t.length],"int32",t)),g=n.makeTensorInfo(p,i.dtype,f);return m.concat([g])}};var LF=Nw;class zF{constructor(t,e,n,r,a,i,o,s,c,l){this.shape=t,this.shapeShape=e,this.values=n,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=o,this.rowPartitionValues=s,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=Aw(l),this.raggedRank=Rw(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===LF.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===LF.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case LF.VALUE_ROWIDS:return zF.getMaxWidthValueRowID(e);case LF.ROW_SPLITS:return zF.getMaxWidthRowSplit(e);default:throw new Error("Cannot handle partition type ".concat(LF[this.getRowPartitionTypeByDimension(t-1)]))}}static getMaxWidthRowSplit(t){const e=t.length;if(0===e||1===e)return 0;let n=0;for(let r=0;r<e-1;++r){const e=t[r+1]-t[r];e>n&&(n=e)}return n}static getMaxWidthValueRowID(t){const e=t.length;if(0===e)return 0;let n=0,r=t[0],a=0;for(let i=1;i<e;++i){const e=t[i];e!==r&&(r=e,a=Math.max(i-n,a),n=i)}return Math.max(e-n,a)}tensorShapeFromTensor(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return jF(t,n)}calculateOutputSize(t){const e=this.valuesShape;Ow(this.defaultValueShape,e);const n=this.tensorShapeFromTensor(this.shape,this.shapeShape),r=Cw(this.raggedRank,n,e);r[0]<0&&(r[0]=t);for(let a=1;a<=this.raggedRank;++a)r[a]<0&&(r[a]=this.getMaxWidth(a));return r}calculateFirstParentOutputIndex(t,e,n){const r=Math.min(t,n),a=[];let i=0;for(let o=0;o<r;++o,i+=e)a.push(i);for(let o=r;o<t;++o)a.push(-1);return ks(a.length===t,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(t,e,n,r){const a=t.length,i=[];for(let o=0;o<a-1;++o){const a=t[o+1]-t[o];let s=Math.min(r,a),c=e[o];-1===c&&(s=0);for(let t=0;t<s;++t)i.push(c),c+=n;for(let t=0;t<a-s;++t)i.push(-1)}if(a>0&&i.length!==t[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(t,e,n,r){const a=t.length,i=[];if(0===a)return[];let o=0,s=t[0];if(s>=e.length)throw new Error("Got currentValueRowId=".concat(s,", which is not less than ").concat(e.length));let c=e[s];i.push(c);for(let l=1;l<a;++l){const a=t[l];if(a===s)c>=0&&(++o,o<r?c+=n:c=-1);else{if(o=0,s=a,a>=e.length)throw new Error("Got nextValueRowId=".concat(a," which is not less than ").concat(e.length));c=e[a]}i.push(c)}if(i.length!==t.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(t,e,n,r){const a=this.getRowPartitionTensor(t),i=this.getRowPartitionTypeByDimension(t);switch(i){case LF.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,e,n,r);case LF.ROW_SPLITS:if(a.length-1>e.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(e.length));return this.calculateOutputIndexRowSplit(a,e,n,r);default:throw new Error("Unsupported partition type: ".concat(LF[i]))}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case LF.FIRST_DIM_SIZE:return t[0];case LF.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case LF.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(LF[e]))}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),e=this.calculateOutputSize(t),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(let i=n.length-2;i>=0;--i)n[i]=n[i+1]*e[i+1];const r=jF(e,!1),a=Ps(this.valuesDType,Is(r));if(n[0]*e[0]>0){let i=this.calculateFirstParentOutputIndex(t,n[0],e[0]);for(let t=1;t<=this.raggedRank;++t){i=this.calculateOutputIndex(t-1,i,n[t],e[t])}this.setOutput(this.raggedRank,i,a,r)}return[r,a]}setOutput(t,e,n,r){if(0===n.length)return;const a=this.values,i=n;let o=r.slice();o=o.slice(t+1);const s=Is(o),c=e.length;let l=this.defaultValue;if(l.length!==s&&1!==l.length){const t=this.defaultValueShape;zp(()=>{const e=bm(l,t),n=Pm(e,o);l=n.dataSync()})}let u=0,h=0,d=0;for(let f=0;f<=c;++f){let t=f<c?e[f]:-1;if(t!==d){if(h<d){const t=a.subarray(u*s);BF(i.subarray(h*s),t,(d-h)*s)}if(f>=c){const e=n.length;t=Math.floor(e/s)}if(t>d)if(1===this.defaultValue.length)i.subarray(d*s,t*s).fill(this.defaultValue[0]),d=t;else for(;t>d;){BF(i.slice(d*s),l,s),++d}t<0?(u=f+1,h=d):(u=f,h=d,d=h+1)}else++d}}}function BF(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function jF(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error("Dimension ".concat(r," must be >= 0"));if(r<-1)throw new Error("Dimension ".concat(r," must be >= -1"));r=-1}n.push(r)}return n}function UF(t,e,n,r,a,i,o,s,c,l){return new zF(t,e,n,r,a,i,o,s,c,l).compute()}const VF={kernelName:du,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=e,{rowPartitionTypes:c}=r,l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,d=s.map(t=>n.data.get(t.dataId).values),f=s.map(t=>t.shape),[p,m]=UF(l,a.shape,u,i.shape,i.dtype,h,o.shape,d,f,c);return n.makeTensorInfo(p,i.dtype,m)}};function WF(t,e,n,r){if(t===e||t<e&&n<0||e<t&&n>1)return Ys(0,r);const a=Ys(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),a[0]=t;for(let i=1;i<a.length;i++)a[i]=a[i-1]+n;return a}const GF={kernelName:fu,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:a,dtype:i,step:o}=n,s=WF(r,a,o,i);return e.makeTensorInfo([s.length],i,s)}},HF=JA(mu,t=>1/t),qF={kernelName:mu,backendName:"cpu",kernelFunc:HF};const KF={kernelName:wu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r;XA(a,"resizeBilinear");const c=Hs(a.shape),[l,u]=s,[h,d,f,p]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(Is([h,l,u,p])),y=[i&&l>1?d-1:d,i&&u>1?f-1:f],v=[i&&l>1?l-1:l,i&&u>1?u-1:u];let b=0;const w=y[0]/v[0],x=y[1]/v[1];for(let k=0;k<h;k++)for(let t=0;t<l;t++){let e;e=o?w*(t+.5)-.5:w*t;const n=Math.max(0,Math.floor(e)),r=e-n,a=Math.min(d-1,Math.ceil(e)),i=k*c[0]+n*c[1],s=k*c[0]+a*c[1];for(let t=0;t<u;t++){let e;e=o?x*(t+.5)-.5:x*t;const n=Math.max(0,Math.floor(e)),a=e-n,l=Math.min(f-1,Math.ceil(e)),u=i+n*c[2],h=s+n*c[2],d=i+l*c[2],y=s+l*c[2];for(let t=0;t<p;t++){const e=m[u+t],n=m[h+t],i=e+(m[d+t]-e)*a,o=i+(n+(m[y+t]-n)*a-i)*r;g[b++]=o}}}return n.makeTensorInfo([h,l,u,p],"float32",g)}};const XF={kernelName:xu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r;XA([i,a],"resizeBilinearGrad");const s=Hs(a.shape),[c,l,u,h]=a.shape,[,d,f]=i.shape,p=new Float32Array(c*l*u*h),m=[o&&d>1?l-1:l,o&&f>1?u-1:u],g=[o&&d>1?d-1:d,o&&f>1?f-1:f],y=m[0]/g[0],v=m[1]/g[1],b=n.data.get(i.dataId).values;let w=0;for(let x=0;x<c;x++){const t=x*s[0];for(let e=0;e<d;e++){const n=e*y,r=Math.floor(n),a=Math.min(Math.ceil(n),l-1),i=t+r*s[1],o=t+a*s[1],c=n-r,d=1-c;for(let t=0;t<f;t++){const e=t*v,n=Math.floor(e),r=Math.min(Math.ceil(e),u-1),a=e-n,l=1-a,f=i+n*s[2],m=i+r*s[2],g=o+n*s[2],y=o+r*s[2],x=d*l,k=d*a,_=c*l,S=c*a;for(let t=0;t<h;t++){const e=b[w++];p[f+t]+=e*x,p[m+t]+=e*k,p[g+t]+=e*_,p[y+t]+=e*S}}}}return n.makeTensorInfo([c,u,l,h],"float32",p)}};const YF={kernelName:vu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r;XA(a,"resizeNearestNeighbor");const c=Hs(a.shape),[l,u]=s,[h,d,f,p]=a.shape,m=n.data.get(a.dataId).values,g=new Float32Array(h*l*u*p),y=[i&&l>1?d-1:d,i&&u>1?f-1:f],v=[i&&l>1?l-1:l,i&&u>1?u-1:u],b=y[0]/v[0],w=y[1]/v[1];let x=0;for(let k=0;k<h;k++){const t=k*c[0];for(let e=0;e<l;e++){const n=o?b*(e+.5):b*e;let r=Math.min(d-1,i?Math.round(n):Math.floor(n));o&&(r=Math.max(0,r));const a=t+r*c[1];for(let t=0;t<u;t++){const e=o?w*(t+.5):w*t;let n=Math.min(f-1,i?Math.round(e):Math.floor(e));o&&(n=Math.max(0,n));const r=a+n*c[2];for(let t=0;t<p;t++){const e=m[r+t];g[x++]=e}}}}return n.makeTensorInfo([h,l,u,p],a.dtype,g)}};const QF={kernelName:bu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r;XA([i,a],"resizeNearestNeighborGrad");const s=Hs(a.shape),c=Hs(i.shape),[l,u,h,d]=a.shape,[,f,p]=i.shape,m=new Float32Array(l*u*h*d),g=n.data.get(i.dataId).values,y=[o&&f>1?u-1:u,o&&p>1?h-1:h],v=[o&&f>1?f-1:f,o&&p>1?p-1:p],b=y[0]/v[0],w=y[1]/v[1],x=1/b,k=1/w,_=2*Math.ceil(x)+2,S=2*Math.ceil(k)+2;for(let T=0;T<l;T++){const t=T*s[0];for(let e=0;e<u;e++){const n=t+e*s[1],r=Math.floor(e*x),a=Math.floor(r-_/2);for(let i=0;i<h;i++){const r=n+i*s[2],l=Math.floor(i*k),y=Math.floor(l-S/2);for(let n=0;n<d;n++){let s=0;for(let r=0;r<_;r++){const l=r+a;if(l<0||l>=f)continue;const d=t+l*c[1],m=l*b;if(e===Math.min(u-1,o?Math.round(m):Math.floor(m)))for(let t=0;t<S;t++){const e=t+y;if(e<0||e>=p)continue;const r=d+e*c[2],a=e*w;i===Math.min(h-1,o?Math.round(a):Math.floor(a))&&(s+=g[r+n])}}m[r+n]=s}}}}return n.makeTensorInfo(a.shape,a.dtype,m)}};const JF={kernelName:_u,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dims:i}=r;XA(a,"reverse");const o=a.shape.length,s=Ds(i,a.shape);if(0===o)return eR({inputs:{x:a},backend:n});const c=new $h(a.shape,a.dtype),l=n.bufferSync(a);for(let u=0;u<c.size;u++){const t=c.indexToLoc(u),e=t.slice();s.forEach(t=>e[t]=a.shape[t]-1-e[t]),c.set(l.get(...e),...t)}return n.makeTensorInfo(c.shape,c.dtype,c.values)}},$F={kernelName:hh,backendName:"cpu",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{image:a}=e,{radians:i,fillValue:o,center:s}=n,c=r,l=Fs(a.dtype,Is(a.shape)),[u,h,d,f]=a.shape,[p,m]=Fw(s,h,d),g=Math.sin(i),y=Math.cos(i),v=c.data.get(a.dataId).values;for(let b=0;b<u;b++){const t=b*d*h*f;for(let e=0;e<h;e++){const n=e*(d*f);for(let r=0;r<d;r++){const a=r*f;for(let i=0;i<f;i++){const s=[u,e,r,i],c=s[2],b=s[1];let w=(c-p)*y-(b-m)*g,x=(c-p)*g+(b-m)*y;w=Math.round(w+p),x=Math.round(x+m);let k=o;if("number"!==typeof o&&(k=3===i?255:o[i]),w>=0&&w<d&&x>=0&&x<h){k=v[t+x*(d*f)+w*f+i]}l[t+n+a+i]=k}}}}return{dataId:c.write(l,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},ZF=JA(Su,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),tP={kernelName:Su,backendName:"cpu",kernelFunc:ZF},eP=fR(t=>1/Math.sqrt(t)),nP=$A(Tu,eP),rP={kernelName:Tu,backendName:"cpu",kernelFunc:nP};function aP(t,e,n,r,a,i,o,s,c,l){const u=[r/a,a],h=t.values,d=e.values;if(0===r)return Lf(n,e.dtype);const f=Lf(u,e.dtype);"string"===typeof c||"number"===typeof c?f.values.fill(c):"boolean"===typeof c&&f.values.fill(+c);for(let p=0;p<i;p++){const t=[];let i=0;for(let e=0;e<o;e++){const n=h[p*o+e];t.push(n),i+=n*s[e]}if(i<0||i>=r/a)throw new Error("Invalid indices: ".concat(t," does not index into ").concat(n));for(let n=0;n<a;n++)l?f.values[i*a+n]+=d[p*a+n]:f.values[i*a+n]=0===e.rank?d[0]:d[p*a+n]}return f}const iP={kernelName:Iu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a,updates:i}=e,{shape:o}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:h}=Yv(0,a,o),d=aP(n.bufferSync(a),n.bufferSync(i),o,h,l,c,s,u,0,!0);return n.makeTensorInfo(o,d.dtype,d.values)}};function oP(t,e){let n=0,r=t.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),t[a]<e?n=a+1:r=a;return r}function sP(t,e){let n=0,r=t.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),t[a]<=e?n=a+1:r=a;return r}const cP={kernelName:Eu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:i}=e,{side:o}=r,s=function(t,e,n,r,a,i){const o=Ps("int32",n*a);for(let s=0;s<n;++s){const n=t.slice(s*r,(s+1)*r),c=s*a;for(let t=0;t<a;++t)o[c+t]="left"===i?oP(n,e[t+c]):sP(n,e[t+c])}return o}(n.data.get(a.dataId).values,n.data.get(i.dataId).values,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",s)}};const lP={kernelName:Nu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:r,t:a,e:i}=e;XA([r,a,i],"select");const o=r.shape.length,s=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,u=hd(a.dtype,i.dtype),h=Ys(Is(a.shape),u);let d=0;const f=0===o||o>1||1===a.shape.length?1:Is(a.shape.slice(1));for(let p=0;p<s.length;p++)for(let t=0;t<f;t++)1===s[p]?h[d++]=c[p]:h[d++]=l[p];return n.makeTensorInfo(a.shape,u,h)}},uP=Vw,hP=Ww,dP=JA(Cu,t=>t>=0?hP*t:uP*(Math.exp(t)-1)),fP={kernelName:Cu,backendName:"cpu",kernelFunc:dP},pP=JA(Du,t=>t<0?-1:t>0?1:0),mP={kernelName:Du,backendName:"cpu",kernelFunc:pP},gP=JA(Ru,t=>Math.sin(t)),yP={kernelName:Ru,backendName:"cpu",kernelFunc:gP},vP=JA(Ou,t=>Math.sinh(t)),bP={kernelName:Ou,backendName:"cpu",kernelFunc:vP},wP=Math.log(1.1920928955078125e-7)+2,xP=JA(Fu,t=>{const e=t>-wP,n=t<wP,r=Math.exp(t);let a;return a=n?r:e?t:Math.log(1+r),a}),kP={kernelName:Fu,backendName:"cpu",kernelFunc:xP};const _P={kernelName:zu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,paddings:o}=r;XA([a],"spaceToBatchND");const s=Is(i),c=[[0,0]];c.push(...o);for(let g=1+i.length;g<a.shape.length;++g)c.push([0,0]);const l=IF.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:c,constantValue:0}}),u=Pw(l.shape,i,s,!1),h=Lw(u.length,i.length,!1),d=zw(l.shape,i,s,!1),f=OR({inputs:{x:l},backend:n,attrs:{shape:u}}),p=HR({inputs:{x:f},backend:n,attrs:{perm:h}}),m=OR({inputs:{x:p},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}};function SP(t,e,n,r,a,i,o){const s=e[0],c=i[0],l=new Array(c),u=new Array(s),h=e[1];if(0===c){if(0!==s)throw new Error(mx(s));return[Ps(n,0),[0,h],Ps(a,0),l,u]}let d=!0,f=0;const p=new Array(c).fill(0);for(let g=0;g<s;++g){const e=t[g*h];if(e<0)throw new Error(gx(g,e));if(e>=c)throw new Error(yx(g,e,c));++p[e],d=d&&e>=f,f=e}let m=!0;for(let g=0;g<c;++g){const t=0===p[g];l[g]=t,m=m&&!t,p[g]=Math.max(p[g],1),g>0&&(p[g]+=p[g-1])}if(m&&d){const e=t,n=r;for(let t=0;t<s;++t)u[t]=t;return[e,[s,h],n,l,u]}{const e=p[c-1],i=Ps(n,e*h),d=Ps(a,e),f=new Array(c).fill(0);for(let n=0;n<s;++n){const e=t[n*h],a=f[e],o=(0===e?0:p[e-1])+a;f[e]++;for(let r=0;r<h;++r)i[o*h+r]=t[n*h+r];d[o]=r[n],u[n]=o}for(let t=0;t<c;++t){if(0===f[t]){const e=0===t?0:p[t-1];i[e*h+0]=t;for(let t=1;t<h;++t)i[e*h+t]=0;d[e]=o}}return[i,[e,h],d,l,u]}}const TP={kernelName:Uu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:i,defaultValue:o}=e;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));const s=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[h,d,f,p,m]=SP(s,r.shape,r.dtype,c,a.dtype,l,u);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],a.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(t=>Number(t)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};function IP(t,e,n,r,a){const i=Is(r),o=e[0],s=a.length,c=[];let l=1,u=-1;for(let m=0;m<s;++m){const t=a[m];if(-1===t){if(-1!==u)throw new Error(vx(u,m));u=m,c.push(1)}else{if(t<0)throw new Error(bx(m,t));l*=t,c.push(t)}}if(-1!==u){if(l<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const t=Math.trunc(i/l);if(l*t!==i)throw new Error(xx(r,c));c[u]=t}if(Is(c)!==i)throw new Error(kx(r,c));const h=r.length,d=[];if(h>0){d[h-1]=1;for(let t=h-2;t>=0;--t)d[t]=d[t+1]*r[t+1]}const f=[];if(s>0){f[s-1]=1;for(let t=s-2;t>=0;--t)f[t]=f[t+1]*c[t+1]}const p=Ps(n,o*s);for(let m=0;m<o;++m){let e=0;for(let n=0;n<h;++n)e+=t[m*h+n]*d[n];for(let t=0;t<s;++t)p[m*s+t]=Math.trunc(e/f[t]),e%=f[t]}return[p,[o,s],c]}const EP={kernelName:Vu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:i}=e;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));const o=Array.from(n.data.get(a.dataId).values),s=n.data.get(r.dataId).values,c=Array.from(n.data.get(i.dataId).values),[l,u,h]=IP(s,r.shape,r.dtype,o,c);return[n.makeTensorInfo(u,r.dtype,l),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}};function NP(t,e,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;const s=r.length,c=[e[0],t.length/e[0]],l=c[1],u=s>0?a[s-1]+1:0;if(u<0)throw new Error("segment ids must be >= 0");const h=e.slice();h[0]=u;const d=Ps(n,h.reduce((t,e)=>t*e,1));if(0===s)return u>0&&d.fill(o),[d,h];if(u<=0)throw new Error("segment ids must be >= 0");let f=0,p=1,m=0,g=a[f];for(;;){let e=0;if(p<s){if(e=a[p],g===e){++p;continue}if(g>=e)throw new Error(Sx())}if(g<0||g>=u)throw new Error(Tx(g,u));g>m&&d.fill(o,m*l,g*l);for(let n=f;n<p;++n){const e=r[n];if(e<0||e>=c[0])throw new Error(Ix(n,r[n],c[0]));for(let n=0;n<l;n++)d[g*l+n]+=t[e*l+n]}if(i)for(let t=0;t<l;t++)d[g*l+t]/=p-f;if(f=p,++p,m=g+1,g=e,p>s)break}return m<u&&d.fill(o,m*l,u*l),[d,h]}const CP={kernelName:Wu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,[l,u]=NP(o,r.shape,r.dtype,s,c,!0);return n.makeTensorInfo(u,r.dtype,l)}};const AP={kernelName:Gu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(i.shape));if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,[l,u]=NP(o,r.shape,r.dtype,s,c);return n.makeTensorInfo(u,r.dtype,l)}};const RP={kernelName:Hu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:a,sparseValues:i,defaultValue:o}=e,{outputShape:s}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:h,outputSize:d}=Yv(0,a,s),f=!1,p=n.bufferSync(a);let m;switch(i.dtype){case"bool":m=aP(p,n.bufferSync(i),s,d,u,l,c,h,Boolean(n.data.get(o.dataId).values[0]),f);break;case"float32":m=aP(p,n.bufferSync(i),s,d,u,l,c,h,n.data.get(o.dataId).values[0],f);break;case"int32":m=aP(p,n.bufferSync(i),s,d,u,l,c,h,n.data.get(o.dataId).values[0],f);break;case"string":m=aP(p,n.bufferSync(i),s,d,u,l,c,h,Wh(n.data.get(o.dataId).values[0]),f);break;default:throw new Error("Unsupported type ".concat(i.dtype))}return n.makeTensorInfo(s,m.dtype,m.values)}};const OP={kernelName:Bu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{numOrSizeSplits:i,axis:o}=r,s=Ds(o,a.shape)[0],c=px(a,i,s),l=new Array(a.shape.length).fill(0),u=a.shape.slice();return c.map(t=>{const e=[...u];e[s]=t;const r=yO({inputs:{x:a},backend:n,attrs:{begin:l,size:e}});return l[s]+=t,r})}},DP=fR(t=>Math.sqrt(t)),MP=JA(Pu,t=>Math.sqrt(t)),FP={kernelName:Pu,backendName:"cpu",kernelFunc:MP},PP={kernelName:Ku,backendName:"cpu",kernelFunc:t=>{let{inputs:e,backend:n}=t;const{x:r}=e,a=n;XA(r,"square");const i=a.data.get(r.dataId).values,o=new Float32Array(i.length);for(let s=0;s<i.length;++s){const t=i[s];o[s]=t*t}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},LP=iR((t,e)=>{const n=t-e;return n*n}),zP=IR(qu,LP),BP={kernelName:qu,backendName:"cpu",kernelFunc:zP},jP=JA(lh,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),UP={kernelName:lh,backendName:"cpu",kernelFunc:jP};function VP(t,e,n,r){const a=Lf(t,e.dtype);for(let i=0;i<a.size;i++){const t=a.indexToLoc(i),o=new Array(t.length);for(let e=0;e<o.length;e++)o[e]=t[e]*n[e]+r[e];a.set(e.get(...o),...t)}return a}const WP={kernelName:Xu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,end:o,strides:s,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=r;XA(a,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:w}=Rp(a.shape,i,o,s,c,l,u,h,d);let x;if(m)x=OR({inputs:{x:a},backend:n,attrs:{shape:p}});else if(g||y){ks(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));const t=vp(v,b,w),e=yO({inputs:{x:a},backend:n,attrs:{begin:v,size:t}});x=OR({inputs:{x:e},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(e)}else{const t=VP(f,n.bufferSync(a),w,v);x=n.makeTensorInfo(p,t.dtype,t.values)}return x}};class GP{constructor(t,e,n,r,a,i){this.separator=Vh(t),this.nGramWidths=e,this.leftPad=Vh(n),this.rightPad=Vh(r),this.padWidth=a,this.preserveShort=i}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const n=this.getPadWidth(e);return Math.max(0,t+2*n-e+1)}createNGrams(t,e,n,r,a,i){for(let o=0;o<a;++o){const s=this.getPadWidth(i),c=Math.max(0,s-o),l=Math.max(0,s-(a-(o+1))),u=i-(c+l),h=e+(c>0?0:o-s);let d=0;d+=c*this.leftPad.length;for(let e=0;e<u;++e)d+=t[h+e].length;d+=l*this.rightPad.length;d+=(c+l+u-1)*this.separator.length,n[r+o]=new Uint8Array(d);const f=n[r+o];let p=0;const m=t=>t.forEach(t=>f[p++]=t);for(let t=0;t<c;++t)m(this.leftPad),m(this.separator);for(let e=0;e<u-1;++e)m(t[h+e]),m(this.separator);if(u>0){m(t[h+u-1]);for(let t=0;t<l;++t)m(this.separator),m(this.rightPad)}else{for(let t=0;t<l-1;++t)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(t,e){const n=t.length,r=e.length;if(r>0){let t=e[0];if(0!==t)throw new Error("First split value must be 0, got ".concat(t));for(let a=1;a<r;++a){let r=e[a]>=t;if(r=r&&e[a]<=n,!r)throw new Error("Invalid split value ".concat(e[a],", must be in [").concat(t,", ").concat(n,"]"));t=e[a]}if(t!==n)throw new Error("Last split value must be data size. Expected ".concat(n,", got ").concat(t))}const a=r-1,i=Ps("int32",r);if(0===n||0===r){const t=new Array(n);for(let e=0;e<=a;++e)i[e]=0;return[t,i]}i[0]=0;for(let s=1;s<=a;++s){const t=e[s]-e[s-1];let n=0;this.nGramWidths.forEach(e=>{n+=this.getNumNGrams(t,e)}),this.preserveShort&&t>0&&0===n&&(n=1),i[s]=i[s-1]+n}const o=new Array(i[a]);for(let s=0;s<a;++s){const n=e[s];let r=i[s];if(this.nGramWidths.forEach(a=>{const i=e[s+1]-e[s],c=this.getNumNGrams(i,a);this.createNGrams(t,n,o,r,c,a),r+=c}),this.preserveShort&&r===i[s]){const a=e[s+1]-e[s];if(0===a)continue;const i=a+2*this.padWidth,c=1;this.createNGrams(t,n,o,r,c,i)}}return[o,i]}}function HP(t,e,n,r,a,i,o,s){return new GP(n,r,a,i,o,s).compute(t,e)}const qP={kernelName:Yu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:h}=e,d=n.data.get(u.dataId).values,f=n.data.get(h.dataId).values,[p,m]=HP(d,f,a,i,o,s,c,l);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",m)]}};function KP(t,e,n,r){if(!t.length)return;if(0===e.length){for(let e=0;e<t.length;++e)r.push(t.subarray(e,e+1));return}if(1===e.length){const a=e[0];let i=t.indexOf(a);for(;-1!==i;){const e=t.subarray(0,i);n&&0===e.length||r.push(e),i=(t=t.subarray(i+1)).indexOf(a)}return void(n&&0===t.length||r.push(t))}let a=0;for(let i=0;i<t.length+1;i++)if(i===t.length||-1!==e.indexOf(t[i])){const e=t.subarray(a,i);n&&0===e.length||r.push(e),a=i+1}}function XP(t,e,n){const r=t.length,a=[];let i=0,o=0;const s=new Array(r);for(let d=0;d<r;++d){const r=a.length;KP(t[d],e,n,a);const c=a.length-r;s[d]=c,i+=c,o=Math.max(o,c)}const c=Ps("int32",2*i),l=new Array(i),u=[r,o];let h=0;for(let d=0;d<r;++d)for(let t=0;t<s[d];++t)c[2*h]=d,c[2*h+1]=t,l[h]=a[h],++h;return[c,l,u]}const YP={kernelName:Qu,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:i,delimiter:o}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));const s=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values[0],[l,u,h]=XP(s,c,a),d=u.length;return[n.makeTensorInfo([d,2],"int32",l),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};function QP(t,e){const n=Ps("int32",t.length);for(let r=0;r<t.length;++r)n[r]=zh(t[r]).modulo(e).getLowBitsUnsigned();return n}const JP={kernelName:Ju,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:i}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=QP(n.data.get(i.dataId).values,a);return n.makeTensorInfo(i.shape,"int32",o)}},$P=JA(Zu,t=>Math.tan(t)),ZP={kernelName:Zu,backendName:"cpu",kernelFunc:$P},tL=JA(th,t=>Math.tanh(t));function eL(t,e){const n=new Array(t.rank);for(let a=0;a<n.length;a++)n[a]=t.shape[a]*e[a];const r=Lf(n,t.dtype);for(let a=0;a<r.values.length;++a){const e=r.indexToLoc(a),n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=e[r]%t.shape[r];const i=t.locToIndex(n);r.values[a]=t.values[i]}return r}const nL={kernelName:eh,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reps:i}=r;XA(a,"tile");const o=eL(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},rL=(t,e)=>{const n=e.value-t.value;return 0===n?t.index-e.index:n};function aL(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length-1;for(;r>n;){if(r-n>600){const a=r-n+1,i=e-n+1,o=Math.log(a),s=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*s*(a-s)/a)*Math.sign(i-a/2);aL(t,e,Math.max(n,Math.floor(e-i*s/a+c)),Math.min(r,Math.floor(e+(a-i)*s/a+c)))}const a=t[e];let i=n,o=r;for(xs(t,n,e),rL(t[r],a)>0&&xs(t,n,r);i<o;){for(xs(t,i,o),i++,o--;rL(t[i],a)<0;)i+=1;for(;rL(t[o],a)>0;)o-=1}0===rL(t[n],a)?xs(t,n,o):(o+=1,xs(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function iL(t,e,n,r,a){const i=e[e.length-1],[o,s]=[t.length/i,i],c=Fs(n,o*r),l=Fs("int32",o*r);for(let h=0;h<o;h++){const e=h*s,n=t.subarray(e,e+s);let i=new Array(n.length);n.forEach((t,e)=>i[e]={value:t,index:e}),r<i.length&&(aL(i,r),i=i.slice(0,r)),a&&i.sort(rL);const o=h*r,u=c.subarray(o,o+r),d=l.subarray(o,o+r);for(let t=0;t<r;t++)u[t]=i[t].value,d[t]=i[t].index}const u=e.slice();return u[u.length-1]=r,[Lf(u,n,c),Lf(u,"int32",l)]}const oL={kernelName:nh,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{k:i,sorted:o}=r;XA(a,"topk");const s=n.data.get(a.dataId).values,[c,l]=iL(s,a.shape,a.dtype,i,o);return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}};const sL={kernelName:rh,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{image:a,transforms:i}=e,{interpolation:o,fillMode:s,fillValue:c,outputShape:l}=n,[u,h,d,f]=a.shape,[p,m]=null!=l?l:[h,d],g=[u,p,m,f],y=Hs(a.shape),v=y[0],b=y[1],w=y[2],x=Hs(g),k=x[0],_=x[1],S=x[2],T=Fs(a.dtype,Is(g));T.fill(c);const I=r.data.get(a.dataId).values,E=r.data.get(i.dataId).values;for(let N=0;N<u;++N){const t=1===i.shape[0]?E:E.subarray(8*N,8*N+8);for(let e=0;e<p;++e)for(let n=0;n<m;++n)for(let r=0;r<f;++r){let a;const i=t[6]*n+t[7]*e+1;if(0===i)continue;const l=(t[0]*n+t[1]*e+t[2])/i,u=(t[3]*n+t[4]*e+t[5])/i,f=cL(l,d,s),p=cL(u,h,s);switch(o){case"nearest":a=uL(I,h,d,v,b,w,N,p,f,r,c);break;case"bilinear":a=hL(I,h,d,v,b,w,N,p,f,r,c);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(o))}T[N*k+e*_+n*S+r]=a}return r.makeTensorInfo(g,a.dtype,T)}return{dataId:r.write(T,g,a.dtype),shape:a.shape,dtype:a.dtype}}};function cL(t,e,n){switch(n){case"reflect":return function(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=2*e;n<t&&(n=t*Math.trunc(-n/t)+n),n=n<-e?n+t:-n-1}else if(n>e-1)if(e<=1)n=0;else{const t=2*e;n-=t*Math.trunc(n/t),n>=e&&(n=t-n-1)}return bs(0,n,e-1)}(t,e);case"wrap":return function(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=e-1;n+=e*(Math.trunc(-n/t)+1)}else if(n>e-1)if(e<=1)n=0;else{const t=e-1;n-=e*Math.trunc(n/t)}return bs(0,n,e-1)}(t,e);case"nearest":return function(t,e){return bs(0,t,e-1)}(t,e);default:return function(t){return t}(t)}}function lL(t,e,n,r,a,i,o,s,c,l,u){return 0<=s&&s<e&&0<=c&&c<n?t[o*r+s*a+c*i+l]:u}function uL(t,e,n,r,a,i,o,s,c,l,u){return lL(t,e,n,r,a,i,o,Math.round(s),Math.round(c),l,u)}function hL(t,e,n,r,a,i,o,s,c,l,u){const h=Math.floor(s),d=Math.floor(c),f=h+1,p=d+1;return(f-s)*((p-c)*lL(t,e,n,r,a,i,o,h,d,l,u)+(c-d)*lL(t,e,n,r,a,i,o,h,p,l,u))+(s-h)*((p-c)*lL(t,e,n,r,a,i,o,f,d,l,u)+(c-d)*lL(t,e,n,r,a,i,o,f,p,l,u))}function dL(t,e,n,r){const a=Ds(e,n)[0],i=[1,n[0],1];for(let p=0;p<a;p++)i[0]*=n[p];i[1]=n[a];for(let p=a+1;p<n.length;p++)i[2]*=n[p];const o={},s=new Int32Array(n[a]),c=new $h(i,r,t),l=[],u=1===i[0]&&1===i[2];for(let p=0;p<n[a];p++){let e;if(u)e=t[p].toString();else{const t=[];for(let e=0;e<i[0];e++)for(let n=0;n<i[2];n++)t.push(c.get(e,p,n));e=t.join(",")}if(void 0!==o[e])s[p]=o[e];else{const t=Object.keys(o).length;o[e]=t,s[p]=t,l.push(p)}}const h=i.slice();h[1]=Object.keys(o).length;const d=new $h(h,r);l.forEach((t,e)=>{for(let n=0;n<i[0];n++)for(let r=0;r<i[2];r++)d.set(c.get(n,t,r),n,e,r)});const f=n.slice();return f[a]=h[1],{outputValues:d.values,outputShape:f,indices:s}}const fL={kernelName:ih,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:a}=n,{x:i}=e;XA(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:s,outputShape:c,indices:l}=dL(o,a,i.shape,i.dtype);return[r.makeTensorInfo(c,i.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}};const pL={kernelName:oh,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a.shape.length,s=a.shape[i],c=new Array(o-1);let l=0;for(let f=0;f<o;f++)f!==i&&(c[l++]=a.shape[f]);const u=new Array(o).fill(0),h=a.shape.slice();h[i]=1;const d=new Array(s);for(let f=0;f<d.length;f++){u[i]=f;const t=yO({inputs:{x:a},backend:n,attrs:{begin:u,size:h}});d[f]=OR({inputs:{x:t},backend:n,attrs:{shape:c}}),n.disposeIntermediateTensorInfo(t)}return d}};const mL={kernelName:sh,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,segmentIds:i}=e,{numSegments:o}=r;XA(a,"unsortedSegmentSum");const s=[],c=[],l=a.shape.length-i.shape.length;let u=i;for(let d=0;d<l;++d){const t=ED({inputs:{input:u},backend:n,attrs:{dim:d+1}});u=t,c.push(t)}for(let d=0;d<o;++d){const t=Bh(d,"int32"),e=n.makeTensorInfo([],"int32",t),r=pD({inputs:{a:e,b:u},backend:n}),i=SR({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),o=sD({inputs:{a:i,b:a},backend:n}),l=lD({inputs:{x:o},backend:n,attrs:{axis:0,keepDims:!1}});s.push(l),c.push(e),c.push(r),c.push(i),c.push(o),c.push(l)}const h=SF({inputs:s,backend:n,attrs:{axis:0}});return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),h}},gL=[PR,zR,jR,VR,RR,WR,KR,XR,YR,QR,$R,tO,nO,iO,sO,hO,dO,fO,pO,FR,mO,bO,kO,_O,TR,IO,NO,bR,CO,MO,PO,LO,zO,BO,jO,UO,WO,HO,qO,KO,XO,YO,QO,$O,ZO,tD,eD,nD,rD,aD,hD,tR,dD,mD,_D,ID,ND,RD,VD,GD,HD,XD,JD,$D,ZD,eM,rM,oM,lM,nR,uM,OO,dM,pM,gM,aR,bM,kM,SM,EM,CM,OM,MM,LM,zM,BM,VM,HM,qM,KM,XM,YM,QM,JM,$M,eF,nF,iF,cF,cD,uF,dF,pF,gF,bF,wF,_F,TF,IF,CF,cR,RF,PF,VF,GF,kR,MD,qF,uR,dR,DR,KF,XF,YF,QF,JF,$F,tP,rP,iP,cP,lP,fP,gR,mP,yP,bP,vO,sF,kP,_P,TP,EP,CP,AP,RP,OP,FP,PP,BP,UP,WP,qP,YP,JP,zD,uD,ZP,{kernelName:th,backendName:"cpu",kernelFunc:tL},nL,oL,sL,qR,fL,pL,mL,kF];for(const n of gL)kh(n);const yL={},vL={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function bL(t,e){if(!(t in yL)||null!=e){const n=function(t,e){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==e?function(t){if("undefined"!==typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t):e;n.addEventListener("webglcontextlost",e=>{e.preventDefault(),delete yL[t]},!1),ac().getBool("SOFTWARE_WEBGL_ENABLED")&&(vL.failIfMajorPerformanceCaveat=!1);if(1===t)return n.getContext("webgl",vL)||n.getContext("experimental-webgl",vL);return n.getContext("webgl2",vL)}(t,e);if(null===n)return console.log("Could not get context for WebGL version",t),null;yL[t]=n}const n=yL[t];return null==n||n.isContextLost()?(delete yL[t],bL(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),yL[t])}var wL,xL,kL;function _L(t,e){return[e,t]}function SL(t){const e=Is(t);return Cs(Math.ceil(e/4))}function TL(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function IL(t,e){const n=t;let r,a,i,o,s,c,l,u,h,d;return 2===ac().getNumber("WEBGL_VERSION")?(r=n.R32F,a=n.R16F,i=n.RGBA16F,o=n.RGBA32F,s=n.RED,l=4,u=1,h=n.HALF_FLOAT,d=n.FLOAT,c=n.RGBA8):(r=t.RGBA,a=t.RGBA,i=t.RGBA,o=n.RGBA,s=t.RGBA,l=4,u=4,h=null!=e?e.HALF_FLOAT_OES:null,d=t.FLOAT,c=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:c,downloadUnpackNumChannels:l,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:d}}function EL(t,e){const n=e();return ac().getBool("DEBUG")&&function(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+function(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(e)}}(t,e))}(t),n}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(wL||(wL={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(xL||(xL={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(kL||(kL={}));function NL(t){return!!(ac().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function CL(t,e){return zL(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}const AL=/ERROR: [0-9]+:([0-9]+):/g;function RL(t,e){const n=AL.exec(e);if(null==n)return console.log("Couldn't parse line number in error: ".concat(e)),void console.log(t);const r=+n[1],a=t.split("\n"),i=a.length.toString().length+2,o=a.map((t,e)=>As((e+1).toString(),i)+t);let s=0;for(let h=0;h<o.length;h++)s=Math.max(o[h].length,s);const c=o.slice(0,r-1),l=o.slice(r-1,r),u=o.slice(r);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c ".concat(As(l[0],s)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join("\n"))}function OL(t,e){if(EL(t,()=>t.validateProgram(e)),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function DL(t,e,n,r,a,i,o){const s=t.getAttribLocation(e,n);return-1!==s&&(EL(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),EL(t,()=>t.vertexAttribPointer(s,a,t.FLOAT,!1,i,o)),EL(t,()=>t.enableVertexAttribArray(s)),!0)}function ML(t,e,n,r){EL(t,()=>function(t,e,n){BL(t,n),EL(t,()=>t.activeTexture(t.TEXTURE0+n)),EL(t,()=>t.bindTexture(t.TEXTURE_2D,e))}(t,e,r)),EL(t,()=>t.uniform1i(n,r))}function FL(t,e,n){EL(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),EL(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function PL(t,e){EL(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),EL(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function LL(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(e)}}(t,e))}function zL(t,e,n){const r=EL(t,()=>e());if(null==r)throw new Error(n);return r}function BL(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const t="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(t,"."))}}function jL(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Is(t.slice(0,t.length-e))}function UL(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function VL(t){let e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[jL(t),...UL(t)]),e}function WL(t){return t%2===0}function GL(t,e){if(Es(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(WL(n)&&WL(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&WL(t[0])&&WL(e[0])}let HL,qL;function KL(t,e){return null!=t.getExtension(e)}function XL(t){try{if(null!=bL(t))return!0}catch(Grt){return console.log("Error when getting WebGL context: ",Grt),!1}return!1}function YL(t){if(0===t)return!1;const e=bL(t);if(1!==t){if(KL(e,"EXT_color_buffer_float"))return QL(e);const t="EXT_color_buffer_half_float";if(KL(e,t)){const n=e.getExtension(t);return function(t,e){const n=IL(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const a=1,i=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),s}(e,n)}return!1}if(!KL(e,"OES_texture_float"))return!1;if(!KL(e,"WEBGL_color_buffer_float"))return!1;return QL(e)}function QL(t){const e=IL(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),a}function JL(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&ks("complex64"!==t.dtype,()=>"".concat(e," does not support complex64 tensors ")+"in the WebGL backend.")})}const $L=ac();function ZL(){let t,e,n,r,a,i,o,s,c,l;return 2===ac().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s=ac().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",c="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",c="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:c,defineRound:l}}function tz(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=Hs(e);return r.map((e,a)=>{const i="int ".concat(t[a]," = ").concat(n," / ").concat(e),o=a===r.length-1?"int ".concat(t[a+1]," = ").concat(n," - ").concat(t[a]," * ").concat(e):"index -= ".concat(t[a]," * ").concat(e);return"".concat(i,"; ").concat(o,";")}).join("")}function ez(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=Hs(e);return r.map((e,a)=>{const i="int ".concat(t[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),o=a===r.length-1?"int ".concat(t[a+1]," = ").concat(n," - ").concat(t[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(t[a]," * outShapeStrides[").concat(a,"]");return"".concat(i,"; ").concat(o,";")}).join("")}function nz(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index";const r=function(t,e){const n=t.length,r=t.map(t=>"".concat(e,"[").concat(t,"]")),a=new Array(n-1);a[n-2]=r[n-1];for(let i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}(t.map((t,e)=>e),e);return r.map((e,a)=>{const i="int ".concat(t[a]," = ").concat(n," / ").concat(r[a]),o=a===r.length-1?"int ".concat(t[a+1]," = ").concat(n," - ").concat(t[a]," * ").concat(r[a]):"index -= ".concat(t[a]," * ").concat(r[a]);return"".concat(i,"; ").concat(o,";")}).join("")}function rz(t){const e=Hs(t).map(t=>t.toString());return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(e[0]," + coords.y * ").concat(e[1]," + coords.z;\n  }\n")}$L.registerFlag("HAS_WEBGL",()=>$L.getNumber("WEBGL_VERSION")>0),$L.registerFlag("WEBGL_VERSION",()=>XL(2)?2:XL(1)?1:0),$L.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),$L.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===$L.get("WEBGL_VERSION")),$L.registerFlag("WEBGL_CPU_FORWARD",()=>!0),$L.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),$L.registerFlag("WEBGL_PACK",()=>$L.getBool("HAS_WEBGL")),$L.registerFlag("WEBGL_PACK_NORMALIZATION",()=>$L.getBool("WEBGL_PACK")),$L.registerFlag("WEBGL_PACK_CLIP",()=>$L.getBool("WEBGL_PACK")),$L.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>$L.getBool("WEBGL_PACK")),$L.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>$L.getBool("WEBGL_PACK")),$L.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>$L.getBool("WEBGL_PACK")),$L.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>$L.getBool("WEBGL_PACK")),$L.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>$L.getBool("WEBGL_PACK")),$L.registerFlag("WEBGL_PACK_REDUCE",()=>$L.getBool("WEBGL_PACK")),$L.registerFlag("WEBGL_LAZILY_UNPACK",()=>$L.getBool("WEBGL_PACK")),$L.registerFlag("WEBGL_CONV_IM2COL",()=>$L.getBool("WEBGL_PACK")),$L.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>function(t){if(null==HL){const e=bL(t);HL=e.getParameter(e.MAX_TEXTURE_SIZE)}return HL}($L.getNumber("WEBGL_VERSION"))),$L.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>function(t){if(null==qL){const e=bL(t);qL=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,qL)}($L.getNumber("WEBGL_VERSION"))),$L.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=$L.getNumber("WEBGL_VERSION");return 0===t?0:function(t){if(0===t)return 0;let e;const n=bL(t);return e=KL(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:KL(n,"EXT_disjoint_timer_query")?1:0,e}(t)}),$L.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>$L.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Sd()),$L.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>function(t){if(0===t)return!1;const e=bL(t);if(1===t){if(!KL(e,"OES_texture_float"))return!1}else if(!KL(e,"EXT_color_buffer_float"))return!1;return QL(e)}($L.getNumber("WEBGL_VERSION"))),$L.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!$L.getBool("WEBGL_FORCE_F16_TEXTURES")&&$L.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),$L.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>YL($L.getNumber("WEBGL_VERSION"))),$L.registerFlag("WEBGL_FENCE_API_ENABLED",()=>{return 2===(t=$L.getNumber("WEBGL_VERSION"))&&null!=bL(t).fenceSync;var t}),$L.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>$L.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),$L.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&-1!==t)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(t,"."))}),$L.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Sd()?1:-1,t=>{if(t<0&&-1!==t)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(t,"."))}),$L.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),$L.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),$L.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),$L.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),$L.registerFlag("WEBGL_EXP_CONV",()=>!1),$L.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>$L.getBool("IS_TEST")),$L.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),$L.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),$L.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);const az="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:iz}=o;function oz(t,e,n){const r=[];if(t.forEach(t=>{const e=Is(t.shapeInfo.logicalShape);if(t.shapeInfo.isUniform?r.push("uniform float ".concat(t.name).concat(e>1?"[".concat(e,"]"):"",";")):(r.push("uniform sampler2D ".concat(t.name,";")),r.push("uniform int offset".concat(t.name,";"))),n.enableShapeUniforms){const{uniformShape:e}=gz(n.packedInputs,t.shapeInfo.logicalShape,t.shapeInfo.texShape);switch(e.length){case 1:r.push("uniform int ".concat(t.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(t.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(t.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(t.name,"Shape;"))}r.push("uniform ivec2 ".concat(t.name,"TexShape;"))}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(t=>{r.push("uniform ".concat(t.type," ").concat(t.name).concat(t.arrayIndex?"[".concat(t.arrayIndex,"]"):"",";"))});const a=r.join("\n"),i=t.map(t=>function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?cz(t,r):sz(t,r);const i=t.shapeInfo.logicalShape,o=e.logicalShape;i.length<=o.length&&(a+=n?function(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,s=iz(t.shapeInfo.logicalShape,e.logicalShape),c=mz(o),l=o-i;let u;const h=["x","y","z","w","u","v"];u=0===i?"":o<2&&s.length>=1?"coords = 0;":s.map(t=>"coords.".concat(h[t+l]," = 0;")).join("\n");let d="";d=o<2&&i>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>"coords.".concat(h[e+l])).join(", ");let f="return outputValue;";const p=1===Is(t.shapeInfo.logicalShape),m=Is(e.logicalShape),g=1===m;if(1!==i||p||g){if(p&&!g)f=1===o?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){const t=i-2,e=i-1;s.indexOf(t)>-1&&s.indexOf(e)>-1?f="return vec4(outputValue.x);":s.indexOf(t)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(e)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(a,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(u,"\n      vec4 outputValue = get").concat(r,"(").concat(d,");\n      ").concat(f,"\n    }\n  ")}(t,e):function(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,s=t.shapeInfo.logicalShape.length,c=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===c&&null==t.shapeInfo.flatOffset&&Es(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");const l=mz(c),u=iz(t.shapeInfo.logicalShape,e.logicalShape),h=c-s;let d;const f=["x","y","z","w","u","v"];d=0===s?"":c<2&&u.length>=1?"coords = 0;":u.map(t=>"coords.".concat(f[t+h]," = 0;")).join("\n");let p="";p=c<2&&s>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>"coords.".concat(f[e+h])).join(", ");return"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(d,"\n      return get").concat(r,"(").concat(p,");\n    }\n  ")}(t,e));return a}(t,e,n.packedInputs,n.enableShapeUniforms)).join("\n"),o=e.texShape,s=ZL(),c=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(t.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(s);let l,u,h=function(t){const e="".concat(t.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(t.varyingFs," vec2 resultUV;\n    ").concat(t.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(t.defineSpecialNaN,"\n    ").concat(t.defineSpecialInf,"\n    ").concat(t.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(lz,"\n    ").concat(uz,"\n    ").concat(hz,"\n  ");return e}(s);e.isPacked?(l=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Es(t,e))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");const a=Math.ceil(t[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[2]/2),i=a*Math.ceil(t[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(t,e,n);default:return function(t,e,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[t.length-1]/2),i=a*Math.ceil(t[t.length-2]/2);let o=i,s="",c="b, r, c";for(let l=2;l<t.length-1;l++)o*=t[t.length-l-1],s="\n      int b".concat(l," = index / ").concat(o,";\n      index -= b").concat(l," * ").concat(o,";\n    ")+s,c="b".concat(l,", ")+c;return"\n    ivec".concat(t.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(s,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(t.length,"(").concat(c,");\n    }\n  ")}(t,e,n)}}(e.logicalShape,o,n.enableShapeUniforms),u=function(t){return"\n    void setOutput(vec4 val) {\n      ".concat(t.output," = val;\n    }\n  ")}(s)):(l=function(t,e,n){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e,n){if(1===e[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(e[1],".0);\n      }\n    ");if(1===e[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(e[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      return resTexRC.x * ").concat(e[1]," + resTexRC.y;\n    }\n  ")}(0,e,n);case 2:return function(t,e,n){if(Es(t,e))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(e[0],", ").concat(e[1],"));\n      }\n    ");if(1===t[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===t[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(e[0],", ").concat(e[1],"));\n        int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      int r = index / ").concat(t[1],";\n      int c = index - r * ").concat(t[1],";\n      return ivec2(r, c);\n    }\n  ")}(t,e,n);case 3:return function(t,e,n){if(n){const e=ez(["r","c","d"],t);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(e,"\n    return ivec3(r, c, d);\n  }\n")}const r=tz(["r","c","d"],t);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec3(r, c, d);\n    }\n  ")}(t,e,n);case 4:return function(t,e,n){if(n){const e=ez(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(e,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}const r=tz(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n      ").concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(t,e,n);case 5:return function(t,e){const n=tz(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(e[0],",\n                             ").concat(e[1],"));\n\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(t,e);case 6:return function(t,e){const n=tz(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(e[0],", ").concat(e[1],"));\n      int index = resTexRC.x * ").concat(e[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(t,e);default:throw new Error("".concat(t.length,"-D output sampling is not yet supported"))}}(e.logicalShape,o,n.enableShapeUniforms),u=function(t){return"\n    void setOutput(float val) {\n      ".concat(t.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(s)),n.packedInputs&&(h+=dz);return[h,c,u,a,l,i,n.userCode].join("\n")}function sz(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");const[a,i]=t.shapeInfo.texShape;if(1===a&&1===i)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const o=fz(n);if(e)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");const[s,c]=t.shapeInfo.texShape;return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(c,", ").concat(o,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,e);case 1:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(pz(t),"\n      }\n    ");const a=t.shapeInfo.texShape,i=a[0],o=a[1];if(1===o&&1===i)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");const s=fz(n);if(1===o)return e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(s,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(1===i)return e?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(s,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(e)return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(o,", index + ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(null!=i&&Es(n,i)){if(e)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const t=i[0],n=i[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(n,".0, ").concat(t,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}const{newShape:o,keptDims:s}=Ms(n),c=o;if(c.length<n.length){const n=yz(t,c),r=["row","col"];return"\n      ".concat(sz(n,e),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(vz(r,s),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(pz(t),"\n      }\n    ");const l=i[0],u=i[1],h=fz(r);if(1===u)return e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(l,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(1===l)return e?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(h,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(u,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");if(e)return"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(h,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");return"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(h,";\n    vec2 uv = uvFromFlat(").concat(l,", ").concat(u,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}(t,e);case 3:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:s,keptDims:c}=Ms(n),l=s;if(l.length<n.length){const n=yz(t,l),r=["row","col","depth"];return"\n        ".concat(sz(n,e),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(vz(r,c),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(pz(t),"\n      }\n    ");const u=t.shapeInfo.texShape,h=u[0],d=u[1],f=t.shapeInfo.flatOffset;if(d===i&&null==f)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(d,".0, ").concat(h,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(d===o&&null==f)return e?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(d,".0, ").concat(h,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");const p=fz(r);if(e)return"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(p,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    ");return"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(p,";\n        vec2 uv = uvFromFlat(").concat(h,", ").concat(d,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}(t,e);case 4:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,s=n[1]*o,{newShape:c,keptDims:l}=Ms(n);if(c.length<n.length){const n=yz(t,c),r=["row","col","depth","depth2"];return"\n      ".concat(sz(n,e),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(vz(r,l),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(pz(t),"\n      }\n    ");const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1],p="int stride2 = ".concat(r,"Shape[3];"),m="int stride1 = ".concat(r,"Shape[2] * stride2;"),g="int stride0 = ".concat(r,"Shape[1] * stride1;");if(f===s&&null==u)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(p,"\n        ").concat(m,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(d,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(f===i&&null==u)return e?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(d,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");const y=fz(r);if(e)return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(p,"\n      ").concat(m,"\n      ").concat(g,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");return"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(f,", index + ").concat(y,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}(t,e);case 5:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],i=e[3]*a,o=e[2]*i,s=e[1]*o,{newShape:c,keptDims:l}=Ms(e);if(c.length<e.length){const e=yz(t,c),n=["row","col","depth","depth2","depth3"];return"\n      ".concat(sz(e),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(vz(n,l),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(s,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(pz(t),"\n      }\n    ");const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1];if(f===s&&null==u)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(f,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(f===a&&null==u)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3],",\n               ").concat(e[2]*e[3],", ").concat(e[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(f,".0, ").concat(d,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const p=fz(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(p,";\n      vec2 uv = uvFromFlat(").concat(d,", ").concat(f,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);case 6:return function(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:i}=Ms(e);if(a.length<e.length){const e=yz(t,a),n=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(sz(e),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(vz(n,i),");\n      }\n    ")}const o=e[5],s=e[4]*o,c=e[3]*s,l=e[2]*c,u=e[1]*l;if(t.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(l,", ").concat(c,", ").concat(s,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(o,", 1)));\n        ").concat(pz(t),"\n      }\n    ");const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1];if(p===u&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(l,", ").concat(c,", ").concat(s,", ").concat(o,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(p,".0, ").concat(f,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(p===o&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(e[1]*e[2]*e[3]*e[4],",\n               ").concat(e[2]*e[3]*e[4],",\n               ").concat(e[3]*e[4],",\n               ").concat(e[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(p,".0, ").concat(f,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");const m=fz(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(l," + depth * ").concat(c," +\n          depth2 * ").concat(s," + depth3 * ").concat(o," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(f,", ").concat(p,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(t);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function cz(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return function(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=ZL();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(e,", halfCR);\n    }\n  ")}(t);case 1:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,i=ZL();if(e)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");const o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e);case 2:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=i[0],s=i[1],c=ZL();if(null!=i&&Es(n,i))return e?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(c.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n\n        return ").concat(c.texture2D,"(").concat(r,", uv);\n      }\n    ");if(e)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(c.texture2D,"(").concat(r,", uv);\n    }\n  ");const l=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(u,", ").concat(l[0],", ").concat(l[1],", row, col);\n      return ").concat(c.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,e);case 3:return function(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){const r=[1,2],i=yz(t,n.slice(1)),o=["b","row","col"];return"\n        ".concat(cz(i,e),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(vz(o,r),");\n        }\n      ")}const s=ZL();if(e)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ");const c=o[0],l=o[1],u=Math.ceil(n[2]/2),h=u*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(c,", ").concat(l,", ").concat(h,", ").concat(u,", b, row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ")}(t,e);default:return function(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=ZL();if(e)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");const i=t.shapeInfo.logicalShape,o=i.length,s=t.shapeInfo.texShape,c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=c[0],u=c[1],h=Math.ceil(i[o-1]/2);let d=h*Math.ceil(i[o-2]/2),f="int b, int row, int col",p="b * ".concat(d," + (row / 2) * ").concat(h," + (col / 2)");for(let m=2;m<o-1;m++)f="int b".concat(m,", ")+f,d*=i[o-m-1],p="b".concat(m," * ").concat(d," + ")+p;return"\n    vec4 ".concat(r,"(").concat(f,") {\n      int index = ").concat(p,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(l,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t,e)}}const lz="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",uz="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",hz="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",dz="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function fz(t){return"offset".concat(t)}function pz(t){const e=t.name,n=Is(t.shapeInfo.logicalShape);return n<2?"return ".concat(e,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(e,"[i];\n      }\n    }\n  ")}function mz(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank ".concat(t," is not yet supported"))}function gz(t,e,n){const{newShape:r,keptDims:a}=Ms(e),i=e.length,o=t&&3===i&&1===e[0],s=o?e.slice(1):r,c=!t&&i>1&&!Es(e,n)&&r.length<i||o;return{useSqueezeShape:c,uniformShape:c?s:e,keptDims:a}}function yz(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function vz(t,e){return e.map(e=>t[e]).join(", ")}function bz(t,e,n,r){const a=n.map((t,n)=>{const r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}}),i=a.map(t=>t.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=oz(a,o,e),c=function(t,e){const n=zL(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(EL(t,()=>t.shaderSource(n,e)),EL(t,()=>t.compileShader(n)),ac().get("ENGINE_COMPILE_ONLY"))return n;if(!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw RL(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(t.gl,s),l=t.createProgram(c);return ac().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:c,source:s,webGLProgram:l,inShapeInfos:i,outShapeInfo:o,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:c,source:s,webGLProgram:l,inShapeInfos:i,outShapeInfo:o},wz(t,e,l))}function wz(t,e,n){const r={},a={},i={},o=[];let s,c,l,u=null,h=null;h=t.getUniformLocation(n,"NAN",!1),1===ac().getNumber("WEBGL_VERSION")&&(u=t.getUniformLocation(n,"INFINITY",!1));const d=!1;for(let f=0;f<e.variableNames.length;f++){const o=e.variableNames[f];r[o]=t.getUniformLocation(n,o,d),r["offset".concat(o)]=t.getUniformLocation(n,"offset".concat(o),d),e.enableShapeUniforms&&(a["".concat(o,"Shape")]=t.getUniformLocation(n,"".concat(o,"Shape"),d),i["".concat(o,"TexShape")]=t.getUniformLocation(n,"".concat(o,"TexShape"),d))}return e.enableShapeUniforms&&(s=t.getUniformLocation(n,"outShape",d),l=t.getUniformLocation(n,"outShapeStrides",d),c=t.getUniformLocation(n,"outTexShape",d)),e.customUniforms&&e.customUniforms.forEach((e,r)=>{o[r]=t.getUniformLocation(n,e.name,d)}),{uniformLocations:r,customUniformLocations:o,infLoc:u,nanLoc:h,inShapesLocations:a,inTexShapesLocations:i,outShapeLocation:s,outShapeStridesLocation:l,outTexShapeLocation:c}}function xz(t,e){if(t.length!==e.length)throw Error("Binary was compiled with ".concat(t.length," inputs, but ")+"was executed with ".concat(e.length," inputs"));t.forEach((t,n)=>{const r=t.logicalShape,a=e[n],i=a.shape;if(!Es(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(t.isUniform&&a.isUniform)return;const o=t.texShape,s=a.isUniform?null:a.texData.texShape;if(!Es(o,s))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(s," must match"))})}function kz(t){return ac().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}class _z{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=wL.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=ZL();this.outputShape=t,this.enableShapeUniforms=kz(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?ez(["r","c","d"],t):tz(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}class Sz{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=wL.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=ZL();this.outputShape=t,this.enableShapeUniforms=kz(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?ez(["r","c","d"],t):tz(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}class Tz{constructor(t){this.variableNames=["A"],this.outTexUsage=xL.DOWNLOAD;const e=ZL();this.outputShape=t,this.userCode="\n      ".concat(az,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}class Iz{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=xL.DOWNLOAD;const e=ZL();this.outputShape=t,this.userCode="\n      ".concat(az,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(e.output," = encode_float(x);\n      }\n    ")}}class Ez{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ZL();this.outputShape=t,this.enableShapeUniforms=kz(this.outputShape.length);let r="result";e&&(r="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":rz(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / texShape[1];\n        int c = imod(flatIndex, texShape[1]);\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(n.output," = vec4(").concat(r,", 0., 0., 0.);\n      }\n    ")}}class Nz{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ZL();this.outputShape=t,this.enableShapeUniforms=kz(this.outputShape.length);let r="",a="result";e&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let e=0;e<=1;e++){const a=2*i+e;r+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(e," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(e,";\n          if (localCoords[1] + ").concat(i," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(i,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(n.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(a,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(a,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(a,"] = values[2];\n            } else {\n              result[").concat(a,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":rz(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(r,"\n\n          ").concat(n.output," = ").concat(a,";\n        }\n    ")}}function Cz(t){const e=ZL();return function(t,e){const n=zL(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(EL(t,()=>t.shaderSource(n,e)),EL(t,()=>t.compileShader(n)),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(t,"".concat(e.version,"\n    precision highp float;\n    ").concat(e.attribute," vec3 clipSpacePos;\n    ").concat(e.attribute," vec2 uv;\n    ").concat(e.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function Az(t){return function(t,e){const n=zL(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return EL(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),EL(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}(t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Rz(t){return function(t,e){const n=zL(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return EL(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),EL(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}(t,new Uint16Array([0,1,2,2,1,3]))}function Oz(t,e,n,r,a,i){!function(t,e){const n=ac().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const n="[".concat(t,"x").concat(e,"]");throw new Error("Requested texture size "+n+" is invalid.")}if(t>n||e>n){const r="[".concat(t,"x").concat(e,"]"),a="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}(e,n);const o=function(t){return zL(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}(t),s=t.TEXTURE_2D;return EL(t,()=>t.bindTexture(s,o)),EL(t,()=>t.texParameteri(s,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),EL(t,()=>t.texParameteri(s,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),EL(t,()=>t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST)),EL(t,()=>t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST)),1===ac().getNumber("WEBGL_VERSION")?EL(t,()=>t.texImage2D(s,0,r,e,n,0,a,i,null)):EL(t,()=>t.texStorage2D(s,1,r,e,n)),EL(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function Dz(t){return t.internalFormatFloat}function Mz(t){return t.internalFormatHalfFloat}function Fz(t){return t.downloadTextureFormat}function Pz(t){return t.internalFormatPackedFloat}function Lz(t){return t.internalFormatPackedHalfFloat}function zz(t,e,n,r,a,i,o,s){const c=t,l=new Float32Array(function(t,e){const[n,r]=TL(t,e);return n*r*4}(i,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}class Bz{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const e=ac().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(t,e){yL[t]=e}(e,t)):this.gl=bL(e);let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===ac().getNumber("WEBGL_VERSION")){const t="OES_texture_float",e="OES_texture_half_float";if(this.textureFloatExtension=CL(this.gl,t),KL(this.gl,e))this.textureHalfFloatExtension=CL(this.gl,e);else if(ac().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),KL(this.gl,r))this.colorBufferHalfFloatExtension=CL(this.gl,r);else if(ac().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",KL(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!KL(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=Az(this.gl),this.indexBuffer=Rz(this.gl),this.framebuffer=function(t){return zL(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=IL(this.gl,this.textureHalfFloatExtension)}get debug(){return ac().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;EL(t,()=>t.finish()),EL(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),EL(t,()=>t.deleteFramebuffer(this.framebuffer)),EL(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),EL(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),EL(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[a,i]=_L(e,n);return Oz(t,a,i,Dz(r),r.textureFormatFloat,t.FLOAT)}(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[a,i]=_L(e,n);return Oz(t,a,i,Mz(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[a,i]=_L(e,n);return Oz(t,a,i,Fz(r),t.RGBA,t.UNSIGNED_BYTE)}(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),function(t,e,n){EL(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?2===ac().getNumber("WEBGL_VERSION")?EL(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):EL(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):2===ac().getNumber("WEBGL_VERSION")?EL(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):EL(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),EL(t,()=>t.bindTexture(t.TEXTURE_2D,null))}(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,r){this.throwIfDisposed(),function(t,e,n,r,a,i){let o,s,c;EL(t,()=>t.bindTexture(t.TEXTURE_2D,e)),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=t.UNSIGNED_BYTE,c=t.RGBA):(o=new Float32Array(n*r*4),s=t.FLOAT,c=i.internalFormatPackedFloat),o.set(a),2===ac().getNumber("WEBGL_VERSION")?EL(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,s,o)):EL(t,()=>t.texImage2D(t.TEXTURE_2D,0,c,n,r,0,t.RGBA,s,o)),EL(t,()=>t.bindTexture(t.TEXTURE_2D,null))}(this.gl,t,e,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[a,i]=TL(e,n);return Oz(t,a,i,Lz(r),t.RGBA,r.textureTypeHalfFloat)}(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),function(t,e,n,r){const[a,i]=TL(e,n);return Oz(t,a,i,Pz(r),t.RGBA,t.FLOAT)}(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(PL(this.gl,this.framebuffer),this.outputTexture=null),EL(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,()=>function(t,e,n,r){const[a,i]=_L(e,n),o=new Uint8Array(e*n*4);return EL(t,()=>t.readPixels(0,0,a,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}(this.gl,e,n,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,n,r,a,i){return zz(this.gl,t,0,0,0,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return function(t,e,n){const r=t,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const r=function(t,e,n){const r=t.createBuffer();EL(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=16*e*n;return EL(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),EL(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),EL(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(ac().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=r.clientWaitSync(a,0,0);return t===r.ALREADY_SIGNALED||t===r.CONDITION_SATISFIED},e=a}else ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,()=>function(t,e,n){const r=new Float32Array(e*n*4);return EL(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}(this.gl,e,n))}createProgram(t){this.throwIfDisposed();const e=this.gl;null==this.vertexShader&&(this.vertexShader=Cz(e));const n=function(t){return zL(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}(e);return EL(e,()=>e.attachShader(n,this.vertexShader)),EL(e,()=>e.attachShader(n,t)),function(t,e){if(EL(t,()=>t.linkProgram(e)),!ac().get("ENGINE_COMPILE_ONLY")&&!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}(e,n),this.debug&&OL(e,n),this.vertexAttrsAreBound||(this.setProgram(n),this.vertexAttrsAreBound=function(t,e,n){return EL(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),DL(t,e,"clipSpacePos",n,3,20,0)&&DL(t,e,"uv",n,2,20,12)}(e,this.program,this.vertexBuffer)),n}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&EL(this.gl,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&OL(this.gl,this.program),EL(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(t,e,n){return zL(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}(this.gl,t,e):function(t,e,n){return t.getUniformLocation(e,n)}(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),EL(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),ML(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[r,a]=TL(e,n);this.setOutputMatrixTextureDriver(t,r,a)}setOutputMatrixWriteRegion(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&OL(this.gl,this.program),LL(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),EL(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),EL(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=CL(this.gl,2===ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await Rs(()=>this.disposed||this.isQueryAvailable(t,ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl;return e.getQueryParameter(t,e.QUERY_RESULT)/1e6}{const e=this.getQueryTimerExtensionWebGL1();return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=function(t){let e=0;for(;e<t.length;++e){if(!t[e]())break}return e-1}(this.itemsToPoll.map(t=>t.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let n;"setTimeoutCustom"in ac().platform&&(n=ac().platform.setTimeoutCustom.bind(ac().platform)),Rs(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,n)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),FL(this.gl,t,this.framebuffer),this.debug&&LL(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(FL(this.gl,this.outputTexture,this.framebuffer),this.debug&&LL(this.gl)):PL(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const r=this.gl;FL(r,t,this.framebuffer),this.debug&&LL(r),this.outputTexture=t,EL(r,()=>r.viewport(0,0,e,n)),EL(r,()=>r.scissor(0,0,e,n))}setOutputMatrixWriteRegionDriver(t,e,n,r){this.throwIfDisposed(),EL(this.gl,()=>this.gl.scissor(t,e,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{mx:jz,XI:Uz,Nk:Vz,ct:Wz,YG:Gz,hH:Hz,z3:qz,sG:Kz,uM:Xz,vS:Yz,qB:Qz,GG:Jz,rq:$z,lg:Zz,WR:tB,cu:eB,GE:nB,px:rB,jC:aB,He:iB,hE:oB,BF:sB,Dk:cB,cl:lB,_B:uB,ub:hB,Ku:dB,qy:fB,Zy:pB,bu:mB,zv:gB,dH:yB,HS:vB,yH:bB,l3:wB,z9:xB,x6:kB,eW:_B,GK:SB,SP:TB,f6:IB,dl:EB,Dw:NB,xT:CB,_X:AB,wz:RB}=E;function OB(t,e){return["x","y","z","w","u","v"].slice(0,e).map(e=>"".concat(t,".").concat(e))}function DB(t,e){return 1===e?[t]:OB(t,e)}class MB{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=kz(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const t=DB("rc",this.rank),e=mz(this.rank),n=this.getOutOfBoundsCondition(t),r=this.getSetup(t),a=this.getOutput(t);this.userCode="\n        void main() {\n          ".concat(e," rc = getOutputCoords();\n\n          if(").concat(n,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(r,"\n\n            setOutput(vec4(").concat(a,"));\n          }\n        }\n      ")}}getSourceCoordsArr(t){const e=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let a="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1");for(let e=2;e<this.rank;e++)a="".concat(t[t.length-1-e],",")+a;e.push(a)}return e}getOutOfBoundsCondition(t){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);let e="";for(let n=this.rank-2;n<this.rank;n++)e+="".concat(t[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(e+="||");return e}getSetup(t){if(1===this.rank)return"";const e=t.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(e[0],";\n      int c = ").concat(e[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}getOutput(t){const e=this.getSourceCoordsArr(t);if(1===this.rank){const t=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(t," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(e[0],"),\n            cEdge ? 0. : getA(").concat(e[1],"),\n            rEdge ? 0. : getA(").concat(e[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(e[3],")")}}class FB{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=kz(this.outputShape.length);let n="";for(let r=0;r<4;r++){let t="thisRC = rc;";r%2===1&&(t+="thisRC.z += 1;"),r>1&&(t+="thisRC.y += 1;"),n+="\n        ".concat(t,"\n        ").concat(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(r,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(r>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(t,e){const n=e?nz(["r","c","d"],"inputShape"):tz(["r","c","d"],t);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":rz(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(n,"\n\n        setOutput(result);\n      }\n    ")}}class PB{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,n){const r=zB(e,n),a=BB(t,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const i=LB(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const t=this.freeTextures[a].shift();return this.usedTextures[a].push(t),t}let o;return r===kL.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===kL.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===kL.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===kL.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===kL.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}releaseTexture(t,e,n,r){if(null==this.freeTextures)return;const a=zB(n,r),i=BB(e,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);const o=LB(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=ac().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==s&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(t),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const c=this.usedTextures[i],l=c.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(l,1),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(t,")"));const e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*e),"%)"))}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function LB(t,e,n,r,a){const i=function(t,e){switch(t){case kL.PACKED_2X2_FLOAT32:return Pz(e);case kL.PACKED_2X2_FLOAT16:return Lz(e);case kL.UNPACKED_FLOAT32:return Dz(e);case kL.UNPACKED_FLOAT16:return Mz(e);case kL.PACKED_4X1_UNSIGNED_BYTE:return Fz(e);default:throw new Error("Unknown physical texture type ".concat(t))}}(e,r);let o;if(a){const[e,n]=TL(t[0],t[1]);o=e*n}else{const[e,n]=_L(t[0],t[1]);o=e*n}const s=function(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(e))}(n,i);return o*s}function zB(t,e){if(t===xL.UPLOAD)return kL.PACKED_2X2_FLOAT32;if(t===xL.RENDER||null==t)return function(t){return ac().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?kL.PACKED_2X2_FLOAT32:kL.UNPACKED_FLOAT32:t?kL.PACKED_2X2_FLOAT16:kL.UNPACKED_FLOAT16}(e);if(t===xL.DOWNLOAD||t===xL.PIXELS)return kL.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(t))}function BB(t,e,n){return"".concat(t[0],"_").concat(t[1],"_").concat(e,"_").concat(n)}class jB{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=kz(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}const UB="if (isnan(x)) return x;",VB="return abs(x);";const WB=UB+"\n  return (x < 0.0) ? 0.0 : x;\n",GB=UB+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",HB="return x;";class qB{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=kz(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(e,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")}}class KB{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=kz(this.outputShape.length);const e=t.length,n=DB("rc",e),r=mz(e),a=function(t,e){if(1===t)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),i=n.slice(-2),o=e<=1?"rc":"vec2(".concat(i.join(","),")");this.userCode="\n      void main() {\n        ".concat(r," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(a,");\n\n        setOutput(getChannel(packedInput, ").concat(o,"));\n      }\n    ")}}const XB=Vv,YB={};const QB=ac().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class JB extends gs{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ac().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let e;if(null!=t){if(t instanceof Bz)e=t;else{const n=bL(ac().getNumber("WEBGL_VERSION"),t);e=new Bz(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const t=bL(ac().getNumber("WEBGL_VERSION"));e=new Bz(t),this.binaryCache=((n=ac().getNumber("WEBGL_VERSION"))in YB||(YB[n]={}),YB[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=e,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new PB(this.gpgpu),this.numMBBeforeWarning=null==ac().global.screen?1024:ac().global.screen.height*ac().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new ms(this,Pp())}nextDataId(){return JB.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(t,e,n){if((ac().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ac().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:xL.UPLOAD,refCount:1}),r}refCount(t){if(this.texData.has(t)){return this.texData.get(t).refCount}return 0}incRef(t){this.texData.get(t).refCount++}decRef(t){if(this.texData.has(t)){this.texData.get(t).refCount--}}move(t,e,n,r,a){if(ac().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:xL.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const e=this.texData.get(t),{values:n,dtype:r,complexTensorInfos:a,slice:i,shape:o,isPacked:s}=e;if(null!=i){let e;e=s?new qB(o,HB):new jB(o,HB);const n=this.runWebGLProgram(e,[{dataId:t,shape:o,dtype:r}],r),a=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;const c=null!=this.activeTimers;let l,u;if(c&&(l=Uh()),"complex64"===r){u=Qw(this.readSync(a.real.dataId),this.readSync(a.imag.dataId))}else u=this.getValuesFromTexture(t);return c&&(this.downloadWaitMs+=Uh()-l),this.convertAndCacheOnCPU(t,u)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise(t=>e.push(t))}const e=this.texData.get(t),{values:n,shape:r,slice:a,dtype:i,complexTensorInfos:o,isPacked:s}=e;if(null!=a){let e;e=s?new qB(r,HB):new jB(r,HB);const n=this.runWebGLProgram(e,[{dataId:t,shape:r,dtype:i}],i),a=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(t);if(ac().getBool("DEBUG")&&!ac().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===ac().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c,l,u=null;if("complex64"!==i&&ac().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(t);const e=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(e.texture.texture,...SL(r))}if(this.pendingRead.set(t,[]),"complex64"!==i&&await this.gpgpu.createAndWaitForFence(),"complex64"===i){const t=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]);l=Qw(t[0],t[1])}else if(null==u)l=this.getValuesFromTexture(t);else{const t=Is(r);l=this.gpgpu.downloadFloat32MatrixFromBuffer(u,t)}if(null!=c&&this.disposeIntermediateTensorInfo(c),null!=u){const t=this.gpgpu.gl;EL(t,()=>t.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(t,l),d=this.pendingRead.get(t);return this.pendingRead.delete(t),d.forEach(t=>t(h)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Pp().removeDataId(t,this),this.pendingDeletes--),h}readToGPU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.texData.get(t),{values:r,shape:a,slice:i,dtype:o,isPacked:s,texture:c}=n;if("complex64"===o)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){let n;n=s?new qB(a,HB):new jB(a,HB);const r=this.runWebGLProgram(n,[{dataId:t,shape:a,dtype:o}],o),i=this.readToGPU(r,e);return this.disposeIntermediateTensorInfo(r),i}if(null==c)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const l=this.decode(t,e.customTexShape),u=Pp().makeTensorFromTensorInfo(l),h=this.texData.get(l.dataId);return Object.assign({tensorRef:u},h.texture)}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map(t=>Wh(t));return Lf(t.shape,t.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Lf(t.shape,t.dtype,e)}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!NL(n)){if(ac().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:r}=this.texData.get(t),a=Is(e);if(ac().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),r=this.texData.get(n.dataId),i=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...SL(e)).subarray(0,a);return this.disposeIntermediateTensorInfo(n),i}const i=ac().getBool("WEBGL_PACK")&&!0===r,o=i?VL(e):e,s=i?new Iz(o):new Tz(o),c=this.runWebGLProgram(s,[{shape:o,dtype:n,dataId:t}],"float32"),l=this.texData.get(c.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture.texture,l.texShape[0],l.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(c),u}timerAvailable(){return ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const e=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t();const a=Ts(this.activeTimers.map(t=>t.query)).filter(t=>null!=t),i=Ts(this.activeTimers.map(t=>t.name)).filter(t=>null!=t);this.activeTimers=e,r&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(a);o.kernelMs=function(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}(t),o.getExtraProfileInfo=()=>t.map((t,e)=>({name:i[e],ms:t})).map(t=>"".concat(t.name,": ").concat(t.ms)).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Uh(),endMs:null}}endTimer(t){return ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=Uh(),t)}async getQueryTime(t){if(ac().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:n}=this.texData.get(t);return null!=n&&(this.disposeData(n.real.dataId,e),this.disposeData(n.imag.dataId,e)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:e,dtype:n,texShape:r,usage:a,isPacked:i,slice:o}=this.texData.get(t),s=o&&o.origDataId||t,c=this.dataRefCount.get(s);c>1?this.dataRefCount.set(s,c-1):(this.dataRefCount.delete(s),null!=e&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(e,r,a,i)));const l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:QB;return ac().getBool("WEBGL_CPU_FORWARD")&&t.every(t=>null==this.texData.get(t.dataId).texture&&Is(t.shape)<e)}getGPGPUContext(){return this.gpgpu}where(t){mh("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return XB(t.shape,e)}packedUnaryOp(t,e,n){const r=new qB(t.shape,e),a=this.compileAndRun(r,[t],n);return Pp().makeTensorFromTensorInfo(a)}abs(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){const e=yB(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if(ac().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,VB,t.dtype);const e=new jB(t.shape,VB),n=this.compileAndRun(e,[t]);return Pp().makeTensorFromTensorInfo(n)}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&js(n[0])){const a=n.map(t=>Vh(t));r=this.write(a,t,e)}else r=this.write(n,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}makeOutput(t,e,n){return Pp().makeTensorFromTensorInfo(this.makeTensorInfo(t,e,n),this)}unpackTensor(t){const e=new KB(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new MB(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const n=[jL(t.shape),...UL(t.shape)],r={dtype:t.dtype,shape:n,dataId:t.dataId},a=[jL(e),...UL(e)],i=new FB(a,n),o=[n],s=this.runWebGLProgram(i,[r],t.dtype,o,!0);return{dataId:s.dataId,shape:e,dtype:s.dtype}}decode(t,e){const n=this.texData.get(t),{isPacked:r,shape:a,dtype:i}=n;if(null!=e){ks(Is(a)<=e[0]*e[1]*4,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=VL(a);let s;s=r?new Sz(o):new _z(o);const c=[null!=e?e:SL(o)];return{dtype:i,shape:a,dataId:this.runWebGLProgram(s,[{shape:o,dtype:i,dataId:t}],i,c,!0,e).dataId}}runWebGLProgram(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0;const o=this.makeTensorInfo(t.outputShape,n),s=this.texData.get(o.dataId);if(t.packedOutput&&(s.isPacked=!0),t.outPackingScheme===wL.DENSE){const e=null!=i?i:SL(t.outputShape);s.texShape=e.map(t=>2*t)}if(null!=t.outTexUsage&&(s.usage=t.outTexUsage),0===Is(o.shape))return s.values=Fs(o.dtype,0),o;const c=[],l=e.map(e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&Is(e.shape)<=ac().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}if(this.uploadToGPU(e.dataId),!!n.isPacked!==!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),c.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!GL(n.shape,e.shape)){const t=e,r=e.shape;e.shape=n.shape,e=this.packedReshape(e,r),c.push(e),n=this.texData.get(e.dataId),t.shape=r}return{shape:e.shape,texData:n,isUniform:!1}});this.uploadToGPU(o.dataId);const u={shape:o.shape,texData:s,isUniform:!1},h=function(t,e,n){let r="";e.concat(n).forEach(e=>{const a=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!e.isUniform){const i=e.texData.texShape,{useSqueezeShape:o,uniformShape:s,keptDims:c}=gz(t.packedInputs,e.shape,i);let l="",u="",h="";if(1===s.length&&t.packedInputs){const t=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];l="".concat(t[0]>1,"_").concat(t[1]>1)}else if(2!==s.length||t.packedInputs){if(s.length>2&&!t.packedInputs){const t=Hs(s);h="".concat(t[0]===i[1],"_").concat(t[t.length-1]===i[1])}}else u="".concat(s[0]>1,"_").concat(s[1]>1);const d=e.shape.length,f=2===s.length&&Es(e.shape,i),p=1===Is(e.shape),m=sp(e.shape,n.shape),g=!t.packedInputs&&d===n.shape.length&&Es(i,n.texData.texShape),y=t.packedInputs||s.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);r+="".concat(d,"_").concat(g,"_").concat(o?c:"","_").concat(s.length,"_").concat(p,"_").concat(m,"_").concat(f,"_").concat(l,"_").concat(u,"_").concat(h,"_").concat(y,"_").concat(a)}else{const t=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(t,"_").concat(a)}});const a=t.userCode;let i=t.constructor.name;return i+="_"+r+"_"+a+"".concat(ac().getNumber("WEBGL_VERSION")),i}(t,l,u),d=this.getAndSaveBinary(h,()=>bz(this.gpgpu,t,l,u)),f=null!=this.activeTimers;let p;f&&(p=this.startTimer()),ac().get("ENGINE_COMPILE_ONLY")||function(t,e,n,r,a){e.program.enableShapeUniforms||(xz(e.inShapeInfos,n),xz([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),1===ac().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((n,r)=>{const a=e.program.variableNames[r],i=e.uniformLocations[a],o=e.uniformLocations["offset".concat(a)],s=e.inShapesLocations["".concat(a,"Shape")],c=e.inTexShapesLocations["".concat(a,"TexShape")];if(s){const{uniformShape:r}=gz(e.program.packedInputs,n.shape,n.texData.texShape);switch(r.length){case 1:t.gl.uniform1iv(s,new Int32Array(r));break;case 2:t.gl.uniform2iv(s,new Int32Array(r));break;case 3:t.gl.uniform3iv(s,new Int32Array(r));break;case 4:t.gl.uniform4iv(s,new Int32Array(r))}}if(c&&t.gl.uniform2i(c,n.texData.texShape[0],n.texData.texShape[1]),null!=i)if(n.isUniform)if(Is(n.shape)<2)t.gl.uniform1f(i,n.uniformValues[0]);else{let e=n.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(i,e)}else null!=n.texData.slice&&null!=o&&t.gl.uniform1i(o,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture.texture,i,r)});const s=e.outShapeLocation;if(s)switch(r.shape.length){case 1:t.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(s,new Int32Array(r.shape))}if(e.outShapeStridesLocation){const n=Hs(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(n));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(n));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(n))}}e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&a&&e.program.customUniforms.forEach((n,r)=>{const i=e.customUniformLocations[r],o=a[r];if("float"===n.type)t.gl.uniform1fv(i,o);else if("vec2"===n.type)t.gl.uniform2fv(i,o);else if("vec3"===n.type)t.gl.uniform3fv(i,o);else if("vec4"===n.type)t.gl.uniform4fv(i,o);else if("int"===n.type)t.gl.uniform1iv(i,o);else if("ivec2"===n.type)t.gl.uniform2iv(i,o);else if("ivec3"===n.type)t.gl.uniform3iv(i,o);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));t.gl.uniform4iv(i,o)}}),t.executeProgram()}(this.gpgpu,d,l,u,r),c.forEach(t=>this.disposeIntermediateTensorInfo(t)),f&&(p=this.endTimer(p),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(p)}));const m=ac().get("WEBGL_FLUSH_THRESHOLD");if(m>0){const t=Uh();t-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=t)}if(!ac().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===a){const t=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),t}return o}compileAndRun(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||e[0].dtype;return this.runWebGLProgram(t,e,n,r,a)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!ac().getBool("IS_TEST")){Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]})}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=zp(()=>{if(!ac().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=ac().getBool("DEBUG");ac().set("DEBUG",!1);const e=this.abs(Wp(1e-8)).dataSync()[0];if(ac().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:r,values:a,texture:i,usage:o,isPacked:s}=e;if(null!=i)return;const c=null!=this.activeTimers;let l;c&&(l=Uh());let u=e.texShape;if(null==u&&(u=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=ac().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=ac().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&ac().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n*=2,r*=2,1===(t=t.map((e,n)=>n>=t.length-2?ws(t[n]):t[n])).length&&(t=[2,t[0]])),2!==t.length){const e=Ms(t);t=e.newShape}let a=Is(t),i=null;t.length<=1&&a<=n?i=[1,a]:2===t.length&&t[0]<=n&&t[1]<=n?i=t:3===t.length&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:3===t.length&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=null!=i&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(null==i||o)if(e){const e=jL(t);let n=2,r=2;t.length&&([n,r]=UL(t)),a=e*(n/2)*(r/2),i=Cs(a).map(t=>2*t)}else i=Cs(a);return i}(n,s),e.texShape=u),null!=a){const t=VL(n);let i,o=u[1],h=u[0];const d=a instanceof Uint8Array||a instanceof Uint8ClampedArray;!s&&d||([o,h]=TL(u[0],u[1])),i=s?new Nz(t,d):new Ez(t,d);const f=d?[h,o]:u,p=this.makeTensorInfo(f,r),m=this.texData.get(p.dataId);m.usage=d?xL.PIXELS:xL.UPLOAD,m.texShape=f,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(p.dataId),o,h,a);const g=[[h,o]],y=!0,v=this.runWebGLProgram(i,[p],r,g,y),b=this.texData.get(v.dataId);e.texShape=b.texShape,e.isPacked=b.isPacked,e.usage=b.usage,ac().get("ENGINE_COMPILE_ONLY")?this.disposeData(v.dataId):(e.texture=b.texture,e.values=null,this.texData.delete(v.dataId)),this.disposeIntermediateTensorInfo(p),c&&(this.uploadWaitMs+=Uh()-l)}else{const t=this.acquireTexture(u,o,r,s);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:r}=n;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error("Unknown dtype ".concat(e))}(e,r)),n.values}acquireTexture(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(t," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*Bs(e)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,e]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(e));return Promise.all(t)}for(const[,e]of Object.entries(this.binaryCache)){const n=new Promise(t=>{try{this.checkCompletion_(e),t(!0)}catch(n){throw n}});t.push(n)}return Promise.all(t)}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await Tw(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(!1===this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw RL(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const[,t]of Object.entries(this.binaryCache)){const{uniformLocations:e,customUniformLocations:n,infLoc:r,nanLoc:a,inShapesLocations:i,inTexShapesLocations:o,outShapeLocation:s,outShapeStridesLocation:c,outTexShapeLocation:l}=wz(this.gpgpu,t.program,t.webGLProgram);t.uniformLocations=e,t.customUniformLocations=n,t.infLoc=r,t.nanLoc=a,t.inShapesLocations=i,t.inTexShapesLocations=o,t.outShapeLocation=s,t.outShapeStridesLocation=c,t.outTexShapeLocation=l}}}JB.nextDataId=0;Td()&&Up("webgl",()=>new JB,2);const $B="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class ZB{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=lp(e,n),this.enableShapeUniforms=kz(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")}}const tj="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class ej{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=lp(e,n);const a=this.outputShape.length;this.enableShapeUniforms=kz(a);let i="";if(r)if(0===a||1===Is(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const t=mz(a);if(i="\n          ".concat(t," coords = getOutputCoords();\n        "),1===a)this.enableShapeUniforms?i+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":i+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{const t=DB("coords",a);this.enableShapeUniforms?i+="\n            bool nextRowOutOfBounds =\n              (".concat(t[a-2]," + 1) >= outShape[").concat(a," - 2];\n            bool nextColOutOfBounds =\n              (").concat(t[a-1]," + 1) >= outShape[").concat(a," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):i+="\n            bool nextRowOutOfBounds =\n              (".concat(t[a-2]," + 1) >= ").concat(this.outputShape[a-2],";\n            bool nextColOutOfBounds =\n              (").concat(t[a-1]," + 1) >= ").concat(this.outputShape[a-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")}}function nj(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const rj={kernelName:kl,backendName:"webgl",kernelFunc:nj};function aj(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=nj({inputs:{x:r},backend:n}),c=nj({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:c},i}const ij={kernelName:Mc,backendName:"webgl",kernelFunc:aj},oj="return (a < 0.) ? b * a : a;",sj="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const cj={kernelName:Nl,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{alpha:i}=r,o=n.makeTensorInfo([],"float32",Bh(i,"float32")),s=ac().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ej(sj,a.shape,o.shape):new ZB(oj,a.shape,o.shape),c=n.runWebGLProgram(s,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),c}},lj="return (a < 0.) ? b * a : a;",uj="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";const hj={kernelName:lu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r,alpha:a}=e,i=ac().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ej(uj,r.shape,a.shape):new ZB(lj,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}},dj="if (isnan(x)) return x;";function fj(t){let{opSnippet:e,packedOpSnippet:n,cpuKernelImpl:r,dtype:a}=t;return t=>{let{inputs:i,backend:o}=t;const{x:s}=i,c=o,l=a||s.dtype;if(c.shouldExecuteOnCPU([s])&&null!=r){const t=c.texData.get(s.dataId),e=r(t.values,l);return c.makeTensorInfo(s.shape,l,e)}let u;return u=ac().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new qB(s.shape,n):new jB(s.shape,e),c.runWebGLProgram(u,[s],l)}}function pj(t){let{opSnippet:e,packedOpSnippet:n,checkOutOfBounds:r=!1,supportsComplex:a=!1,cpuKernelImpl:i,dtype:o}=t;return t=>{let{inputs:s,backend:c}=t;const{a:l,b:u}=s,h=c;if(a&&"complex64"===l.dtype){const t=h.texData.get(l.dataId),n=h.texData.get(u.dataId),[r,a]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(t=>{const[n,r]=t,a={dataId:n.dataId,dtype:n.dtype,shape:l.shape},i={dataId:r.dataId,dtype:r.dtype,shape:u.shape},o=new ZB(e,l.shape,u.shape);return h.runWebGLProgram(o,[a,i],hd(n.dtype,r.dtype))}),i=aj({inputs:{real:r,imag:a},backend:h});return h.disposeIntermediateTensorInfo(r),h.disposeIntermediateTensorInfo(a),i}const d=o||hd(l.dtype,u.dtype);if(("string"===l.dtype||"string"===u.dtype||h.shouldExecuteOnCPU([l,u]))&&null!=i){const t=h.texData.get(l.dataId).values,e=h.texData.get(u.dataId).values,n="string"===l.dtype?Ax(t):t,r="string"===l.dtype?Ax(e):e,[a,o]=i(l.shape,u.shape,n,r,d),s=h.makeTensorInfo(o,d);return h.texData.get(s.dataId).values=a,s}let f;return f=ac().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new ej(n,l.shape,u.shape,r):new ZB(e,l.shape,u.shape),h.runWebGLProgram(f,[l,u],d)}}function mj(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===t)return"return x;";if("relu"===t)return e?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":WB;if("elu"===t)return e?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===t)return e?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":GB;if("prelu"===t)return e?uj:lj;if("leakyrelu"===t)return e?sj:oj;if("sigmoid"===t)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error("Activation ".concat(t," has not been implemented for the WebGL backend."))}class gj{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=kz(this.outputShape.length);const l=r?t[1]:t[2],u=Math.ceil(l/2),h=r?"i * 2, rc.y":"rc.y, i * 2",d=a?"rc.z, i * 2":"i * 2, rc.z",f=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],p=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",g="";o&&(m=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(o,"\n        }"):c?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(o,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(o,"\n        }"),g="result = activation(result);");const y=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";t[0]<e[0]?v="int(min(float(rc.x), ".concat(t[0]-1,".))"):e[0]<t[0]&&(b="int(min(float(rc.x), ".concat(e[0]-1,".))")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(u,"; i++) {\n          int batchA = ").concat(v,";\n          int batchB = ").concat(b,";\n          vec4 a = getMatrixA(batchA, ").concat(h,");\n          vec4 b = getMatrixB(batchB, ").concat(d,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(f[0]," * ").concat(p[0],");\n          result += (").concat(f[1]," * ").concat(p[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")}}const yj="return areal * breal - aimag * bimag;",vj="return areal * bimag + aimag * breal;";class bj{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=lp(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")}}const wj="return a * b;";function xj(t){const{inputs:e,backend:n}=t,{a:r,b:a}=e,i=hd(r.dtype,a.dtype);if("complex64"===r.dtype){const t=n.texData.get(r.dataId),e=n.texData.get(a.dataId),i=new bj(yj,r.shape,a.shape),o=new bj(vj,r.shape,a.shape),s=[{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:r.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:a.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:a.shape}],c=n.runWebGLProgram(i,s,"float32"),l=n.runWebGLProgram(o,s,"float32"),u=aj({inputs:{real:c,imag:l},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),u}if(n.shouldExecuteOnCPU([r,a])){const t=n.texData.get(r.dataId),e=n.texData.get(a.dataId),[o,s]=sB(r.shape,a.shape,t.values,e.values,i),c=n.makeTensorInfo(s,i);return n.texData.get(c.dataId).values=o,c}let o;return o=ac().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ej(wj,r.shape,a.shape):new ZB(wj,r.shape,a.shape),n.runWebGLProgram(o,[r,a],i)}const kj={kernelName:$l,backendName:"webgl",kernelFunc:xj};function _j(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{shape:i}=r,o=n,s=Is(a.shape),c=Os(i,s),l=Is(c);ks(s===l,()=>"The new shape (".concat(c,") has ").concat(l," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements.");const u=o.texData.get(a.dataId);return!u.isPacked||GL(a.shape,c)||null!==u.texture&&GL(u.shape,c)?(o.incRef(a.dataId),{dataId:a.dataId,shape:c,dtype:a.dtype}):function(t,e,n){const r=[jL(t.shape),...UL(t.shape)],a={dtype:t.dtype,shape:r,dataId:t.dataId},i=[jL(e),...UL(e)],o=new FB(i,r),s=[r],c=n.runWebGLProgram(o,[a],t.dtype,s,!0);return{dataId:c.dataId,shape:e,dtype:c.dtype}}(a,c,o)}const Sj={kernelName:yu,backendName:"webgl",kernelFunc:_j};class Tj{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:a,outSize:i}=t;this.outputShape=[r,i];const o=4*Math.floor(n/4),s=n%4;let c="sumValue += dot(values, ones);";if(null!=e){const t=1/e;c="sumValue += dot(values * ".concat(Ns(t)?t.toPrecision(2):t,", ones);")}let l="";a%n>0&&(l="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(l,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(o,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(c,"\n        }\n\n        int inIdx = inOffset + ").concat(o,";\n        if (").concat(1===s,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(2===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(c,"\n        } else if (").concat(3===s,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(c,"\n        }\n        setOutput(sumValue);\n      }\n    ")}}class Ij{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:a,outSize:i}=t;this.outputShape=[r,i];let o="0.0",s="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",s="min"):"max"===e&&(o="-1.0 / 1e-20",s="max");let c="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?c="sumValue":"prod"===e?c="prodValue":"all"===e?c="allValue":"any"===e&&(c="anyValue");const l=4*Math.floor(n/4),u=n%4;let h="\n      if (".concat("sum"===e,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===e,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n        if (").concat("min"===e," || ").concat("max"===e,") {\n          minMaxValue = ").concat(s,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),d="vec4";"all"===e?(o="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(o="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");let f="";a%n>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(o,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(n,";\n\n        vec4 minMaxValue = vec4(").concat(o,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===u,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")}}function Ej(t,e,n,r){const a=function(t){const e=[];for(;0===e.length||1!==e[e.length-1].outSize;){const n=e.length?e[e.length-1].outSize:t[1],r=Mw(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}(t.shape);let i=t;for(let o=0;o<a.length;o++){const{inSize:s,windowSize:c,outSize:l}=a[o];let u,h;u="mean"===n?0===o?new Tj({windowSize:c,inSize:s,batchSize:t.shape[0],outSize:l},s):new Tj({windowSize:c,inSize:s,batchSize:t.shape[0],outSize:l}):new Ij({windowSize:c,inSize:s,batchSize:t.shape[0],outSize:l},n),h=i,i=r.runWebGLProgram(u,[i],e),h.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(h)}return i}class Nj{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let i=0;i<n.length;i++)n[i]=t[e[i]];this.outputShape=n,this.rank=n.length;const r=mz(this.rank),a=function(t){const e=t.length;if(e>6)throw Error("Transpose for rank ".concat(e," is not yet supported"));const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let a=0;a<t.length;a++)r[t[a]]=n[a];return r.join()}(e);this.userCode="\n    void main() {\n      ".concat(r," resRC = getOutputCoords();\n      setOutput(getA(").concat(a,"));\n    }\n    ")}}class Cj{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let l=0;l<n.length;l++)n[l]=t[e[l]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));const r=mz(this.rank),a=OB("rc",this.rank),i=new Array(this.rank);for(let l=0;l<e.length;l++)i[e[l]]=a[l];const o="vec2(".concat(i.slice(-2).join(),")"),s="++".concat(a[this.rank-1]," < ").concat(n[this.rank-1]),c="getChannel(getA(".concat(i.join(),"), ").concat(o,")");this.userCode="\n    void main() {\n      ".concat(r," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(c,";\n      if(").concat(s,") {\n        result[1] = ").concat(c,";\n      }\n      --").concat(a[this.rank-1],";\n      if(++").concat(a[this.rank-2]," < ").concat(n[this.rank-2],") {\n        result[2] = ").concat(c,";\n        if(").concat(s,") {\n          result[3] = ").concat(c,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}}function Aj(t,e,n){const r=ac().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Cj(t.shape,e):new Nj(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}function Rj(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;return function(t,e,n,r){const a=e,i=t.shape.length,o=Ds(a,t.shape);let s=o;const c=xg(s,i),l=null!=c;let u=t;l&&(u=Aj(t,c,r),s=_g(s.length,i)),wg("sum",s,i);const[h,d]=vg(u.shape,s);let f=h;n&&(f=bg(h,o));const p=Is(d),m=_j({inputs:{x:u},attrs:{shape:[Is(t.shape)/p,p]},backend:r}),g=Ej(m,dd(t.dtype),"sum",r),y=_j({inputs:{x:g},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(g),l&&r.disposeIntermediateTensorInfo(u),y}(a,i,o,n)}const Oj={kernelName:Lu,backendName:"webgl",kernelFunc:Rj};function Dj(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{perm:i}=r,o=n,s=a.shape.length,c=new Array(s);for(let u=0;u<c.length;u++)c[u]=a.shape[i[u]];let l;if(o.shouldExecuteOnCPU([a])){const t=o.texData.get(a.dataId).values,e=AB(t,a.shape,a.dtype,i,c);l=o.makeTensorInfo(c,a.dtype);o.texData.get(l.dataId).values=e}else l=Aj(a,i,o);return l}const Mj={kernelName:ah,backendName:"webgl",kernelFunc:Dj};function Fj(t){let{a:e,b:n,transposeA:r,transposeB:a,backend:i,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:c=0,activation:l=null}=t;const u=e.shape.length,h=n.shape.length,d=r?e.shape[u-2]:e.shape[u-1],f=a?n.shape[h-1]:n.shape[h-2],p=r?e.shape[u-1]:e.shape[u-2],m=a?n.shape[h-2]:n.shape[h-1],g=e.shape.slice(0,-2),y=n.shape.slice(0,-2),v=Is(g),b=Is(y),w=lp(e.shape.slice(0,-2),n.shape.slice(0,-2)).concat([p,m]);ks(d===f,()=>"Error in matMul: inner shapes (".concat(d,") and (")+"".concat(f,") of Tensors with shapes ").concat(e.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match."));const x=r?[v,d,p]:[v,p,d],k=a?[b,m,f]:[b,f,m],_=_j({inputs:{x:e},backend:i,attrs:{shape:x}}),S=_j({inputs:{x:n},backend:i,attrs:{shape:k}}),T=[_,S],I=Math.max(v,b),E=r?_.shape[1]:_.shape[2],N=null!=o,C=null!=s,A="leakyrelu"===l,R=null!=l?mj(l,!0):null;let O;if((1===p||1===m)&&E>1e3&&!1===(N||C||A||null!=R)){let t=_,e=S;r&&(t=Dj({inputs:{x:_},backend:i,attrs:{perm:[0,2,1]}}),T.push(t)),a&&(e=Dj({inputs:{x:S},backend:i,attrs:{perm:[0,2,1]}}),T.push(e));const n=1===m;let o=t;1!==m&&(o=_j({inputs:{x:t},backend:i,attrs:{shape:[I,E,1]}}),T.push(o));const s=1===m?2:1;let c=e;n&&(c=_j({inputs:{x:e},backend:i,attrs:{shape:[I,1,E]}}),T.push(c));const l=xj({inputs:{a:o,b:c},backend:i});O=Rj({inputs:{x:l},backend:i,attrs:{axis:s,keepDims:!0}}),T.push(l)}else{const t=hd(e.dtype,n.dtype),l=new gj(x,k,[I,p,m],r,a,N,R,C,A),u=[_,S];if(null!=o&&u.push(o),C&&u.push(s),A){const t=i.makeTensorInfo([],"float32",Bh(c,"float32"));u.push(t),T.push(t)}O=i.runWebGLProgram(l,u,t)}const D=_j({inputs:{x:O},backend:i,attrs:{shape:w}});T.push(O);for(const M of T)i.disposeIntermediateTensorInfo(M);return D}const Pj={kernelName:dh,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:a,b:i,bias:o,preluActivationWeights:s}=e,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:h}=r;return Fj({a:a,b:i,transposeA:c,transposeB:l,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:h,activation:u})}},Lj="return abs(x);";const zj={kernelName:lc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const t=n.texData.get(r.dataId),e=yB(t.values);return n.makeTensorInfo(r.shape,r.dtype,e)}let a;return a=ac().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new qB(r.shape,Lj):new jB(r.shape,Lj),n.runWebGLProgram(a,[r],r.dtype)}},Bj=fj({opSnippet:UB+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),jj={kernelName:uc,backendName:"webgl",kernelFunc:Bj},Uj=fj({opSnippet:UB+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),Vj={kernelName:hc,backendName:"webgl",kernelFunc:Uj},Wj="return a + b;",Gj=pj({opSnippet:Wj,packedOpSnippet:Wj,supportsComplex:!0,cpuKernelImpl:jz}),Hj={kernelName:dc,backendName:"webgl",kernelFunc:Gj};class qj{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((t,e)=>"T".concat(e));const n=[];this.variableNames.forEach(t=>{n.push("float v".concat(t," = get").concat(t,"AtOutCoords();"))});const r=this.variableNames.map(t=>"v".concat(t)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        float result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}class Kj{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((t,e)=>"T".concat(e));const n=[];this.variableNames.forEach(t=>{n.push("vec4 v".concat(t," = get").concat(t,"AtOutCoords();"))});const r=this.variableNames.map(t=>"v".concat(t)).join(" + ");this.userCode="\n      void main() {\n        ".concat(n.join("\n        "),"\n\n        vec4 result = ").concat(r,";\n        setOutput(result);\n      }\n    ")}}const Xj={kernelName:fc,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,a=n;if(1===a.length)return nj({inputs:{x:a[0]},backend:r});if(a.length>ac().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const e=Math.floor(a.length/2),n=t({inputs:a.slice(0,e),backend:r}),i=t({inputs:a.slice(e),backend:r});return t({inputs:[n,i],backend:r})}const i=a.map(t=>t.dtype).reduce((t,e)=>hd(t,e)),o=a.map(t=>t.shape),s=ac().getBool("WEBGL_PACK")?new Kj(a[0].shape,o):new qj(a[0].shape,o);return r.runWebGLProgram(s,a,i)}};const Yj={kernelName:pc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,c=Ds(i,a.shape);let l=c;const u=xg(l,s);let h=a;null!=u&&(h=Dj({inputs:{x:a},backend:n,attrs:{perm:u}}),l=_g(l.length,s)),wg("all",l,s);const[d,f]=vg(h.shape,l),p=_j({inputs:{x:h},backend:n,attrs:{shape:[-1,Is(f)]}}),m=Ej(p,p.dtype,"all",n);let g;if(o){g=_j({inputs:{x:m},backend:n,attrs:{shape:bg(d,c)}})}else g=_j({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(h),g}};const Qj={kernelName:mc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,c=Ds(i,a.shape);let l=c;const u=xg(l,s);let h=a;null!=u&&(h=Dj({inputs:{x:a},backend:n,attrs:{perm:u}}),l=_g(l.length,s)),wg("any",l,s);const[d,f]=vg(h.shape,l),p=_j({inputs:{x:h},backend:n,attrs:{shape:[-1,Is(f)]}}),m=Ej(p,p.dtype,"any",n);let g;if(o){g=_j({inputs:{x:m},backend:n,attrs:{shape:bg(d,c)}})}else g=_j({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(h),g}};class Jj{constructor(t,e,n){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:i}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];const o="max"===e?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(r,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(o," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}}class $j{constructor(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,ks(t.length>2,()=>"Packed arg".concat(n.charAt(0).toUpperCase()+n.slice(1)," supports only inputs with rank above 2."));const a=t[t.length-1],i=Math.ceil(a/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const o=this.outputShape,s=o.length,c=mz(s),l=DB("coords",s);let u,h;if(1===i){h=s+1;const t=mz(h);u="\n        ".concat(t," sourceLocR = ").concat(t,"(").concat(l.join(),", 0);\n        ++").concat(l[s-1],";\n        ").concat(t," sourceLocG = ").concat(t,"(").concat(l.join(),", 0);\n        ++").concat(l[s-2],";\n        ").concat(t," sourceLocA = ").concat(t,"(").concat(l.join(),", 0);\n        --").concat(l[s-1],";\n        ").concat(t," sourceLocB = ").concat(t,"(").concat(l.join(),", 0);\n        --").concat(l[s-2],";")}else h=s,u="\n        ".concat(c," sourceLocR = coords;\n        ++").concat(l[s-1],";\n        ").concat(c," sourceLocG = coords;\n        ++").concat(l[s-2],";\n        ").concat(c," sourceLocA = coords;\n        --").concat(l[s-1],";\n        ").concat(c," sourceLocB = coords;\n        --").concat(l[s-2],";");const d=["x","y","z","w","u","v"].slice(0,h),f="."+d[h-1],p=d.map(t=>"int "+t),m=DB("sourceLocR",h-1).concat("inIdx.r"),g=DB("sourceLocG",h-1).concat("inIdx.g"),y=DB("sourceLocB",h-1).concat("inIdx.b"),v=DB("sourceLocA",h-1).concat("inIdx.a"),b="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(m.join(),"),\n                             getBestIndicesAChannel(").concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(v.join(),")));"),x="vec4(\n            getAChannel(".concat(m.join(),"),\n            hasNextCol ? getAChannel(").concat(g.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(v.join(),") : 0.)"),k=r?"":"\n      float getBestIndicesAChannel(".concat(p.join(),") {\n        return getChannel(getBestIndicesA(").concat(d.join(),"),\n                                          vec2(").concat(d.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(p.join(),") {\n        return getChannel(getA(").concat(d.join(),"),\n                               vec2(").concat(d.slice(-2).join(),"));\n      }\n      ").concat(k,"\n      void main() {\n        ").concat(c," coords = getOutputCoords();\n        bool hasNextCol = ").concat(l[s-1]," < ").concat(o[s-1]-1,";\n        bool hasNextRow = ").concat(l[s-2]," < ").concat(o[s-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(f,", sourceLocG").concat(f,",\n          sourceLocB").concat(f,", sourceLocA").concat(f,") * ").concat(e,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(x,";\n\n        for (int i = 0; i < ").concat(e,"; i++) {\n          inIdx = srcIdx;\n          ").concat(w,"\n          vec4 candidate = ").concat(x,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(b,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}}function Zj(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=e.shape[0],i=e.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);const o=Mw(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},c=new Jj(s,n,null==r),l=[e];null!=r&&l.push(r);const u=t.runWebGLProgram(c,l,"int32");if(1===u.shape[1])return u;const h=Zj(t,e,n,u);return t.disposeIntermediateTensorInfo(u),h}function tU(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const a=null!=r?r.shape:e.shape,i=Mw(a[a.length-1]),o=new $j(a,i,n,null==r),s=null==r?[e]:[e,r],c=t.runWebGLProgram(o,s,"int32");if(c.shape.length===e.shape.length){const r=tU(t,e,n,c);return t.disposeIntermediateTensorInfo(c),r}return c}function eU(t,e,n,r){const a=[n];if(wg("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,e.shape.length),!ac().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const n=[],i=t.texData.get(e.dataId);let o=e;null!==i&&i.isPacked&&(o=t.unpackTensor(e),n.push(o));const[s,c]=vg(o.shape,a),l=Is(c),u=_j({inputs:{x:o},backend:t,attrs:{shape:[-1,l]}});n.push(u);const h=Zj(t,u,r);n.push(h);const d=_j({inputs:{x:h},backend:t,attrs:{shape:s}});return n.forEach(e=>t.disposeIntermediateTensorInfo(e)),d}return tU(t,e,r)}const nU={kernelName:gc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;let o=Ds(i,a.shape);const s=xg(o,a.shape.length);let c=a;const l=[];null!=s&&(c=Dj({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(c),o=_g(o.length,c.shape.length)),wg("argMax",[o[0]],c.shape.length);const u=eU(n,c,o[0],"max");return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),u}};const rU={kernelName:yc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;let o=Ds(i,a.shape);const s=xg(o,a.shape.length);let c=a;const l=[];null!=s&&(c=Dj({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(c),o=_g(o.length,c.shape.length)),wg("argMin",[o[0]],c.shape.length);const u=eU(n,c,o[0],"min");return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),u}},aU=fj({opSnippet:UB+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),iU={kernelName:vc,backendName:"webgl",kernelFunc:aU},oU=fj({opSnippet:UB+"return log(x + sqrt(x * x + 1.0));"}),sU={kernelName:bc,backendName:"webgl",kernelFunc:oU},cU=fj({opSnippet:UB+"\n  return atan(x);\n"}),lU={kernelName:wc,backendName:"webgl",kernelFunc:cU},uU=pj({opSnippet:$B+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+tj+"\n  return result;\n"}),hU={kernelName:kc,backendName:"webgl",kernelFunc:uU},dU=fj({opSnippet:UB+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),fU={kernelName:xc,backendName:"webgl",kernelFunc:dU};class pU{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,o=t.strideHeight,s=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=t.padInfo.top,f=t.padInfo.left;this.outputShape=t.outShape;const p="avg"===e,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d");let y="0.0";if(p||(y="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(f,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(e," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(r?a?m:g:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let v="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(v="avgValue / count");const b=4*Math.floor(i/4),w=i%4,x="\n      if (".concat(p,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(o,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(f,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(u,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(b,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(x,"\n          }\n\n          int xC = xCCorner + ").concat(b,";\n          if (").concat(1===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(x,"\n          } else if (").concat(2===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(x,"\n          } else if (").concat(3===w,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(x,"\n          }\n        }\n        setOutput(").concat(v,");\n      }\n    ")}}class mU{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,o=t.strideDepth,s=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,u=t.dilationHeight,h=t.dilationWidth,d=t.effectiveFilterDepth,f=t.effectiveFilterHeight,p=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;const v="avg"===e;let b="0.0";if(v||(b="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(o,", ").concat(s,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(f,";\n                wR += ").concat(u,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(p,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(e," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(r?a?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(f," * ").concat(p," +\n                      wR * ").concat(p," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      "))}let w="".concat(e,"(").concat(e,"(").concat(e,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(w="avgValue / count");const x=4*Math.floor(i/4),k=i%4,_="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat("max","(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(o,", ").concat(s,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(x,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(_,"\n            }\n\n            int xC = xCCorner + ").concat(x,";\n            if (").concat(1===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(2===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(_,"\n            } else if (").concat(3===k,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(_,"\n            }\n          }\n          setOutput(").concat(w,");\n        }\n      }\n    ")}}const gU={kernelName:_c,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;JL(a,"avgPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:c}=r;ks(gm(o,1),()=>"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'"));const l=om(a.shape,i,o,1,s,c);if(1===l.filterWidth&&1===l.filterHeight&&Es(l.inShape,l.outShape))return nj({inputs:{x:a},backend:n});const u=new pU(l,"avg",!1);return n.runWebGLProgram(u,[a],"float32")}};const yU={kernelName:Tc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:c,dataFormat:l}=r,u=sm(a.shape,i,o,[1,1,1],s,c,l),h=new mU(u,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}};class vU{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.top,u=c-1-t.padInfo.left,h=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(u,");\n      const float avgMultiplier = float(").concat(h,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(o,") {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class bU{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=u-1-t.padInfo.front,p=h-1-t.padInfo.top,m=d-1-t.padInfo.left,g=1/(e*n*r);this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(p,", ").concat(m,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(u,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(a,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const wU={kernelName:Ic,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i,{filterSize:s,strides:c,pad:l,dimRoundingMode:u}=r,h=sm(o.shape,s,c,[1,1,1],l,u),d=new bU(h);return n.runWebGLProgram(d,[a],o.dtype)}};const xU={kernelName:Sc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i;JL([a,i],"avgPoolGrad");const{filterSize:s,strides:c,pad:l}=r,u=om(o.shape,s,c,1,l),h=new vU(u);return n.runWebGLProgram(h,[a],o.dtype)}};const kU={kernelName:Ec,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:a,b:i}=e,{transposeA:o,transposeB:s}=r;return Fj({a:a,b:i,transposeA:o,transposeB:s,backend:n})}};class _U{constructor(t,e,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],lp(t,e),lp(t,n);let o="0.0";null!=r&&(lp(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let s="1.0";null!=a&&(lp(t,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(o,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(i,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")}}class SU{constructor(t,e,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],lp(t,e),lp(t,n);let o="vec4(0.0)";null!=r&&(lp(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let s="vec4(1.0)";null!=a&&(lp(t,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(o,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(i,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")}}const TU={kernelName:yl,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:a,mean:i,variance:o,offset:s,scale:c}=e;ks(i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),ks(null==s||i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),ks(null==c||i.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=r;null==l&&(l=.001);const u=[a,i,o];let h=null;null!=s&&(h=s.shape,u.push(s));let d=null;null!=c&&(d=c.shape,u.push(c));const f=ac().getBool("WEBGL_PACK_NORMALIZATION")?new SU(a.shape,i.shape,o.shape,h,d,l):new _U(a.shape,i.shape,o.shape,h,d,l);return n.runWebGLProgram(f,u,u[0].dtype)}};class IU{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=mz(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(t){if(1===t)return"sourceLoc";if(t<=6)return EU.slice(0,t).map(t=>"sourceLoc."+t).join(",");throw Error("Slicing for rank ".concat(t," is not yet supported"))}(this.rank);let r;const a=t.map((t,e)=>"sourceLoc.".concat(EU[e]," = start[").concat(e,"] + coords.").concat(EU[e],";"));r="\n        ".concat(e," sourceLoc;\n        ").concat(e," coords = getOutputCoords();\n        ").concat(a.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(n,"));\n      }\n    ")}}const EU=["x","y","z","w","u","v"];class NU{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=mz(this.rank),n=DB("coords",this.rank),r=DB("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2(".concat(r.slice(-2).join(),")"),i="getChannel(getSource(".concat(r.join(),"), ").concat(a,")"),o="\n      result.x = ".concat(i,";\n      if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(r[this.rank-1],";\n        result.y = ").concat(i,";\n        --").concat(r[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(n[this.rank-1],";\n      if (++").concat(n[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(r[this.rank-2],";\n        result.z = ").concat(i,";\n        if (++").concat(n[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(r[this.rank-1],";\n          result.w = ").concat(i,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(e,"(").concat(t.map((t,e)=>"start[".concat(e,"]")).join(),");"):t.map((t,e)=>"".concat(r[e]," = ").concat(n[e]," + start[").concat(e,"];")).join("\n");this.userCode="\n      void main() {\n        ".concat(e," coords = getOutputCoords();\n        ").concat(e," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(o,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")}}function CU(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,size:o}=r,[s,c]=Ap(a,i,o);if(gp(a,s,c),0===Is(c))return n.makeTensorInfo(c,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){const t=n.texData.get(a.dataId),e=vB(t.values,s,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,e)}const{isPacked:l}=n.texData.get(a.dataId),u=Np(a.shape,s,c);if(l||!u){const t=ac().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new NU(c):new IU(c),e=[s];return n.runWebGLProgram(t,[a],a.dtype,e)}return n.uploadToGPU(a.dataId),function(t,e,n,r){const a=r.texData.get(t.dataId),i=r.makeTensorInfo(n,t.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=t.dtype;let s=Cp(e,Hs(t.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||t.dataId};const c=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,c+1),i}(a,s,c,n)}const AU={kernelName:Au,backendName:"webgl",kernelFunc:CU},RU={kernelName:Nc,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,crops:o}=r;ks(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const s=i.reduce((t,e)=>t*e),c=Pw(a.shape,i,s),l=Lw(c.length,i.length),u=zw(a.shape,i,s),h=Bw(o,i.length),d=jw(u,o,i.length),f=[],p=_j({inputs:{x:a},backend:n,attrs:{shape:c}}),m=Dj({inputs:{x:p},backend:n,attrs:{perm:l}}),g=_j({inputs:{x:m},backend:n,attrs:{shape:u}}),y=CU({inputs:{x:g},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(m),f.push(g),f.forEach(t=>n.disposeIntermediateTensorInfo(t)),y}};const OU={kernelName:Cc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o}=r,s=n.readSync(a.dataId),c=n.readSync(i.dataId),l=Uz(s,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}};const DU={kernelName:Ac,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e,i=n.readSync(r.dataId),o=n.readSync(a.dataId),s=lp(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}},MU=pj({opSnippet:"return float(a != b);",cpuKernelImpl:lB,dtype:"bool"}),FU={kernelName:tu,backendName:"webgl",kernelFunc:MU};function PU(t){const{inputs:e,backend:n}=t,{input:r}=e;return nj({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const LU={kernelName:pu,backendName:"webgl",kernelFunc:PU};const zU={kernelName:Rc,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r,attrs:a}=e,{x:i}=n,{dtype:o}=a;if("complex64"===o){if("complex64"===i.dtype)return nj({inputs:{x:i},backend:r});const e=yy(i.shape),n=t({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),a=aj({inputs:{real:n,imag:e},backend:r});return e.dispose(),r.disposeIntermediateTensorInfo(n),a}if("complex64"===i.dtype){const e=PU({inputs:{input:i},backend:r}),n=t({inputs:{x:e},backend:r,attrs:{dtype:o}});return r.disposeIntermediateTensorInfo(e),n}if(!Ls(i.dtype,o)){const t=nj({inputs:{x:i},backend:r});return{dataId:t.dataId,shape:t.shape,dtype:o}}if(r.shouldExecuteOnCPU([i])){const t=r.texData.get(i.dataId).values,[e,n,a]=Wz(t,i.shape,i.dtype,o);return r.makeTensorInfo(e,n,a)}if("int32"===o)return function(t,e){const n=new jB(t.shape,"return float(int(x));"),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===o){const t=r.makeTensorInfo([],"bool",Fs("bool",1)),e=MU({inputs:{a:i,b:t},backend:r});return r.disposeIntermediateTensorInfo(t),e}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(o))}},BU="return ceil(x);",jU=fj({opSnippet:BU,packedOpSnippet:BU,cpuKernelImpl:Gz}),UU={kernelName:Oc,backendName:"webgl",kernelFunc:jU};class VU{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class WU{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const GU={kernelName:Dc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{clipValueMin:i,clipValueMax:o}=r;let s;s=ac().getBool("WEBGL_PACK_CLIP")?new WU(a.shape):new VU(a.shape);const c=[[i],[o]];return n.runWebGLProgram(s,[a],a.dtype,c)}};class HU{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function qU(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}const KU={kernelName:Fc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,a=n.texData.get(r.dataId),i=new HU(r.shape),o=[qU(r,a.complexTensorInfos.real),qU(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}};class XU{constructor(t){this.outputShape=[],this.outputShape=Ew(t,1),this.variableNames=t.map((t,e)=>"T".concat(e));const e=new Array(t.length-1);e[0]=t[0][1];for(let i=1;i<e.length;i++)e[i]=e[i-1]+t[i][1];const n=["if (yC < ".concat(e[0],") setOutput(getT0(yR, yC));")];for(let i=1;i<e.length;i++){const t=e[i-1];n.push("else if (yC < ".concat(e[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(t,"));"))}const r=e.length,a=e[e.length-1];n.push("else setOutput(getT".concat(r,"(yR, yC-").concat(a,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(n.join("\n        "),"\n      }\n    ")}}class YU{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ew(t,e);const n=this.outputShape,r=n.length,a=mz(r),i=DB("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((t,e)=>"T".concat(e));const s=new Array(t.length-1);s[0]=t[0][e];for(let p=1;p<s.length;p++)s[p]=s[p-1]+t[p][e];const c=o[e],l=o.slice(-2),u=o.join();let h="if (".concat(c," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(u,"), vec2(").concat(l.join(),"));\n        }");for(let p=1;p<s.length;p++){const t=s[p-1];h+="\n        if (".concat(c," < ").concat(s[p],"  && ").concat(c," >= ").concat(s[p-1],") {\n          return getChannel(\n            getT").concat(p,"(").concat(QU(o,c,t),"),\n            vec2(").concat(QU(l,c,t),"));\n        }")}const d=s.length,f=s[s.length-1];h+="\n        return getChannel(\n          getT".concat(d,"(").concat(QU(o,c,f),"),\n          vec2(").concat(QU(l,c,f),"));"),this.userCode="\n      float getValue(".concat(o.map(t=>"int "+t),") {\n        ").concat(h,"\n      }\n\n      void main() {\n        ").concat(a," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(i,"), 0., 0., 0.);\n\n        ").concat(i[r-1]," = ").concat(i[r-1]," + 1;\n        if (").concat(i[r-1]," < ").concat(n[r-1],") {\n          result.g = getValue(").concat(i,");\n        }\n\n        ").concat(i[r-2]," = ").concat(i[r-2]," + 1;\n        if (").concat(i[r-2]," < ").concat(n[r-2],") {\n          result.a = getValue(").concat(i,");\n        }\n\n        ").concat(i[r-1]," = ").concat(i[r-1]," - 1;\n        if (").concat(i[r-2]," < ").concat(n[r-2]," &&\n            ").concat(i[r-1]," < ").concat(n[r-1],") {\n          result.b = getValue(").concat(i,");\n        }\n        setOutput(result);\n      }\n    ")}}function QU(t,e,n){const r=t.indexOf(e);return t.map((t,e)=>e===r?"".concat(t," - ").concat(n):t).join()}function JU(t){const{inputs:e,backend:n}=t,{input:r}=e;return nj({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}const $U={kernelName:Sl,backendName:"webgl",kernelFunc:JU};function ZU(t,e,n){const r=t[0].dtype;if("complex64"===r){const r=t.map(t=>PU({inputs:{input:t},backend:n})),a=t.map(t=>JU({inputs:{input:t},backend:n})),i=ZU(r,e,n),o=ZU(a,e,n),s=aj({inputs:{real:i,imag:o},backend:n});return r.forEach(t=>n.disposeIntermediateTensorInfo(t)),a.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),s}let a=n.shouldExecuteOnCPU(t);if("string"===r&&(a=!0),a){const a=t.map(t=>{const r=Is(t.shape.slice(e));return _j({inputs:{x:t},backend:n,attrs:{shape:[-1,r]}})}),i=a.map(t=>({vals:n.readSync(t.dataId),shape:t.shape})),o=Ew(a.map(t=>t.shape),1),s=1===a[0].shape[0],c=Hz(i,o,r,s),l=Ew(t.map(t=>t.shape),e),u=n.makeTensorInfo(l,r,c);return a.forEach(t=>n.disposeIntermediateTensorInfo(t)),u}const i=ac().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(t.length>i){const r=[];for(let o=0;o<t.length;o+=i){const a=t.slice(o,o+i);r.push(ZU(a,e,n))}const a=ZU(r,e,n);for(const t of r)n.disposeIntermediateTensorInfo(t);return a}if(ac().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){const a=new YU(t.map(t=>t.shape),e);return n.runWebGLProgram(a,t,r)}const{tensors2D:o,outShape:s}=function(t,e,n){const r=Ew(t.map(t=>t.shape),e),a=t.map(t=>_j({inputs:{x:t},attrs:{shape:[-1,Is(t.shape.slice(e))]},backend:n}));return{tensors2D:a,outShape:r}}(t,e,n),c=new XU(o.map(t=>t.shape)),l=n.runWebGLProgram(c,o,r);o.forEach(t=>n.disposeIntermediateTensorInfo(t));const u=_j({inputs:{x:l},attrs:{shape:s},backend:n});return n.disposeIntermediateTensorInfo(l),u}function tV(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r,i=Ds(a,e[0].shape)[0];Iw(e.map(t=>t.shape),i);const o=Ew(e.map(t=>t.shape),i);if(0===Is(o))return n.makeTensorInfo(o,e[0].dtype,[]);const s=e.filter(t=>Is(t.shape)>0);return 1===s.length?nj({inputs:{x:s[0]},backend:n}):ZU(s,i,n)}const eV={kernelName:Pc,backendName:"webgl",kernelFunc:tV};class nV{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.outputShape=t.outShape;const i=t.padInfo.top,o=t.padInfo.left,s=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,u=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4,m="channelsLast"===t.dataFormat,g=m?1:2,y=m?2:3,v=m?3:1;let b="",w="";n&&(b=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),w="result = activation(result);");const x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(v,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(g,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(d,"; wC++) {\n            int xC = xCCorner + wC * ").concat(u,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===p,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(f,") *\n                    getW(wR, wC, ").concat(f,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(f,", xR, xC) *\n                    getW(wR, wC, ").concat(f,", d2);\n              }\n\n            } else if (").concat(2===p,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===p,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(f,", d2),\n                getW(wR, wC, ").concat(f," + 1, d2),\n                getW(wR, wC, ").concat(f," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(f,"),\n                  getX(batch, xR, xC, ").concat(f," + 1),\n                  getX(batch, xR, xC, ").concat(f," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(f,", xR, xC),\n                  getX(batch, ").concat(f," + 1, xR, xC),\n                  getX(batch, ").concat(f," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(x,"\n        ").concat(w,"\n        setOutput(result);\n      }\n    ")}}class rV{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,u=t.filterDepth,h=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(a,", ").concat(i,", ").concat(o,");\n      const ivec3 pads = ivec3(").concat(e,", ").concat(n,", ").concat(r,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(u,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(f,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===p,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(f,") *\n                  getW(wF, wR, wC, ").concat(f,", d2);\n              } else if (").concat(2===p,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===p,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(f,"),\n                  getX(batch, xF, xR, xC, ").concat(f," + 1),\n                  getX(batch, xF, xR, xC, ").concat(f," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(f,", d2),\n                  getW(wF, wR, wC, ").concat(f," + 1, d2),\n                  getW(wF, wR, wC, ").concat(f," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class aV{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=kz(this.outputShape.length);const i=t.padInfo.left,o=t.strideWidth,s=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,u=l;let h="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let m=0;m<l;m++)h+="\n           vec4 xTexelC".concat(2*m,";\n           int xTexelC").concat(2*m,"Ready;\n           vec4 xTexelC").concat(2*m+1,";\n           int xTexelC").concat(2*m+1,"Ready;\n           vec4 xC").concat(m,";");h+="\n     for (int r = 0; r < ".concat(c,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       ");for(let m=0;m<l;m++)h+="\n           xTexelC".concat(2*m," = vec4(0.0);\n           xTexelC").concat(2*m,"Ready = 0;\n           xTexelC").concat(2*m+1," = vec4(0.0);\n           xTexelC").concat(2*m+1,"Ready = 0;\n           xC").concat(m," = vec4(0.0);");h+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let m=0;m<(u+1)/2;m++){const e=2*m;if(h+="\n           xC = xCCorner + ".concat(e*s,";\n           "),1===o){if(e<l&&(i%2===1?(h+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n               "),h+=1===s&&e>0?"\n                 xC".concat(e," = vec4(xTexelC").concat(e-2,".zw, xTexelC").concat(e,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(e," = vec4(previous.zw, xTexelC").concat(e,".xy);\n                   } else {\n                     xC").concat(e," = vec4(0.0, 0.0, xTexelC").concat(e,".xy);\n                   }\n                   ")):h+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 xC").concat(e," = xTexelC").concat(e,";\n                 "),e+1<l)){const t=i%2===0?ws(s):s;s%2===0&&i%2===1||s%2!==0&&i%2!==1?(h+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(t,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                     xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(e+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(e+1,"Ready = 1;\n                   }\n                   "),h+=s>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(e+1," = vec4(previous.zw, xTexelC").concat(e+1,".xy);\n                     } else {\n                      xC").concat(e+1," = vec4(0.0, 0.0, xTexelC").concat(e+1,".xy);\n                     }\n                     "):"\n                     xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".xy);\n                     ")):h+=1===t?"\n                     xC".concat(e+1," = xTexelC").concat(e,";\n                     "):"\n                     xCOffset = xC + ".concat(t,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                       xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(e+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(e+1,"Ready = 1;\n                     }\n\n                     xC").concat(e+1," = xTexelC").concat(e+1,";\n                     ")}}else e<l&&(i%2===1?(h+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                   xTexelC").concat(e+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(e+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e+1,"Ready = 1;\n                 }\n\n                 xC").concat(e," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n               "),e+1<l&&(h+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(e+1," = vec4(xTexelC").concat(e+1,".xy, final.xy);\n                 "))):(h+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(e,"Ready == 0) {\n                   xTexelC").concat(e," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(e,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(e,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(e+1,"Ready == 0) {\n                   xTexelC").concat(e+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(e+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(e+1,"Ready = 1;\n                 }\n\n                 xC").concat(e," = vec4(\n                   xTexelC").concat(e,".xy, xTexelC").concat(e+1,".xy);\n               "),e+1<l&&(h+="\n                   xC".concat(e+1," = vec4(xTexelC").concat(e,".zw, xTexelC").concat(e+1,".zw);\n                 "))));e<l&&(h+="\n             wTexel = getW(r, ".concat(e,", d1, d2);\n             dotProd += xC").concat(e,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(e,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),e+1<l&&(h+="\n               wTexel = getW(r, ".concat(e+1,", d1, d2);\n               dotProd += xC").concat(e+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(e+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}h+="\n     }\n   ",h+="\n     }\n   ",h+="\n     }\n   ";let d="",f="";n&&(d=r?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(n,"\n         }"):a?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(n,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(n,"\n         }"),f="result = activation(result);");const p=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(d,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(h,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(p,"\n         ").concat(f,"\n         setOutput(result);\n       }\n     ")}}class iV{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=kz(this.outputShape.length);const{dataFormat:n}=e,r=ZL(),a="channelsLast"===n,i=a?1:2,o=a?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {");let c="";for(let l=0;l<=1;l++)for(let t=0;t<=1;t++)c+="\n          blockIndex = rc.z + ".concat(t,";\n          pos = rc.y + ").concat(l,";\n\n          ").concat(s,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(i,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(o,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(a,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*l+t,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*l+t,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(c,"\n\n        ").concat(r.output," = result;\n      }\n    ")}}function oV(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&1===n&&t[0]>1?[t[0],1]:null}function sV(t){let{x:e,filter:n,convInfo:r,backend:a,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:c=null}=t;const l=e.shape,u=a.texData.get(e.dataId),h=r.inChannels,d=l[0]*l[1]*l[2],f=r.outChannels,p="channelsLast"===r.dataFormat,m=!1;let g;const y=[];if(null!=o){const t=oV(o.shape,p);null!=t&&(o=_j({inputs:{x:o},backend:a,attrs:{shape:t}}),y.push(o))}if(null!=i){const t=oV(i.shape,p);null!=t&&(i=_j({inputs:{x:i},backend:a,attrs:{shape:t}}),y.push(i))}if(!((1===d||1===f)&&h>1e3)&&u.isPacked&&p&&null!=u.texture&&l[2]%2!==0&&Es(u.shape.slice(-3),l.slice(-3))){const t=l[0]*l[1]*(l[2]+1),h={dataId:e.dataId,shape:[1,t,r.inChannels],dtype:e.dtype},d=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,ks(GL(u.shape,h.shape),()=>"packed reshape ".concat(u.shape," to ").concat(h.shape," isn't free"));const f=_j({inputs:{x:n},backend:a,attrs:{shape:[1,r.inChannels,r.outChannels]}});y.push(f);const p=Fj({a:h,b:f,backend:a,transposeA:false,transposeB:m,bias:i,activation:c,preluActivationWeights:o,leakyreluAlpha:s}),v=a.texData.get(p.dataId);ks(v.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=d,v.shape=r.outShape,g=nj({inputs:{x:p},backend:a}),g.shape=r.outShape,y.push(p)}else{const t=r.outHeight*r.outWidth,l=_j({inputs:{x:e},backend:a,attrs:{shape:p?[r.batchSize,t,r.inChannels]:[r.batchSize,r.inChannels,t]}}),u=_j({inputs:{x:n},backend:a,attrs:{shape:[1,r.inChannels,r.outChannels]}}),h=Fj({a:p?l:u,b:p?u:l,transposeA:!p,transposeB:m,backend:a,bias:i,activation:c,preluActivationWeights:o,leakyreluAlpha:s});g=_j({inputs:{x:h},backend:a,attrs:{shape:r.outShape}}),y.push(l),y.push(u),y.push(h)}for(const v of y)a.disposeIntermediateTensorInfo(v);return g}function cV(t){let{x:e,filter:n,convInfo:r,backend:a,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:c=null}=t;const{filterWidth:l,filterHeight:u,inChannels:h,outWidth:d,outHeight:f,dataFormat:p}=r,m="channelsLast"===p,g=l*u*h,y=f*d,v=[r.batchSize,g,y],b=[];if(null!=o){const t=oV(o.shape,m);null!=t&&(o=_j({inputs:{x:o},backend:a,attrs:{shape:t}}),b.push(o))}if(null!=i){const t=oV(i.shape,m);null!=t&&(i=_j({inputs:{x:i},backend:a,attrs:{shape:t}}),b.push(i))}const w=_j({inputs:{x:n},backend:a,attrs:{shape:[1,g,Is(n.shape)/g]}});b.push(w);const x=new iV(v,r),k=[e.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],_=a.runWebGLProgram(x,[e],"float32",k),S=_j({inputs:{x:_},backend:a,attrs:{shape:v}});b.push(_),b.push(S);const T=null!=i,I=null!=o,E="leakyrelu"===c,N=c?mj(c,!0):null,C=new gj(m?S.shape:w.shape,m?w.shape:S.shape,m?[r.batchSize,y,r.outChannels]:[r.batchSize,r.outChannels,y],!0,!1,T,N,I,E),A=m?[S,w]:[w,S];if(i&&A.push(i),I&&A.push(o),E){const t=a.makeTensorInfo([],"float32",Bh(s,"float32"));A.push(t),b.push(t)}const R=a.runWebGLProgram(C,A,"float32"),O=_j({inputs:{x:R},backend:a,attrs:{shape:r.outShape}});b.push(R);for(const D of b)a.disposeIntermediateTensorInfo(D);return O}const lV={kernelName:Lc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dataFormat:c,dilations:l,dimRoundingMode:u}=r,h=ym(c),d=cm(a.shape,i.shape,o,l,s,u,!1,h);let f;if(1!==d.filterHeight||1!==d.filterWidth||1!==d.dilationHeight||1!==d.dilationWidth||1!==d.strideHeight||1!==d.strideWidth||"SAME"!==d.padInfo.type&&"VALID"!==d.padInfo.type)if(d.strideWidth<=2&&"channelsLast"===h&&ac().getBool("WEBGL_EXP_CONV")){const t=new aV(d),e=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=n.runWebGLProgram(t,[a,i],"float32",e)}else if(ac().getBool("WEBGL_CONV_IM2COL"))f=cV({x:a,filter:i,convInfo:d,backend:n});else{const t=new nV(d);f=n.runWebGLProgram(t,[a,i],"float32")}else f=sV({x:a,filter:i,convInfo:d,backend:n});const p=_j({inputs:{x:f},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(f),p}};class uV{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(a,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(i,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class hV{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,s=n-1-t.padInfo.left,c=i?1:2,l=i?2:3,u=i?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(u,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class dV{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,a=t.padInfo.front,i=t.padInfo.top,o=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(e," - ").concat(a,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(n," - ").concat(i,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(r," - ").concat(o,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class fV{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.front,c=n-1-t.padInfo.top,l=r-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(e,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(a,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(e," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(n,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(n," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(r,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(r," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const pV={kernelName:zc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,dataFormat:c,dimRoundingMode:l,filterShape:u}=r,h=ym(c),d=cm(a.shape,u,o,1,s,l,!1,h),f=new uV(d);return n.runWebGLProgram(f,[a,i],"float32")}};const mV={kernelName:Bc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{inputShape:o,strides:s,pad:c,dataFormat:l,dimRoundingMode:u}=r,h=ym(l),d=cm(o,i.shape,s,1,c,u,!1,h),f=new hV(d);return n.runWebGLProgram(f,[a,i],"float32")}};const gV={kernelName:jc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:c}=r,l=lm(a.shape,i.shape,o,c,s),u=new rV(l);return n.runWebGLProgram(u,[a,i],"float32")}};const yV={kernelName:Uc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,filterShape:c}=r,l=lm(a.shape,c,o,1,s),u=new dV(l);return n.runWebGLProgram(u,[a,i],"float32")}};const vV={kernelName:Vc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{pad:o,strides:s,inputShape:c}=r,l=lm(c,i.shape,s,1,o),u=new fV(l);return n.runWebGLProgram(u,[a,i],"float32")}},bV=fj({opSnippet:dj+"\n  return cos(x);\n"}),wV={kernelName:Wc,backendName:"webgl",kernelFunc:bV},xV=fj({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),kV={kernelName:Gc,backendName:"webgl",kernelFunc:xV};class _V{constructor(t,e,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,o,s,c]=t,[l]=e,[u,h]=n;this.outputShape=[l,u,h,c];const d="bilinear"===r?1:0,[f,p]=["".concat(o-1,".0"),"".concat(s-1,".0")],[m,g,y]=u>1?["".concat((o-1)/(u-1)),"(y2-y1) * height_ratio","y1*".concat(f," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(f)],[v,b,w]=h>1?["".concat((s-1)/(h-1)),"(x2-x1) * width_ratio","x1*".concat(p," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(p)];this.userCode="\n      const float height_ratio = float(".concat(m,");\n      const float width_ratio = float(").concat(v,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(i,") {\n          return;\n        }\n\n        float height_scale = ").concat(g,";\n        float width_scale = ").concat(b,";\n\n        float in_y = ").concat(y,";\n        if( in_y < 0.0 || in_y > ").concat(f," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n        float in_x = ").concat(w,";\n        if( in_x < 0.0 || in_x > ").concat(p," ) {\n          setOutput(float(").concat(a,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(d," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")}}const SV={kernelName:Kc,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:i,boxInd:o}=e,{cropSize:s,method:c,extrapolationValue:l}=r,u=new _V(a.shape,i.shape,s,c,l);return n.runWebGLProgram(u,[a,i,o],"float32")}};var TV;!function(t){t.Prod="*",t.Sum="+"}(TV||(TV={}));class IV{constructor(t,e,n,r){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,i=this.op===TV.Prod?"1.0":"0.0",o=n?i:"getX(".concat(EV(a,"coords",this.op),")"),s=this.outputShape[this.outputShape.length-1];let c="",l="";n?(c=r?"end != ".concat(s-1):"end != 0",l=r?"end + 1":"end - 1"):(c=r?"end + pow2 < ".concat(s):"end >= pow2",l=r?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(mz(a)," coords = getOutputCoords();\n        int end = ").concat(NV(a,"coords",this.op),";\n        float val = ").concat(o,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(c,") {\n          int idx = ").concat(l,";\n          ").concat(NV(a,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(EV(a,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}}function EV(t,e,n){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".x, ").concat(e,".y");if(3===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z");if(4===t)return"".concat(e,".x, ").concat(e,".y, ").concat(e,".z, ").concat(e,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(t," is not yet supported"))}function NV(t,e,n){if(1===t)return"".concat(e);if(2===t)return"".concat(e,".y");if(3===t)return"".concat(e,".z");if(4===t)return"".concat(e,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(t," is not yet supported"))}function CV(t,e,n,r,a,i){const o=e.shape.length,s=xg([r],o);let c=e;null!=s&&(c=Dj({inputs:{x:e},backend:n,attrs:{perm:s}}));const l=_g(1,o)[0];if(l!==o-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(e.shape.length-1," ")+"but got axis=".concat(r));const u=c.shape[l];let h=nj({inputs:{x:c},backend:n});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){const e=new IV(t,c.shape,!1,i),r=[[d]],a=h;h=n.runWebGLProgram(e,[h],h.dtype,r),n.disposeIntermediateTensorInfo(a)}if(a){const e=new IV(t,c.shape,a,i),r=h;h=n.runWebGLProgram(e,[h],h.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=s){const t=Dj({inputs:{x:h},backend:n,attrs:{perm:kg(s)}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(c),t}return h}const AV={kernelName:Hc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;return CV(TV.Prod,a,n,i,o,s)}};const RV={kernelName:qc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;return CV(TV.Sum,a,n,i,o,s)}};const OV={kernelName:Xc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o,binaryOutput:s}=r;if(1===a.shape.length){const t=n.readSync(a.dataId),e=n.readSync(i.dataId),r=Uz(t,e,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,r)}if(2===a.shape.length){const t=n.bufferSync(a),e=n.bufferSync(i),r=Vz(t,e,o,s);return n.makeTensorInfo(r.shape,i.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};class DV{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(e,";\n      int offset_h = imod(h, ").concat(e,");\n      int in_w = w / ").concat(e,";\n      int offset_w = imod(w, ").concat(e,");\n      int offset_d = (offset_h * ").concat(e," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const MV={kernelName:Yc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:i,dataFormat:o}=r,s=a.shape[0],c=("NHWC"===o?a.shape[1]:a.shape[2])*i,l=("NHWC"===o?a.shape[2]:a.shape[3])*i,u=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),h=new DV("NHWC"===o?[s,c,l,u]:[s,u,c,l],i,o);return n.runWebGLProgram(h,[a],a.dtype)}};class FV{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=kz(this.outputShape.length);const i=t.filterHeight,o=t.filterWidth,s=t.outChannels/t.inChannels;let c="",l="";n&&(c=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"\n          float activation(float x) {\n            ".concat(n,"\n          }\n        "),l="result = activation(result);");const u=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(c,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(s,";\n        int q = d2 - d1 * ").concat(s,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(i,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(u,"\n        ").concat(l,"\n        setOutput(result);\n      }\n    ")}}class PV{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=kz(this.outputShape.length);const i=t.outChannels/t.inChannels,o=t.padInfo.left,s=t.strideWidth,c=t.dilationWidth,l=t.filterHeight,u=t.filterWidth,h=u;let d="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let g=0;g<u;g++)d+="\n          vec4 xTexelC".concat(2*g,";\n          int xTexelC").concat(2*g,"Ready;\n          vec4 xTexelC").concat(2*g+1,";\n          int xTexelC").concat(2*g+1,"Ready;\n          vec4 xC").concat(g,";");d+="\n    for (int r = 0; r < ".concat(l,"; r++) {\n      ");for(let g=0;g<u;g++)d+="\n          xTexelC".concat(2*g," = vec4(0.0);\n          xTexelC").concat(2*g,"Ready = 0;\n          xTexelC").concat(2*g+1," = vec4(0.0);\n          xTexelC").concat(2*g+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");d+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let g=0;g<(h+1)/2;g++){const t=2*g;if(d+="\n          xC = xCCorner + ".concat(t*c,";\n          "),1===s){if(t<u&&(o%2===1?(d+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n              "),d+=1===c&&t>0?"\n                xC".concat(t," = vec4(xTexelC").concat(t-2,".zw, xTexelC").concat(t,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(t," = vec4(previous.zw, xTexelC").concat(t,".xy);\n                  } else {\n                    xC").concat(t," = vec4(0.0, 0.0, xTexelC").concat(t,".xy);\n                  }\n                  ")):d+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                xC").concat(t," = xTexelC").concat(t,";\n                "),t+1<u)){const e=o%2===0?ws(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(d+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(e,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                    xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(t+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(t+1,"Ready = 1;\n                  }\n                  "),d+=c>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(t+1," = vec4(previous.zw, xTexelC").concat(t+1,".xy);\n                    } else {\n                     xC").concat(t+1," = vec4(0.0, 0.0, xTexelC").concat(t+1,".xy);\n                    }\n                    "):"\n                    xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".xy);\n                    ")):d+=1===e?"\n                    xC".concat(t+1," = xTexelC").concat(t,";\n                    "):"\n                    xCOffset = xC + ".concat(e,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                      xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(t+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(t+1,"Ready = 1;\n                    }\n\n                    xC").concat(t+1," = xTexelC").concat(t+1,";\n                    ")}}else t<u&&(o%2===1?(d+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                  xTexelC").concat(t+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(t+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t+1,"Ready = 1;\n                }\n\n                xC").concat(t," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n              "),t+1<u&&(d+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(t+1," = vec4(xTexelC").concat(t+1,".xy, final.xy);\n                "))):(d+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(t,"Ready == 0) {\n                  xTexelC").concat(t," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(t,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(t,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(t+1,"Ready == 0) {\n                  xTexelC").concat(t+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(t+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(t+1,"Ready = 1;\n                }\n\n                xC").concat(t," = vec4(\n                  xTexelC").concat(t,".xy, xTexelC").concat(t+1,".xy);\n              "),t+1<u&&(d+="\n                  xC".concat(t+1," = vec4(xTexelC").concat(t,".zw, xTexelC").concat(t+1,".zw);\n                "))));t<u&&(d+="\n            wTexel = getW(r, ".concat(t,", d1, q);\n            dotProd += xC").concat(t," * vec4(wTexel.xz, wTexel.xz);\n          "),t+1<u&&(d+="\n              wTexel = getW(r, ".concat(t+1,", d1, q);\n              dotProd += xC").concat(t+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}d+="\n    }\n  ",d+="\n      }\n    ";let f="",p="";n&&(f=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(n,"\n        }"):a?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(n,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(n,"\n        }"),p="result = activation(result);");const m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(f,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(i,";\n        int q = d2 - d1 * ").concat(i,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(d,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(m,"\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")}}const LV={kernelName:Qc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:c,dimRoundingMode:l}=r;let u=c;null==u&&(u=[1,1]),ks(gm(o,u),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(u,"'"));const h=cm(a.shape,i.shape,o,u,s,l,!0);let d;d=ac().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new PV(h):new FV(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[a,i],"float32",f)}};class zV{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(i," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(e," - ").concat(r,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(n," - ").concat(a,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class BV{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=e-1-t.padInfo.top,o=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(e,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(e," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(n,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(n," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const jV={kernelName:Jc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,dilations:s,pad:c,dimRoundingMode:l,filterShape:u}=r,h=cm(a.shape,u,o,s,c,l,!0),d=new zV(h);return n.runWebGLProgram(d,[a,i],"float32")}};const UV={kernelName:$c,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{strides:o,dilations:s,pad:c,dimRoundingMode:l,inputShape:u}=r,h=cm(u,i.shape,o,s,c,l,!0),d=new BV(h);return n.runWebGLProgram(d,[a,i],"float32")}};class VV{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const WV={kernelName:Zc,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,a=[...r.shape,...r.shape],i=Is(r.shape),o=_j({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new VV(i),c=n.runWebGLProgram(s,[o],o.dtype),l=_j({inputs:{x:c},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),l}};class GV{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:n,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:o,filterWidth:s,dilationHeight:c,dilationWidth:l}=t,{top:u,left:h}=r;this.userCode="\n      const ivec2 strides = ivec2(".concat(a,", ").concat(i,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(h,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(o,"; h++) {\n          int hIn = hBeg + h * ").concat(c,";\n\n          if (hIn >= 0 && hIn < ").concat(e,") {\n            for (int w = 0; w < ").concat(s,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(n,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}}const HV={kernelName:tl,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:c}=r,l=im(a.shape,i.shape,o,s,"NHWC",c);let u;const h=new GV(l);u=n.runWebGLProgram(h,[a,i],"float32");const d=_j({inputs:{x:u},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(u),d}};const qV={kernelName:al,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{equation:a}=r,i=e,{allDims:o,summedDims:s,idDims:c}=cx(a,i.length);ux(o.length,c,i);const{path:l,steps:u}=hx(s,c),h=u.length;let d=null,f=o.length;const p=[];for(let m=0;m<h;++m){for(const t of u[m]){const{permutationIndices:e,expandDims:r}=lx(f,c[t]);let a;dx(e)?a=i[t]:(a=Dj({inputs:{x:i[t]},backend:n,attrs:{perm:e}}),p.push(a));const o=a.shape.slice();for(let t=0;t<r.length;++t)o.splice(r[t],0,1);Es(a.shape,o)||(a=_j({inputs:{x:a},backend:n,attrs:{shape:o}}),p.push(a)),null===d?d=a:(d=xj({inputs:{a:a,b:d},backend:n}),p.push(d))}m<h-1&&(l[m]>=0&&(d=Rj({inputs:{x:d},backend:n,attrs:{axis:l[m]-(o.length-f),keepDims:!1}}),p.push(d)),f--)}for(const m of p)m!==d&&n.disposeIntermediateTensorInfo(m);return d}},KV=fj({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),XV={kernelName:il,backendName:"webgl",kernelFunc:KV},YV={kernelName:ol,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n}=t,{dy:r,y:a}=e,i=ac().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ej("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new ZB("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},QV=pj({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:qz}),JV={kernelName:cl,backendName:"webgl",kernelFunc:QV},$V=fj({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(Gw,";\n  float a1 = ").concat(Hw,";\n  float a2 = ").concat(qw,";\n  float a3 = ").concat(Kw,";\n  float a4 = ").concat(Xw,";\n  float a5 = ").concat(Yw,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),ZV={kernelName:sl,backendName:"webgl",kernelFunc:$V},tW=fj({opSnippet:dj+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:Kz,dtype:"float32"}),eW={kernelName:ll,backendName:"webgl",kernelFunc:tW};function nW(t){const{inputs:e,attrs:n,backend:r}=t,{dim:a}=n,{input:i}=e,o=i.shape.length,s=i.shape.slice();let c=a;return a<0&&(ks(-(o+1)<=a,()=>"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")),c=o+a+1),s.splice(c,0,1),_j({inputs:{x:i},backend:r,attrs:{shape:s}})}const rW={kernelName:ul,backendName:"webgl",kernelFunc:nW},aW="return exp(x) - 1.0;",iW=fj({opSnippet:aW,packedOpSnippet:aW,cpuKernelImpl:Xz}),oW={kernelName:hl,backendName:"webgl",kernelFunc:iW};class sW{constructor(t,e,n){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const a=n?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),i=n?"".concat(r,".0"):"1.0";let o;if("real"===t)o="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));o="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(a,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(o,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(r,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(r,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(i,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}}function cW(t,e,n){const r=n.texData.get(t.dataId),a=Is(t.shape),i=t.shape[t.shape.length-1],o=_j({inputs:{x:t},backend:n,attrs:{shape:[a/i,i]}}),s=o.shape,c=new sW("real",s,e),l=new sW("imag",s,e),u=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:s},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:s}],h=n.runWebGLProgram(c,u,"float32"),d=n.runWebGLProgram(l,u,"float32"),f=aj({inputs:{real:h,imag:d},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d);const p=_j({inputs:{x:f},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(f),p}const lW={kernelName:dl,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return cW(r,!1,n)}};class uW{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function hW(t){const{backend:e,attrs:n}=t,{shape:r,value:a}=n;let{dtype:i}=n;if(i=i||Vs(a),"string"===i){const t=Ps(i,Is(r));return t.fill(a),e.makeTensorInfo(r,i,t)}{const t=new uW(r,a),n=[[a]];return e.runWebGLProgram(t,[],i,n)}}const dW={kernelName:fl,backendName:"webgl",kernelFunc:hW};class fW{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(e," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(e,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const pW={kernelName:pl,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n}=t;const{image:r}=e,a=n,i=new fW(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},mW="return floor(x);",gW=fj({opSnippet:mW,packedOpSnippet:mW,cpuKernelImpl:Yz}),yW={kernelName:ml,backendName:"webgl",kernelFunc:gW},vW=pj({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),bW={kernelName:gl,backendName:"webgl",kernelFunc:vW};class wW{constructor(t){this.variableNames=["A"];const e=ZL(),[n,r]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(r,".0, ").concat(n,".0);\n\n        vec4 values = ").concat(e.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")}}class xW{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=ZL(),[n,r]=t;this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(r,".0, ").concat(n,".0);\n            vec4 values = ").concat(e.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(e.output," = result;\n      }\n    ")}}const kW={kernelName:uh,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:a}=e;const{numChannels:i}=r,o="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,[c,l]=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],u=[l,c],h=[l,c,i];if(s||o){const t=ac().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=_W&&t===SW||(SW=t,_W=document.createElement("canvas").getContext("2d",{willReadFrequently:SW})),_W.canvas.width=c,_W.canvas.height=l,_W.drawImage(a,0,0,c,l),a=_W.canvas}const d=n.makeTensorInfo(u,"int32");n.texData.get(d.dataId).usage=xL.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),a);const f=ac().getBool("WEBGL_PACK")?new xW(h):new wW(h),p=n.runWebGLProgram(f,[d],"int32");return n.disposeData(d.dataId),p}};let _W,SW=ac().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const TW={kernelName:fh,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:c,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r,m=ym(u),g=cm(a.shape,i.shape,c,h,l,d,!1,m);let y;const v=[],b=null!=o,w=null!=s,x="leakyrelu"===f,k=()=>{const t=[a,i],e=(t,e)=>{if("NCHW"===e&&1===t.shape.length&&1!==t.shape[0]){const e=_j({inputs:{x:t},backend:n,attrs:{shape:[t.shape[0],1,1]}});return v.push(e),e}return t};if(b&&t.push(e(o,u)),w&&t.push(e(s,u)),x){const e=n.makeTensorInfo([],"float32",Bh(p,"float32"));t.push(e),v.push(e)}return t};if(1!==g.filterHeight||1!==g.filterWidth||1!==g.dilationHeight||1!==g.dilationWidth||1!==g.strideHeight||1!==g.strideWidth||"SAME"!==g.padInfo.type&&"VALID"!==g.padInfo.type)if(g.strideWidth<=2&&"channelsLast"===m&&ac().getBool("WEBGL_EXP_CONV")){const t=f?mj(f,!0):null,e=new aV(g,b,t,w,x),r=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],a=k();y=n.runWebGLProgram(e,a,"float32",r)}else if(ac().getBool("WEBGL_CONV_IM2COL"))y=cV({x:a,filter:i,convInfo:g,backend:n,bias:o,activation:f,preluActivationWeights:s,leakyreluAlpha:p});else{const t=f?mj(f,!1):null,e=new nV(g,b,t,w,x),r=k();y=n.runWebGLProgram(e,r,"float32")}else y=sV({x:a,filter:i,convInfo:g,backend:n,bias:o,activation:f,preluActivationWeights:s,leakyreluAlpha:p});const _=_j({inputs:{x:y},backend:n,attrs:{shape:g.outShape}});return v.push(y),v.forEach(t=>n.disposeIntermediateTensorInfo(t)),_}};const IW={kernelName:ph,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:c,pad:l,dilations:u,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=r,p=[];let m=u;null==m&&(m=[1,1]),ks(gm(c,m),()=>"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(c," and dilations '").concat(m,"'"));const g=cm(a.shape,i.shape,c,m,l,h,!0),y=ac().getBool("WEBGL_PACK_DEPTHWISECONV")&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,v=d?mj(d,y):null,b=[a,i],w=null!=o,x=null!=s,k="leakyrelu"===d;if(w&&b.push(o),x&&b.push(s),k){const t=n.makeTensorInfo([],"float32",Bh(f,"float32"));b.push(t),p.push(t)}let _;_=y?new PV(g,w,v,x,k):new FV(g,w,v,x,k);const S=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],T=n.runWebGLProgram(_,b,"float32",S);return p.forEach(t=>n.disposeIntermediateTensorInfo(t)),T}};class EW{constructor(t,e,n,r){this.sliceDim=t,this.strides=e,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const a=mz(n.length);let i="\n    int index;";for(let o=0;o<this.sliceDim;o++)i+="\n          index = round(getIndices(coords[0], ".concat(o,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[o],";\n          flattenIndex += index * ").concat(this.strides[o],";");this.userCode="\n         void main() {\n          ".concat(a," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(i,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}}const NW={kernelName:bl,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:r,indices:a}=e,i=a.shape,o=i[i.length-1],s=Is(r.shape),[c,l,u,h]=Uw(r,a),d=_j({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),f=_j({inputs:{x:r},backend:n,attrs:{shape:[Is(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){const t=n.readSync(a.dataId),e=n.bufferSync(r),i=Qz(t,e,r.dtype,l,o,u,h,r.shape,s);return n.makeTensorInfo(c,r.dtype,i.values)}const p=new EW(o,h,[l,u],r.shape),m=n.runWebGLProgram(p,[f,d],f.dtype),g=_j({inputs:{x:m},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}};class CW{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const n=mz(this.rank),r=function(t){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let r=0;r<t.length;r++)2===r?n.push("index"):n.push("".concat(e[r]));return n.join()}(t);this.userCode="\n      void main() {\n        ".concat(n," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(r,"));\n      }\n    ")}}function AW(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,indices:i}=e,{axis:o,batchDims:s}=r,c=Ds(o,a.shape)[0];if(ac().get("DEBUG")){const t=n.readSync(i.dataId),e=a.shape[c];for(let n=0;n<t.length;++n){const r=t[n];ks(r<=e-1&&r>=0,()=>"GatherV2: the index value ".concat(r," is not in [0, ").concat(e-1,"]"))}}const l=Cx(a,i,c,s),u=Is(i.shape),h=[],d=_j({inputs:{x:a},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),f=_j({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,u/l.batchSize]}});h.push(d),h.push(f);const p=[l.batchSize,l.outerSize,u/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){const t=n.bufferSync(f),e=n.bufferSync(d),r=Jz(e,t,p);return h.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(l.outputShape,r.dtype,r.values)}const m=new CW(d.shape,p),g=n.runWebGLProgram(m,[d,f],d.dtype);h.push(g);const y=_j({inputs:{x:g},backend:n,attrs:{shape:l.outputShape}});return h.forEach(t=>n.disposeIntermediateTensorInfo(t)),y}const RW={kernelName:vl,backendName:"webgl",kernelFunc:AW},OW=pj({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:$z,dtype:"bool"}),DW={kernelName:wl,backendName:"webgl",kernelFunc:OW},MW=pj({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:Zz}),FW={kernelName:xl,backendName:"webgl",kernelFunc:MW};const PW={kernelName:_l,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e;return cW(r,!0,n)}},LW=fj({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),zW={kernelName:Tl,backendName:"webgl",kernelFunc:LW},BW=fj({opSnippet:"return float(isinf(x));",dtype:"bool"}),jW={kernelName:Il,backendName:"webgl",kernelFunc:BW},UW=fj({opSnippet:"return float(isnan(x));",dtype:"bool"}),VW={kernelName:El,backendName:"webgl",kernelFunc:UW},WW=pj({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:tB,dtype:"bool"}),GW={kernelName:Cl,backendName:"webgl",kernelFunc:WW},HW=pj({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:eB,dtype:"bool"}),qW={kernelName:Al,backendName:"webgl",kernelFunc:HW};const KW={kernelName:Rl,backendName:"webgl",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:i}=n,o=nB(r,a,i);return e.makeTensorInfo([o.length],"float32",o)}},XW=fj({opSnippet:dj+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:rB}),YW={kernelName:Ol,backendName:"webgl",kernelFunc:XW},QW=fj({opSnippet:dj+"\n  return log(1.0 + x);\n"}),JW={kernelName:Dl,backendName:"webgl",kernelFunc:QW},$W=pj({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),ZW={kernelName:Ml,backendName:"webgl",kernelFunc:$W},tG=fj({opSnippet:"return float(!(x >= 1.0));"}),eG={kernelName:Fl,backendName:"webgl",kernelFunc:tG},nG=pj({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),rG={kernelName:Pl,backendName:"webgl",kernelFunc:nG};class aG{constructor(t,e,n,r,a){this.variableNames=["x"],this.outputShape=[];const i=e,o=t[3]-1;let s;this.outputShape=t;const c="float(".concat(n,") + float(").concat(r,") * sum");s=.5===a?"inversesqrt(".concat(c,")"):1===a?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(i,"; j <= ").concat(i,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(o,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(s,";\n        setOutput(val);\n      }\n    ")}}class iG{constructor(t,e,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=e,o=t[3]-1;let s;this.outputShape=t;const c="float(".concat(n,") + float(").concat(r,") * sum");s=.5===a?"inversesqrt(".concat(c,")"):1===a?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(a,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(i,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(i,"; j <= ").concat(i,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(o,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(s,";\n        setOutput(result);\n      }\n    ")}}const oG={kernelName:Ll,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{depthRadius:i,bias:o,alpha:s,beta:c}=r,l=ac().getBool("WEBGL_PACK_NORMALIZATION")?new iG(a.shape,i,o,s,c):new aG(a.shape,i,o,s,c);return n.runWebGLProgram(l,[a],a.dtype)}};class sG{constructor(t,e,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(e,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(e," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(r,") * norm + float(").concat(n,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(r,")\n                * float(").concat(a,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(a,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")}}const cG={kernelName:zl,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a,y:i,dy:o}=e,{depthRadius:s,bias:c,alpha:l,beta:u}=r,h=new sG(a.shape,s,c,l,u);return n.runWebGLProgram(h,[a,i,o],a.dtype)}};function lG(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reductionIndices:i,keepDims:o}=r,s=a.shape.length,c=Ds(i,a.shape);let l=c;const u=xg(l,s),h=null!=u,d=n.shouldExecuteOnCPU([a]);let f=a;if(h){if(d){const t=n.texData.get(f.dataId).values,e=new Array(s);for(let n=0;n<e.length;n++)e[n]=a.shape[u[n]];const r=AB(t,a.shape,a.dtype,u,e);f=n.makeTensorInfo(e,a.dtype);n.texData.get(f.dataId).values=r}else f=Aj(a,u,n);l=_g(l.length,s)}wg("max",l,s);const[p,m]=vg(f.shape,l);let g,y=p;if(o&&(y=bg(p,c)),d){const t=n.texData.get(f.dataId).values,e=aB(t,Is(m),y,a.dtype);g=n.makeTensorInfo(y,a.dtype);n.texData.get(g.dataId).values=e}else g=function(t,e,n,r){const a=Is(e),i=_j({inputs:{x:t},attrs:{shape:[Is(t.shape)/a,a]},backend:r}),o=Ej(i,t.dtype,"max",r),s=_j({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(f,m,y,n);return h&&n.disposeIntermediateTensorInfo(f),g}const uG={kernelName:Bl,backendName:"webgl",kernelFunc:lG},hG=pj({opSnippet:$B+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+tj+"\n  return result;\n",cpuKernelImpl:iB}),dG={kernelName:jl,backendName:"webgl",kernelFunc:hG};const fG={kernelName:Ul,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;JL(a,"maxPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:c}=r;ks(gm(o,1),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'"));const l=om(a.shape,i,o,1,s,c);if(1===l.filterWidth&&1===l.filterHeight&&Es(l.inShape,l.outShape))return nj({inputs:{x:a},backend:n});const u=new pU(l,"max",!1);return n.runWebGLProgram(u,[a],a.dtype)}};const pG={kernelName:Wl,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dataFormat:c,dimRoundingMode:l}=r,u=sm(a.shape,i,o,[1,1,1],s,l,c),h=new mU(u,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}};class mG{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,a=t.effectiveFilterHeight,i=t.effectiveFilterWidth,o=a-1-t.padInfo.top,s=i-1-t.padInfo.left,c=a*i-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(a,";\n          wR += ").concat(r,") {\n          float dyR = float(dyRCorner + wR) / ").concat(e,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(n,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(i," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}class gG{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,a=t.dilationDepth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterDepth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,u=s-1-t.padInfo.front,h=c-1-t.padInfo.top,d=l-1-t.padInfo.left,f=s*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(u,", ").concat(h,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(a,") {\n          float dyD = float(dyDCorner + wD) / ").concat(e,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(i,") {\n            float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(o,") {\n              float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(f," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}}const yG={kernelName:Gl,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i,{filterSize:s,strides:c,pad:l,dimRoundingMode:u}=r,h=sm(o.shape,s,c,[1,1,1],l,u),d=new mU(h,"max",!0),f=n.runWebGLProgram(d,[o],o.dtype),p=new gG(h),m=n.runWebGLProgram(p,[a,f],o.dtype);return n.disposeIntermediateTensorInfo(f),m}};const vG={kernelName:Vl,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i,output:o}=e,s=i;JL([i,o],"maxPoolGrad");const{filterSize:c,strides:l,pad:u,dimRoundingMode:h}=r,d=om(s.shape,c,l,1,u,h),f=new pU(d,"max",!0),p=n.runWebGLProgram(f,[s],s.dtype),m=new mG(d),g=n.runWebGLProgram(m,[a,p],s.dtype);return n.disposeIntermediateTensorInfo(p),g}};const bG={kernelName:Hl,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{x:a}=e,{filterSize:i,strides:o,pad:s,includeBatchInIndex:c}=n,l=r;ks(4===a.shape.length,()=>"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,"."));const u=[1,1];ks(gm(o,u),()=>"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(u,"'"));const h=om(a.shape,i,o,u,s),[d,f]=function(t,e,n,r){let a=new pU(n,"max",!1);const i=r.runWebGLProgram(a,[t],"float32");return a=new pU(n,"max",!0,!0,e),[i,r.runWebGLProgram(a,[t],"float32")]}(a,c,h,l);return[d,f]}};const wG={kernelName:ql,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{x:a}=e,{keepDims:i,axis:o}=n,s=r,c=a.shape.length,l=Ds(o,a.shape);let u=l;const h=xg(u,c),d=null!=h,f=s.shouldExecuteOnCPU([a]),p=[];let m=a;if(d){if(f){const t=s.texData.get(m.dataId).values,e=new Array(c);for(let r=0;r<e.length;r++)e[r]=a.shape[h[r]];const n=AB(t,a.shape,a.dtype,h,e);m=s.makeTensorInfo(e,a.dtype);s.texData.get(m.dataId).values=n}else m=Aj(a,h,s);p.push(m),u=_g(u.length,c)}wg("sum",u,c);const[g,y]=vg(m.shape,u);let v=g;i&&(v=bg(g,l));const b=function(t,e,n,r){const a=Is(e),i=_j({inputs:{x:t},attrs:{shape:[Is(t.shape)/a,a]},backend:r}),o=Ej(i,"float32","mean",r),s=_j({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}(m,y,v,s);for(const w of p)s.disposeIntermediateTensorInfo(w);return b}};const xG={kernelName:Kl,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,c=Ds(i,a.shape);let l=c;const u=xg(l,s);let h=a;null!=u&&(h=Dj({inputs:{x:a},backend:n,attrs:{perm:u}}),l=_g(l.length,a.shape.length)),wg("min",l,s);const[d,f]=vg(h.shape,l),p=_j({inputs:{x:h},backend:n,attrs:{shape:[-1,Is(f)]}}),m=Ej(p,p.dtype,"min",n);let g;if(o){g=_j({inputs:{x:m},backend:n,attrs:{shape:bg(d,c)}})}else g=_j({inputs:{x:m},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),null!=u&&n.disposeIntermediateTensorInfo(h),g}},kG=pj({opSnippet:$B+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+tj+"\n  return result;\n",cpuKernelImpl:oB}),_G={kernelName:Xl,backendName:"webgl",kernelFunc:kG};class SG{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,a=mz(r),i=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c="reflect"===n?0:1;this.userCode=1!==r?"\n      ".concat(a," start = ").concat(a,"(").concat(i,");\n      ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(r,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(c,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(c,";\n          }\n        }\n        ").concat(a," coords = outC - start;\n        setOutput(getX(").concat(s,"));\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(c,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(c,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")}}class TG{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,a=mz(r),i=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=DB("rc",r),c=DB("source",r),l="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),u=1===r?"source":"vec2(".concat(c.slice(-2).join(),")"),h="reflect"===n?0:1;let d="";if(1===r){const t="\n        ".concat(a," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(h,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(h,";\n        }\n        source -= start;\n      ");d="\n        ".concat(a," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(l,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n      ")}else{const t="\n        ".concat(a," source = rc;\n        ").concat(a," lt = ").concat(a,"(lessThan(source, start));\n        ").concat(a," gte = ").concat(a,"(greaterThanEqual(source, end));\n        ").concat(a," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(h,") +\n                gte * ((end - 1) * 2 - source + ").concat(h,");\n        source -= start;\n      ");d="\n        ".concat(a," rc = outputLoc;\n        ").concat(t,"\n        result[0] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        ").concat(s[r-1]," += 1;\n        if(").concat(l,") {\n          ").concat(t,"\n          result[1] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n        rc = outputLoc;\n        ").concat(s[r-2]," += 1;\n        if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {\n          ").concat(t,"\n          result[2] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n          ").concat(s[r-1]," += 1;\n          if(").concat(l,") {\n            ").concat(t,"\n            result[3] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(i,");\n      const ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(d,"\n        setOutput(result);\n      }\n    ")}}const IG={kernelName:Yl,backendName:"webgl",kernelFunc:t=>{let{inputs:e,backend:n,attrs:r}=t;const{x:a}=e,{paddings:i,mode:o}=r,s=ac().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TG(a.shape,i,o):new SG(a.shape,i,o);return n.runWebGLProgram(s,[a],a.dtype)}},EG=pj({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+tj+"\n  return result;\n"}),NG={kernelName:Ql,backendName:"webgl",kernelFunc:EG};class CG{constructor(t,e,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(e-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(e-1,"));\n      }\n    ")}}const AG=pj({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),RG={kernelName:rl,backendName:"webgl",kernelFunc:AG},OG="return a - b;",DG=pj({opSnippet:OG,packedOpSnippet:OG,supportsComplex:!0,cpuKernelImpl:EB}),MG={kernelName:$u,backendName:"webgl",kernelFunc:DG};function FG(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{dim:i}=r,o=Ds([i],a.shape),s=lG({inputs:{x:a},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),c=bg(s.shape,o),l=_j({inputs:{x:s},backend:n,attrs:{shape:c}}),u=DG({inputs:{a:a,b:l},backend:n}),h=tW({inputs:{x:u},backend:n}),d=Rj({inputs:{x:h},backend:n,attrs:{axis:o,keepDims:!1}}),f=_j({inputs:{x:d},backend:n,attrs:{shape:c}}),p=AG({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}const PG={kernelName:ju,backendName:"webgl",kernelFunc:FG};const LG={kernelName:Jl,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{numSamples:i,seed:o,normalized:s}=r,c=s?a:FG({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),l=c.shape[0],u=c.shape[1],h=new CG(l,u,i),d=[[o]],f=n.runWebGLProgram(h,[c],"int32",d);return s||n.disposeIntermediateTensorInfo(c),f}},zG=UB+"\n  return -x;\n";const BG={kernelName:Zl,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const t=n.texData.get(r.dataId),[e,a]=cB(t.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,e)}let a;return a=ac().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new qB(r.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new jB(r.shape,zG),n.runWebGLProgram(a,[r],r.dtype)}},jG=Tb;const UG={kernelName:eu,backendName:"webgl",kernelFunc:function(t){mh("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c}=r,l=n.readSync(a.dataId),u=n.readSync(i.dataId),{selectedIndices:h}=jG(l,u,o,s,c);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},VG=Ib;const WG={kernelName:nu,backendName:"webgl",kernelFunc:function(t){mh("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c,padToMaxOutputSize:l}=r,u=n.readSync(a.dataId),h=n.readSync(i.dataId),{selectedIndices:d,validOutputs:f}=VG(u,h,o,s,c,l);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}},GG=Eb;const HG={kernelName:ru,backendName:"webgl",kernelFunc:function(t){mh("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c,softNmsSigma:l}=r,u=n.readSync(a.dataId),h=n.readSync(i.dataId),d=o,f=s,p=c,m=l,{selectedIndices:g,selectedScores:y}=GG(u,h,d,f,p,m);return[n.makeTensorInfo([g.length],"int32",new Int32Array(g)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}};class qG{constructor(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(r,"), float(").concat(n,"),\n                      float(index == coords.y)));\n      }\n    ")}}const KG={kernelName:iu,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:a}=e,{dtype:i,depth:o,onValue:s,offValue:c}=r,l=Is(a.shape),u=new qG(l,o,s,c),h=_j({inputs:{x:a},backend:n,attrs:{shape:[l]}}),d=n.runWebGLProgram(u,[h],i);n.disposeIntermediateTensorInfo(h);const f=_j({inputs:{x:d},backend:n,attrs:{shape:[...a.shape,o]}});return n.disposeIntermediateTensorInfo(d),f}};function XG(t){const{inputs:e,backend:n}=t,{x:r}=e;if("complex64"===r.dtype){const t=PU({inputs:{input:r},backend:n}),e=XG({inputs:{x:t},backend:n}),a=JU({inputs:{input:r},backend:n}),i=XG({inputs:{x:a},backend:n}),o=aj({inputs:{real:e,imag:i},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}return hW({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const YG={kernelName:ch,backendName:"webgl",kernelFunc:XG};const QG={kernelName:au,backendName:"webgl",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:a}=n;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){const e=PU({inputs:{input:a},backend:r}),n=t({inputs:{x:e},backend:r}),i=JU({inputs:{input:a},backend:r}),o=XG({inputs:{x:i},backend:r}),s=aj({inputs:{real:n,imag:o},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),s}return hW({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};const JG={kernelName:ou,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(1===e.length)return nW({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const i=e[0].shape,o=e[0].dtype;e.forEach(t=>{_s(i,t.shape,"All tensors passed to stack must have matching shapes"),ks(o===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],c=tV({inputs:e.map(t=>{const e=nW({inputs:{input:t},backend:n,attrs:{dim:a}});return s.push(e),e}),backend:n,attrs:{axis:a}});return s.forEach(t=>n.disposeIntermediateTensorInfo(t)),c}};class $G{constructor(t,e,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,a=mz(r),i=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      ".concat(a," start = ").concat(a,"(").concat(i,");\n      ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(a," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(o,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}}class ZG{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,a=mz(r),i=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=DB("rc",r),c=DB("source",r),l="".concat(s[r-1]," < ").concat(this.outputShape[r-1]),u=1===r?"source":"vec2(".concat(c.slice(-2).join(),")"),h=["".concat(a," rc = outputLoc;"),"".concat(s[r-1]," += 1;\n       if(").concat(l,") {\n      "),1===r?"":"}\n       rc = outputLoc;\n       ".concat(s[r-2]," += 1;\n       if(").concat(s[r-2]," < ").concat(this.outputShape[r-2],") {"),1===r?"":"  ".concat(s[r-1]," += 1;\n         if(").concat(l,") {")],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let f="";for(let p=0,m=1===r?2:4;p<m;p++)f+="\n        ".concat(h[p],"\n        if (").concat(d,") {\n          result[").concat(p,"] = float(value);\n        } else {\n          ").concat(a," source = rc - start;\n          result[").concat(p,"] = getChannel(getX(").concat(c.join(),"), ").concat(u,");\n        }\n      ");f+=1===r?"} ":"}}",this.userCode="\n      const ".concat(a," start = ").concat(a,"(").concat(i,");\n      const ").concat(a," end = ").concat(a,"(").concat(o,");\n\n      void main() {\n        ").concat(a," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")}}const tH=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:i,constantValue:o}=r;if(0===Is(a.shape)){const t=i.map((t,e)=>t[0]+a.shape[e]+t[1]);return hW({backend:n,attrs:{shape:t,value:o,dtype:a.dtype}})}const s=ac().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ZG(a.shape,i,o):new $G(a.shape,i,o),c=[[o]];return n.runWebGLProgram(s,[a],a.dtype,c)},eH={kernelName:su,backendName:"webgl",kernelFunc:tH},nH=pj({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+tj+"\n  return result;\n"}),rH={kernelName:cu,backendName:"webgl",kernelFunc:nH};const aH={kernelName:uu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,c=[],l=Ds(i,a.shape);let u=l;const h=xg(u,s);let d,f=a;if(null!=h&&(f=Dj({inputs:{x:a},backend:n,attrs:{perm:h}}),u=_g(u.length,s),c.push(f)),wg("prod",u,s),n.shouldExecuteOnCPU([f])){const t=n.texData.get(f.dataId).values,{outVals:e,outShape:r,outDtype:a}=uB(f.shape,f.dtype,t,u);d=n.makeTensorInfo(r,a,e)}else{const[t,e]=vg(f.shape,u),r=Is(e),i=_j({inputs:{x:f},backend:n,attrs:{shape:[-1,r]}}),o=Ej(i,dd(a.dtype),"prod",n);d=_j({inputs:{x:o},backend:n,attrs:{shape:t}}),c.push(i),c.push(o)}if(o){c.push(d);const t=bg(d.shape,l);d=_j({inputs:{x:d},backend:n,attrs:{shape:t}})}return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),d}};const iH={kernelName:hu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:s}=r,c=a.map(t=>n.readSync(t.dataId)),l=a.map(t=>t.shape),u=n.readSync(i.dataId),h=n.readSync(o.dataId),[d,f,p]=hB(c,l,u,i.shape,i.dtype,h,o.shape,s),m=d.map(t=>n.makeTensorInfo([t.length],"int32",t)),g=n.makeTensorInfo(p,i.dtype,f);return m.concat([g])}};const oH={kernelName:du,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=e,{rowPartitionTypes:c}=r,l=n.readSync(a.dataId),u=n.readSync(i.dataId),h=n.readSync(o.dataId),d=s.map(t=>n.readSync(t.dataId)),f=s.map(t=>t.shape),[p,m]=dB(l,a.shape,u,i.shape,i.dtype,h,o.shape,d,f,c);return n.makeTensorInfo(p,i.dtype,m)}},sH=t=>{const{backend:e,attrs:n}=t,{start:r,stop:a,step:i,dtype:o}=n,s=fB(r,a,i,o);return e.makeTensorInfo([s.length],o,s)},cH={kernelName:fu,backendName:"webgl",kernelFunc:sH},lH=fj({opSnippet:"return 1.0 / x;"}),uH={kernelName:mu,backendName:"webgl",kernelFunc:lH},hH=fj({opSnippet:UB+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),dH={kernelName:gu,backendName:"webgl",kernelFunc:hH},fH=fj({opSnippet:UB+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),pH={kernelName:ku,backendName:"webgl",kernelFunc:fH};class mH{constructor(t,e,n,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,s,c]=t;this.outputShape=[i,e,n,c];const l=[r&&e>1?o-1:o,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=a?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")}}class gH{constructor(t,e,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,s,c]=t;this.outputShape=[i,e,n,c];const l=[r&&e>1?o-1:o,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];let h;h=a?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],",\n          ").concat(l[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}}const yH={kernelName:wu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r,[c,l]=s,u=ac().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new gH(a.shape,c,l,i,o):new mH(a.shape,c,l,i,o);return n.runWebGLProgram(u,[a],"float32")}};class vH{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,a]=e,[,i,o]=t,s=[n&&i>1?r-1:r,n&&o>1?a-1:a],c=[n&&i>1?i-1:i,n&&o>1?o-1:o],l=s[0]/c[0],u=s[1]/c[1],h=1/l,d=1/u,f=2*Math.ceil(h)+2,p=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(l,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(f,");\n        const int winWidth = int(").concat(p,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(r-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(a-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const bH={kernelName:xu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r,s=new vH(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}};class wH{constructor(t,e,n,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,s,c]=t;this.outputShape=[i,e,n,c];const l=[r&&e>1?o-1:o,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=a?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],");\n      const vec2 inputShapeRC = vec2(").concat(o,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")}}class xH{constructor(t,e,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,s,c]=t;this.outputShape=[i,e,n,c];const l=[r&&e>1?o-1:o,r&&n>1?s-1:s],u=[r&&e>1?e-1:e,r&&n>1?n-1:n],h=r?"0.5":"0.0";let d;d=a?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(l[0]/u[0],",\n          ").concat(l[1]/u[1],",\n          ").concat(l[1]/u[1],");\n      const vec3 inputShapeRC = vec3(").concat(o,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(d,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(n-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}}const kH={kernelName:vu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r,[c,l]=s,u=ac().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new xH(a.shape,c,l,i,o):new wH(a.shape,c,l,i,o);return n.runWebGLProgram(u,[a],a.dtype)}};class _H{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,a]=e,[,i,o]=t,s=[n&&i>1?r-1:r,n&&o>1?a-1:a],c=[n&&i>1?i-1:i,n&&o>1?o-1:o],l=s[0]/c[0],u=s[1]/c[1],h=1/l,d=1/u,f=2*Math.ceil(h)+2,p=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(l,");\n        const float widthScale = float(").concat(u,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(d,");\n\n        const int winHeight = int(").concat(f,");\n        const int winWidth = int(").concat(p,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(o,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(s[0],") *\n                (float(dyR) / float(").concat(c[0],"));\n\n            float sourceFracCol =\n                float(").concat(s[1],") *\n                  (float(dyC) / float(").concat(c[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(r,") - 1),\n                ").concat(n," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(a,") - 1),\n                ").concat(n," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}}const SH={kernelName:bu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r,s=new _H(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}};class TH{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));if(this.outputShape=t,1===n)return void(this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      "));const r=t.map((n,r)=>(n=>-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - coords[").concat(n,"] - 1"):"coords[".concat(n,"]"))(r)).join(","),a=mz(n);this.userCode="\n      void main() {\n        ".concat(a," coords = getOutputCoords();\n        setOutput(getX(").concat(r,"));\n      }\n    ")}}class IH{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-".concat(n," tensor is not yet supported"));this.outputShape=t;const r=DB("rc",n),a="".concat(r[n-1]," + 1 < ").concat(this.outputShape[n-1]),i="".concat(r[n-2]," + 1 < ").concat(this.outputShape[n-2]),o=mz(n);function s(n){const r=t.map((r,a)=>function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?"".concat(t[n]," - ").concat(r[n]," - 1"):"".concat(r[n])}(a,n)),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(a,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(o," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(t){return s(t)}(r.slice()),";\n          if(").concat(a,"){\n            result.g = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice()),";\n          }\n          if(").concat(i,") {\n            result.b = ").concat(function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice()),";\n            if(").concat(a,") {\n              result.a = ").concat(function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}}const EH={kernelName:_u,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dims:i}=r,o=a.shape.length,s=Ds(i,a.shape);if(0===o)return nj({inputs:{x:a},backend:n});const c=ac().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new IH(a.shape,s):new TH(a.shape,s);return n.runWebGLProgram(c,[a],a.dtype)}};class NH{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=t[1],r=t[2];this.outputShape=t;let a="";a="number"===typeof e?"float outputValue = ".concat(e.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(e.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(a,"\n          if(coordX >= 0 && coordX < ").concat(r," && coordY >= 0 && coordY < ").concat(n,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}}const CH={kernelName:hh,backendName:"webgl",kernelFunc:t=>{let{inputs:e,attrs:n,backend:r}=t;const{image:a}=e,{radians:i,fillValue:o,center:s}=n,c=r,l=new NH(a.shape,o),[u,h]=Fw(s,a.shape[1],a.shape[2]),d=[[u,h,Math.sin(i),Math.cos(i)]];return c.runWebGLProgram(l,[a],a.dtype,d)}},AH=fj({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),RH={kernelName:Su,backendName:"webgl",kernelFunc:AH},OH=fj({opSnippet:"return inversesqrt(x);",cpuKernelImpl:pB}),DH={kernelName:Tu,backendName:"webgl",kernelFunc:OH};class MH{constructor(t,e,n,r,a,i){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const o=mz(a.length),s=mz(i.length);let c="";1===n?c="i":2===n&&(c="i, j");const l="getIndices(".concat(c,")");let u="";1===r?u="i":2===r&&(u="i, coords[1]");const h="getUpdates(".concat(u,")"),d=e>1?"strides[j]":"strides";this.userCode="\n        ".concat(o," strides = ").concat(o,"(").concat(a,");\n\n        void main() {\n          ").concat(s," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(e,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(d,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")}}const FH={kernelName:Iu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a,updates:i}=e,{shape:o}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:h}=Yv(0,a,o),d=[h/l,l];if(0===h)return n.makeTensorInfo(o,a.dtype);const f=_j({inputs:{x:a},backend:n,attrs:{shape:[c,s]}}),p=_j({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0])),g=new MH(c,s,f.shape.length,p.shape.length,u,d),y=n.runWebGLProgram(g,[p,f,m],p.dtype),v=_j({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(m),v}};class PH{constructor(t,e,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,n];const a="for (int i = 0; i < ".concat(Math.ceil(Math.log2(e+1)),"; ++i) { if (left >= right) break;"),i=2===ac().getNumber("WEBGL_VERSION")?"while (left < right) {":a,o="left"===r?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(i,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(o," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}}const LH={kernelName:Eu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:i}=e,{side:o}=r,s=new PH(a.shape[0],a.shape[1],i.shape[1],o),c=[[a.shape[1]]];return n.runWebGLProgram(s,[a,i],"int32",c)}};class zH{constructor(t,e,n){let r,a;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank ".concat(n," is not yet supported"));if(1===n)a="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=[];for(let r=0;r<e.length;r++)o.push("".concat(n[r])),r<t&&i.push("".concat(n[r]));r=i.join(),a=o.join()}const i=mz(n);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        float cVal = getC(").concat(r,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(a,"));\n        } else {\n          setOutput(getB(").concat(a,"));\n        }\n      }\n    ")}}const BH={kernelName:Nu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:r,t:a,e:i}=e,o=new zH(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],hd(a.dtype,i.dtype))}},jH=fj({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(Vw,";\n  float scale = ").concat(Ww,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),UH={kernelName:Cu,backendName:"webgl",kernelFunc:jH},VH=fj({opSnippet:dj+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:gB}),WH={kernelName:Mu,backendName:"webgl",kernelFunc:VH},GH=fj({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),HH={kernelName:Du,backendName:"webgl",kernelFunc:GH},qH=fj({opSnippet:dj+"\n  return sin(x);\n"}),KH={kernelName:Ru,backendName:"webgl",kernelFunc:qH},XH=fj({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),YH={kernelName:Ou,backendName:"webgl",kernelFunc:XH},QH=fj({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),JH={kernelName:Fu,backendName:"webgl",kernelFunc:QH},$H={kernelName:zu,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,paddings:o}=r;ks(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const s=i.reduce((t,e)=>t*e),c=[[0,0]];c.push(...o);for(let y=1+i.length;y<a.shape.length;++y)c.push([0,0]);const l=[],u=tH({inputs:{x:a},backend:n,attrs:{paddings:c,constantValue:0}}),h=Pw(u.shape,i,s,!1),d=Lw(h.length,i.length,!1),f=zw(u.shape,i,s,!1),p=_j({inputs:{x:u},backend:n,attrs:{shape:h}}),m=Dj({inputs:{x:p},backend:n,attrs:{perm:d}}),g=_j({inputs:{x:m},backend:n,attrs:{shape:f}});return l.push(u),l.push(p),l.push(m),l.forEach(t=>n.disposeIntermediateTensorInfo(t)),g}};const ZH={kernelName:Uu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:i,defaultValue:o}=e;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(i.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(o.shape));const s=n.readSync(r.dataId),c=n.readSync(a.dataId),l=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[h,d,f,p,m]=bB(s,r.shape,r.dtype,c,a.dtype,l,u);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],a.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(t=>Number(t)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}};const tq={kernelName:Vu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:i}=e;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(i.shape));const o=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),c=Array.from(n.readSync(i.dataId)),[l,u,h]=wB(s,r.shape,r.dtype,o,c);return[n.makeTensorInfo(u,r.dtype,l),n.makeTensorInfo([h.length],i.dtype,new Int32Array(h))]}};const eq={kernelName:Wu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(i.shape));const o=n.readSync(r.dataId),s=n.readSync(a.dataId),c=n.readSync(i.dataId),[l,u]=xB(o,r.shape,r.dtype,s,c,!0);return n.makeTensorInfo(u,r.dtype,l)}};const nq={kernelName:Gu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(i.shape));const o=n.readSync(r.dataId),s=n.readSync(a.dataId),c=n.readSync(i.dataId),[l,u]=xB(o,r.shape,r.dtype,s,c);return n.makeTensorInfo(u,r.dtype,l)}};const rq={kernelName:Hu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:a,sparseValues:i,defaultValue:o}=e,{outputShape:s}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:h,outputSize:d}=Yv(0,a,s),f=!1;if("string"===i.dtype){const t=n.bufferSync(a),e=n.bufferSync(i),r=Wh(n.readSync(o.dataId)[0]),p=mB(t,e,s,d,u,l,c,h,r,f);return n.makeTensorInfo(s,p.dtype,p.values)}const p=new MH(l,c,a.shape.length,i.shape.length,h,[d,1],f),m=n.runWebGLProgram(p,[i,a,o],i.dtype),g=_j({inputs:{x:m},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(m),g}};const aq={kernelName:Bu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{numOrSizeSplits:i,axis:o}=r,s=Ds(o,a.shape)[0],c=px(a,i,s),l=a.shape.length,u=new Array(l).fill(0),h=a.shape.slice();return c.map(t=>{const e=[...h];e[s]=t;const r=CU({inputs:{x:a},backend:n,attrs:{begin:u,size:e}});return u[s]+=t,r})}},iq="return sqrt(x);",oq=fj({opSnippet:iq,packedOpSnippet:iq,cpuKernelImpl:kB}),sq={kernelName:Pu,backendName:"webgl",kernelFunc:oq},cq={kernelName:Ku,backendName:"webgl",kernelFunc:fj({opSnippet:"return x * x;"})},lq="return (a - b) * (a - b);",uq=pj({opSnippet:lq,packedOpSnippet:lq}),hq={kernelName:qu,backendName:"webgl",kernelFunc:uq};const dq={kernelName:lh,backendName:"webgl",kernelFunc:function(t){let{inputs:e,attrs:n,backend:r}=t;const{x:a}=e,i=UB+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new jB(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}};class fq{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,a=mz(n.length),i=mz(n.length);let o="";if(1===r)o="coords * strides + begin";else{let t=0;o=n.map((e,r)=>(t++,1===n.length?"coords * strides[".concat(r,"] + begin[").concat(r,"]"):"coords[".concat(t-1,"] * strides[").concat(r,"] + begin[").concat(r,"]"))).join(",")}this.userCode="\n      ".concat(a," begin = ").concat(a,"(").concat(t,");\n      ").concat(a," strides = ").concat(a,"(").concat(e,");\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(o,"));\n      }\n    ")}}const pq={kernelName:Xu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,end:o,strides:s,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=r,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:g,isSimpleSlice:y,begin:v,end:b,strides:w}=Rp(a.shape,i,o,s,c,l,u,h,d);let x;if(m)x=_j({inputs:{x:a},backend:n,attrs:{shape:p}});else if(g||y){ks(a.shape.length>=1,()=>"Input must have rank at least 1, got: ".concat(a.shape.length));const t=vp(v,b,w),e=CU({inputs:{x:a},backend:n,attrs:{begin:v,size:t}});x=_j({inputs:{x:e},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(e)}else{if(n.shouldExecuteOnCPU([a])){const t=n.readSync(a.dataId),e=Lf(a.shape,a.dtype,t),r=_B(f,e,w,v);x=n.makeTensorInfo(p,a.dtype,r.values)}else{const t=new fq(v,w,f);x=n.runWebGLProgram(t,[a],a.dtype)}}const k=_j({inputs:{x:x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(x),k}};const mq={kernelName:Yu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:h}=e,d=n.readSync(u.dataId),f=n.readSync(h.dataId),[p,m]=SB(d,f,a,i,o,s,c,l);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",m)]}};const gq={kernelName:Qu,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:i,delimiter:o}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: ".concat(i.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));const s=n.readSync(i.dataId),c=n.readSync(o.dataId)[0],[l,u,h]=TB(s,c,a),d=u.length;return[n.makeTensorInfo([d,2],"int32",l),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};const yq={kernelName:Ju,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:i}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),s=IB(o,a);return n.makeTensorInfo(i.shape,"int32",s)}},vq=fj({opSnippet:"return tan(x);"}),bq={kernelName:Zu,backendName:"webgl",kernelFunc:vq},wq=fj({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),xq={kernelName:th,backendName:"webgl",kernelFunc:wq};class kq{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let i=0;i<n.length;i++)n[i]=t[i]*e[i];this.outputShape=n,this.rank=n.length;const r=mz(this.rank),a=function(t){const e=t.length;if(e>5)throw Error("Tile for rank ".concat(e," is not yet supported"));if(1===e)return"imod(resRC, ".concat(t[0],")");const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<t.length;a++)r.push("imod(".concat(n[a],", ").concat(t[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")}}function _q(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reps:i}=r;if("string"===a.dtype||a.shape.length>5){const t=n.readSync(a.dataId),e="string"===a.dtype?t.map(t=>Wh(t)):t,r=Lf(a.shape,a.dtype,e),o=NB(r,i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const o=new kq(a.shape,i);return n.runWebGLProgram(o,[a],a.dtype)}const Sq={kernelName:eh,backendName:"webgl",kernelFunc:_q};class Tq{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class Iq{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function Eq(t,e){null!==e&&t.disposeIntermediateTensorInfo(e)}function Nq(t){let e=1;for(;e<t;)e*=2;return e}const Cq={kernelName:nh,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{k:i,sorted:o}=r,s=ac().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=ac().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=a.shape,u=l[l.length-1];if(n.shouldExecuteOnCPU([a])||u<s||i>c){const t=n.readSync(a.dataId),[e,r]=CB(t,l,a.dtype,i,o);return[n.makeTensorInfo(e.shape,e.dtype,e.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===i)return l[l.length-1]=0,[n.makeTensorInfo(l,a.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(1===u)return[a,hW({attrs:{shape:l,dtype:"int32",value:0},backend:n})];const h=n.texData.get(a.dataId),d=null!==h&&h.isPacked,f=d?n.unpackTensor(a):a,p=Is(l)/u,m=_j({inputs:{x:f},attrs:{shape:[p,u]},backend:n});d&&Eq(n,f);const g=Nq(i),y=Nq(u);let v=null;const b=()=>null===v?[m,m]:[m,v],w=(t,e,r)=>{const a=b(),i=new Tq(r),o=[[u],[null===v?1:0],[Number.NEGATIVE_INFINITY],[t],[e]],s=v;v=n.runWebGLProgram(i,a,"int32",o),Eq(n,s)};for(let T=1;T<g;T*=2){const t=2*T;for(let e=T;e>=1;e/=2)w(t,e,[p,y])}for(let T=y;T>g;T/=2){const t=b(),e=new Iq([p,T/2]),r=[[u],[null===v?1:0],[g]],a=v;v=n.runWebGLProgram(e,t,"int32",r),Eq(n,a);const i=g/2,o=2*i;for(let n=i;n>=1;n/=2)w(o,n,v.shape)}let x=v;v=CU({inputs:{x:v},backend:n,attrs:{begin:0,size:[p,i]}}),Eq(n,x);let k=AW({inputs:{x:m,indices:v},backend:n,attrs:{axis:1,batchDims:1}});Eq(n,m);const _=l.slice(0,-1);_.push(i),x=v,v=_j({inputs:{x:v},attrs:{shape:_},backend:n}),Eq(n,x);const S=k;return k=_j({inputs:{x:k},attrs:{shape:_},backend:n}),Eq(n,S),[k,v]}};class Aq{constructor(t,e,n,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const o="nearest"===n?1:2;let s;switch(r){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(e,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(a,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(a,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(e,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(o," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}}const Rq={kernelName:rh,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,transforms:i}=e,{interpolation:o,fillMode:s,fillValue:c,outputShape:l}=r,[u,h,d,f]=a.shape,[p,m]=null!=l?l:[h,d],g=new Aq(h,d,o,s,c,[u,p,m,f]);return n.runWebGLProgram(g,[a,i],"float32")}};const Oq={kernelName:ih,backendName:"webgl",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:a}=n,{x:i}=e;JL(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:s,outputShape:c,indices:l}=RB(o,a,i.shape,i.dtype);return[r.makeTensorInfo(c,i.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}};const Dq={kernelName:oh,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a,s=o.shape.length,c=a.shape[i],l=new Array(s-1);let u=0;for(let m=0;m<s;m++)m!==i&&(l[u++]=o.shape[m]);const h=[],d=new Array(s).fill(0),f=o.shape.slice();f[i]=1;const p=new Array(c);for(let m=0;m<p.length;m++){d[i]=m;const t=CU({inputs:{x:o},backend:n,attrs:{begin:d,size:f}}),e=_j({inputs:{x:t},backend:n,attrs:{shape:l}});p[m]=e,h.push(t)}return h.forEach(t=>n.disposeIntermediateTensorInfo(t)),p}};class Mq{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,r=t.batchSize,a=t.inSize,i=t.numSegments,o=i*Math.ceil(a/n);this.outputShape=[r,o];const s=4*Math.floor(n/4),c=n%4,l="\n        sumValue += dot(values, segFilter);\n    ";let u="";a%n>0&&(u="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return initializationValue;\n        }\n      "));let h="";a%n>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(a,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(u,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(i,")) * float(").concat(n,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(i,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}}const Fq={kernelName:sh,backendName:"webgl",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,segmentIds:i}=e,{numSegments:o}=r,s=a.shape.length,c=[];let l=0;const u=xg([l],s);let h=a;null!=u&&(h=Dj({inputs:{x:a},backend:n,attrs:{perm:u}}),c.push(h),l=_g(1,s)[0]);const d=Nx(h.shape,l,o),f=Is([h.shape[l]]),p=_j({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});c.push(p);const m=dd(a.dtype),g=(t,e,r,a,i)=>{const o=t.shape[0],s=t.shape[1],l=Ex(s,i),u=new Mq({windowSize:l,inSize:s,batchSize:o,numSegments:i},e),h=n.compileAndRun(u,[t,r],a);if(c.push(h),h.shape[1]===i)return h;const d=sH({backend:n,attrs:{start:0,stop:i,step:1,dtype:"float32"}}),f=_q({inputs:{x:d},backend:n,attrs:{reps:[s/l]}});c.push(d),c.push(f);return g(h,e,f,a,i)},y=_j({inputs:{x:g(p,"unsortedSegmentSum",i,m,o)},backend:n,attrs:{shape:d}});let v=y;if(null!=u){c.push(y);const t=kg(u);v=Dj({inputs:{x:v},backend:n,attrs:{perm:t}})}return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),v}},Pq=[Pj,zj,jj,Vj,Hj,Xj,Yj,Qj,nU,rU,iU,sU,lU,hU,fU,gU,yU,wU,xU,kU,TU,RU,OU,DU,zU,UU,GU,ij,KU,eV,lV,pV,mV,gV,yV,vV,wV,kV,SV,AV,RV,OV,MV,LV,jV,UV,WV,HV,qV,XV,YV,JV,ZV,eW,rW,oW,lW,dW,pW,yW,bW,kW,TW,IW,NW,RW,DW,FW,rj,PW,$U,zW,jW,VW,cj,GW,qW,KW,YW,JW,ZW,eG,rG,oG,cG,uG,dG,fG,pG,yG,vG,bG,wG,xG,_G,IG,NG,LG,kj,BG,UG,WG,HG,FU,KG,QG,JG,eH,rH,hj,aH,iH,oH,cH,LU,RG,uH,dH,pH,Sj,yH,bH,kH,SH,EH,CH,RH,DH,FH,LH,BH,UH,WH,HH,KH,YH,AU,PG,JH,$H,ZH,tq,eq,nq,rq,aq,sq,cq,hq,dq,pq,mq,gq,yq,MG,Oj,bq,xq,Sq,Cq,Rq,Mj,Oq,Dq,Fq,YG];for(const n of Pq)kh(n);n(4177);const Lq={moveTickSize:50,videoContainerId:"webgazerVideoContainer",videoElementId:"webgazerVideoFeed",videoElementCanvasId:"webgazerVideoCanvas",faceOverlayId:"webgazerFaceOverlay",faceFeedbackBoxId:"webgazerFaceFeedbackBox",gazeDotId:"webgazerGazeDot",videoViewerWidth:320,videoViewerHeight:240,faceFeedbackBoxRatio:.66,showVideo:!0,mirrorVideo:!0,showFaceOverlay:!0,showFaceFeedbackBox:!0,showGazeDot:!0,camConstraints:{video:{width:{min:320,ideal:640,max:1920},height:{min:240,ideal:480,max:1080},facingMode:"user"}},dataTimestep:50,showVideoPreview:!0,applyKalmanFilter:!0,saveDataAcrossSessions:!0,storingPoints:!1,trackEye:"both"};window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(t,1e3/60)},window.cancelRequestAnimFrame=window.cancelCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.clearTimeout;var zq=n(4423),Bq=function(){return(Bq=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function jq(t,e,n,r){return new(n||(n=Promise))(function(a,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,s)}c((r=r.apply(t,e||[])).next())})}function Uq(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function Vq(t,e,n,r){return new(n||(n=Promise))(function(a,i){function o(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,s)}c((r=r.apply(t,e||[])).next())})}function Wq(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var Gq=function(t){return{startEndTensor:t,startPoint:Im(t,[0,0],[-1,2]),endPoint:Im(t,[0,2],[-1,2])}},Hq={strides:[8,16],anchors:[2,6]};function qq(t,e){var n,r,a;if(t.topLeft instanceof nd&&t.bottomRight instanceof nd){var i=zp(function(){return[km([Im(ny(e-1,t.topLeft),0,1),Im(t.topLeft,1,1)]),km([ny(e-1,Im(t.bottomRight,0,1)),Im(t.bottomRight,1,1)])]});n=i[0],r=i[1],null!=t.landmarks&&(a=zp(function(){var n=ny(Av([e-1,0]),t.landmarks),r=Av([1,-1]);return Sm(n,r)}))}else{var o=t.topLeft,s=o[0],c=o[1],l=t.bottomRight,u=l[0],h=l[1];n=[e-1-s,c],r=[e-1-u,h],null!=t.landmarks&&(a=t.landmarks.map(function(t){return[e-1-t[0],t[1]]}))}var d={topLeft:n,bottomRight:r};return null!=a&&(d.landmarks=a),null!=t.probability&&(d.probability=t.probability instanceof nd?t.probability.clone():t.probability),d}function Kq(t,e){return zp(function(){var n;return n=t.hasOwnProperty("box")?t.box:t,Tv(function(t,e){var n=Sm(t.startPoint,e),r=Sm(t.endPoint,e),a=Um([n,r],1);return Gq(a)}(n,e).startEndTensor)})}var Xq=function(){function t(t,e,n,r,a,i){this.blazeFaceModel=t,this.width=e,this.height=n,this.maxFaces=r,this.anchorsData=function(t,e,n){for(var r=[],a=0;a<n.strides.length;a++)for(var i=n.strides[a],o=Math.floor((e+i-1)/i),s=Math.floor((t+i-1)/i),c=n.anchors[a],l=0;l<o;l++)for(var u=i*(l+.5),h=0;h<s;h++)for(var d=i*(h+.5),f=0;f<c;f++)r.push([d,u]);return r}(e,n,Hq),this.anchors=Rv(this.anchorsData),this.inputSizeData=[e,n],this.inputSize=Av([e,n]),this.iouThreshold=a,this.scoreThreshold=i}return t.prototype.getBoundingBoxes=function(t,e,n){return void 0===n&&(n=!0),Vq(this,void 0,void 0,function(){var r,a,i,o,s,c,l,u,h,d,f,p,m,g,y=this;return Wq(this,function(v){switch(v.label){case 0:return r=zp(function(){var e=uw.resizeBilinear(t,[y.width,y.height]),n=Sm(ny(sg(e,255),.5),2),r=y.blazeFaceModel.predict(n),a=Tv(r),i=function(t,e,n){var r=Im(t,[0,1],[-1,2]),a=Xp(r,e),i=Im(t,[0,3],[-1,2]),o=sg(i,n),s=sg(a,n),c=sg(o,2),l=ny(s,c),u=Xp(s,c),h=Sm(l,n),d=Sm(u,n);return Um([h,d],1)}(a,y.anchors,y.inputSize),o=Im(a,[0,0],[-1,1]);return[a,i,Tv(Tm(o))]}),a=r[0],i=r[1],o=r[2],s=console.warn,console.warn=function(){},c=uw.nonMaxSuppression(i,o,this.maxFaces,this.iouThreshold,this.scoreThreshold),console.warn=s,[4,c.array()];case 1:return l=v.sent(),c.dispose(),u=l.map(function(t){return Im(i,[t,0],[1,-1])}),e?[3,3]:[4,Promise.all(u.map(function(t){return Vq(y,void 0,void 0,function(){var e;return Wq(this,function(n){switch(n.label){case 0:return[4,t.array()];case 1:return e=n.sent(),t.dispose(),[2,e]}})})}))];case 2:u=v.sent(),v.label=3;case 3:for(h=t.shape[1],d=t.shape[2],f=e?sg([d,h],this.inputSize):[d/this.inputSizeData[0],h/this.inputSizeData[1]],p=[],m=function(t){var r=u[t],i=zp(function(){var i=Gq(r instanceof nd?r:Rv(r));if(!n)return i;var s,c=l[t];return s=e?Im(y.anchors,[c,0],[1,2]):y.anchorsData[c],{box:i,landmarks:bm(Tv(Im(a,[c,5],[1,-1])),[6,-1]),probability:Im(o,[c],[1]),anchor:s}});p.push(i)},g=0;g<u.length;g++)m(g);return i.dispose(),o.dispose(),a.dispose(),[2,{boxes:p,scaleFactor:f}]}})})},t.prototype.estimateFaces=function(t,e,n,r){return void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===r&&(r=!0),Vq(this,void 0,void 0,function(){var a,i,o,s,c,l,u=this;return Wq(this,function(h){switch(h.label){case 0:return a=function(t){return t instanceof nd?[t.shape[0],t.shape[1]]:[t.height,t.width]}(t),i=a[1],o=zp(function(){return t instanceof nd||(t=fp(t)),Mg(zf(t,"float32"),0)}),[4,this.getBoundingBoxes(o,e,r)];case 1:return s=h.sent(),c=s.boxes,l=s.scaleFactor,o.dispose(),e?[2,c.map(function(t){var e=Kq(t,l),a={topLeft:Im(e,[0],[2]),bottomRight:Im(e,[2],[2])};if(r){var o=t,s=o.landmarks,c=o.probability,u=o.anchor,h=Sm(Xp(s,u),l);a.landmarks=h,a.probability=c}return n&&(a=qq(a,i)),a})]:[2,Promise.all(c.map(function(t){return Vq(u,void 0,void 0,function(){var e,a,o,s,c,u,h,d,f,p,m,g=this;return Wq(this,function(y){switch(y.label){case 0:return e=Kq(t,l),r?[3,2]:[4,e.array()];case 1:return c=y.sent(),a={topLeft:c.slice(0,2),bottomRight:c.slice(2)},[3,4];case 2:return[4,Promise.all([t.landmarks,e,t.probability].map(function(t){return Vq(g,void 0,void 0,function(){return Wq(this,function(e){return[2,t.array()]})})}))];case 3:o=y.sent(),s=o[0],c=o[1],u=o[2],h=t.anchor,f=(d=l)[0],p=d[1],m=s.map(function(t){return[(t[0]+h[0])*f,(t[1]+h[1])*p]}),a={topLeft:c.slice(0,2),bottomRight:c.slice(2),landmarks:m,probability:u},function(t){t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose()}(t.box),t.landmarks.dispose(),t.probability.dispose(),y.label=4;case 4:return e.dispose(),n&&(a=qq(a,i)),[2,a]}})})}))]}})})},t}();function Yq(t){var e=void 0===t?{}:t,n=e.maxFaces,r=void 0===n?10:n,a=e.inputWidth,i=void 0===a?128:a,o=e.inputHeight,s=void 0===o?128:o,c=e.iouThreshold,l=void 0===c?.3:c,u=e.scoreThreshold,h=void 0===u?.75:u,d=e.modelUrl;return Vq(this,void 0,void 0,function(){var t;return Wq(this,function(e){switch(e.label){case 0:return null==d?[3,2]:[4,gA(d)];case 1:return t=e.sent(),[3,4];case 2:return[4,gA("https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1",{fromTFHub:!0})];case 3:t=e.sent(),e.label=4;case 4:return[2,new Xq(t,i,s,r,l,h)]}})})}var Qq={silhouette:[10,338,297,332,284,251,389,356,454,323,361,288,397,365,379,378,400,377,152,148,176,149,150,136,172,58,132,93,234,127,162,21,54,103,67,109],lipsUpperOuter:[61,185,40,39,37,0,267,269,270,409,291],lipsLowerOuter:[146,91,181,84,17,314,405,321,375,291],lipsUpperInner:[78,191,80,81,82,13,312,311,310,415,308],lipsLowerInner:[78,95,88,178,87,14,317,402,318,324,308],rightEyeUpper0:[246,161,160,159,158,157,173],rightEyeLower0:[33,7,163,144,145,153,154,155,133],rightEyeUpper1:[247,30,29,27,28,56,190],rightEyeLower1:[130,25,110,24,23,22,26,112,243],rightEyeUpper2:[113,225,224,223,222,221,189],rightEyeLower2:[226,31,228,229,230,231,232,233,244],rightEyeLower3:[143,111,117,118,119,120,121,128,245],rightEyebrowUpper:[156,70,63,105,66,107,55,193],rightEyebrowLower:[35,124,46,53,52,65],rightEyeIris:[473,474,475,476,477],leftEyeUpper0:[466,388,387,386,385,384,398],leftEyeLower0:[263,249,390,373,374,380,381,382,362],leftEyeUpper1:[467,260,259,257,258,286,414],leftEyeLower1:[359,255,339,254,253,252,256,341,463],leftEyeUpper2:[342,445,444,443,442,441,413],leftEyeLower2:[446,261,448,449,450,451,452,453,464],leftEyeLower3:[372,340,346,347,348,349,350,357,465],leftEyebrowUpper:[383,300,293,334,296,336,285,417],leftEyebrowLower:[265,353,276,283,282,295],leftEyeIris:[468,469,470,471,472],midwayBetweenEyes:[168],noseTip:[1],noseBottom:[2],noseRightCorner:[98],noseLeftCorner:[327],rightCheek:[205],leftCheek:[425]};function Jq(t){return[Math.abs(t.endPoint[0]-t.startPoint[0]),Math.abs(t.endPoint[1]-t.startPoint[1])]}function $q(t){return[t.startPoint[0]+(t.endPoint[0]-t.startPoint[0])/2,t.startPoint[1]+(t.endPoint[1]-t.startPoint[1])/2]}function Zq(t,e){void 0===e&&(e=1.5);var n=$q(t),r=Jq(t),a=[e*r[0]/2,e*r[1]/2];return{startPoint:[n[0]-a[0],n[1]-a[1]],endPoint:[n[0]+a[0],n[1]+a[1]],landmarks:t.landmarks}}function tK(t){var e=$q(t),n=Jq(t),r=Math.max.apply(Math,n)/2;return{startPoint:[e[0]-r,e[1]-r],endPoint:[e[0]+r,e[1]+r],landmarks:t.landmarks}}var eK=[[1,0,0],[0,1,0],[0,0,1]];function nK(t,e){return[[1,0,t],[0,1,e],[0,0,1]]}function rK(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n}function aK(t,e){for(var n=[],r=0;r<t.length;r++)n.push(t[r][e]);return n}function iK(t,e){for(var n=[],r=t.length,a=0;a<r;a++){n.push([]);for(var i=0;i<r;i++)n[a].push(rK(t[a],aK(e,i)))}return n}function oK(t,e){var n=Math.cos(t),r=Math.sin(t),a=[[n,-r,0],[r,n,0],[0,0,1]],i=iK(nK(e[0],e[1]),a);return iK(i,nK(-e[0],-e[1]))}var sK=[13,Qq.midwayBetweenEyes[0]],cK=[3,2],lK=Qq.leftEyeLower0,uK=[lK[0],lK[lK.length-1]],hK=Qq.rightEyeLower0,dK=[hK[0],hK[hK.length-1]],fK=[{key:"EyeUpper0",indices:[9,10,11,12,13,14,15]},{key:"EyeUpper1",indices:[25,26,27,28,29,30,31]},{key:"EyeUpper2",indices:[41,42,43,44,45,46,47]},{key:"EyeLower0",indices:[0,1,2,3,4,5,6,7,8]},{key:"EyeLower1",indices:[16,17,18,19,20,21,22,23,24]},{key:"EyeLower2",indices:[32,33,34,35,36,37,38,39,40]},{key:"EyeLower3",indices:[54,55,56,57,58,59,60,61,62]},{key:"EyebrowUpper",indices:[63,64,65,66,67,68,69,70]},{key:"EyebrowLower",indices:[48,49,50,51,52,53]}];function pK(t,e,n,r){for(var a=0;a<fK.length;a++){var i=fK[a],o=i.key,s=i.indices,c=Qq[""+n+o];if(null==r||r.includes(o))for(var l=0;l<s.length;l++){var u=s[l];t[c[l]]=[e[u][0],e[u][1],(e[u][2]+t[c[l]][2])/2]}}}var mK=function(){function t(t,e,n,r,a,i,o){this.regionsOfInterest=[],this.runsWithoutFaceDetector=0,this.boundingBoxDetector=t,this.meshDetector=e,this.irisModel=o,this.meshWidth=n,this.meshHeight=r,this.maxContinuousChecks=a,this.maxFaces=i}return t.prototype.transformRawCoords=function(t,e,n,r){var a,i,o,s,c=this,l=Jq({startPoint:e.startPoint,endPoint:e.endPoint}),u=[l[0]/this.meshWidth,l[1]/this.meshHeight],h=t.map(function(t){return[u[0]*(t[0]-c.meshWidth/2),u[1]*(t[1]-c.meshHeight/2),t[2]]}),d=oK(n,[0,0]),f=h.map(function(t){return function(t,e){return[rK(t,e[0]),rK(t,e[1])]}(t,d).concat([t[2]])}),p=(i=[[(a=r)[0][0],a[1][0]],[a[0][1],a[1][1]]],o=[a[0][2],a[1][2]],s=[-rK(i[0],o),-rK(i[1],o)],[i[0].concat(s[0]),i[1].concat(s[1]),[0,0,1]]),m=$q({startPoint:e.startPoint,endPoint:e.endPoint}).concat([1]),g=[rK(m,p[0]),rK(m,p[1])];return f.map(function(t){return[t[0]+g[0],t[1]+g[1],t[2]]})},t.prototype.getLeftToRightEyeDepthDifference=function(t){return t[uK[0]][2]-t[dK[0]][2]},t.prototype.getEyeBox=function(t,e,n,r,a){void 0===a&&(a=!1);var i=tK(Zq(this.calculateLandmarksBoundingBox([t[n],t[r]]),2.3)),o=Jq(i),s=uw.cropAndResize(e,[[i.startPoint[1]/this.meshHeight,i.startPoint[0]/this.meshWidth,i.endPoint[1]/this.meshHeight,i.endPoint[0]/this.meshWidth]],[0],[64,64]);return a&&(s=uw.flipLeftRight(s)),{box:i,boxSize:o,crop:s}},t.prototype.getEyeCoords=function(t,e,n,r){void 0===r&&(r=!1);for(var a=[],i=0;i<76;i++){var o=t[3*i],s=t[3*i+1],c=t[3*i+2];a.push([(r?1-o/64:o/64)*n[0]+e.startPoint[0],s/64*n[1]+e.startPoint[1],c])}return{rawCoords:a,iris:a.slice(71)}},t.prototype.getAdjustedIrisCoords=function(t,e,n){var r=t[Qq[n+"EyeUpper0"][3]][2],a=t[Qq[n+"EyeLower0"][4]][2],i=(r+a)/2;return e.map(function(t,e){var n=i;return 2===e?n=r:4===e&&(n=a),[t[0],t[1],n]})},t.prototype.predict=function(t,e){return jq(this,void 0,void 0,function(){var n,r,a,i,o=this;return Uq(this,function(s){switch(s.label){case 0:return this.shouldUpdateRegionsOfInterest()?[4,this.boundingBoxDetector.getBoundingBoxes(t,!1,!0)]:[3,2];case 1:return n=s.sent(),r=n.boxes,a=n.scaleFactor,0===r.length?(this.regionsOfInterest=[],[2,null]):(i=r.map(function(t){var e,n,r={startPoint:Tv(t.box.startPoint).arraySync(),endPoint:Tv(t.box.endPoint).arraySync()},i=tK(Zq((n=a,{startPoint:[(e=r).startPoint[0]*n[0],e.startPoint[1]*n[1]],endPoint:[e.endPoint[0]*n[0],e.endPoint[1]*n[1]]})));return Bq({},i,{landmarks:t.landmarks.arraySync()})}),r.forEach(function(t){null!=t&&null!=t.startPoint&&(t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose())}),this.updateRegionsOfInterest(i),this.runsWithoutFaceDetector=0,[3,3]);case 2:this.runsWithoutFaceDetector++,s.label=3;case 3:return[2,zp(function(){return o.regionsOfInterest.map(function(n,r){var a,i=n.landmarks.length>=468,s=sK[0],c=sK[1];!1===i&&(s=cK[0],c=cK[1]),a=function(t,e){var n;return(n=Math.PI/2-Math.atan2(-(e[1]-t[1]),e[0]-t[0]))-2*Math.PI*Math.floor((n+Math.PI)/(2*Math.PI))}(n.landmarks[s],n.landmarks[c]);var l=$q({startPoint:n.startPoint,endPoint:n.endPoint}),u=[l[0]/t.shape[2],l[1]/t.shape[1]],h=t,d=eK;0!==a&&(h=uw.rotateWithOffset(t,a,0,u),d=oK(-a,l));var f={startPoint:n.startPoint,endPoint:n.endPoint},p=sg(function(t,e,n){var r=e.shape[1],a=e.shape[2],i=[[t.startPoint[1]/r,t.startPoint[0]/a,t.endPoint[1]/r,t.endPoint[0]/a]];return uw.cropAndResize(e,i,[0],n,"bilinear",0)}(f,h,[o.meshHeight,o.meshWidth]),255),m=o.meshDetector.predict(p),g=m[1],y=m[2],v=bm(y,[-1,3]).arraySync();if(e){var b=o.getEyeBox(v,p,uK[0],uK[1],!0),w=b.box,x=b.boxSize,k=b.crop,_=o.getEyeBox(v,p,dK[0],dK[1]),S=_.box,T=_.boxSize,I=_.crop,E=o.irisModel.predict(km([k,I])).dataSync(),N=E.slice(0,228),C=o.getEyeCoords(N,w,x,!0),A=C.rawCoords,R=C.iris,O=E.slice(228),D=o.getEyeCoords(O,S,T),M=D.rawCoords,F=D.iris,P=o.getLeftToRightEyeDepthDifference(v);Math.abs(P)<30?(pK(v,A,"left"),pK(v,M,"right")):P<1?pK(v,A,"left",["EyeUpper0","EyeLower0"]):pK(v,M,"right",["EyeUpper0","EyeLower0"]);var L=o.getAdjustedIrisCoords(v,R,"left"),z=o.getAdjustedIrisCoords(v,F,"right");v=v.concat(L).concat(z)}var B=o.transformRawCoords(v,n,a,d),j=Rv(B),U=Zq(o.calculateLandmarksBoundingBox(B)),V=tK(U);return o.regionsOfInterest[r]=Bq({},V,{landmarks:j.arraySync()}),{coords:Rv(v,[v.length,3]),scaledCoords:j,box:U,flag:Tv(g)}})})]}})})},t.prototype.updateRegionsOfInterest=function(t){for(var e=0;e<t.length;e++){var n=t[e],r=this.regionsOfInterest[e],a=0;if(r&&r.startPoint){var i=n.startPoint,o=i[0],s=i[1],c=n.endPoint,l=c[0],u=c[1],h=r.startPoint,d=h[0],f=h[1],p=r.endPoint,m=p[0],g=p[1],y=Math.max(o,d),v=Math.max(s,f),b=(Math.min(l,m)-y)*(Math.min(u,g)-v);a=b/((l-o)*(u-s)+(m-d)*(g-s)-b)}a<.25&&(this.regionsOfInterest[e]=n)}this.regionsOfInterest=this.regionsOfInterest.slice(0,t.length)},t.prototype.clearRegionOfInterest=function(t){null!=this.regionsOfInterest[t]&&(this.regionsOfInterest=this.regionsOfInterest.slice(0,t).concat(this.regionsOfInterest.slice(t+1)))},t.prototype.shouldUpdateRegionsOfInterest=function(){var t=this.regionsOfInterest.length,e=0===t;return 1===this.maxFaces||e?e:t!==this.maxFaces&&this.runsWithoutFaceDetector>=this.maxContinuousChecks},t.prototype.calculateLandmarksBoundingBox=function(t){var e=t.map(function(t){return t[0]}),n=t.map(function(t){return t[1]});return{startPoint:[Math.min.apply(Math,e),Math.min.apply(Math,n)],endPoint:[Math.max.apply(Math,e),Math.max.apply(Math,n)]}},t}(),gK=[[.499976992607117,.652534008026123],[.500025987625122,.547487020492554],[.499974012374878,.602371990680695],[.482113003730774,.471979022026062],[.500150978565216,.527155995368958],[.499909996986389,.498252987861633],[.499523013830185,.40106201171875],[.289712011814117,.380764007568359],[.499954998493195,.312398016452789],[.499987006187439,.269918978214264],[.500023007392883,.107050001621246],[.500023007392883,.666234016418457],[.5000159740448,.679224014282227],[.500023007392883,.692348003387451],[.499976992607117,.695277988910675],[.499976992607117,.70593398809433],[.499976992607117,.719385027885437],[.499976992607117,.737019002437592],[.499967992305756,.781370997428894],[.499816000461578,.562981009483337],[.473773002624512,.573909997940063],[.104906998574734,.254140973091125],[.365929991006851,.409575998783112],[.338757991790771,.41302502155304],[.311120003461838,.409460008144379],[.274657994508743,.389131009578705],[.393361985683441,.403706014156342],[.345234006643295,.344011008739471],[.370094001293182,.346076011657715],[.319321990013123,.347265005111694],[.297903001308441,.353591024875641],[.24779200553894,.410809993743896],[.396889001131058,.842755019664764],[.280097991228104,.375599980354309],[.106310002505779,.399955987930298],[.2099249958992,.391353011131287],[.355807989835739,.534406006336212],[.471751004457474,.65040397644043],[.474155008792877,.680191993713379],[.439785003662109,.657229006290436],[.414617002010345,.66654098033905],[.450374007225037,.680860996246338],[.428770989179611,.682690978050232],[.374971002340317,.727805018424988],[.486716985702515,.547628998756409],[.485300987958908,.527395009994507],[.257764995098114,.314490020275116],[.401223003864288,.455172002315521],[.429818987846375,.548614978790283],[.421351999044418,.533740997314453],[.276895999908447,.532056987285614],[.483370006084442,.499586999416351],[.33721199631691,.282882988452911],[.296391993761063,.293242990970612],[.169294998049736,.193813979625702],[.447580009698868,.302609980106354],[.392390012741089,.353887975215912],[.354490011930466,.696784019470215],[.067304998636246,.730105042457581],[.442739009857178,.572826027870178],[.457098007202148,.584792017936707],[.381974011659622,.694710969924927],[.392388999462128,.694203019142151],[.277076005935669,.271932005882263],[.422551989555359,.563233017921448],[.385919004678726,.281364023685455],[.383103013038635,.255840003490448],[.331431001424789,.119714021682739],[.229923993349075,.232002973556519],[.364500999450684,.189113974571228],[.229622006416321,.299540996551514],[.173287004232407,.278747975826263],[.472878992557526,.666198015213013],[.446828007698059,.668527007102966],[.422762006521225,.673889994621277],[.445307999849319,.580065965652466],[.388103008270264,.693961024284363],[.403039008378983,.706539988517761],[.403629004955292,.693953037261963],[.460041999816895,.557139039039612],[.431158006191254,.692366003990173],[.452181994915009,.692366003990173],[.475387006998062,.692366003990173],[.465828001499176,.779190003871918],[.472328990697861,.736225962638855],[.473087012767792,.717857003211975],[.473122000694275,.704625964164734],[.473033010959625,.695277988910675],[.427942007780075,.695277988910675],[.426479011774063,.703539967536926],[.423162013292313,.711845993995667],[.4183090031147,.720062971115112],[.390094995498657,.639572978019714],[.013953999616206,.560034036636353],[.499913990497589,.58014702796936],[.413199990987778,.69539999961853],[.409626007080078,.701822996139526],[.468080013990402,.601534962654114],[.422728985548019,.585985004901886],[.463079988956451,.593783974647522],[.37211999297142,.47341400384903],[.334562003612518,.496073007583618],[.411671012639999,.546965003013611],[.242175996303558,.14767599105835],[.290776997804642,.201445996761322],[.327338010072708,.256527006626129],[.399509996175766,.748921036720276],[.441727995872498,.261676013469696],[.429764986038208,.187834024429321],[.412198007106781,.108901023864746],[.288955003023148,.398952007293701],[.218936994671822,.435410976409912],[.41278201341629,.398970007896423],[.257135003805161,.355440020561218],[.427684992551804,.437960982322693],[.448339998722076,.536936044692993],[.178560003638268,.45755398273468],[.247308000922203,.457193970680237],[.286267012357712,.467674970626831],[.332827985286713,.460712015628815],[.368755996227264,.447206974029541],[.398963987827301,.432654976844788],[.476410001516342,.405806005001068],[.189241006970406,.523923993110657],[.228962004184723,.348950982093811],[.490725994110107,.562400996685028],[.404670000076294,.485132992267609],[.019469000399113,.401564002037048],[.426243007183075,.420431017875671],[.396993011236191,.548797011375427],[.266469985246658,.376977026462555],[.439121007919312,.51895797252655],[.032313998788595,.644356966018677],[.419054001569748,.387154996395111],[.462783008813858,.505746960639954],[.238978996872902,.779744982719421],[.198220998048782,.831938028335571],[.107550002634525,.540755033493042],[.183610007166862,.740257024765015],[.134409993886948,.333683013916016],[.385764002799988,.883153975009918],[.490967005491257,.579378008842468],[.382384985685349,.508572995662689],[.174399003386497,.397670984268188],[.318785011768341,.39623498916626],[.343364000320435,.400596976280212],[.396100014448166,.710216999053955],[.187885001301765,.588537991046906],[.430987000465393,.944064974784851],[.318993002176285,.898285031318665],[.266247987747192,.869701027870178],[.500023007392883,.190576016902924],[.499976992607117,.954452991485596],[.366169989109039,.398822009563446],[.393207013607025,.39553701877594],[.410373002290726,.391080021858215],[.194993004202843,.342101991176605],[.388664990663528,.362284004688263],[.365961998701096,.355970978736877],[.343364000320435,.355356991291046],[.318785011768341,.35834002494812],[.301414996385574,.363156020641327],[.058132998645306,.319076001644135],[.301414996385574,.387449026107788],[.499987989664078,.618434011936188],[.415838003158569,.624195992946625],[.445681989192963,.566076993942261],[.465844005346298,.620640993118286],[.49992299079895,.351523995399475],[.288718998432159,.819945991039276],[.335278987884521,.852819979190826],[.440512001514435,.902418971061707],[.128294005990028,.791940987110138],[.408771991729736,.373893976211548],[.455606997013092,.451801002025604],[.499877005815506,.908990025520325],[.375436991453171,.924192011356354],[.11421000212431,.615022003650665],[.448662012815475,.695277988910675],[.4480200111866,.704632043838501],[.447111994028091,.715808033943176],[.444831997156143,.730794012546539],[.430011987686157,.766808986663818],[.406787008047104,.685672998428345],[.400738000869751,.681069016456604],[.392399996519089,.677703022956848],[.367855995893478,.663918972015381],[.247923001646996,.601333022117615],[.452769994735718,.420849978923798],[.43639200925827,.359887003898621],[.416164010763168,.368713974952698],[.413385987281799,.692366003990173],[.228018000721931,.683571994304657],[.468268007040024,.352671027183533],[.411361992359161,.804327011108398],[.499989002943039,.469825029373169],[.479153990745544,.442654013633728],[.499974012374878,.439637005329132],[.432112008333206,.493588984012604],[.499886006116867,.866917014122009],[.49991300702095,.821729004383087],[.456548988819122,.819200992584229],[.344549000263214,.745438992977142],[.37890899181366,.574010014533997],[.374292999505997,.780184984207153],[.319687992334366,.570737957954407],[.357154995203018,.604269981384277],[.295284003019333,.621580958366394],[.447750002145767,.862477004528046],[.410986006259918,.508723020553589],[.31395098567009,.775308012962341],[.354128003120422,.812552988529205],[.324548006057739,.703992962837219],[.189096003770828,.646299958229065],[.279776990413666,.71465802192688],[.1338230073452,.682700991630554],[.336768001317978,.644733011722565],[.429883986711502,.466521978378296],[.455527991056442,.548622965812683],[.437114000320435,.558896005153656],[.467287987470627,.529924988746643],[.414712011814117,.335219979286194],[.37704598903656,.322777986526489],[.344107985496521,.320150971412659],[.312875986099243,.32233202457428],[.283526003360748,.333190023899078],[.241245999932289,.382785975933075],[.102986000478268,.468762993812561],[.267612010240555,.424560010433197],[.297879010438919,.433175981044769],[.333433985710144,.433878004550934],[.366427004337311,.426115989685059],[.396012008190155,.416696012020111],[.420121014118195,.41022801399231],[.007561000064015,.480777025222778],[.432949006557465,.569517970085144],[.458638995885849,.479089021682739],[.473466008901596,.545744001865387],[.476087987422943,.563830018043518],[.468472003936768,.555056989192963],[.433990985155106,.582361996173859],[.483518004417419,.562983989715576],[.482482999563217,.57784903049469],[.42645001411438,.389798998832703],[.438998997211456,.39649498462677],[.450067013502121,.400434017181396],[.289712011814117,.368252992630005],[.276670008897781,.363372981548309],[.517862021923065,.471948027610779],[.710287988185883,.380764007568359],[.526226997375488,.573909997940063],[.895093023777008,.254140973091125],[.634069979190826,.409575998783112],[.661242008209229,.41302502155304],[.688880026340485,.409460008144379],[.725341975688934,.389131009578705],[.606630027294159,.40370500087738],[.654766023159027,.344011008739471],[.629905998706818,.346076011657715],[.680678009986877,.347265005111694],[.702096998691559,.353591024875641],[.75221198797226,.410804986953735],[.602918028831482,.842862963676453],[.719901978969574,.375599980354309],[.893692970275879,.399959981441498],[.790081977844238,.391354024410248],[.643998026847839,.534487962722778],[.528249025344849,.65040397644043],[.525849997997284,.680191040039062],[.560214996337891,.657229006290436],[.585384011268616,.66654098033905],[.549625992774963,.680860996246338],[.57122802734375,.682691991329193],[.624852001667023,.72809898853302],[.513050019741058,.547281980514526],[.51509702205658,.527251958847046],[.742246985435486,.314507007598877],[.598631024360657,.454979002475739],[.570338010787964,.548575043678284],[.578631997108459,.533622980117798],[.723087012767792,.532054007053375],[.516445994377136,.499638974666595],[.662801027297974,.282917976379395],[.70362401008606,.293271005153656],[.830704987049103,.193813979625702],[.552385985851288,.302568018436432],[.607609987258911,.353887975215912],[.645429015159607,.696707010269165],[.932694971561432,.730105042457581],[.557260990142822,.572826027870178],[.542901992797852,.584792017936707],[.6180260181427,.694710969924927],[.607590973377228,.694203019142151],[.722943007946014,.271963000297546],[.577413976192474,.563166975975037],[.614082992076874,.281386971473694],[.616907000541687,.255886018276215],[.668509006500244,.119913995265961],[.770092010498047,.232020974159241],[.635536015033722,.189248979091644],[.77039098739624,.299556016921997],[.826722025871277,.278755009174347],[.527121007442474,.666198015213013],[.553171992301941,.668527007102966],[.577238023281097,.673889994621277],[.554691970348358,.580065965652466],[.611896991729736,.693961024284363],[.59696102142334,.706539988517761],[.596370995044708,.693953037261963],[.539958000183105,.557139039039612],[.568841993808746,.692366003990173],[.547818005084991,.692366003990173],[.52461302280426,.692366003990173],[.534089982509613,.779141008853912],[.527670979499817,.736225962638855],[.526912987232208,.717857003211975],[.526877999305725,.704625964164734],[.526966989040375,.695277988910675],[.572058022022247,.695277988910675],[.573521018028259,.703539967536926],[.57683801651001,.711845993995667],[.581691026687622,.720062971115112],[.609944999217987,.639909982681274],[.986046016216278,.560034036636353],[.5867999792099,.69539999961853],[.590372025966644,.701822996139526],[.531915009021759,.601536989212036],[.577268004417419,.585934996604919],[.536915004253387,.593786001205444],[.627542972564697,.473352015018463],[.665585994720459,.495950996875763],[.588353991508484,.546862006187439],[.757824003696442,.14767599105835],[.709249973297119,.201507985591888],[.672684013843536,.256581008434296],[.600408971309662,.74900496006012],[.55826598405838,.261672019958496],[.570303976535797,.187870979309082],[.588165998458862,.109044015407562],[.711045026779175,.398952007293701],[.781069993972778,.435405015945435],[.587247014045715,.398931980133057],[.742869973182678,.355445981025696],[.572156012058258,.437651991844177],[.55186802148819,.536570012569427],[.821442008018494,.457556009292603],[.752701997756958,.457181990146637],[.71375697851181,.467626988887787],[.66711300611496,.460672974586487],[.631101012229919,.447153985500336],[.6008620262146,.432473003864288],[.523481011390686,.405627012252808],[.810747981071472,.523926019668579],[.771045982837677,.348959028720856],[.509127020835876,.562718033790588],[.595292985439301,.485023975372314],[.980530977249146,.401564002037048],[.573499977588654,.420000016689301],[.602994978427887,.548687994480133],[.733529984951019,.376977026462555],[.560611009597778,.519016981124878],[.967685997486115,.644356966018677],[.580985009670258,.387160003185272],[.537728011608124,.505385041236877],[.760966002941132,.779752969741821],[.801778972148895,.831938028335571],[.892440974712372,.54076099395752],[.816350996494293,.740260004997253],[.865594983100891,.333687007427216],[.614073991775513,.883246004581451],[.508952975273132,.579437971115112],[.617941975593567,.508316040039062],[.825608015060425,.397674977779388],[.681214988231659,.39623498916626],[.656635999679565,.400596976280212],[.603900015354156,.710216999053955],[.81208598613739,.588539004325867],[.56801301240921,.944564998149872],[.681007981300354,.898285031318665],[.733752012252808,.869701027870178],[.633830010890961,.398822009563446],[.606792986392975,.39553701877594],[.589659988880157,.391062021255493],[.805015981197357,.342108011245728],[.611334979534149,.362284004688263],[.634037971496582,.355970978736877],[.656635999679565,.355356991291046],[.681214988231659,.35834002494812],[.698584973812103,.363156020641327],[.941866993904114,.319076001644135],[.698584973812103,.387449026107788],[.584177017211914,.624107003211975],[.554318010807037,.566076993942261],[.534153997898102,.62064003944397],[.711217999458313,.819975018501282],[.664629995822906,.852871000766754],[.559099972248077,.902631998062134],[.871706008911133,.791940987110138],[.591234028339386,.373893976211548],[.544341027736664,.451583981513977],[.624562978744507,.924192011356354],[.88577002286911,.615028977394104],[.551338016986847,.695277988910675],[.551980018615723,.704632043838501],[.552887976169586,.715808033943176],[.555167973041534,.730794012546539],[.569944024085999,.767035007476807],[.593203008174896,.685675978660583],[.599261999130249,.681069016456604],[.607599973678589,.677703022956848],[.631937980651855,.663500010967255],[.752032995223999,.601315021514893],[.547226011753082,.420395016670227],[.563543975353241,.359827995300293],[.583841025829315,.368713974952698],[.586614012718201,.692366003990173],[.771915018558502,.683578014373779],[.531597018241882,.352482974529266],[.588370978832245,.804440975189209],[.52079701423645,.442565023899078],[.567984998226166,.493479013442993],[.543282985687256,.819254994392395],[.655317008495331,.745514988899231],[.621008992195129,.574018001556396],[.625559985637665,.78031200170517],[.680198013782501,.570719003677368],[.64276397228241,.604337990283966],[.704662978649139,.621529996395111],[.552012026309967,.862591981887817],[.589071989059448,.508637011051178],[.685944974422455,.775357007980347],[.645735025405884,.812640011310577],[.675342977046967,.703978002071381],[.810858011245728,.646304965019226],[.72012197971344,.714666962623596],[.866151988506317,.682704985141754],[.663187026977539,.644596993923187],[.570082008838654,.466325998306274],[.544561982154846,.548375964164734],[.562758982181549,.558784961700439],[.531987011432648,.530140042304993],[.585271000862122,.335177004337311],[.622952997684479,.32277899980545],[.655896008014679,.320163011550903],[.687132000923157,.322345972061157],[.716481983661652,.333200991153717],[.758756995201111,.382786989212036],[.897013008594513,.468769013881683],[.732392013072968,.424547016620636],[.70211398601532,.433162987232208],[.66652500629425,.433866024017334],[.633504986763,.426087975502014],[.603875994682312,.416586995124817],[.579657971858978,.409945011138916],[.992439985275269,.480777025222778],[.567192018032074,.569419980049133],[.54136598110199,.478899002075195],[.526564002037048,.546118021011353],[.523913025856018,.563830018043518],[.531529009342194,.555056989192963],[.566035985946655,.582329034805298],[.51631098985672,.563053965568542],[.5174720287323,.577877044677734],[.573594987392426,.389806985855103],[.560697972774506,.395331978797913],[.549755990505219,.399751007556915],[.710287988185883,.368252992630005],[.723330020904541,.363372981548309]];function yK(t){return jq(this,void 0,void 0,function(){var e,n,r,a,i,o,s,c,l,u,h,d,f,p,m,g;return Uq(this,function(y){switch(y.label){case 0:return e=t.maxContinuousChecks,n=void 0===e?5:e,r=t.detectionConfidence,a=void 0===r?.9:r,i=t.maxFaces,o=void 0===i?10:i,s=t.iouThreshold,c=void 0===s?.3:s,l=t.scoreThreshold,u=void 0===l?.75:l,h=t.shouldLoadIrisModel,d=void 0===h||h,f=t.modelUrl,p=t.detectorModelUrl,m=t.irisModelUrl,d?[4,Promise.all([vK(p,o,c,u),bK(f),wK(m)])]:[3,2];case 1:return g=y.sent(),[3,4];case 2:return[4,Promise.all([vK(p,o,c,u),bK(f)])];case 3:g=y.sent(),y.label=4;case 4:return[2,new _K(g[0],g[1],n,a,o,d?g[2]:null)]}})})}function vK(t,e,n,r){return jq(this,void 0,void 0,function(){return Uq(this,function(a){return[2,Yq({modelUrl:t,maxFaces:e,iouThreshold:n,scoreThreshold:r})]})})}function bK(t){return jq(this,void 0,void 0,function(){return Uq(this,function(e){return null!=t?[2,gA(t)]:[2,gA("https://tfhub.dev/mediapipe/tfjs-model/facemesh/1/default/1",{fromTFHub:!0})]})})}function wK(t){return jq(this,void 0,void 0,function(){return Uq(this,function(e){return null!=t?[2,gA(t)]:[2,gA("https://tfhub.dev/mediapipe/tfjs-model/iris/1/default/2",{fromTFHub:!0})]})})}function xK(t,e){if(t.mesh instanceof nd){var n=zp(function(){var n=Av([e-1,0,0]),r=Av([1,-1,1]);return zp(function(){return[km([ny(e-1,Im(t.boundingBox.topLeft,0,1)),Im(t.boundingBox.topLeft,1,1)]),km([ny(e-1,Im(t.boundingBox.bottomRight,0,1)),Im(t.boundingBox.bottomRight,1,1)]),Sm(ny(n,t.mesh),r),Sm(ny(n,t.scaledMesh),r)]})}),r=n[0],a=n[1],i=n[2],o=n[3];return Object.assign({},t,{boundingBox:{topLeft:r,bottomRight:a},mesh:i,scaledMesh:o})}return Object.assign({},t,{boundingBox:{topLeft:[e-1-t.boundingBox.topLeft[0],t.boundingBox.topLeft[1]],bottomRight:[e-1-t.boundingBox.bottomRight[0],t.boundingBox.bottomRight[1]]},mesh:t.mesh.map(function(t){var n=t.slice(0);return n[0]=e-1-t[0],n}),scaledMesh:t.scaledMesh.map(function(t){var n=t.slice(0);return n[0]=e-1-t[0],n})})}var kK,_K=function(){function t(t,e,n,r,a,i){this.kind="MediaPipeFaceMesh",this.pipeline=new mK(t,e,192,192,n,a,i),this.detectionConfidence=r}return t.getAnnotations=function(){return Qq},t.getUVCoords=function(){return gK},t.prototype.estimateFaces=function(t){return jq(this,void 0,void 0,function(){var e,n,r,a,i,o,s,c,l,u,h,d,f=this;return Uq(this,function(p){switch(p.label){case 0:if(e=t.returnTensors,n=void 0!==e&&e,r=t.flipHorizontal,a=void 0!==r&&r,i=t.predictIrises,o=void 0===i||i,s=t.input,o&&null==this.pipeline.irisModel)throw new Error("The iris model was not loaded as part of facemesh. Please initialize the model with facemesh.load({shouldLoadIrisModel: true}).");return c=function(t){return t instanceof nd?[t.shape[0],t.shape[1]]:[t.height,t.width]}(s),l=c[1],u=zp(function(){return s instanceof nd||(s=fp(s)),Mg(zf(s,"float32"),0)}),"webgl"!==xd.backendName?[3,2]:(d=ac().get("WEBGL_PACK_DEPTHWISECONV"),ac().set("WEBGL_PACK_DEPTHWISECONV",!0),[4,this.pipeline.predict(u,o)]);case 1:return h=p.sent(),ac().set("WEBGL_PACK_DEPTHWISECONV",d),[3,4];case 2:return[4,this.pipeline.predict(u,o)];case 3:h=p.sent(),p.label=4;case 4:return u.dispose(),null!=h&&h.length>0?[2,Promise.all(h.map(function(t,e){return jq(f,void 0,void 0,function(){var r,i,s,c,u,h,d,f,p,m,g,y,v,b,w=this;return Uq(this,function(x){switch(x.label){case 0:return r=t.coords,i=t.scaledCoords,s=t.box,c=t.flag,u=[c],n||(u=u.concat([r,i])),[4,Promise.all(u.map(function(t){return jq(w,void 0,void 0,function(){return Uq(this,function(e){return[2,t.array()]})})}))];case 1:if(h=x.sent(),d=h[0],c.dispose(),d<this.detectionConfidence&&this.pipeline.clearRegionOfInterest(e),n)return f={kind:"MediaPipePredictionTensors",faceInViewConfidence:d,mesh:r,scaledMesh:i,boundingBox:{topLeft:Av(s.startPoint),bottomRight:Av(s.endPoint)}},a?[2,xK(f,l)]:[2,f];for(b in p=h.slice(1),m=p[0],g=p[1],i.dispose(),r.dispose(),y={kind:"MediaPipePredictionValues",faceInViewConfidence:d,boundingBox:{topLeft:s.startPoint,bottomRight:s.endPoint},mesh:m,scaledMesh:g},a&&(y=xK(y,l)),v={},Qq)(o||!1===b.includes("Iris"))&&(v[b]=Qq[b].map(function(t){return y.scaledMesh[t]}));return y.annotations=v,[2,y]}})})}))]:[2,[]]}})})},t}();(kK||(kK={})).mediapipeFacemesh="mediapipe-facemesh";const SK=function(){this.model=function(t,e){return void 0===t&&(t=kK.mediapipeFacemesh),void 0===e&&(e={}),jq(this,void 0,void 0,function(){return Uq(this,function(n){if(t===kK.mediapipeFacemesh)return[2,yK(e)];throw new Error(t+" is not a valid package name.")})})}(kK.mediapipeFacemesh,{maxFaces:1}),this.predictionReady=!1};SK.prototype.positionsArray=null,SK.prototype.getEyePatches=async function(t,e,n,r){if(0===e.width)return null;const a=await this.model,i=await a.estimateFaces({input:t,returnTensors:!1,flipHorizontal:!1,predictIrises:!1});if(0==i.length)return!1;this.positionsArray=i[0].scaledMesh;const o=i[0],{scaledMesh:s}=(this.positionsArray,i[0]),[c,l]=[{eyeTopArc:o.annotations.leftEyeUpper0,eyeBottomArc:o.annotations.leftEyeLower0},{eyeTopArc:o.annotations.rightEyeUpper0,eyeBottomArc:o.annotations.rightEyeLower0}].map(t=>{let{eyeTopArc:e,eyeBottomArc:n}=t;const r={x:Math.round(Math.min(...e.map(t=>t[0]))),y:Math.round(Math.min(...e.map(t=>t[1])))},a=Math.round(Math.max(...n.map(t=>t[0]))),i=Math.round(Math.max(...n.map(t=>t[1])));return{origin:r,width:a-r.x,height:i-r.y}});var u=c.origin.x,h=c.origin.y,d=c.width,f=c.height,p=l.origin.x,m=l.origin.y,g=l.width,y=l.height;if(0===d||0===g)return console.log("an eye patch had zero width"),null;if(0===f||0===y)return console.log("an eye patch had zero height"),null;var v={},b=e.getContext("2d").getImageData(u,h,d,f);v.left={patch:b,imagex:u,imagey:h,width:d,height:f};var w=e.getContext("2d").getImageData(p,m,g,y);return v.right={patch:w,imagex:p,imagey:m,width:g,height:y},this.predictionReady=!0,v},SK.prototype.getPositions=function(){return this.positionsArray},SK.prototype.reset=function(){console.log("Unimplemented; Tracking.js has no obvious reset function")},SK.prototype.drawFaceOverlay=function(t,e){if(e){t.fillStyle="#32EEDB",t.strokeStyle="#32EEDB",t.lineWidth=.5;for(let n=0;n<e.length;n++){const r=e[n][0],a=e[n][1];t.beginPath(),t.arc(r,a,1,0,2*Math.PI),t.closePath(),t.fill()}}},SK.prototype.name="TFFaceMesh";const TK=SK;function IK(t,e,n){if(t.length!==e.length||t[0].length!==e[0].length)throw new Error("Matrix dimensions must agree.");const r=t.length,a=t[0].length,i=new Array(r);for(let o=0;o<r;o++){i[o]=new Array(a);for(let r=0;r<a;r++)i[o][r]=n(t[o][r],e[o][r])}return i}const EK={transpose(t){const e=t.length,n=t[0].length,r=new Array(n);for(let a=0;a<n;a++){r[a]=new Array(e);for(let n=0;n<e;n++)r[a][n]=t[n][a]}return r},getMatrix(t,e,n,r){const a=new Array(e.length),i=r-n+1;for(let o=0,s=e.length;o<s;o++){a[o]=new Array(i);for(let i=n;i<=r;i++)a[o][i-n]=t[e[o]][i]}return a},getSubMatrix(t,e,n,r,a){const i=a-r+1,o=new Array(n-e+1);for(let s=e;s<=n;s++){const n=s-e;o[n]=new Array(i);for(let e=r;e<=a;e++)o[n][e-r]=t[s][e]}return o},mult(t,e){e.length!=t[0].length&&console.log("Matrix inner dimensions must agree:");for(var n=new Array(t.length),r=new Array(t[0].length),a=0;a<e[0].length;a++){for(var i=0;i<t[0].length;i++)r[i]=e[i][a];for(var o=0;o<t.length;o++){0===a&&(n[o]=new Array(e[0].length));var s=t[o],c=0;for(i=0;i<t[0].length;i++)c+=s[i]*r[i];n[o][a]=c}}return n},multScalar(t,e){const n=t.length,r=t[0].length,a=new Array(n);for(let i=0;i<n;i++){a[i]=new Array(r);for(let n=0;n<r;n++)a[i][n]=t[i][n]*e}return a},add:(t,e)=>IK(t,e,(t,e)=>t+e),sub:(t,e)=>IK(t,e,(t,e)=>t-e),inv:t=>EK.solve(t,EK.identity(t.length,t[0].length)),identity(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;const n=new Array(t);for(let r=0;r<t;r++){n[r]=new Array(e);for(let t=0;t<e;t++)n[r][t]=r===t?1:0}return n},solve:(t,e)=>t.length===t[0].length?EK.LUDecomposition(t,e):EK.QRDecomposition(t,e),LUDecomposition(t,e){for(var n=new Array(t.length),r=0;r<t.length;r++){n[r]=new Array(t[0].length);for(var a=0;a<t[0].length;a++)n[r][a]=t[r][a]}var i=t.length,o=t[0].length,s=new Array(i);for(r=0;r<i;r++)s[r]=r;var c=1,l=new Array,u=new Array(i);for(a=0;a<o;a++){for(r=0;r<i;r++)u[r]=n[r][a];for(r=0;r<i;r++){l=n[r];for(var h=Math.min(r,a),d=0,f=0;f<h;f++)d+=l[f]*u[f];l[a]=u[r]-=d}var p=a;for(r=a+1;r<i;r++)Math.abs(u[r])>Math.abs(u[p])&&(p=r);if(p!=a){for(f=0;f<o;f++){var m=n[p][f];n[p][f]=n[a][f],n[a][f]=m}f=s[p];s[p]=s[a],s[a]=f,c=-c}if(a<i&0!=n[a][a])for(r=a+1;r<i;r++)n[r][a]/=n[a][a]}e.length!=i&&console.log("Matrix row dimensions must agree.");for(a=0;a<o;a++)0===n[a][a]&&console.log("Matrix is singular.");var g=e[0].length,y=EK.getMatrix(e,s,0,g-1);for(f=0;f<o;f++)for(r=f+1;r<o;r++)for(a=0;a<g;a++)y[r][a]-=y[f][a]*n[r][f];for(f=o-1;f>=0;f--){for(a=0;a<g;a++)y[f][a]/=n[f][f];for(r=0;r<f;r++)for(a=0;a<g;a++)y[r][a]-=y[f][a]*n[r][f]}return y},QRDecomposition(t,e){for(var n=new Array(t.length),r=0;r<t.length;r++){n[r]=new Array(t[0].length);for(var a=0;a<t[0].length;a++)n[r][a]=t[r][a]}for(var i,o=t.length,s=t[0].length,c=new Array(s),l=0;l<s;l++){i=0;for(r=l;r<o;r++)i=Math.hypot(i,n[r][l]);if(0!=i){n[l][l]<0&&(i=-i);for(r=l;r<o;r++)n[r][l]/=i;n[l][l]+=1;for(a=l+1;a<s;a++){var u=0;for(r=l;r<o;r++)u+=n[r][l]*n[r][a];u=-u/n[l][l];for(r=l;r<o;r++)n[r][a]+=u*n[r][l]}}c[l]=-i}e.length!=o&&console.log("Matrix row dimensions must agree.");for(a=0;a<s;a++)0===c[a]&&console.log("Matrix is rank deficient");var h=e[0].length,d=new Array(e.length);for(r=0;r<e.length;r++)d[r]=new Array(e[0].length);for(r=0;r<e.length;r++)for(a=0;a<e[0].length;a++)d[r][a]=e[r][a];for(l=0;l<s;l++)for(a=0;a<h;a++){for(u=0,r=l;r<o;r++)u+=n[r][l]*d[r][a];u=-u/n[l][l];for(r=l;r<o;r++)d[r][a]+=u*n[r][l]}for(l=s-1;l>=0;l--){for(a=0;a<h;a++)d[l][a]/=c[l];for(r=0;r<l;r++)for(a=0;a<h;a++)d[r][a]-=d[l][a]*n[r][l]}return EK.getSubMatrix(d,0,s-1,0,h-1)}},NK=EK,CK={};CK.Eye=function(t,e,n,r,a){this.patch=t,this.imagex=e,this.imagey=n,this.width=r,this.height=a},CK.getEyeFeats=function(t){let e=t=>{let e=this.resizeEye(t,10,6),n=this.grayscale(e.data,e.width,e.height),r=[];return this.equalizeHistogram(n,5,r),r};return"left"==webgazer.params.trackEye?e(t.left):"right"==webgazer.params.trackEye?e(t.right):[].concat(e(t.left),e(t.right))},CK.DataWindow=function(t,e){this.data=[],this.windowSize=t,this.index=0,this.length=0,e&&(this.data=e.slice(e.length-t,e.length),this.length=this.data.length)},CK.DataWindow.prototype.push=function(t){return this.data.length<this.windowSize?(this.data.push(t),this.length=this.data.length,this):(this.data[this.index]=t,this.index=(this.index+1)%this.windowSize,this)},CK.DataWindow.prototype.get=function(t){return this.data[this.getTrueIndex(t)]},CK.DataWindow.prototype.getTrueIndex=function(t){return this.data.length<this.windowSize?t:(t+this.index)%this.windowSize},CK.DataWindow.prototype.addAll=function(t){for(var e=0;e<t.length;e++)this.push(t[e])},CK.grayscale=function(t,e,n){for(var r=new Uint8ClampedArray(t.length>>2),a=0,i=0,o=0;o<n;o++)for(var s=0;s<e;s++){var c=.299*t[i]+.587*t[i+1]+.114*t[i+2];r[a++]=c,i+=4}return r},CK.equalizeHistogram=function(t,e,n){var r=t.length;n||(n=t),e||(e=5);for(var a=Array(256).fill(0),i=0;i<r;i+=e)++a[t[i]];var o=255*e/r,s=0;for(i=0;i<256;++i){var c=a[i];s=c+=s,a[i]=c*o}for(i=0;i<r;++i)n[i]=a[t[i]];return n},CK.threshold=function(t,e){for(let n=0;n<t.length;n++)t[n]=t[n]>e?255:0;return t},CK.correlation=function(t,e){const n=Math.min(t.length,e.length);let r=0;for(let a=0;a<n;a++)t[a]===e[a]&&r++;return r/Math.max(t.length,e.length)},CK.resizeEye=function(t,e,n){var r=document.createElement("canvas");r.width=t.width,r.height=t.height,r.getContext("2d").putImageData(t.patch,0,0);var a=document.createElement("canvas");return a.width=e,a.height=n,a.getContext("2d").drawImage(r,0,0,r.width,r.height,0,0,e,n),a.getContext("2d").getImageData(0,0,e,n)},CK.bound=function(t){t.x<0&&(t.x=0),t.y<0&&(t.y=0);var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),n=Math.max(document.documentElement.clientHeight,window.innerHeight||0);return t.x>e&&(t.x=e),t.y>n&&(t.y=n),t},CK.DebugBox=function(t){var e;this.para=document.createElement("p"),this.div=document.createElement("div"),this.div.appendChild(this.para),document.body.appendChild(this.div),this.buttons={},this.canvas={},this.stats={},e=this,setInterval(function(){!function(t,e){var n="";for(var r in e)n+=r+": "+e[r]+"\n";t.innerText=n}(e.para,e.stats)},t||300)},CK.DebugBox.prototype.set=function(t,e){this.stats[t]=e},CK.DebugBox.prototype.inc=function(t,e,n){this.stats[t]||(this.stats[t]=n||0),this.stats[t]+=e||1},CK.DebugBox.prototype.addButton=function(t,e){this.buttons[t]||(this.buttons[t]=document.createElement("button"),this.div.appendChild(this.buttons[t]));var n=this.buttons[t];this.buttons[t]=n,n.addEventListener("click",e),n.innerText=t},CK.DebugBox.prototype.show=function(t,e){this.canvas[t]||(this.canvas[t]=document.createElement("canvas"),this.div.appendChild(this.canvas[t]));var n=this.canvas[t];n.getContext("2d").clearRect(0,0,n.width,n.height),e(n)};const AK=CK,RK={InitRegression:function(){var t=700;this.ridgeParameter=Math.pow(10,-5),this.errorXArray=new AK.DataWindow(t),this.errorYArray=new AK.DataWindow(t),this.screenXClicksArray=new AK.DataWindow(t),this.screenYClicksArray=new AK.DataWindow(t),this.eyeFeaturesClicks=new AK.DataWindow(t),this.trailTime=1e3,this.trailDataWindow=this.trailTime/Lq.moveTickSize,this.screenXTrailArray=new AK.DataWindow(10),this.screenYTrailArray=new AK.DataWindow(10),this.eyeFeaturesTrail=new AK.DataWindow(10),this.trailTimes=new AK.DataWindow(10),this.dataClicks=new AK.DataWindow(t),this.dataTrail=new AK.DataWindow(10);var e=[[1/4,0,.5,0],[0,1/4,0,.5],[.5,0,1,0],[0,.5,0,1]];e=NK.multScalar(e,.1);var n=NK.multScalar(NK.identity(2),47),r=NK.multScalar(NK.identity(4),1e-4);this.kalman=new RK.KalmanFilter([[1,0,1,0],[0,1,0,1],[0,0,1,0],[0,0,0,1]],[[1,0,0,0],[0,1,0,0]],e,n,r,[[500],[500],[0],[0]])},KalmanFilter:function(t,e,n,r,a,i){this.F=t,this.Q=n,this.H=e,this.R=r,this.P=a,this.X=i}};RK.KalmanFilter.prototype.update=function(t){for(var{add:e,sub:n,mult:r,inv:a,identity:i,transpose:o}=NK,s=r(this.F,this.X),c=e(r(r(this.F,this.P),o(this.F)),this.Q),l=n(t=o([t]),r(this.H,s)),u=e(r(r(this.H,c),o(this.H)),this.R),h=r(c,r(o(this.H),a(u))),d=0;d<l.length;d++)l[d]=[l[d]];return this.X=e(s,r(h,l)),this.P=r(n(i(h.length),r(h,this.H)),c),o(r(this.H,this.X))[0]},RK.ridge=function(t,e,n){var r=e[0].length,a=new Array(r),i=NK.transpose(e),o=new Array,s=!0;do{for(var c=NK.mult(i,e),l=0;l<r;l++)c[l][l]=c[l][l]+n;var u=NK.mult(i,t);for(l=0;l<r;l++)a[l]=u[l][0];try{var h=0!==a.length?a.length/a.length:0;a.length*h!==a.length&&console.log("Array length must be a multiple of m"),o=NK.solve(c,u);for(l=0;l<r;l++)a[l]=o[l];s=!0}catch(d){n*=10,console.log(d),s=!1}}while(!s);return a},RK.setData=function(t){for(var e=0;e<t.length;e++){var n=new Uint8ClampedArray(t[e].eyes.left.patch.data),r=new Uint8ClampedArray(t[e].eyes.right.patch.data);t[e].eyes.left.patch=new ImageData(n,t[e].eyes.left.width,t[e].eyes.left.height),t[e].eyes.right.patch=new ImageData(r,t[e].eyes.right.width,t[e].eyes.right.height),this.addData(t[e].eyes,t[e].screenPos,t[e].type)}},RK.getCurrentFixationIndex=function(){for(var t=this.screenXTrailArray.get(0),e=this.screenYTrailArray.get(0),n=this.screenXTrailArray.length-1;n>=0;n--){var r=this.screenXTrailArray.get(n),a=this.screenYTrailArray.get(n);if(Math.sqrt(Math.pow(r-t,2)+Math.pow(a-e,2))>72)return n+1}return n},RK.addData=function(t,e,n){t&&("click"===n?(this.screenXClicksArray.push([e[0]]),this.screenYClicksArray.push([e[1]]),this.eyeFeaturesClicks.push(AK.getEyeFeats(t)),this.dataClicks.push({eyes:t,screenPos:e,type:n})):"move"===n&&(this.screenXTrailArray.push([e[0]]),this.screenYTrailArray.push([e[1]]),this.eyeFeaturesTrail.push(AK.getEyeFeats(t)),this.trailTimes.push(performance.now()),this.dataTrail.push({eyes:t,screenPos:e,type:n})))};const OK=RK,DK={RidgeReg:function(){this.init()}};DK.RidgeReg.prototype.init=OK.InitRegression,DK.RidgeReg.prototype.addData=OK.addData,DK.RidgeReg.prototype.predict=function(t){if(!t||0===this.eyeFeaturesClicks.length)return null;for(var e=performance.now()-this.trailTime,n=[],r=[],a=[],i=0;i<this.trailDataWindow;i++)this.trailTimes.get(i)>e&&(n.push(this.screenXTrailArray.get(i)),r.push(this.screenYTrailArray.get(i)),a.push(this.eyeFeaturesTrail.get(i)));var o=this.screenXClicksArray.data.concat(n),s=this.screenYClicksArray.data.concat(r),c=this.eyeFeaturesClicks.data.concat(a),l=OK.ridge(o,c,this.ridgeParameter),u=OK.ridge(s,c,this.ridgeParameter),h=AK.getEyeFeats(t),d=0;for(i=0;i<h.length;i++)d+=h[i]*l[i];var f=0;for(i=0;i<h.length;i++)f+=h[i]*u[i];if(d=Math.floor(d),f=Math.floor(f),Lq.applyKalmanFilter){var p=[d,f];return{x:(p=this.kalman.update(p))[0],y:p[1]}}return{x:d,y:f}},DK.RidgeReg.prototype.setData=OK.setData,DK.RidgeReg.prototype.getData=function(){return this.dataClicks.data},DK.RidgeReg.prototype.name="ridge";const MK=DK,FK={RidgeWeightedReg:function(){this.init()}};FK.RidgeWeightedReg.prototype.init=OK.InitRegression,FK.RidgeWeightedReg.prototype.addData=OK.addData,FK.RidgeWeightedReg.prototype.predict=function(t){if(!t||0===this.eyeFeaturesClicks.length)return null;for(var e=performance.now()-this.trailTime,n=[],r=[],a=[],i=0;i<this.trailDataWindow;i++)this.trailTimes.get(i)>e&&(n.push(this.screenXTrailArray.get(i)),r.push(this.screenYTrailArray.get(i)),a.push(this.eyeFeaturesTrail.get(i)));var o=this.eyeFeaturesClicks.data.length,s=Array(o),c=Array(o),l=Array(o);for(i=0;i<o;i++){for(var u=Math.sqrt(1/(o-i)),h=this.eyeFeaturesClicks.getTrueIndex(i),d=0;d<this.eyeFeaturesClicks.data[h].length;d++){var f=this.eyeFeaturesClicks.data[h][d]*u;void 0!==s[h]?s[h].push(f):s[h]=[f]}c[i]=this.screenXClicksArray.get(i).slice(0,this.screenXClicksArray.get(i).length),l[i]=this.screenYClicksArray.get(i).slice(0,this.screenYClicksArray.get(i).length),c[i][0]=c[i][0]*u,l[i][0]=l[i][0]*u}var p=c.concat(n),m=l.concat(r),g=s.concat(a),y=OK.ridge(p,g,this.ridgeParameter),v=OK.ridge(m,g,this.ridgeParameter),b=AK.getEyeFeats(t),w=0;for(i=0;i<b.length;i++)w+=b[i]*y[i];var x=0;for(i=0;i<b.length;i++)x+=b[i]*v[i];if(w=Math.floor(w),x=Math.floor(x),Lq.applyKalmanFilter){var k=[w,x];return{x:(k=this.kalman.update(k))[0],y:k[1]}}return{x:w,y:x}},FK.RidgeWeightedReg.prototype.setData=OK.setData,FK.RidgeWeightedReg.prototype.getData=function(){return this.dataClicks.data},FK.RidgeWeightedReg.prototype.name="ridgeWeighted";const PK=FK,LK={};Math.pow(10,-5);var zK=700,BK={X:[0],Y:[0]};LK.RidgeRegThreaded=function(){this.init()},LK.RidgeRegThreaded.prototype.init=function(){this.screenXClicksArray=new AK.DataWindow(zK),this.screenYClicksArray=new AK.DataWindow(zK),this.eyeFeaturesClicks=new AK.DataWindow(zK),this.screenXTrailArray=new AK.DataWindow(10),this.screenYTrailArray=new AK.DataWindow(10),this.eyeFeaturesTrail=new AK.DataWindow(10),this.dataClicks=new AK.DataWindow(zK),this.dataTrail=new AK.DataWindow(zK),this.worker||(this.worker=new Worker("ridgeWorker.mjs"),this.worker.onerror=function(t){console.log(t.message)},this.worker.onmessage=function(t){BK.X=t.data.X,BK.Y=t.data.Y},console.log("initialized worker"));var t=[[1/4,0,.5,0],[0,1/4,0,.5],[.5,0,1,0],[0,.5,0,1]];t=NK.multScalar(t,.1);var e=NK.multScalar(NK.identity(2),47),n=NK.multScalar(NK.identity(4),1e-4);this.kalman=new OK.KalmanFilter([[1,0,1,0],[0,1,0,1],[0,0,1,0],[0,0,0,1]],[[1,0,0,0],[0,1,0,0]],t,e,n,[[500],[500],[0],[0]])},LK.RidgeRegThreaded.prototype.addData=function(t,e,n){t&&this.worker.postMessage({eyes:AK.getEyeFeats(t),screenPos:e,type:n})},LK.RidgeRegThreaded.prototype.predict=function(t){if(!t)return null;for(var e=BK.X,n=BK.Y,r=AK.getEyeFeats(t),a=0,i=0,o=0;o<r.length;o++)a+=r[o]*e[o],i+=r[o]*n[o];if(a=Math.floor(a),i=Math.floor(i),Lq.applyKalmanFilter){var s=[a,i];return{x:(s=this.kalman.update(s))[0],y:s[1]}}return{x:a,y:i}},LK.RidgeRegThreaded.prototype.setData=OK.setData,LK.RidgeRegThreaded.prototype.getData=function(){return this.dataClicks.data},LK.RidgeRegThreaded.prototype.name="ridge";const jK=LK,UK={tracker:{}};UK.tracker.TFFaceMesh=TK,UK.reg=MK,UK.reg.RidgeWeightedReg=PK.RidgeWeightedReg,UK.reg.RidgeRegThreaded=jK.RidgeRegThreaded,UK.util=AK,UK.params=Lq;var VK=null,WK=null,GK=null,HK=null,qK=null,KK=null,XK=null,YK="",QK=new Array(50),JK=new Array(50),$K=performance.now(),ZK=null,tX=null,eX=!1,nX=function(t,e){},rX=nX,aX=["click","move"],iX=performance.now(),oX=new UK.tracker.TFFaceMesh,sX=[new UK.reg.RidgeReg],cX={TFFacemesh:function(){return new UK.tracker.TFFaceMesh}},lX={ridge:function(){return new UK.reg.RidgeReg},weightedRidge:function(){return new UK.reg.RidgeWeightedReg},threadedRidge:function(){return new UK.reg.RidgeRegThreaded}},uX="webgazerGlobalData",hX="webgazerGlobalSettings",dX={},fX=[],pX={data:[],settings:{}};async function mX(t){var e=[];if(ZK=await function(t,e,n){if(t)try{return oX.getEyePatches(GK,t,e,n)}catch(Hrt){return console.log("can't get pupil features ",Hrt),null}}(HK,HK.width,HK.height),0===sX.length)return console.log("regression not set, call setRegression()"),null;for(var n in sX)e.push(sX[n].predict(ZK));return void 0!==t?null===e[t]?null:{x:e[t].x,y:e[t].y,eyeFeatures:ZK}:0===e.length||null===e[0]?null:{x:e[0].x,y:e[0].y,eyeFeatures:ZK,all:e}}UK.computeValidationBoxSize=function(){var t=GK.videoWidth,e=GK.videoHeight,n=parseInt(GK.style.width),r=parseInt(GK.style.height),a=Math.min(t,e),i=t==Math.max(t,e)?n/t:r/e,o=a*UK.params.faceFeedbackBoxRatio*i;return[(r-o)/2,(n-o)/2,o,o]};var gX=new AK.DataWindow(4),yX=0;async function vX(){if(!eX){s=HK,c=HK.width,l=HK.height,s.width!=c&&(s.width=c),s.height!=l&&(s.height=l),s.getContext("2d").drawImage(GK,0,0,s.width,s.height),tX=mX();var t=performance.now()-$K;if(UK.params.showFaceOverlay){var e=UK.getTracker();qK.getContext("2d").clearRect(0,0,GK.videoWidth,GK.videoHeight),e.drawFaceOverlay(qK.getContext("2d"),e.getPositions())}if(UK.params.showFaceFeedbackBox&&function(){if(null!=KK&&ZK){var t=GK.videoWidth,e=GK.videoHeight,n=Math.min(t,e)*UK.params.faceFeedbackBoxRatio,r=(e-n)/2,a=(t-n)/2,i=a+n,o=r+n,s=ZK.left.imagex,c=ZK.left.imagey,l=ZK.right.imagex,u=ZK.right.imagey,h=!1,d=!1;s>a&&s+ZK.left.width<i&&l>a&&l+ZK.right.width<i&&(h=!0),c>r&&c+ZK.left.height<o&&u>r&&u+ZK.right.height<o&&(d=!0),KK.style.border=h&&d?"solid green":"solid red"}else KK.style.border="solid black"}(),tX=await tX,rX(tX,t),tX){gX.push(tX);var n=0,r=0,a=gX.length;for(var i in gX.data)n+=gX.get(i).x,r+=gX.get(i).y;var o=AK.bound({x:n/a,y:r/a});UK.params.storingPoints&&(!function(t,e,n){var r=document.getElementById("plotting_canvas").getContext("2d");r.fillStyle=t,r.beginPath(),r.arc(e,n,5,0,2*Math.PI,!0),r.fill()}("blue",o.x,o.y),UK.storePoints(o.x,o.y,yX),50==++yX&&(yX=0)),UK.params.showGazeDot&&(XK.style.display="block"),XK.style.transform="translate3d("+o.x+"px,"+o.y+"px,0)"}else XK.style.display="none";requestAnimationFrame(vX)}var s,c,l}var bX=function(t,e,n){if(!eX){if(0===sX.length)return console.log("regression not set, call setRegression()"),null;for(var r in sX)ZK&&sX[r].addData(ZK,[t,e],n)}},wX=async function(t){bX(t.clientX,t.clientY,aX[0]),UK.params.saveDataAcrossSessions&&await async function(){var t=sX[0].getData()||fX;zq.setItem(hX,dX),zq.setItem(uX,t)}()},xX=function(t){if(!eX){var e=performance.now();e<iX+UK.params.moveTickSize||(iX=e,bX(t.clientX,t.clientY,aX[1]))}},kX=function(){document.addEventListener("click",wX,!0),document.addEventListener("mousemove",xX,!0)};async function _X(t){VK=t,(WK=document.createElement("div")).id=UK.params.videoContainerId,WK.style.position="fixed",WK.style.top="0px",WK.style.left="0px",WK.style.width=UK.params.videoViewerWidth+"px",WK.style.height=UK.params.videoViewerHeight+"px",SX(WK),(GK=document.createElement("video")).setAttribute("playsinline",""),GK.id=UK.params.videoElementId,GK.srcObject=t,GK.autoplay=!0,GK.style.position="absolute",GK.style.width=UK.params.videoViewerWidth+"px",GK.style.height=UK.params.videoViewerHeight+"px",SX(GK),(HK=document.createElement("canvas")).id=UK.params.videoElementCanvasId,HK.style.display="none",(qK=document.createElement("canvas")).id=UK.params.faceOverlayId,qK.style.display=UK.params.showFaceOverlay?"block":"none",qK.style.position="absolute",UK.params.mirrorVideo&&(GK.style.setProperty("-moz-transform","scale(-1, 1)"),GK.style.setProperty("-webkit-transform","scale(-1, 1)"),GK.style.setProperty("-o-transform","scale(-1, 1)"),GK.style.setProperty("transform","scale(-1, 1)"),GK.style.setProperty("filter","FlipH"),qK.style.setProperty("-moz-transform","scale(-1, 1)"),qK.style.setProperty("-webkit-transform","scale(-1, 1)"),qK.style.setProperty("-o-transform","scale(-1, 1)"),qK.style.setProperty("transform","scale(-1, 1)"),qK.style.setProperty("filter","FlipH")),(KK=document.createElement("canvas")).id=UK.params.faceFeedbackBoxId,KK.style.display=UK.params.showFaceFeedbackBox?"block":"none",KK.style.border="solid",KK.style.position="absolute",(XK=document.createElement("div")).id=UK.params.gazeDotId,XK.style.display=UK.params.showGazeDot?"block":"none",XK.style.position="fixed",XK.style.zIndex=99999,XK.style.left="-5px",XK.style.top="-5px",XK.style.background="red",XK.style.borderRadius="100%",XK.style.opacity="0.7",XK.style.width="10px",XK.style.height="10px",WK.appendChild(GK),document.body.appendChild(WK);const e=new Promise(t=>{GK.addEventListener("loadeddata",function e(n){TX(GK.videoWidth,GK.videoHeight),UK.setVideoViewerSize(UK.params.videoViewerWidth,UK.params.videoViewerHeight),WK.appendChild(HK),WK.appendChild(qK),WK.appendChild(KK),document.body.appendChild(XK),n.target.removeEventListener(n.type,e),t()})});kX(),eX=!1,$K=performance.now(),await e,await vX()}function SX(t){navigator.vendor&&navigator.vendor.indexOf("Apple")>-1?(t.style.opacity=UK.params.showVideo?"1":"0",t.style.display="block"):t.style.display=UK.params.showVideo?"block":"none"}function TX(t,e){HK&&(HK.width=t,HK.height=e),qK&&(qK.width=t,qK.height=e)}UK.begin=function(t){return"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&window.chrome&&alert("WebGazer works only over https. If you are doing local development, you need to run a local server."),UK.params.saveDataAcrossSessions&&async function(){dX=(dX=await zq.getItem(hX))||pX;var t=await zq.getItem(uX);for(var e in fX=t=t||pX,sX)sX[e].setData(t);console.log("loaded stored data into regression model")}(),t=t||function(){console.log("No stream")},YK?(_X(YK),UK):(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){var e=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return e?new Promise(function(n,r){e.call(navigator,t,n,r)}):Promise.reject(new Error("Unfortunately, your browser does not support access to the webcam through the getUserMedia API. Try to use the latest version of Google Chrome, Mozilla Firefox, Opera, or Microsoft Edge instead."))}),new Promise(async(e,n)=>{let r;try{r=await navigator.mediaDevices.getUserMedia(UK.params.camConstraints),await _X(r),e(UK)}catch(Hrt){t(),GK=null,r=null,n(Hrt)}}))},UK.isReady=function(){return null!==HK&&HK.width>0},UK.pause=function(){return eX=!0,UK},UK.resume=async function(){return eX?(eX=!1,await vX(),UK):UK},UK.end=function(){return eX=!0,WK.remove(),XK.remove(),UK},UK.stopVideo=function(){return VK.getTracks()[0].stop(),WK.removeChild(qK),WK.removeChild(KK),UK},UK.detectCompatibility=function(){return void 0!==(navigator.mediaDevices.getUserMedia||navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia)},UK.showVideoPreview=function(t){return UK.params.showVideoPreview=t,UK.showVideo(t&&UK.params.showVideo),UK.showFaceOverlay(t&&UK.params.showFaceOverlay),UK.showFaceFeedbackBox(t&&UK.params.showFaceFeedbackBox),UK},UK.showVideo=function(t){return UK.params.showVideo=t,GK&&SX(GK),WK&&SX(WK),UK},UK.showFaceOverlay=function(t){return UK.params.showFaceOverlay=t,qK&&(qK.style.display=t?"block":"none"),UK},UK.showFaceFeedbackBox=function(t){return UK.params.showFaceFeedbackBox=t,KK&&(KK.style.display=t?"block":"none"),UK},UK.showPredictionPoints=function(t){return UK.params.showGazeDot=t,XK&&(XK.style.display=t?"block":"none"),UK},UK.saveDataAcrossSessions=function(t){return UK.params.saveDataAcrossSessions=t,UK},UK.applyKalmanFilter=function(t){return UK.params.applyKalmanFilter=t,UK},UK.setCameraConstraints=async function(t){var e,n;if(UK.params.camConstraints=t,VK){UK.pause(),e=VK.getVideoTracks()[0];try{await e.applyConstraints(UK.params.camConstraints),TX((n=e.getSettings()).width,n.height)}catch(Hrt){return void console.log(Hrt)}UK.setVideoViewerSize(UK.params.videoViewerWidth,UK.params.videoViewerHeight),UK.getTracker().reset(),await UK.resume()}},UK.setStaticVideo=function(t){return YK=t,UK},UK.setVideoViewerSize=function(t,e){UK.params.videoViewerWidth=t,UK.params.videoViewerHeight=e,GK.style.width=t+"px",GK.style.height=e+"px",WK.style.width=t+"px",WK.style.height=e+"px",qK.style.width=t+"px",qK.style.height=e+"px";var n=UK.computeValidationBoxSize();KK.style.top=n[0]+"px",KK.style.left=n[1]+"px",KK.style.width=n[2]+"px",KK.style.height=n[3]+"px"},UK.addMouseEventListeners=function(){return kX(),UK},UK.removeMouseEventListeners=function(){return document.removeEventListener("click",wX,!0),document.removeEventListener("mousemove",xX,!0),UK},UK.recordScreenPosition=function(t,e,n){return bX(t,e,n||aX[0]),UK},UK.storePoints=function(t,e,n){QK[n]=t,JK[n]=e},UK.setTracker=function(t){if(void 0===cX[t]){for(var e in console.log("Invalid tracker selection"),console.log("Options are: "),cX)console.log(e);return UK}return oX=cX[t](),UK},UK.setRegression=function(t){if(void 0===lX[t]){for(var e in console.log("Invalid regression selection"),console.log("Options are: "),lX)console.log(e);return UK}return fX=sX[0].getData(),(sX=[lX[t]()])[0].setData(fX),UK},UK.addTrackerModule=function(t,e){cX[t]=function(){return new e}},UK.addRegressionModule=function(t,e){lX[t]=function(){return new e}},UK.addRegression=function(t){var e=lX[t]();return fX=sX[0].getData(),e.setData(fX),sX.push(e),UK},UK.setGazeListener=function(t){return rX=t,UK},UK.clearGazeListener=function(){return rX=nX,UK},UK.setVideoElementCanvas=function(t){return HK=t},UK.clearData=async function(){!function(){for(var t in zq.clear(),sX)sX[t].init()}()},UK.getTracker=function(){return oX},UK.getRegression=function(){return sX},UK.getCurrentPrediction=function(t){return mX(t)},UK.params.getEventTypes=function(){return aX.slice()},UK.getVideoElementCanvas=function(){return HK},UK.getVideoPreviewToCameraResolutionRatio=function(){return[UK.params.videoViewerWidth/GK.videoWidth,UK.params.videoViewerHeight/GK.videoHeight]},UK.getStoredPoints=function(){return[QK,JK]};const IX=UK,EX=n.p+"static/media/Prepare.12c86a203241a437d967.png";function NX(){return(0,ra.jsx)("nav",{className:"navbar navbar-expand-lg bg-body-tertiary fixed-top w-100 shadow",style:{zIndex:1e3},children:(0,ra.jsxs)("div",{className:"container-fluid",children:[(0,ra.jsxs)(Zt,{className:"navbar-brand",to:"/",children:[(0,ra.jsx)("img",{src:EX,alt:"Logo",width:"30",height:"24",class:"d-inline-block align-text-top"}),"PreBoost"]}),(0,ra.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:(0,ra.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[(0,ra.jsx)("li",{className:"nav-item",children:(0,ra.jsx)(Zt,{className:"nav-link active","aria-current":"page",to:"/home",children:"Home"})}),(0,ra.jsx)("li",{className:"nav-item",children:(0,ra.jsx)(Zt,{className:"nav-link active","aria-current":"page",to:"/About",children:"About"})}),(0,ra.jsx)("li",{className:"nav-item",children:(0,ra.jsx)(Zt,{className:"nav-link",to:"/engineering",children:"Enginnering"})}),(0,ra.jsx)("li",{className:"nav-item",children:(0,ra.jsx)(Zt,{className:"nav-link",to:"/english",children:"Learn English"})}),(0,ra.jsx)("li",{className:"nav-item",children:(0,ra.jsx)(Zt,{className:"nav-link",to:"/upsc",children:"Prepare UPSC"})})]})})]})})}window.webgazer=IX;const CX=()=>{const[t,e]=(0,C.useState)({name:"",location:"",education:"",fatherName:"",motherName:"",siblings:"",resume:null});let n=null;const[r,a]=(0,C.useState)(""),[i,o]=(0,C.useState)(!1),[s,c]=(0,C.useState)(null),[l,u]=(0,C.useState)(1),[h,d]=(0,C.useState)([]),f=(0,C.useRef)(null),[p,m]=(0,C.useState)(!1),[g,y]=(0,C.useState)(!1),[v,b]=(0,C.useState)(""),[w,x]=(0,C.useState)(!1),[k,_]=(0,C.useState)(null),[S,T]=(0,C.useState)(null),[I,E]=(0,C.useState)(0),[N,A]=(0,C.useState)(0),[R,O]=(0,C.useState)(""),{transcript:D,listening:M,resetTranscript:F,browserSupportsSpeechRecognition:P}=ta();(0,C.useEffect)(()=>{M&&(n&&clearTimeout(n),n=setTimeout(()=>{B(),console.log("Auto-stopped due to silence.")},4e3))},[D]);const L=async t=>{for(let e=0;e<5;e++){const e=(await Mr.post("".concat("http://localhost:5000","/api/engineering-question"),t)).data.question;if(!h.includes(e))return d(t=>[...t,e]),e}return"Unable to generate a unique question. Please try again later."},z=()=>{IX&&IX.setGazeListener?(IX.setGazeListener((t,e)=>{t&&console.log("Gaze at:",t.x,t.y)}).begin(),IX.showVideo(!1).showFaceOverlay(!1).showFaceFeedbackBox(!1)):console.warn("webgazer is not available.")},B=()=>{ea.stopListening();const t=Date.now();if(T(t),k){const e=(t-k)/1e3,n=D.trim().split(/\s+/).filter(Boolean).length/(e/60);A(e),E(n.toFixed(2));let r="Needs improvement";n>=90?r="Excellent fluency!":n>=80?r="Very good fluency!":n>=70?r="Good fluency!":n>=60&&(r="Good, but can improve."),O(r)}};(0,C.useEffect)(()=>{const t=()=>{if(window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end()}catch(Grt){console.warn("webgazer.end() cleanup error:",Grt)}m(!1)};return window.addEventListener("beforeunload",t),()=>{if(window.removeEventListener("beforeunload",t),window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end()}catch(Grt){console.warn("webgazer.end() cleanup error:",Grt)}m(!1)}},[]),(0,C.useEffect)(()=>{if(p){(async()=>{try{const t=await navigator.mediaDevices.getUserMedia({video:!0});f.current&&(f.current.srcObject=t)}catch(Hrt){console.error("Camera access denied or not available",Hrt)}})()}},[p]),(0,C.useEffect)(()=>{D.toLowerCase().includes("stop")&&(B(),console.log("Voice command 'stop' detected. Stopping..."))},[D]);return P?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)(NX,{}),(0,ra.jsx)(ps,{children:(0,ra.jsx)("div",{className:"container py-5",style:{marginTop:"20px",marginBottom:"20px"},children:(0,ra.jsx)(ps,{children:(0,ra.jsx)("div",{className:"card shadow-lg rounded-3 ",style:{marginTop:"50px",marginBottom:"20px"},children:(0,ra.jsxs)("div",{className:"card-body",children:[g&&(p?(0,ra.jsxs)("div",{className:"mb-4 ",children:[(0,ra.jsx)("h4",{className:"h6 fw-bold",children:" Eye Tracking Camera (Live)"}),(0,ra.jsx)("video",{ref:f,autoPlay:!0,playsInline:!0,className:"w-100 rounded border",style:{maxHeight:"220px"}}),(0,ra.jsx)("button",{className:"btn btn-danger",onClick:()=>{if(window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end(),window.webgazer.clearData(),console.log("WebGazer stopped.")}catch(Grt){console.warn("Error stopping WebGazer:",Grt)}if(f.current&&f.current.srcObject){f.current.srcObject.getTracks().forEach(t=>{try{t.stop()}catch(Grt){console.warn("Error stopping camera track:",Grt)}}),f.current.srcObject=null,console.log("Camera stopped.")}try{f.current&&(f.current.pause(),f.current.removeAttribute("src"),f.current.load())}catch(Grt){console.error("Error cleaning up video element:",Grt)}m(!1)},children:"Close Camera"})]}):(0,ra.jsx)("button",{className:"btn btn-danger",onClick:()=>{m(!0),z()},children:"Open Camera"})),!g&&(0,ra.jsx)(fs,{handleChange:n=>{const{name:r,value:a}=n.target;e(oe(oe({},t),{},{[r]:a}))},handleSubmit:async e=>{e.preventDefault(),o(!0);try{const e=new FormData;Object.entries(t).forEach(t=>{let[n,r]=t;"resume"===n&&null===r||e.append(n,r)});const n=await L(e);a(n),F(),c(null),m(!0),z(),y(!0)}catch(n){console.error("Error sending data to GPT API:",n)}o(!1)},handleFileChange:n=>{e(oe(oe({},t),{},{resume:n.target.files[0]}))},loading:i}),r&&(0,ra.jsxs)("div",{className:"mt-5 p-3 bg-light rounded border",children:[(0,ra.jsxs)("h4",{className:"h4 fw-bold mb-2",children:[" Question ",l,":"]}),(0,ra.jsx)("h2",{children:r}),!w&&(0,ra.jsx)("button",{onClick:async()=>{const t=await(async t=>{try{return(await Mr.post("".concat("http://localhost:5000","/api/engineering-question/answer"),{text:t})).data.answer}catch(e){return console.error("Error fetching AI answer:",e),"Unable to generate answer. Please try again later."}})(r);b(t),x(!0),console.log("ai answer",t)},className:"btn btn-secondary mb-3",children:"Check Answer"}),w&&(0,ra.jsxs)("div",{className:"alert alert-info mt-2",children:[(0,ra.jsx)("strong",{children:"AI Answer:"})," ",v]}),(0,ra.jsxs)("div",{className:"mt-3",children:[(0,ra.jsx)("h3",{className:"h4 fw-bold",children:" Your Answer (Voice Input)"}),(0,ra.jsx)("h2",{className:"text-secondary mb-2",children:D||"Your speech will appear here..."}),(0,ra.jsxs)("div",{className:"d-flex gap-3 mb-3",children:[(0,ra.jsxs)("div",{className:"d-flex  justifyContent-space-between ",children:[(0,ra.jsx)("button",{type:"button",onClick:()=>{F(),_(Date.now()),ea.startListening({continuous:!0})},className:"btn btn-success hover-effect",children:"Start Talking"}),(0,ra.jsx)("button",{type:"button",onClick:B,className:"btn btn-danger",style:{marginLeft:"10px"},children:"Stop"}),(0,ra.jsx)("button",{type:"button",onClick:()=>{ea&&"function"===typeof ea.stopListening&&ea.stopListening(),c(null),O(""),E(0),A(0),x(!1),b(""),_(null),T(null),F()},className:"btn btn-secondary",style:{marginLeft:"10px"},children:"Reset"})]}),(0,ra.jsx)("button",{onClick:async()=>{try{const t=await Mr.post("".concat("http://localhost:5000","/api/analyze-answer"),{text:D});c(t.data)}catch(t){console.error("Error analyzing transcript:",t)}},className:"btn btn-primary",children:"Check Analyasis"})]})]}),s&&(0,ra.jsxs)("div",{children:[(0,ra.jsx)("h4",{className:"h6 fw-bold mb-2",children:"Answer Analysis"}),(0,ra.jsxs)("div",{className:"d-flex flex-row gap-2",children:[(0,ra.jsxs)("div",{className:"mt-4 p-3 bg-warning bg-opacity-25 rounded",children:[(0,ra.jsxs)("p",{children:["Fluency Feedback: ",R]}),(0,ra.jsx)("div",{children:(0,ra.jsx)(aa,{value:I})})]}),(0,ra.jsxs)("div",{className:"mt-4 p-3 bg-warning bg-opacity-25 rounded",children:[(0,ra.jsxs)("p",{children:["Grammar Accuracy: ",s.grammar,"%"]}),(0,ra.jsx)("div",{children:(0,ra.jsx)(aa,{value:s.grammar})})]})]})]}),(0,ra.jsx)("div",{className:"text-end",children:(0,ra.jsx)("button",{onClick:async()=>{o(!0);try{const e=new FormData;Object.entries(t).forEach(t=>{let[n,r]=t;e.append(n,r)});const n=await L(e);a(n),F(),c(null),u(t=>t+1),b(""),x(!1)}catch(e){console.error("Error generating next question:",e)}o(!1)},className:"btn btn-info mt-2",children:i?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Generating..."]}):"Next Question"})})]})]})})})})})]}):(0,ra.jsx)("span",{children:"Your browser does not support speech recognition."})},AX=t=>{let{children:e}=t;const n=(0,C.useRef)(null);return(0,C.useEffect)(()=>{if(window.VANTA&&window.VANTA.BIRDS&&n.current){const t=window.VANTA.BIRDS({el:n.current,mouseControls:!0,touchControls:!0,gyroControls:!1,minHeight:200,minWidth:200,scale:1,scaleMobile:1,backgroundColor:13624063,backgroundAlpha:1,color1:16711680,color2:53759,colorMode:"varianceGradient",quantity:5,birdSize:1,wingSpan:30,speedLimit:5,separation:20,alignment:20,cohesion:20});return()=>{t&&t.destroy&&t.destroy()}}},[]),(0,ra.jsx)("div",{ref:n,style:{width:"100vw",height:"100vh",position:"relative"},children:(0,ra.jsx)("div",{style:{position:"relative",zIndex:1},children:e})})};function RX(){return(0,ra.jsx)(ra.Fragment,{children:(0,ra.jsxs)(AX,{children:[(0,ra.jsx)("div",{children:(0,ra.jsx)(NX,{})}),(0,ra.jsx)("h3",{className:"text-4xl font-bold text-center mb-10 text-dark",children:" Check Your Level?"}),(0,ra.jsx)("div",{className:"row justify-content-center  rounded-4 border p-4  w-20",children:(0,ra.jsx)("div",{className:"col-md-2 mb-1",children:(0,ra.jsx)(Zt,{to:"/checking",className:"text-decoration-none text-dark",children:(0,ra.jsx)("div",{className:"card h-100 shadow-sm rounded-3 hover-shadow",children:(0,ra.jsx)("div",{className:"card-body text-center",children:(0,ra.jsx)("h5",{className:"card-title",children:"Check Your Level"})})})})})}),(0,ra.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 to-purple-200 flex flex-col items-center justify-center p-10",children:[(0,ra.jsx)("h1",{className:"text-4xl font-bold text-center mb-10 text-dark",children:" Choose Your Level?"}),(0,ra.jsx)("div",{className:"container my-5",children:(0,ra.jsxs)("div",{className:"row justify-content-center shadow-lg rounded-4 border p-4 bg-white",children:[(0,ra.jsx)("div",{className:"col-md-4 mb-4",children:(0,ra.jsx)(Zt,{to:"/Beginner",className:"text-decoration-none text-dark",children:(0,ra.jsx)("div",{className:"card h-100 shadow-sm rounded-3 hover-shadow",children:(0,ra.jsx)("div",{className:"card-body text-center",children:(0,ra.jsx)("h5",{className:"card-title",children:"Beginner"})})})})}),(0,ra.jsx)("div",{className:"col-md-4 mb-4",children:(0,ra.jsx)(Zt,{to:"/Intermediate",className:"text-decoration-none text-dark",children:(0,ra.jsx)("div",{className:"card h-100 shadow-sm rounded-3 hover-shadow",children:(0,ra.jsx)("div",{className:"card-body text-center",children:(0,ra.jsx)("h5",{className:"card-title",children:"InterMediate"})})})})}),(0,ra.jsx)("div",{className:"col-md-4 mb-4",children:(0,ra.jsx)(Zt,{to:"/Expert",className:"text-decoration-none text-dark",children:(0,ra.jsx)("div",{className:"card h-100 shadow-sm rounded-3 hover-shadow",children:(0,ra.jsx)("div",{className:"card-body text-center",children:(0,ra.jsx)("h5",{className:"card-title",children:" Expert"})})})})})]})})]})]})})}function OX(){return(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)(NX,{}),(0,ra.jsx)("div",{className:"d-flex justify-content-center align-item-center",children:(0,ra.jsx)("h1",{children:"Coming Soon..."})})]})}function DX(){return(0,ra.jsx)(ra.Fragment,{children:(0,ra.jsxs)(AX,{children:[(0,ra.jsx)("div",{children:(0,ra.jsx)(NX,{})}),(0,ra.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-100 to-purple-200 flex flex-col items-center justify-center p-10",children:[(0,ra.jsx)("h1",{className:"text-4xl font-bold text-center mb-10 text-dark",children:"\ud83c\udf93 Student AI Interview Preparation"}),(0,ra.jsx)("div",{className:"container my-5",children:(0,ra.jsxs)("div",{className:"row justify-content-center shadow-lg rounded-4 border p-4 bg-white",children:[(0,ra.jsx)("div",{className:"col-md-4 mb-4",children:(0,ra.jsx)(Zt,{to:"/engineering",className:"text-decoration-none text-dark",children:(0,ra.jsx)("div",{className:"card h-100 shadow-sm rounded-3 hover-shadow",children:(0,ra.jsxs)("div",{className:"card-body text-center",children:[(0,ra.jsx)("h5",{className:"card-title",children:" Engineering"}),(0,ra.jsx)("p",{className:"card-text",children:"AI Interview Questions + Voice Analysis"})]})})})}),(0,ra.jsx)("div",{className:"col-md-4 mb-4",children:(0,ra.jsx)(Zt,{to:"/english",className:"text-decoration-none text-dark",children:(0,ra.jsx)("div",{className:"card h-100 shadow-sm rounded-3 hover-shadow",children:(0,ra.jsxs)("div",{className:"card-body text-center",children:[(0,ra.jsx)("h5",{className:"card-title",children:" English Learning"}),(0,ra.jsx)("p",{className:"card-text",children:"Practice Basic English with AI"})]})})})}),(0,ra.jsx)("div",{className:"col-md-4 mb-4",children:(0,ra.jsx)(Zt,{to:"/upsc",className:"text-decoration-none text-dark",children:(0,ra.jsx)("div",{className:"card h-100 shadow-sm rounded-3 hover-shadow",children:(0,ra.jsxs)("div",{className:"card-body text-center",children:[(0,ra.jsx)("h5",{className:"card-title",children:" UPSC Section"}),(0,ra.jsx)("p",{className:"card-text",children:"Essay, MCQs and Practice Questions"})]})})})})]})})]})]})})}window.webgazer=IX;const MX=()=>{const t=(0,C.useRef)(null),[e,n]=(0,C.useState)({name:"",location:"",education:"",fatherName:"",motherName:"",siblings:"",resume:null});let r=null;const[a,i]=(0,C.useState)(""),[o,s]=(0,C.useState)(!1),[c,l]=(0,C.useState)(null),[u,h]=(0,C.useState)(1),[d,f]=(0,C.useState)([]),p=(0,C.useRef)(null),[m,g]=(0,C.useState)(!1),[y,v]=(0,C.useState)(!1),[b,w]=(0,C.useState)(""),[x,k]=(0,C.useState)(!1),[_,S]=(0,C.useState)(null),[T,I]=(0,C.useState)(null),[E,N]=(0,C.useState)(0),[A,R]=(0,C.useState)(0),[O,D]=(0,C.useState)(""),[M,F]=(0,C.useState)(null),{transcript:P,listening:L,resetTranscript:z,browserSupportsSpeechRecognition:B}=ta();(0,C.useEffect)(()=>{var e;(m||a)&&(null===(e=t.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))},[m,a]);const j=async()=>{for(let t=0;t<5;t++){const t=(await Mr.get("".concat("http://localhost:5000","/api/questioncheck"))).data.question;if(!d.includes(t))return f(e=>[...e,t]),t}return"Unable to generate a unique question. Please try again later."};(0,C.useEffect)(()=>{L&&(r&&clearTimeout(r),r=setTimeout(()=>{U(),console.log("Auto-stopped due to silence.")},4e3))},[P]);const U=()=>{ea.stopListening();const t=Date.now();if(I(t),_){const e=(t-_)/1e3,n=P.trim().split(/\s+/).filter(Boolean).length/(e/60);R(e),N(n.toFixed(2));let r="Needs improvement";n>=90?r="Excellent fluency!":n>=80?r="Very good fluency!":n>=70?r="Good fluency!":n>=60&&(r="Good, but can improve."),D(r)}};(0,C.useEffect)(()=>{const t=()=>{if(window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end()}catch(Grt){console.warn("webgazer.end() cleanup error:",Grt)}g(!1)};return window.addEventListener("beforeunload",t),()=>{if(window.removeEventListener("beforeunload",t),window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end()}catch(Grt){console.warn("webgazer.end() cleanup error:",Grt)}g(!1)}},[]),(0,C.useEffect)(()=>{if(m){(async()=>{try{const t=await navigator.mediaDevices.getUserMedia({video:!0});p.current&&(p.current.srcObject=t)}catch(Hrt){console.error("Camera access denied or not available",Hrt)}})()}},[m]),(0,C.useEffect)(()=>{P.toLowerCase().includes("stop")&&(U(),console.log("Voice command 'stop' detected. Stopping..."))},[P]),(0,C.useEffect)(()=>{M&&(alert("Failed to Generate"),F(""))},[M]);return B?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)(NX,{}),(0,ra.jsxs)(ps,{children:[(0,ra.jsx)("div",{className:"container",style:{marginTop:"20px",marginBottom:"50px"},children:(0,ra.jsx)(ps,{children:(0,ra.jsx)("div",{className:"card shadow-lg rounded-3",style:{marginTop:"100px"},children:(0,ra.jsxs)("div",{className:"card-body",children:[y&&m&&(0,ra.jsxs)("div",{className:"mb-4 ",children:[(0,ra.jsx)("h4",{className:"h6 fw-bold",children:"\ud83d\udcf7 Eye Tracking Camera (Live)"}),(0,ra.jsx)("video",{ref:p,autoPlay:!0,playsInline:!0,className:"w-100 rounded border",style:{maxHeight:"220px"}}),(0,ra.jsx)("button",{className:"btn btn-danger",onClick:()=>{if(window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.isReady()&&(window.webgazer.end(),window.webgazer.clearData(),console.log("WebGazer successfully stopped"))}catch(Grt){console.warn("Error stopping WebGazer:",Grt)}if(p.current&&p.current.srcObject){p.current.srcObject.getTracks().forEach(t=>{try{t.stop()}catch(Grt){console.warn("Error stopping camera track:",Grt)}}),p.current.srcObject=null,console.log("Camera stopped.")}g(!1)},children:"Close Camera"})]}),!y&&(0,ra.jsxs)("div",{className:"d-flex flex-column justify-content-center align-items-center vh-100",children:[(0,ra.jsx)("h2",{className:"card-title mb-4",children:"Click Below To Check"}),(0,ra.jsx)("button",{onClick:async t=>{t.preventDefault(),s(!0),F(null);try{const t=await j();i(t),z(),l(null),g(!0),IX&&IX.setGazeListener?(IX.setGazeListener((t,e)=>{t&&console.log("Gaze at:",t.x,t.y)}).begin(),IX.showVideo(!1).showFaceOverlay(!1).showFaceFeedbackBox(!1)):console.warn("webgazer is not available."),v(!0)}catch(M){F(M),console.error("Error sending data to GPT API:",M)}s(!1)},className:"btn btn-primary btn-lg fw-bold px-4 py-2 shadow",style:{transition:"transform 0.3s ease, background-color 0.3s ease"},onMouseOver:t=>t.target.style.transform="scale(1.05)",onMouseOut:t=>t.target.style.transform="scale(1)",children:o?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Generating..."]}):"Let's Check"})]}),a&&(0,ra.jsxs)("div",{className:"mt-5 p-3 bg-light rounded border",children:[(0,ra.jsxs)("h3",{className:"h4 fw-bold mb-2",children:[" Question ",u,":"]}),(0,ra.jsx)("h2",{children:a}),!x&&(0,ra.jsx)("button",{onClick:async()=>{const t=await(async t=>{try{return(await Mr.post("".concat("http://localhost:5000","/api/answercheck"),{text:t})).data.answer}catch(M){return console.error("Error fetching AI answer:",M),"Unable to generate answer. Please try again later."}})(a);w(t),k(!0),console.log("ai answer",t)},className:"btn btn-secondary mb-3",children:"Check Answer"}),x&&(0,ra.jsxs)("div",{className:"alert alert-info mt-2",children:[(0,ra.jsx)("strong",{children:"AI Answer:"})," ",b]}),(0,ra.jsxs)("div",{className:"mt-3",children:[(0,ra.jsx)("h3",{className:"h4 fw-bold",children:" Your Answer (Voice Input)"}),(0,ra.jsx)("h2",{className:"text-secondary mb-2",children:P||"Your speech will appear here..."}),(0,ra.jsxs)("div",{className:"d-flex gap-3 mb-3",children:[(0,ra.jsxs)("div",{className:"d-flex justifyContent-space-between pd-5",children:[(0,ra.jsx)("button",{type:"button",onClick:()=>{z(),S(Date.now()),ea.startListening({continuous:!0})},className:"btn btn-success hover-effect",children:"Start Talking"}),(0,ra.jsx)("button",{type:"button",onClick:U,className:"btn btn-danger",style:{marginLeft:"10px"},children:"Stop"}),(0,ra.jsx)("button",{type:"button",onClick:()=>{ea&&"function"===typeof ea.stopListening&&ea.stopListening(),l(null),D(""),N(0),R(0),k(!1),w(""),S(null),I(null),z()},className:"btn btn-secondary",style:{marginLeft:"10px"},children:"Reset"})]}),(0,ra.jsx)("button",{onClick:async()=>{try{const t=await Mr.post("".concat("http://localhost:5000","/api/analyze-answer"),{text:P});l(t.data)}catch(M){console.error("Error analyzing transcript:",M)}},className:"btn btn-primary",children:"Check Analyasis"})]})]}),c&&(0,ra.jsxs)("div",{children:[(0,ra.jsx)("h4",{className:"h6 fw-bold mb-2",children:" Answer Analysis"}),(0,ra.jsxs)("div",{className:"d-flex flex-row gap-2",children:[(0,ra.jsxs)("div",{className:"mt-4 p-3 bg-warning bg-opacity-25 rounded",children:[(0,ra.jsxs)("p",{children:["Fluency Feedback: ",O]}),(0,ra.jsx)("div",{children:(0,ra.jsx)(aa,{value:E})})]}),(0,ra.jsxs)("div",{className:"mt-4 p-3 bg-warning bg-opacity-25 rounded",children:[(0,ra.jsxs)("p",{children:["Grammar Accuracy: ",c.grammar,"%"]}),(0,ra.jsx)("div",{children:(0,ra.jsx)(aa,{value:c.grammar})})]})]})]}),(0,ra.jsx)("div",{className:"text-end",children:(0,ra.jsx)("button",{onClick:async()=>{s(!0);try{const t=await j();i(t),z(),l(null),h(t=>t+1),w(""),k(!1)}catch(M){console.error("Error generating next question:",M)}s(!1)},className:"btn btn-info mt-2",children:o?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Generating..."]}):"Next Question"})})]})]})})})})," "]})]}):(0,ra.jsx)("span",{children:"Your browser does not support speech recognition."})};window.webgazer=IX;const FX=()=>{const[t,e]=(0,C.useState)({name:"",location:"",education:"",fatherName:"",motherName:"",siblings:"",resume:null});let n=null;const[r,a]=(0,C.useState)(""),[i,o]=(0,C.useState)(!1),[s,c]=(0,C.useState)(null),[l,u]=(0,C.useState)(1),[h,d]=(0,C.useState)([]),f=(0,C.useRef)(null),[p,m]=(0,C.useState)(!1),[g,y]=(0,C.useState)(""),[v,b]=(0,C.useState)(!1),[w,x]=(0,C.useState)(null),[k,_]=(0,C.useState)(null),[S,T]=(0,C.useState)(0),[I,E]=(0,C.useState)(0),[N,A]=(0,C.useState)(""),{transcript:R,listening:O,resetTranscript:D,browserSupportsSpeechRecognition:M}=ta(),F=async()=>{for(let t=0;t<5;t++){const t=(await Mr.get("".concat("http://localhost:5000","/api/beginer"))).data.question;if(!h.includes(t))return d(e=>[...e,t]),t}return"Unable to generate a unique question. Please try again later."},P=()=>{IX&&IX.setGazeListener?(IX.setGazeListener((t,e)=>{t&&console.log("Gaze at:",t.x,t.y)}).begin(),IX.showVideo(!1).showFaceOverlay(!1).showFaceFeedbackBox(!1)):console.warn("webgazer is not available.")};(0,C.useEffect)(()=>{O&&(n&&clearTimeout(n),n=setTimeout(()=>{L(),console.log("Auto-stopped due to silence.")},4e3))},[R]);const L=()=>{ea.stopListening();const t=Date.now();if(_(t),w){const e=(t-w)/1e3,n=R.trim().split(/\s+/).filter(Boolean).length/(e/60);E(e),T(n.toFixed(2));let r="Needs improvement";n>=90?r="Excellent fluency!":n>=80?r="Very good fluency!":n>=70?r="Good fluency!":n>=60&&(r="Good, but can improve."),A(r)}};(0,C.useEffect)(()=>{const t=()=>{if(window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end()}catch(Grt){console.warn("webgazer.end() cleanup error:",Grt)}m(!1)};return window.addEventListener("beforeunload",t),()=>{if(window.removeEventListener("beforeunload",t),window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end()}catch(Grt){console.warn("webgazer.end() cleanup error:",Grt)}m(!1)}},[]),(0,C.useEffect)(()=>{if(p){(async()=>{try{const t=await navigator.mediaDevices.getUserMedia({video:!0});f.current&&(f.current.srcObject=t)}catch(Hrt){console.error("Camera access denied or not available",Hrt)}})()}},[p]),(0,C.useEffect)(()=>{R.toLowerCase().includes("stop")&&(L(),console.log("Voice command 'stop' detected. Stopping..."))},[R]);return M?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)(NX,{}),(0,ra.jsxs)(ps,{children:[(0,ra.jsx)("div",{className:"container ",style:{marginTop:"20px",marginBottom:"20px"},children:(0,ra.jsx)(ps,{children:(0,ra.jsx)("div",{className:"card shadow-lg rounded-3 ",style:{marginTop:"100px"},children:(0,ra.jsxs)("div",{className:"card-body",children:[(0,ra.jsx)("h2",{className:"card-title mb-4",children:"Beginner language Improvement"}),p?(0,ra.jsxs)("div",{className:"mb-4 ",children:[(0,ra.jsx)("h4",{className:"h6 fw-bold",children:"\ud83d\udcf7 Eye Tracking Camera (Live)"}),(0,ra.jsx)("video",{ref:f,autoPlay:!0,playsInline:!0,className:"w-100 rounded border",style:{maxHeight:"220px"}}),(0,ra.jsx)("button",{className:"btn btn-danger",onClick:()=>{if(window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end(),console.log("WebGazer stopped.")}catch(Grt){console.warn("Error stopping WebGazer:",Grt)}if(f.current&&f.current.srcObject){f.current.srcObject.getTracks().forEach(t=>{try{t.stop()}catch(Grt){console.warn("Error stopping camera track:",Grt)}}),f.current.srcObject=null,console.log("Camera stopped.")}m(!1)},children:"Close Camera"})]}):(0,ra.jsx)("button",{className:"btn btn-danger",onClick:()=>{m(!0),P()},children:"Open Camera"}),r?(0,ra.jsxs)("div",{className:"mt-5 p-3 bg-light rounded border",children:[(0,ra.jsxs)("h4",{className:"h4 fw-bold mb-2",children:[" Question ",l,":"]}),(0,ra.jsx)("h2",{children:r}),!v&&(0,ra.jsx)("button",{onClick:async()=>{const t=await(async t=>{try{return(await Mr.post("".concat("http://localhost:5000","/api/answerbeginer"),{text:t})).data.answer}catch(e){return console.error("Error fetching AI answer:",e),"Unable to generate answer. Please try again later."}})(r);y(t),b(!0),console.log("ai answer",t)},className:"btn btn-secondary mb-3",children:"Check Answer"}),v&&(0,ra.jsxs)("div",{className:"alert alert-info mt-2",children:[(0,ra.jsx)("strong",{children:"AI Answer:"})," ",g]}),(0,ra.jsxs)("div",{className:"mt-3",children:[(0,ra.jsx)("h3",{className:"h4 fw-bold",children:" Your Answer (Voice Input)"}),(0,ra.jsx)("h2",{className:"text-secondary mb-2",children:R||"Your speech will appear here..."}),(0,ra.jsxs)("div",{className:"d-flex gap-3 mb-3",children:[(0,ra.jsxs)("div",{className:"d-flex justifyContent-space-between pd-5",children:[(0,ra.jsx)("button",{type:"button",onClick:()=>{D(),x(Date.now()),ea.startListening({continuous:!0})},className:"btn btn-success hover-effect",children:"Start Talking"}),(0,ra.jsx)("button",{type:"button",onClick:L,className:"btn btn-danger",style:{marginLeft:"10px"},children:"Stop"}),(0,ra.jsx)("button",{type:"button",onClick:()=>{ea&&"function"===typeof ea.stopListening&&ea.stopListening(),c(null),A(""),T(0),E(0),b(!1),y(""),x(null),_(null),D()},className:"btn btn-secondary",style:{marginLeft:"10px"},children:"Reset"})]}),(0,ra.jsx)("button",{onClick:async()=>{try{const t=await Mr.post("".concat("http://localhost:5000","/api/analyze-answer"),{text:R});c(t.data)}catch(t){console.error("Error analyzing transcript:",t)}},className:"btn btn-primary",children:"Check Analyasis"})]})]}),s&&(0,ra.jsxs)("div",{children:[(0,ra.jsx)("h4",{className:"h6 fw-bold mb-2",children:" Answer Analysis"}),(0,ra.jsxs)("div",{className:"d-flex flex-row gap-2",children:[(0,ra.jsxs)("div",{className:"mt-4 p-3 bg-warning bg-opacity-25 rounded",children:[(0,ra.jsxs)("p",{children:["Fluency Feedback: ",N]}),(0,ra.jsx)("div",{children:(0,ra.jsx)(aa,{value:S})})]}),(0,ra.jsxs)("div",{className:"mt-4 p-3 bg-warning bg-opacity-25 rounded",children:[(0,ra.jsxs)("p",{children:["Grammar Accuracy: ",s.grammar,"%"]}),(0,ra.jsx)("div",{children:(0,ra.jsx)(aa,{value:s.grammar})})]})]})]}),(0,ra.jsx)("div",{className:"text-end",children:(0,ra.jsx)("button",{onClick:async()=>{o(!0);try{const t=await F();a(t),D(),c(null),u(t=>t+1),y(""),b(!1)}catch(t){console.error("Error generating next question:",t)}o(!1)},className:"btn btn-info mt-2",children:i?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Generating..."]}):"Next Question"})})]}):(0,ra.jsx)("div",{className:"d-flex justify-content-center  my-4",children:(0,ra.jsx)("button",{onClick:async t=>{t.preventDefault(),o(!0);try{const t=await F();a(t),D(),c(null),m(!0),P()}catch(e){console.error("Error sending data to GPT API:",e)}o(!1)},className:"btn btn-primary btn-lg px-5 py-3 fw-bold shadow",style:{transition:"0.3s"},onMouseOver:t=>t.target.style.transform="scale(1.05)",onMouseOut:t=>t.target.style.transform="scale(1)",children:"Check\xa0>>"})})]})})})})," "]})]}):(0,ra.jsx)("span",{children:"Your browser does not support speech recognition."})};window.webgazer=IX;const PX=()=>{const t=(0,C.useRef)(null),[e,n]=(0,C.useState)({name:"",location:"",education:"",fatherName:"",motherName:"",siblings:"",resume:null});let r=null;const[a,i]=(0,C.useState)(""),[o,s]=(0,C.useState)(!1),[c,l]=(0,C.useState)(null),[u,h]=(0,C.useState)(1),[d,f]=(0,C.useState)([]),p=(0,C.useRef)(null),[m,g]=(0,C.useState)(!1),[y,v]=(0,C.useState)(!1),[b,w]=(0,C.useState)(""),[x,k]=(0,C.useState)(!1),[_,S]=(0,C.useState)(null),[T,I]=(0,C.useState)(null),[E,N]=(0,C.useState)(0),[A,R]=(0,C.useState)(0),[O,D]=(0,C.useState)(""),{transcript:M,listening:F,resetTranscript:P,browserSupportsSpeechRecognition:L}=ta();(0,C.useEffect)(()=>{var e;(m||a)&&(null===(e=t.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))},[m,a]);const z=async()=>{for(let t=0;t<5;t++){const t=(await Mr.get("".concat("http://localhost:5000","/api/intermediate"))).data.question;if(!d.includes(t))return f(e=>[...e,t]),t}return"Unable to generate a unique question. Please try again later."},B=()=>{IX&&IX.setGazeListener?(IX.setGazeListener((t,e)=>{t&&console.log("Gaze at:",t.x,t.y)}).begin(),IX.showVideo(!1).showFaceOverlay(!1).showFaceFeedbackBox(!1)):console.warn("webgazer is not available.")};(0,C.useEffect)(()=>{F&&(r&&clearTimeout(r),r=setTimeout(()=>{j(),console.log("Auto-stopped due to silence.")},4e3))},[M]);const j=()=>{ea.stopListening();const t=Date.now();if(I(t),_){const e=(t-_)/1e3,n=M.trim().split(/\s+/).filter(Boolean).length/(e/60);R(e),N(n.toFixed(2));let r="Needs improvement";n>=90?r="Excellent fluency!":n>=80?r="Very good fluency!":n>=70?r="Good fluency!":n>=60&&(r="Good, but can improve."),D(r)}};(0,C.useEffect)(()=>{const t=()=>{if(window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end()}catch(Grt){console.warn("webgazer.end() cleanup error:",Grt)}g(!1)};return window.addEventListener("beforeunload",t),()=>{if(window.removeEventListener("beforeunload",t),window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end()}catch(Grt){console.warn("webgazer.end() cleanup error:",Grt)}g(!1)}},[]),(0,C.useEffect)(()=>{if(m){(async()=>{try{const t=await navigator.mediaDevices.getUserMedia({video:!0});p.current&&(p.current.srcObject=t)}catch(Hrt){console.error("Camera access denied or not available",Hrt)}})()}},[m]),(0,C.useEffect)(()=>{M.toLowerCase().includes("stop")&&(j(),console.log("Voice command 'stop' detected. Stopping..."))},[M]);return L?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)(NX,{}),(0,ra.jsxs)(ps,{children:[(0,ra.jsx)("div",{className:"container",style:{marginTop:"20px",marginBottom:"20px"},children:(0,ra.jsx)(ps,{children:(0,ra.jsx)("div",{className:"card shadow-lg rounded-3 ",style:{marginTop:"100px"},children:(0,ra.jsxs)("div",{className:"card-body",children:[(0,ra.jsx)("h2",{className:"card-title mb-4",children:"Intermediate language Improvement"}),m?(0,ra.jsxs)("div",{className:"mb-4 ",children:[(0,ra.jsx)("h4",{className:"h6 fw-bold",children:"\ud83d\udcf7 Eye Tracking Camera (Live)"}),(0,ra.jsx)("video",{ref:p,autoPlay:!0,playsInline:!0,className:"w-100 rounded border",style:{maxHeight:"220px"}}),(0,ra.jsx)("button",{className:"btn btn-danger",onClick:()=>{if(window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end(),console.log("WebGazer stopped.")}catch(Grt){console.warn("Error stopping WebGazer:",Grt)}if(p.current&&p.current.srcObject){p.current.srcObject.getTracks().forEach(t=>{try{t.stop()}catch(Grt){console.warn("Error stopping camera track:",Grt)}}),p.current.srcObject=null,console.log("Camera stopped.")}g(!1)},children:"Close Camera"})]}):(0,ra.jsx)("button",{className:"btn btn-danger",onClick:()=>{g(!0),B()},children:"Open Camera"}),a?(0,ra.jsxs)("div",{className:"mt-5 p-3 bg-light rounded border",children:[(0,ra.jsxs)("h4",{className:"h4 fw-bold mb-2",children:[" Question ",u,":"]}),(0,ra.jsx)("h2",{children:a}),!x&&(0,ra.jsx)("button",{onClick:async()=>{const t=await(async t=>{try{return(await Mr.get("".concat("http://localhost:5000","/api/answerintermediate"),{text:t})).data.answer}catch(e){return console.error("Error fetching AI answer:",e),"Unable to generate answer. Please try again later."}})(a);w(t),k(!0),console.log("ai answer",t)},className:"btn btn-secondary mb-3",children:"Check Answer"}),x&&(0,ra.jsxs)("div",{className:"alert alert-info mt-2",children:[(0,ra.jsx)("strong",{children:"AI Answer:"})," ",b]}),(0,ra.jsxs)("div",{className:"mt-3",children:[(0,ra.jsx)("h3",{className:"h4 fw-bold",children:"\ud83c\udf99\ufe0f Your Answer (Voice Input)"}),(0,ra.jsx)("h2",{className:"text-secondary mb-2",children:M||"Your speech will appear here..."}),(0,ra.jsxs)("div",{className:"d-flex gap-3 mb-3",children:[(0,ra.jsxs)("div",{className:"d-flex justifyContent-space-between pd-5",children:[(0,ra.jsx)("button",{type:"button",onClick:()=>{P(),S(Date.now()),ea.startListening({continuous:!0})},className:"btn btn-success hover-effect",children:"Start Talking"}),(0,ra.jsx)("button",{type:"button",onClick:j,className:"btn btn-danger",style:{marginLeft:"10px"},children:"Stop"}),(0,ra.jsx)("button",{type:"button",onClick:()=>{ea&&"function"===typeof ea.stopListening&&ea.stopListening(),l(null),D(""),N(0),R(0),k(!1),w(""),S(null),I(null),P()},className:"btn btn-secondary",style:{marginLeft:"10px"},children:"Reset"})]}),(0,ra.jsx)("button",{onClick:async()=>{try{const t=await Mr.post("".concat("http://localhost:5000","/api/analyze-answer"),{text:M});l(t.data)}catch(t){console.error("Error analyzing transcript:",t)}},className:"btn btn-primary",children:"Check Analyasis"})]})]}),c&&(0,ra.jsxs)("div",{children:[(0,ra.jsx)("h4",{className:"h6 fw-bold mb-2",children:"\ud83d\udcca Answer Analysis"}),(0,ra.jsxs)("div",{className:"d-flex flex-row gap-2",children:[(0,ra.jsxs)("div",{className:"mt-4 p-3 bg-warning bg-opacity-25 rounded",children:[(0,ra.jsxs)("p",{children:["Fluency Feedback: ",O]}),(0,ra.jsx)("div",{children:(0,ra.jsx)(aa,{value:E})})]}),(0,ra.jsxs)("div",{className:"mt-4 p-3 bg-warning bg-opacity-25 rounded",children:[(0,ra.jsxs)("p",{children:["Grammar Accuracy: ",c.grammar,"%"]}),(0,ra.jsx)("div",{children:(0,ra.jsx)(aa,{value:c.grammar})})]})]})]}),(0,ra.jsx)("div",{className:"text-end",children:(0,ra.jsx)("button",{onClick:async()=>{s(!0);try{const t=await z();i(t),P(),l(null),h(t=>t+1),w(""),k(!1)}catch(t){console.error("Error generating next question:",t)}s(!1)},className:"btn btn-info mt-2",children:o?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Generating..."]}):"Next Question"})})]}):(0,ra.jsx)("div",{className:"d-flex justify-content-center  my-4",children:(0,ra.jsx)("button",{onClick:async t=>{t.preventDefault(),s(!0);try{const t=await z();i(t),P(),l(null),g(!0),B()}catch(e){console.error("Error sending data to GPT API:",e)}s(!1)},className:"btn btn-primary btn-lg px-5 py-3 fw-bold shadow",style:{transition:"0.3s"},onMouseOver:t=>t.target.style.transform="scale(1.05)",onMouseOut:t=>t.target.style.transform="scale(1)",children:"Check\xa0>>"})})]})})})})," "]})]}):(0,ra.jsx)("span",{children:"Your browser does not support speech recognition."})};var LX=n(89);var zX=n(8404),BX=n(2038),jX=n(455);var UX=n(8321),VX=n(2013);function WX(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function GX(t,e){if(t){var n;if("string"==typeof t)return WX(t,e);var r=UX(n={}.toString.call(t)).call(n,8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?VX(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?WX(t,e):void 0}}function HX(t,e){return function(t){if(LX(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof zX&&BX(t)||t["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(jX(s).call(s,r.value),s.length!==e);c=!0);}catch(t){l=!0,a=t}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw a}}return s}}(t,e)||GX(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var qX=n(4600),KX=n.n(qX),XX=n(7448),YX=n.n(XX),QX=C.createContext({scrollTo:function(){return 0},scrollToBottom:function(){return 0},scrollToEnd:function(){return 0},scrollToStart:function(){return 0},scrollToTop:function(){return 0}});QX.displayName="ScrollToBottomFunctionContext";const JX=QX;function $X(){return(0,C.useContext)(JX).scrollToEnd}var ZX=C.createContext({atBottom:!0,atEnd:!0,atStart:!1,atTop:!0,mode:"bottom"});ZX.displayName="ScrollToBottomState1Context";const tY=ZX;var eY=C.createContext({animating:!1,animatingToEnd:!1,sticky:!0});eY.displayName="ScrollToBottomState2Context";const nY=eY;var rY=C.createContext({animating:!1,animatingToEnd:!1,atBottom:!0,atEnd:!0,atStart:!1,atTop:!0,mode:"bottom",sticky:!0});rY.displayName="ScrollToBottomStateContext";const aY=rY;var iY=[aY,tY,nY];function oY(){var t;return[(t=2,(0,C.useContext)(iY[t]||iY[0])).sticky]}var sY=C.createContext({offsetHeight:0,scrollHeight:0,setTarget:function(){return 0},styleToClassName:function(){return""}});sY.displayName="ScrollToBottomInternalContext";const cY=sY;function lY(){return(0,C.useContext)(cY).styleToClassName}var uY={backgroundColor:"rgba(0, 0, 0, .2)",borderRadius:10,borderWidth:0,bottom:5,cursor:"pointer",height:20,outline:0,position:"absolute",right:20,width:20,"&:hover":{backgroundColor:"rgba(0, 0, 0, .4)"},"&:active":{backgroundColor:"rgba(0, 0, 0, .6)"}},hY=function(t){var e=t.children,n=t.className,r=HX(oY(),1)[0],a=lY()(uY),i=$X();return!r&&C.createElement("button",{className:KX()(a,(n||"")+""),onClick:i,type:"button"},e)};hY.defaultProps={children:void 0,className:""},hY.propTypes={children:YX().any,className:YX().string};const dY=hY;var fY=n(5468),pY=n(4224);function mY(t){return mY="function"==typeof zX&&"symbol"==typeof pY?function(t){return typeof t}:function(t){return t&&"function"==typeof zX&&t.constructor===zX&&t!==zX.prototype?"symbol":typeof t},mY(t)}var gY=n(875);function yY(t){var e=function(t,e){if("object"!=mY(t)||!t)return t;var n=t[gY];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=mY(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==mY(e)?e:e+""}function vY(t,e,n){return(e=yY(e))in t?fY(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bY(t){return function(t){if(LX(t))return WX(t)}(t)||function(t){if("undefined"!=typeof zX&&null!=BX(t)||null!=t["@@iterator"])return VX(t)}(t)||GX(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n(572),n(5881);var wY=n(6988),xY=n.n(wY),kY=n(6388),_Y=n.n(kY),SY=n(385),TY=n.n(SY),IY=n(1393),EY=n.n(IY),NY=n(9550),CY=n.n(NY),AY=n(6226),RY=n.n(AY),OY=n(697),DY=n.n(OY),MY=n(6100),FY=n.n(MY),PY=n(6319),LY=n.n(PY),zY=n(8928),BY=n.n(zY),jY=n(6751),UY=n.n(jY),VY=n(5110),WY=n.n(VY),GY=n(3930),HY=n.n(GY);var qY=function(){function t(t){var e=this;this._insertTag=function(t){var n;n=0===e.tags.length?e.insertionPoint?e.insertionPoint.nextSibling:e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling,e.container.insertBefore(t,n),e.tags.push(t)},this.isSpeedy=void 0===t.speedy||t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(t){t.forEach(this._insertTag)},e.insert=function(t){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(e);try{n.insertRule(t,n.cssRules.length)}catch(Grt){}}else e.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach(function(t){var e;return null==(e=t.parentNode)?void 0:e.removeChild(t)}),this.tags=[],this.ctr=0},t}(),KY=Math.abs,XY=String.fromCharCode,YY=Object.assign;function QY(t){return t.trim()}function JY(t,e,n){return t.replace(e,n)}function $Y(t,e){return t.indexOf(e)}function ZY(t,e){return 0|t.charCodeAt(e)}function tQ(t,e,n){return t.slice(e,n)}function eQ(t){return t.length}function nQ(t){return t.length}function rQ(t,e){return e.push(t),t}var aQ=1,iQ=1,oQ=0,sQ=0,cQ=0,lQ="";function uQ(t,e,n,r,a,i,o){return{value:t,root:e,parent:n,type:r,props:a,children:i,line:aQ,column:iQ,length:o,return:""}}function hQ(t,e){return YY(uQ("",null,null,"",null,null,0),t,{length:-t.length},e)}function dQ(){return cQ=sQ>0?ZY(lQ,--sQ):0,iQ--,10===cQ&&(iQ=1,aQ--),cQ}function fQ(){return cQ=sQ<oQ?ZY(lQ,sQ++):0,iQ++,10===cQ&&(iQ=1,aQ++),cQ}function pQ(){return ZY(lQ,sQ)}function mQ(){return sQ}function gQ(t,e){return tQ(lQ,t,e)}function yQ(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function vQ(t){return aQ=iQ=1,oQ=eQ(lQ=t),sQ=0,[]}function bQ(t){return lQ="",t}function wQ(t){return QY(gQ(sQ-1,_Q(91===t?t+2:40===t?t+1:t)))}function xQ(t){for(;(cQ=pQ())&&cQ<33;)fQ();return yQ(t)>2||yQ(cQ)>3?"":" "}function kQ(t,e){for(;--e&&fQ()&&!(cQ<48||cQ>102||cQ>57&&cQ<65||cQ>70&&cQ<97););return gQ(t,mQ()+(e<6&&32==pQ()&&32==fQ()))}function _Q(t){for(;fQ();)switch(cQ){case t:return sQ;case 34:case 39:34!==t&&39!==t&&_Q(cQ);break;case 40:41===t&&_Q(t);break;case 92:fQ()}return sQ}function SQ(t,e){for(;fQ()&&t+cQ!==57&&(t+cQ!==84||47!==pQ()););return"/*"+gQ(e,sQ-1)+"*"+XY(47===t?t:fQ())}function TQ(t){for(;!yQ(pQ());)fQ();return gQ(t,sQ)}var IQ="-ms-",EQ="-moz-",NQ="-webkit-",CQ="comm",AQ="rule",RQ="decl",OQ="@keyframes";function DQ(t,e){for(var n="",r=nQ(t),a=0;a<r;a++)n+=e(t[a],a,t,e)||"";return n}function MQ(t,e,n,r){switch(t.type){case"@layer":if(t.children.length)break;case"@import":case RQ:return t.return=t.return||t.value;case CQ:return"";case OQ:return t.return=t.value+"{"+DQ(t.children,r)+"}";case AQ:t.value=t.props.join(",")}return eQ(n=DQ(t.children,r))?t.return=t.value+"{"+n+"}":""}function FQ(t){return function(e){e.root||(e=e.return)&&t(e)}}function PQ(t){return bQ(LQ("",null,null,null,[""],t=vQ(t),0,[0],t))}function LQ(t,e,n,r,a,i,o,s,c){for(var l=0,u=0,h=o,d=0,f=0,p=0,m=1,g=1,y=1,v=0,b="",w=a,x=i,k=r,_=b;g;)switch(p=v,v=fQ()){case 40:if(108!=p&&58==ZY(_,h-1)){-1!=$Y(_+=JY(wQ(v),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:_+=wQ(v);break;case 9:case 10:case 13:case 32:_+=xQ(p);break;case 92:_+=kQ(mQ()-1,7);continue;case 47:switch(pQ()){case 42:case 47:rQ(BQ(SQ(fQ(),mQ()),e,n),c);break;default:_+="/"}break;case 123*m:s[l++]=eQ(_)*y;case 125*m:case 59:case 0:switch(v){case 0:case 125:g=0;case 59+u:-1==y&&(_=JY(_,/\f/g,"")),f>0&&eQ(_)-h&&rQ(f>32?jQ(_+";",r,n,h-1):jQ(JY(_," ","")+";",r,n,h-2),c);break;case 59:_+=";";default:if(rQ(k=zQ(_,e,n,l,u,a,s,b,w=[],x=[],h),i),123===v)if(0===u)LQ(_,e,k,k,w,i,h,s,x);else switch(99===d&&110===ZY(_,3)?100:d){case 100:case 108:case 109:case 115:LQ(t,k,k,r&&rQ(zQ(t,k,k,0,0,a,s,b,a,w=[],h),x),a,x,h,s,r?w:x);break;default:LQ(_,k,k,k,[""],x,0,s,x)}}l=u=f=0,m=y=1,b=_="",h=o;break;case 58:h=1+eQ(_),f=p;default:if(m<1)if(123==v)--m;else if(125==v&&0==m++&&125==dQ())continue;switch(_+=XY(v),v*m){case 38:y=u>0?1:(_+="\f",-1);break;case 44:s[l++]=(eQ(_)-1)*y,y=1;break;case 64:45===pQ()&&(_+=wQ(fQ())),d=pQ(),u=h=eQ(b=_+=TQ(mQ())),v++;break;case 45:45===p&&2==eQ(_)&&(m=0)}}return i}function zQ(t,e,n,r,a,i,o,s,c,l,u){for(var h=a-1,d=0===a?i:[""],f=nQ(d),p=0,m=0,g=0;p<r;++p)for(var y=0,v=tQ(t,h+1,h=KY(m=o[p])),b=t;y<f;++y)(b=QY(m>0?d[y]+" "+v:JY(v,/&\f/g,d[y])))&&(c[g++]=b);return uQ(t,e,n,0===a?AQ:s,c,l,u)}function BQ(t,e,n){return uQ(t,e,n,CQ,XY(cQ),tQ(t,2,-2),0)}function jQ(t,e,n,r){return uQ(t,e,n,RQ,tQ(t,0,r),tQ(t,r+1,-1),r)}var UQ=function(t,e,n){for(var r=0,a=0;r=a,a=pQ(),38===r&&12===a&&(e[n]=1),!yQ(a);)fQ();return gQ(t,sQ)},VQ=function(t,e){return bQ(function(t,e){var n=-1,r=44;do{switch(yQ(r)){case 0:38===r&&12===pQ()&&(e[n]=1),t[n]+=UQ(sQ-1,e,n);break;case 2:t[n]+=wQ(r);break;case 4:if(44===r){t[++n]=58===pQ()?"&\f":"",e[n]=t[n].length;break}default:t[n]+=XY(r)}}while(r=fQ());return t}(vQ(t),e))},WQ=new WeakMap,GQ=function(t){if("rule"===t.type&&t.parent&&!(t.length<1)){for(var e=t.value,n=t.parent,r=t.column===n.column&&t.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==t.props.length||58===e.charCodeAt(0)||WQ.get(n))&&!r){WQ.set(t,!0);for(var a=[],i=VQ(e,a),o=n.props,s=0,c=0;s<i.length;s++)for(var l=0;l<o.length;l++,c++)t.props[c]=a[s]?i[s].replace(/&\f/g,o[l]):o[l]+" "+i[s]}}},HQ=function(t){if("decl"===t.type){var e=t.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(t.return="",t.value="")}};function qQ(t,e){switch(function(t,e){return 45^ZY(t,0)?(((e<<2^ZY(t,0))<<2^ZY(t,1))<<2^ZY(t,2))<<2^ZY(t,3):0}(t,e)){case 5103:return NQ+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return NQ+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return NQ+t+EQ+t+IQ+t+t;case 6828:case 4268:return NQ+t+IQ+t+t;case 6165:return NQ+t+IQ+"flex-"+t+t;case 5187:return NQ+t+JY(t,/(\w+).+(:[^]+)/,NQ+"box-$1$2"+IQ+"flex-$1$2")+t;case 5443:return NQ+t+IQ+"flex-item-"+JY(t,/flex-|-self/,"")+t;case 4675:return NQ+t+IQ+"flex-line-pack"+JY(t,/align-content|flex-|-self/,"")+t;case 5548:return NQ+t+IQ+JY(t,"shrink","negative")+t;case 5292:return NQ+t+IQ+JY(t,"basis","preferred-size")+t;case 6060:return NQ+"box-"+JY(t,"-grow","")+NQ+t+IQ+JY(t,"grow","positive")+t;case 4554:return NQ+JY(t,/([^-])(transform)/g,"$1"+NQ+"$2")+t;case 6187:return JY(JY(JY(t,/(zoom-|grab)/,NQ+"$1"),/(image-set)/,NQ+"$1"),t,"")+t;case 5495:case 3959:return JY(t,/(image-set\([^]*)/,NQ+"$1$`$1");case 4968:return JY(JY(t,/(.+:)(flex-)?(.*)/,NQ+"box-pack:$3"+IQ+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+NQ+t+t;case 4095:case 3583:case 4068:case 2532:return JY(t,/(.+)-inline(.+)/,NQ+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(eQ(t)-1-e>6)switch(ZY(t,e+1)){case 109:if(45!==ZY(t,e+4))break;case 102:return JY(t,/(.+:)(.+)-([^]+)/,"$1"+NQ+"$2-$3$1"+EQ+(108==ZY(t,e+3)?"$3":"$2-$3"))+t;case 115:return~$Y(t,"stretch")?qQ(JY(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(115!==ZY(t,e+1))break;case 6444:switch(ZY(t,eQ(t)-3-(~$Y(t,"!important")&&10))){case 107:return JY(t,":",":"+NQ)+t;case 101:return JY(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+NQ+(45===ZY(t,14)?"inline-":"")+"box$3$1"+NQ+"$2$3$1"+IQ+"$2box$3")+t}break;case 5936:switch(ZY(t,e+11)){case 114:return NQ+t+IQ+JY(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return NQ+t+IQ+JY(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return NQ+t+IQ+JY(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return NQ+t+IQ+t+t}return t}var KQ=[function(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case RQ:t.return=qQ(t.value,t.length);break;case OQ:return DQ([hQ(t,{value:JY(t.value,"@","@"+NQ)})],r);case AQ:if(t.length)return function(t,e){return t.map(e).join("")}(t.props,function(e){switch(function(t,e){return(t=e.exec(t))?t[0]:t}(e,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return DQ([hQ(t,{props:[JY(e,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return DQ([hQ(t,{props:[JY(e,/:(plac\w+)/,":"+NQ+"input-$1")]}),hQ(t,{props:[JY(e,/:(plac\w+)/,":-moz-$1")]}),hQ(t,{props:[JY(e,/:(plac\w+)/,IQ+"input-$1")]})],r)}return""})}}],XQ=function(t){var e=t.key;if("css"===e){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(t){-1!==t.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(t),t.setAttribute("data-s",""))})}var r,a,i=t.stylisPlugins||KQ,o={},s=[];r=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),function(t){for(var e=t.getAttribute("data-emotion").split(" "),n=1;n<e.length;n++)o[e[n]]=!0;s.push(t)});var c,l=[GQ,HQ],u=[MQ,FQ(function(t){c.insert(t)})],h=function(t){var e=nQ(t);return function(n,r,a,i){for(var o="",s=0;s<e;s++)o+=t[s](n,r,a,i)||"";return o}}(l.concat(i,u));a=function(t,e,n,r){c=n,DQ(PQ(t?t+"{"+e.styles+"}":e.styles),h),r&&(d.inserted[e.name]=!0)};var d={key:e,sheet:new qY({key:e,container:r,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:o,registered:{},insert:a};return d.sheet.hydrate(s),d};var YQ={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function QQ(t){var e=Object.create(null);return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}}var JQ=/[A-Z]|^ms/g,$Q=/_EMO_([^_]+?)_([^]*?)_EMO_/g,ZQ=function(t){return 45===t.charCodeAt(1)},tJ=function(t){return null!=t&&"boolean"!==typeof t},eJ=QQ(function(t){return ZQ(t)?t:t.replace(JQ,"-$&").toLowerCase()}),nJ=function(t,e){switch(t){case"animation":case"animationName":if("string"===typeof e)return e.replace($Q,function(t,e,n){return aJ={name:e,styles:n,next:aJ},e})}return 1===YQ[t]||ZQ(t)||"number"!==typeof e||0===e?e:e+"px"};function rJ(t,e,n){if(null==n)return"";var r=n;if(void 0!==r.__emotion_styles)return r;switch(typeof n){case"boolean":return"";case"object":var a=n;if(1===a.anim)return aJ={name:a.name,styles:a.styles,next:aJ},a.name;var i=n;if(void 0!==i.styles){var o=i.next;if(void 0!==o)for(;void 0!==o;)aJ={name:o.name,styles:o.styles,next:aJ},o=o.next;return i.styles+";"}return function(t,e,n){var r="";if(Array.isArray(n))for(var a=0;a<n.length;a++)r+=rJ(t,e,n[a])+";";else for(var i in n){var o=n[i];if("object"!==typeof o){var s=o;null!=e&&void 0!==e[s]?r+=i+"{"+e[s]+"}":tJ(s)&&(r+=eJ(i)+":"+nJ(i,s)+";")}else if(!Array.isArray(o)||"string"!==typeof o[0]||null!=e&&void 0!==e[o[0]]){var c=rJ(t,e,o);switch(i){case"animation":case"animationName":r+=eJ(i)+":"+c+";";break;default:r+=i+"{"+c+"}"}}else for(var l=0;l<o.length;l++)tJ(o[l])&&(r+=eJ(i)+":"+nJ(i,o[l])+";")}return r}(t,e,n);case"function":if(void 0!==t){var s=aJ,c=n(t);return aJ=s,rJ(t,e,c)}}var l=n;if(null==e)return l;var u=e[l];return void 0!==u?u:l}var aJ,iJ=/label:\s*([^\s;{]+)\s*(;|$)/g;function oJ(t,e,n){if(1===t.length&&"object"===typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var r=!0,a="";aJ=void 0;var i=t[0];null==i||void 0===i.raw?(r=!1,a+=rJ(n,e,i)):a+=i[0];for(var o=1;o<t.length;o++){if(a+=rJ(n,e,t[o]),r)a+=i[o]}iJ.lastIndex=0;for(var s,c="";null!==(s=iJ.exec(a));)c+="-"+s[1];var l=function(t){for(var e,n=0,r=0,a=t.length;a>=4;++r,a-=4)e=1540483477*(65535&(e=255&t.charCodeAt(r)|(255&t.charCodeAt(++r))<<8|(255&t.charCodeAt(++r))<<16|(255&t.charCodeAt(++r))<<24))+(59797*(e>>>16)<<16),n=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(a){case 3:n^=(255&t.charCodeAt(r+2))<<16;case 2:n^=(255&t.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}(a)+c;return{name:l,styles:a,next:aJ}}function sJ(t,e,n){var r="";return n.split(" ").forEach(function(n){void 0!==t[n]?e.push(t[n]+";"):n&&(r+=n+" ")}),r}function cJ(t,e){if(void 0===t.inserted[e.name])return t.insert("",e,t.sheet,!0)}function lJ(t,e,n){var r=[],a=sJ(t,r,n);return r.length<2?n:a+e(r)}var uJ=function t(e){for(var n="",r=0;r<e.length;r++){var a=e[r];if(null!=a){var i=void 0;switch(typeof a){case"boolean":break;case"object":if(Array.isArray(a))i=t(a);else for(var o in i="",a)a[o]&&o&&(i&&(i+=" "),i+=o);break;default:i=a}i&&(n&&(n+=" "),n+=i)}}return n};const hJ=function(t){var e=XQ(t);e.sheet.speedy=function(t){this.isSpeedy=t},e.compat=!0;var n=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=oJ(n,e.registered,void 0);return function(t,e,n){!function(t,e,n){var r=t.key+"-"+e.name;!1===n&&void 0===t.registered[r]&&(t.registered[r]=e.styles)}(t,e,n);var r=t.key+"-"+e.name;if(void 0===t.inserted[e.name]){var a=e;do{t.insert(e===a?"."+r:"",a,t.sheet,!0),a=a.next}while(void 0!==a)}}(e,a,!1),e.key+"-"+a.name};return{css:n,cx:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return lJ(e.registered,n,uJ(r))},injectGlobal:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=oJ(n,e.registered);cJ(e,a)},keyframes:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=oJ(n,e.registered),i="animation-"+a.name;return cJ(e,{name:a.name,styles:"@keyframes "+i+"{"+a.styles+"}"}),i},hydrate:function(t){t.forEach(function(t){e.inserted[t]=!0})},flush:function(){e.registered={},e.inserted={},e.sheet.flush()},sheet:e.sheet,cache:e,getRegisteredStyles:sJ.bind(null,e.registered),merge:lJ.bind(null,e.registered,n)}};var dJ=n(4705),fJ=n.n(dJ);var pJ=n(6615),mJ=n.n(pJ);function gJ(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"white",n="background-color: ".concat(t,"; border-radius: 4px; padding: 2px 4px;");return e&&(n+=" color: ".concat(e,";")),[n,""]}function yJ(t,e){for(var n,r,a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return EY()(n=[EY()(r="%c".concat(t,"%c ")).call(r,e)]).call(n,bY(gJ("green","white")),i)}var vJ=n(6255),bJ=n.n(vJ);var wJ=function(t){var e=t.debounce,n=t.name,r=t.onEvent,a=t.target,i=(0,C.useRef)();i.current=r;var o=(0,C.useMemo)(function(){return function(t,e){if(!e)return t;var n=0,r=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];var s=CY()();s-n>e?(t.apply(void 0,i),n=s):(clearTimeout(r),r=bJ()(function(){t.apply(void 0,i),n=CY()()},Math.max(0,e-s+n)))}}(function(t){var e=i.current;e&&e(t)},e)},[e,i]),s=(0,C.useCallback)(function(t){t.timeStampLow=CY()(),o(t)},[o]);return(0,C.useLayoutEffect)(function(){return a.addEventListener(n,s,{passive:!0}),s({target:a,type:n}),function(){return a.removeEventListener(n,s)}},[n,s,a]),!1};wJ.defaultProps={debounce:200};const xJ=wJ;var kJ=n(1691),_J=n.n(kJ);function SJ(t,e){var n=_J()(e-t),r=t+Math.sqrt(Math.abs(e-t))*n;return n>0?Math.min(e,r):Math.max(e,r)}var TJ=function(t){var e=t.name,n=t.onEnd,r=t.target,a=t.value,i=(0,C.useRef)(),o=(0,C.useCallback)(function(t,e,a,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:CY()();"100%"!==a&&"number"!==typeof a||(cancelAnimationFrame(i.current),i.current=requestAnimationFrame(function(){if(r){var i="100%"===a?r.scrollHeight-r.offsetHeight:a,l=function(t,e,n,r){for(var a=t,i=0;i<r;i++)a=n(a,e);return a}(e,i,SJ,(CY()()-c)/5);Math.abs(i-l)<1.5&&(l=i),r[t]=l,i===l?n&&n(!0):o(t,e,a,s+1,c)}}))},[i,n,r]),s=(0,C.useCallback)(function(){cancelAnimationFrame(i.current),n&&n(!1)},[n]);return(0,C.useLayoutEffect)(function(){return o(e,r[e],a,1),r?(r.addEventListener("pointerdown",s,{passive:!0}),r.addEventListener("wheel",s,{passive:!0}),function(){r.removeEventListener("pointerdown",s),r.removeEventListener("wheel",s),cancelAnimationFrame(i.current)}):function(){return cancelAnimationFrame(i.current)}},[o,i,s,e,r,a]),!1};TJ.propTypes={name:YX().string.isRequired,onEnd:YX().func,target:YX().any.isRequired,value:YX().oneOfType([YX().number,YX().oneOf(["100%"])]).isRequired};const IJ=TJ;function EJ(t){var e=HX((0,C.useState)(t),2),n=e[0],r=e[1],a=(0,C.useRef)(),i=(0,C.useCallback)(function(t){"function"===typeof t?i(function(e){return t=t(e),a.current=t,t}):(a.current=t,i(t))},[a]);return a.current=n,[n,r,a]}function NJ(t,e){var n=DY()(t);if(FY()){var r=FY()(t);e&&(r=LY()(r).call(r,function(e){return BY()(t,e).enumerable})),n.push.apply(n,r)}return n}function CJ(t){for(var e=1;e<arguments.length;e++){var n,r=null!=arguments[e]?arguments[e]:{};if(e%2)RY()(n=NJ(Object(r),!0)).call(n,function(e){vY(t,e,r[e])});else if(UY())WY()(t,UY()(r));else{var a;RY()(a=NJ(Object(r))).call(a,function(e){HY()(t,e,BY()(r,e))})}}return t}var AJ="top",RJ={};function OJ(t){var e=t.mode,n=t.target,r=n.offsetHeight,a=n.scrollHeight,i=n.scrollTop,o=a-i-r<1,s=i<1;return{atBottom:o,atEnd:e===AJ?s:o,atStart:e!==AJ?s:o,atTop:s}}function DJ(t,e){return t===(e===AJ?0:"100%")}var MJ=function(t){var e=t.checkInterval,n=t.children,r=t.debounce,a=t.debug,i=t.initialScrollBehavior,o=t.mode,s=t.nonce,c=t.scroller,l=(0,C.useMemo)(function(){return function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).force;return void 0!==e&&e?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(n.length){var a=HX(n,1)[0];"function"===typeof a&&(n=a());var i=mJ()(n[0])?n:[n],o=1===i.length;RY()(i).call(i,function(e,n){var r,a;if(o)(r=console).log.apply(r,bY(yJ.apply(void 0,EY()(a=[t]).call(a,bY(e)))));else if(n){var i;(i=console).log.apply(i,bY(mJ()(e)?e:[e]))}else{var s,c;(s=console).groupCollapsed.apply(s,bY(yJ.apply(void 0,EY()(c=[t]).call(c,bY(e)))))}}),o||console.groupEnd()}}:function(){return 0}}("<ScrollToBottom>",{force:a})},[a]);o=o===AJ?AJ:"bottom";var u=(0,C.useRef)(0),h=(0,C.useRef)(i),d=HX(EJ(o===AJ?0:"100%"),3),f=d[0],p=d[1],m=d[2],g=HX(EJ(null),3),y=g[0],v=g[1],b=g[2],w=(0,C.useRef)(0),x=(0,C.useRef)(0),k=(0,C.useRef)(0),_=HX((0,C.useState)(!0),2),S=_[0],T=_[1],I=HX((0,C.useState)(!0),2),E=I[0],N=I[1],A=HX((0,C.useState)(!0),2),R=A[0],O=A[1],D=HX((0,C.useState)(!1),2),M=D[0],F=D[1],P=HX(EJ(!0),3),L=P[0],z=P[1],B=P[2],j=(0,C.useRef)([]),U=(0,C.useCallback)(function(t){var e=b.current;return j.current.push(t),e&&t({scrollTop:e.scrollTop}),function(){var e=j.current,n=_Y()(e).call(e,t);~n&&TY()(e).call(e,n,1)}},[j,b]),V=(0,C.useCallback)(function(){var t=m.current;l(function(){var e;return EY()(e=["%cSpineTo%c: %conEnd%c is fired."]).call(e,bY(gJ("magenta")),bY(gJ("orange")),[{animateTo:t}])}),u.current=CY()(),DJ(t,o)||z(!1),p(null)},[m,l,u,o,p,z]),W=(0,C.useCallback)(function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).behavior,n=b.current;if("number"!==typeof t&&"100%"!==t)return console.warn('react-scroll-to-bottom: Arguments passed to scrollTo() must be either number or "100%".');l(function(){var r;return[EY()(r=["%cscrollTo%c: Will scroll to %c".concat("number"===typeof t?t+"px":t.replace(/%/g,"%%"),"%c")]).call(r,bY(gJ("lime","")),bY(gJ("purple"))),{behavior:e,nextAnimateTo:t,target:n}]}),"auto"===e?(V(),n&&(n.scrollTop="100%"===t?n.scrollHeight-n.offsetHeight:t)):("smooth"!==e&&console.warn('react-scroll-to-bottom: Please set "behavior" when calling "scrollTo". In future versions, the default behavior will be changed from smooth scrolling to discrete scrolling to align with HTML Standard.'),p(t)),DJ(t,o)&&(l(function(){var e;return[EY()(e=["%cscrollTo%c: Scrolling to end, will set sticky to %ctrue%c."]).call(e,bY(gJ("lime","")),bY(gJ("purple"))),[{mode:o,nextAnimateTo:t}]]}),z(!0))},[l,V,o,p,z,b]),G=(0,C.useCallback)(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).behavior;l(function(){var t;return EY()(t=["%cscrollToBottom%c: Called"]).call(t,bY(gJ("yellow","")))}),"smooth"!==t&&console.warn('react-scroll-to-bottom: Please set "behavior" when calling "scrollToBottom". In future versions, the default behavior will be changed from smooth scrolling to discrete scrolling to align with HTML Standard.'),W("100%",{behavior:t||"smooth"})},[l,W]),H=(0,C.useCallback)(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).behavior;l(function(){var t;return EY()(t=["%cscrollToTop%c: Called"]).call(t,bY(gJ("yellow","")))}),"smooth"!==t&&console.warn('react-scroll-to-bottom: Please set "behavior" when calling "scrollToTop". In future versions, the default behavior will be changed from smooth scrolling to discrete scrolling to align with HTML Standard.'),W(0,{behavior:t||"smooth"})},[l,W]),q=(0,C.useCallback)(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).behavior;l(function(){var t;return EY()(t=["%cscrollToEnd%c: Called"]).call(t,bY(gJ("yellow","")))}),"smooth"!==t&&console.warn('react-scroll-to-bottom: Please set "behavior" when calling "scrollToEnd". In future versions, the default behavior will be changed from smooth scrolling to discrete scrolling to align with HTML Standard.');var e={behavior:t||"smooth"};o===AJ?H(e):G(e)},[l,o,G,H]),K=(0,C.useCallback)(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).behavior;l(function(){var t;return EY()(t=["%cscrollToStart%c: Called"]).call(t,bY(gJ("yellow","")))}),"smooth"!==t&&console.warn('react-scroll-to-bottom: Please set "behavior" when calling "scrollToStart". In future versions, the default behavior will be changed from smooth scrolling to discrete scrolling to align with HTML Standard.');var e={behavior:t||"smooth"};o===AJ?G(e):H(e)},[l,o,G,H]),X=(0,C.useCallback)(function(){var t=b.current;if(t){if("auto"===h.current)return l(function(){var t;return EY()(t=["%ctarget changed%c: Initial scroll"]).call(t,bY(gJ("blue")))}),t.scrollTop=o===AJ?0:t.scrollHeight-t.offsetHeight,void(h.current=!1);var e,n=w.current,r=t.offsetHeight,a=t.scrollHeight,i=t.scrollTop,s=o===AJ?0:Math.max(0,a-r-i),u=Math.max(0,n-i),d=c({maxValue:s,minValue:u,offsetHeight:r,scrollHeight:a,scrollTop:i}),f=Math.max(0,Math.min(s,d));e=o===AJ||f!==s?i+f:"100%",l(function(){var t,o,c;return[EY()(t=[EY()(o=EY()(c="%cscrollToSticky%c: Will animate from %c".concat(n,"px%c to %c")).call(c,"number"===typeof e?e+"px":e.replace(/%/g,"%%"),"%c (%c")).call(o,("100%"===e?s:e)+n,"px%c)")]).call(t,bY(gJ("orange")),bY(gJ("purple")),bY(gJ("purple")),bY(gJ("purple"))),{animateFrom:n,maxValue:s,minValue:u,nextAnimateTo:e,nextValue:f,offsetHeight:r,rawNextValue:d,scrollHeight:a,scrollTop:i}]}),W(e,{behavior:"smooth"})}},[w,l,o,c,W,b]),Y=(0,C.useCallback)(function(t){var e,n=t.timeStampLow,r=m.current,a=b.current,i=null!==r;if(!(n<=u.current)&&a){var s=OJ({mode:o,target:a}),c=s.atBottom,h=s.atEnd,d=s.atStart,f=s.atTop;T(c),N(h),F(d),O(f);var p=a.offsetHeight,g=a.scrollHeight,y=x.current,v=k.current,w=p!==y,_=g!==v;if(w&&(x.current=p),_&&(k.current=g),w||_)B.current&&(l(function(){var t;return[EY()(t=["%conScroll%c: Size changed while sticky, calling %cscrollToSticky()%c"]).call(t,bY(gJ("red")),bY(gJ("orange")),[{offsetHeightChanged:w,scrollHeightChanged:_}]),{nextOffsetHeight:p,prevOffsetHeight:y,nextScrollHeight:g,prevScrollHeight:v}]}),X());else{var S=i&&DJ(r,o)||h;B.current!==S&&(l(function(){var t,e,n,s;return[EY()(t=["%conScroll%c: %csetSticky%c(%c".concat(S,"%c)")]).call(t,bY(gJ("red")),bY(gJ("red")),bY(gJ("purple"))),EY()(e=[EY()(n=EY()(s="(animating = %c".concat(i,"%c && isEnd = %c")).call(s,DJ(r,o),"%c) || atEnd = %c")).call(n,h,"%c")]).call(e,bY(gJ("purple")),bY(gJ("purple")),bY(gJ("purple")),[{animating:i,animateTo:r,atEnd:h,mode:o,offsetHeight:a.offsetHeight,scrollHeight:a.scrollHeight,sticky:B.current,nextSticky:S}])]}),z(S))}var I=a.scrollTop;RY()(e=j.current).call(e,function(t){return t({scrollTop:I})})}},[m,l,u,o,x,k,j,X,T,N,F,O,z,B,b]);(0,C.useEffect)(function(){if(y){var t=!1,n=function(t,e){return t(),xY()(t,e)}(function(){var e=b.current,n=null!==m.current;B.current?OJ({mode:o,target:e}).atEnd?t=!1:t?CY()()-t>34&&(n||(w.current=e.scrollTop,l(function(){var t;return EY()(t=["%cInterval check%c: Should sticky but not at end, calling %cscrollToSticky()%c to scroll"]).call(t,bY(gJ("navy")),bY(gJ("orange")))}),X()),t=!1):t=CY()():e.scrollHeight<=e.offsetHeight&&!B.current&&(l(function(){var t;return[EY()(t=["%cInterval check%c: Container is emptied, setting sticky back to %ctrue%c"]).call(t,bY(gJ("navy")),bY(gJ("purple"))),[{offsetHeight:e.offsetHeight,scrollHeight:e.scrollHeight,sticky:B.current}]]}),z(!0))},Math.max(17,e)||17);return function(){return clearInterval(n)}}},[m,e,l,o,X,z,B,y,b]);var Q=(0,C.useMemo)(function(){var t=RJ[s]||(RJ[s]=hJ({key:"react-scroll-to-bottom--css-"+fJ()().toString(26).substr(2,5).replace(/[0-9]/g,function(t){return String.fromCharCode(t.charCodeAt(0)+65)}),nonce:s}));return function(e){return t.css(e)+""}},[s]),J=(0,C.useMemo)(function(){return{observeScrollPosition:U,setTarget:v,styleToClassName:Q}},[U,v,Q]),$=(0,C.useMemo)(function(){return{atBottom:S,atEnd:E,atStart:M,atTop:R,mode:o}},[S,E,M,R,o]),Z=(0,C.useMemo)(function(){var t=null!==f;return{animating:t,animatingToEnd:t&&DJ(f,o),sticky:L}},[f,o,L]),tt=(0,C.useMemo)(function(){return CJ(CJ({},$),Z)},[$,Z]),et=(0,C.useMemo)(function(){return{scrollTo:W,scrollToBottom:G,scrollToEnd:q,scrollToStart:K,scrollToTop:H}},[W,G,q,K,H]);return(0,C.useEffect)(function(){if(y){var t=function(){k.current=y.scrollHeight};return y.addEventListener("focus",t,{capture:!0,passive:!0}),function(){return y.removeEventListener("focus",t)}}},[y]),l(function(){var t;return[EY()(t=["%cRender%c: Render"]).call(t,bY(gJ("cyan",""))),{animateTo:f,animating:null!==f,sticky:L,target:y}]}),C.createElement(cY.Provider,{value:J},C.createElement(JX.Provider,{value:et},C.createElement(aY.Provider,{value:tt},C.createElement(tY.Provider,{value:$},C.createElement(nY.Provider,{value:Z},n,y&&C.createElement(xJ,{debounce:r,name:"scroll",onEvent:Y,target:y}),y&&null!==f&&C.createElement(IJ,{name:"scrollTop",onEnd:V,target:y,value:f}))))))};MJ.defaultProps={checkInterval:100,children:void 0,debounce:17,debug:void 0,initialScrollBehavior:"smooth",mode:void 0,nonce:void 0,scroller:function(){return 1/0}},MJ.propTypes={checkInterval:YX().number,children:YX().any,debounce:YX().number,debug:YX().bool,initialScrollBehavior:YX().oneOf(["auto","smooth"]),mode:YX().oneOf(["bottom","top"]),nonce:YX().string,scroller:YX().func};const FJ=MJ;var PJ={height:"100%",overflowY:"auto",width:"100%"},LJ=function(t){var e=t.children,n=t.className,r=(0,C.useContext)(cY).setTarget,a=lY()(PJ);return C.createElement("div",{className:KX()(a,(n||"")+""),ref:r},e)};LJ.defaultProps={children:void 0,className:void 0},LJ.propTypes={children:YX().any,className:YX().string};const zJ=LJ;var BJ={position:"relative"},jJ=function(t){var e=t.children,n=t.className,r=t.followButtonClassName,a=t.scrollViewClassName,i=lY()(BJ);return C.createElement("div",{className:KX()(i,(n||"")+"")},C.createElement(zJ,{className:(a||"")+""},e),C.createElement(dY,{className:(r||"")+""}))};jJ.defaultProps={children:void 0,className:void 0,followButtonClassName:void 0,scrollViewClassName:void 0},jJ.propTypes={children:YX().any,className:YX().string,followButtonClassName:YX().string,scrollViewClassName:YX().string};var UJ=function(t){var e=t.checkInterval,n=t.children,r=t.className,a=t.debounce,i=t.debug,o=t.followButtonClassName,s=t.initialScrollBehavior,c=t.mode,l=t.nonce,u=t.scroller,h=t.scrollViewClassName;return C.createElement(FJ,{checkInterval:e,debounce:a,debug:i,initialScrollBehavior:s,mode:c,nonce:l,scroller:u},C.createElement(jJ,{className:r,followButtonClassName:o,scrollViewClassName:h},n))};UJ.defaultProps={checkInterval:void 0,children:void 0,className:void 0,debounce:void 0,debug:void 0,followButtonClassName:void 0,initialScrollBehavior:"smooth",mode:void 0,nonce:void 0,scroller:void 0,scrollViewClassName:void 0},UJ.propTypes={checkInterval:YX().number,children:YX().any,className:YX().string,debounce:YX().number,debug:YX().bool,followButtonClassName:YX().string,initialScrollBehavior:YX().oneOf(["auto","smooth"]),mode:YX().oneOf(["bottom","top"]),nonce:YX().string,scroller:YX().func,scrollViewClassName:YX().string};!function(t,e){try{var r=n.g.document;if("undefined"!==typeof r&&r.createElement&&r.head&&r.head.appendChild){var a=r.querySelector('html meta[name="'.concat(encodeURI(t),'"]'))||r.createElement("meta");a.setAttribute("name",t),a.setAttribute("content",e),r.head.appendChild(a)}}catch(Hrt){}}("react-scroll-to-bottom:version","4.2.0"),window.webgazer=IX;const VJ=()=>{const t=(0,C.useRef)(null),[e,n]=(0,C.useState)({name:"",location:"",education:"",fatherName:"",motherName:"",siblings:"",resume:null});let r=null;const[a,i]=(0,C.useState)(""),[o,s]=(0,C.useState)(!1),[c,l]=(0,C.useState)(null),[u,h]=(0,C.useState)(1),[d,f]=(0,C.useState)([]),p=(0,C.useRef)(null),[m,g]=(0,C.useState)(!1),[y,v]=(0,C.useState)(!1),[b,w]=(0,C.useState)(""),[x,k]=(0,C.useState)(!1),[_,S]=(0,C.useState)(null),[T,I]=(0,C.useState)(null),[E,N]=(0,C.useState)(0),[A,R]=(0,C.useState)(0),[O,D]=(0,C.useState)(""),{transcript:M,listening:F,resetTranscript:P,browserSupportsSpeechRecognition:L}=ta();(0,C.useEffect)(()=>{var e;(m||a)&&(null===(e=t.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))},[m,a]);const z=async()=>{for(let t=0;t<5;t++){const t=(await Mr.get("".concat("http://localhost:5000","/api/expert"))).data.question;if(!d.includes(t))return f(e=>[...e,t]),t}return"Unable to generate a unique question. Please try again later."},B=()=>{ea.stopListening();const t=Date.now();if(I(t),_){const e=(t-_)/1e3,n=M.trim().split(/\s+/).filter(Boolean).length/(e/60);R(e),N(n.toFixed(2));let r="Needs improvement";n>=90?r="Excellent fluency!":n>=80?r="Very good fluency!":n>=70?r="Good fluency!":n>=60&&(r="Good, but can improve."),D(r)}};(0,C.useEffect)(()=>{const t=()=>{if(window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end()}catch(Grt){console.warn("webgazer.end() cleanup error:",Grt)}g(!1)};return window.addEventListener("beforeunload",t),()=>{if(window.removeEventListener("beforeunload",t),window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end()}catch(Grt){console.warn("webgazer.end() cleanup error:",Grt)}g(!1)}},[]),(0,C.useEffect)(()=>{if(m){(async()=>{try{const t=await navigator.mediaDevices.getUserMedia({video:!0});p.current&&(p.current.srcObject=t)}catch(Hrt){console.error("Camera access denied or not available",Hrt)}})()}},[m]),(0,C.useEffect)(()=>{M.toLowerCase().includes("stop")&&(B(),console.log("Voice command 'stop' detected. Stopping..."))},[M]);(0,C.useEffect)(()=>{F&&(r&&clearTimeout(r),r=setTimeout(()=>{B(),console.log("Auto-stopped due to silence.")},4e3))},[M]);return L?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)(NX,{}),(0,ra.jsxs)(ps,{children:[(0,ra.jsx)("div",{className:"container",style:{marginTop:"20px",marginBottom:"20px"},children:(0,ra.jsx)(ps,{children:(0,ra.jsx)("div",{className:"card shadow-lg rounded-3 ",style:{marginTop:"100px"},children:(0,ra.jsxs)("div",{className:"card-body",children:[(0,ra.jsx)("h2",{className:"card-title mb-4",children:"Expert language Improvement"}),m&&(0,ra.jsxs)("div",{className:"mb-4 ",children:[(0,ra.jsx)("h4",{className:"h6 fw-bold",children:"Eye Tracking Camera (Live)"}),(0,ra.jsx)("video",{ref:p,autoPlay:!0,playsInline:!0,className:"w-100 rounded border",style:{maxHeight:"220px"}}),(0,ra.jsx)("button",{className:"btn btn-danger",onClick:()=>{if(window.webgazer&&"function"===typeof window.webgazer.end)try{window.webgazer.end(),console.log("WebGazer stopped.")}catch(Grt){console.warn("Error stopping WebGazer:",Grt)}if(p.current&&p.current.srcObject){p.current.srcObject.getTracks().forEach(t=>{try{t.stop()}catch(Grt){console.warn("Error stopping camera track:",Grt)}}),p.current.srcObject=null,console.log("Camera stopped.")}g(!1)},children:"Close Camera"})]}),a?(0,ra.jsxs)("div",{className:"mt-5 p-3 bg-light rounded border",children:[(0,ra.jsxs)("h4",{className:"h4 fw-bold mb-2",children:[" Question ",u,":"]}),(0,ra.jsx)("h2",{children:a}),!x&&(0,ra.jsx)("button",{onClick:async()=>{const t=await(async t=>{try{return(await Mr.post("".concat("http://localhost:5000","/api/answerexpert"),{text:t})).data.answer}catch(e){return console.error("Error fetching AI answer:",e),"Unable to generate answer. Please try again later."}})(a);w(t),k(!0),console.log("ai answer",t)},className:"btn btn-secondary mb-3",children:"Check Answer"}),x&&(0,ra.jsxs)("div",{className:"alert alert-info mt-2",children:[(0,ra.jsx)("strong",{children:"AI Answer:"})," ",b]}),(0,ra.jsxs)("div",{className:"mt-3",children:[(0,ra.jsx)("h3",{className:"h4 fw-bold",children:"Your Answer (Voice Input)"}),(0,ra.jsx)("h2",{className:"text-secondary mb-2",children:M||"Your speech will appear here..."}),(0,ra.jsxs)("div",{className:"d-flex gap-3 mb-3",children:[(0,ra.jsxs)("div",{className:"d-flex justifyContent-space-between pd-5",children:[(0,ra.jsx)("button",{type:"button",onClick:()=>{P(),S(Date.now()),ea.startListening({continuous:!0})},className:"btn btn-success hover-effect",children:"Start Talking"}),(0,ra.jsx)("button",{type:"button",onClick:B,className:"btn btn-danger",style:{marginLeft:"10px"},children:"Stop"}),(0,ra.jsx)("button",{type:"button",onClick:()=>{ea&&"function"===typeof ea.stopListening&&ea.stopListening(),l(null),D(""),N(0),R(0),k(!1),w(""),S(null),I(null),P()},className:"btn btn-secondary",style:{marginLeft:"10px"},children:"Reset"})]}),(0,ra.jsx)("button",{onClick:async()=>{try{const t=await Mr.post("".concat("http://localhost:5000","/api/analyze-answer"),{text:M});l(t.data)}catch(t){console.error("Error analyzing transcript:",t)}},className:"btn btn-primary",children:"Check Analyasis"})]})]}),c&&(0,ra.jsxs)("div",{children:[(0,ra.jsx)("h4",{className:"h6 fw-bold mb-2",children:" Answer Analysis"}),(0,ra.jsxs)("div",{className:"d-flex flex-row gap-2",children:[(0,ra.jsxs)("div",{className:"mt-4 p-3 bg-warning bg-opacity-25 rounded",children:[(0,ra.jsxs)("p",{children:["Fluency Feedback: ",O]}),(0,ra.jsx)("div",{children:(0,ra.jsx)(aa,{value:E})})]}),(0,ra.jsxs)("div",{className:"mt-4 p-3 bg-warning bg-opacity-25 rounded",children:[(0,ra.jsxs)("p",{children:["Grammar Accuracy: ",c.grammar,"%"]}),(0,ra.jsx)("div",{children:(0,ra.jsx)(aa,{value:c.grammar})})]})]})]}),(0,ra.jsx)("div",{className:"text-end",children:(0,ra.jsx)("button",{onClick:async()=>{s(!0);try{const t=await z();i(t),P(),l(null),h(t=>t+1),w(""),k(!1)}catch(t){console.error("Error generating next question:",t)}s(!1)},className:"btn btn-info mt-2",children:o?(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Generating..."]}):"Next Question"})})]}):(0,ra.jsx)("div",{className:"d-flex justify-content-center  my-4",children:(0,ra.jsx)("button",{onClick:async t=>{t.preventDefault(),s(!0);try{const t=await z();i(t),P(),l(null),g(!0),IX&&IX.setGazeListener?(IX.setGazeListener((t,e)=>{t&&console.log("Gaze at:",t.x,t.y)}).begin(),IX.showVideo(!1).showFaceOverlay(!1).showFaceFeedbackBox(!1)):console.warn("webgazer is not available.")}catch(e){console.error("Error sending data to GPT API:",e)}s(!1)},className:"btn btn-primary btn-lg px-5 py-3 fw-bold shadow",style:{transition:"0.3s"},onMouseOver:t=>t.target.style.transform="scale(1.05)",onMouseOut:t=>t.target.style.transform="scale(1)",children:"Check\xa0>>"})})]})})})})," "]})]}):(0,ra.jsx)("span",{children:"Your browser does not support speech recognition."})};var WJ={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},GJ=C.createContext&&C.createContext(WJ),HJ=["attr","size","title"];function qJ(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function KJ(){return KJ=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},KJ.apply(this,arguments)}function XJ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function YJ(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?XJ(Object(n),!0).forEach(function(e){QJ(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XJ(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function QJ(t,e,n){return e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JJ(t){return t&&t.map((t,e)=>C.createElement(t.tag,YJ({key:e},t.attr),JJ(t.child)))}function $J(t){return e=>C.createElement(ZJ,KJ({attr:YJ({},t.attr)},e),JJ(t.child))}function ZJ(t){var e=e=>{var n,{attr:r,size:a,title:i}=t,o=qJ(t,HJ),s=a||e.size||"1em";return e.className&&(n=e.className),t.className&&(n=(n?n+" ":"")+t.className),C.createElement("svg",KJ({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},e.attr,r,o,{className:n,style:YJ(YJ({color:t.color||e.color},e.style),t.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),i&&C.createElement("title",null,i),t.children)};return void 0!==GJ?C.createElement(GJ.Consumer,null,t=>e(t)):e(WJ)}function t$(t){return $J({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"g",attr:{fill:"#FFA726"},child:[{tag:"circle",attr:{cx:"10",cy:"26",r:"4"},child:[]},{tag:"circle",attr:{cx:"38",cy:"26",r:"4"},child:[]}]},{tag:"path",attr:{fill:"#FFB74D",d:"M39,19c0-12.7-30-8.3-30,0c0,1.8,0,8.2,0,10c0,8.3,6.7,15,15,15s15-6.7,15-15C39,27.2,39,20.8,39,19z"},child:[]},{tag:"path",attr:{fill:"#FF5722",d:"M24,3C14.6,3,7,10.6,7,20c0,1.2,0,3.4,0,3.4L9,25v-3l21-9.8l9,9.8v3l2-1.6c0,0,0-2.1,0-3.4 C41,12,35.3,3,24,3z"},child:[]},{tag:"g",attr:{fill:"#784719"},child:[{tag:"circle",attr:{cx:"31",cy:"26",r:"2"},child:[]},{tag:"circle",attr:{cx:"17",cy:"26",r:"2"},child:[]}]},{tag:"path",attr:{fill:"#757575",d:"M43,24c-0.6,0-1,0.4-1,1v-7c0-8.8-7.2-16-16-16h-7c-0.6,0-1,0.4-1,1s0.4,1,1,1h7c7.7,0,14,6.3,14,14v10 c0,0.6,0.4,1,1,1s1-0.4,1-1v2c0,3.9-3.1,7-7,7H24c-0.6,0-1,0.4-1,1s0.4,1,1,1h11c5,0,9-4,9-9v-5C44,24.4,43.6,24,43,24z"},child:[]},{tag:"g",attr:{fill:"#37474F"},child:[{tag:"path",attr:{d:"M43,22h-1c-1.1,0-2,0.9-2,2v4c0,1.1,0.9,2,2,2h1c1.1,0,2-0.9,2-2v-4C45,22.9,44.1,22,43,22z"},child:[]},{tag:"circle",attr:{cx:"24",cy:"38",r:"2"},child:[]}]}]})(t)}function e$(t){return $J({tag:"svg",attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r\n\tc0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r\n\tc0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"},child:[]},{tag:"path",attr:{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r\n\tC34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"},child:[]},{tag:"path",attr:{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r\n\tc-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"},child:[]},{tag:"path",attr:{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r\n\tc0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"},child:[]}]})(t)}function n$(t){return $J({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#5C6BC0",d:"M40,40c-6.9,0-16,4-16,4V22c0,0,9-4,18-4L40,40z"},child:[]},{tag:"path",attr:{fill:"#7986CB",d:"M8,40c6.9,0,16,4,16,4V22c0,0-9-4-18-4L8,40z"},child:[]},{tag:"g",attr:{fill:"#FFB74D"},child:[{tag:"circle",attr:{cx:"24",cy:"12",r:"8"},child:[]},{tag:"path",attr:{d:"M41,32h1c0.6,0,1-0.4,1-1v-4c0-0.6-0.4-1-1-1h-1c-1.7,0-3,1.3-3,3v0C38,30.7,39.3,32,41,32z"},child:[]},{tag:"path",attr:{d:"M7,26H6c-0.6,0-1,0.4-1,1v4c0,0.6,0.4,1,1,1h1c1.7,0,3-1.3,3-3v0C10,27.3,8.7,26,7,26z"},child:[]}]}]})(t)}function r$(t){return $J({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#455A64",d:"M36,4H26c0,1.1-0.9,2-2,2s-2-0.9-2-2H12C9.8,4,8,5.8,8,8v32c0,2.2,1.8,4,4,4h24c2.2,0,4-1.8,4-4V8 C40,5.8,38.2,4,36,4z"},child:[]},{tag:"path",attr:{fill:"#fff",d:"M36,41H12c-0.6,0-1-0.4-1-1V8c0-0.6,0.4-1,1-1h24c0.6,0,1,0.4,1,1v32C37,40.6,36.6,41,36,41z"},child:[]},{tag:"g",attr:{fill:"#90A4AE"},child:[{tag:"path",attr:{d:"M26,4c0,1.1-0.9,2-2,2s-2-0.9-2-2h-7v4c0,1.1,0.9,2,2,2h14c1.1,0,2-0.9,2-2V4H26z"},child:[]},{tag:"path",attr:{d:"M24,0c-2.2,0-4,1.8-4,4s1.8,4,4,4s4-1.8,4-4S26.2,0,24,0z M24,6c-1.1,0-2-0.9-2-2s0.9-2,2-2s2,0.9,2,2 S25.1,6,24,6z"},child:[]}]},{tag:"g",attr:{fill:"#CFD8DC"},child:[{tag:"rect",attr:{x:"21",y:"20",width:"12",height:"2"},child:[]},{tag:"rect",attr:{x:"15",y:"19",width:"4",height:"4"},child:[]}]},{tag:"g",attr:{fill:"#03A9F4"},child:[{tag:"rect",attr:{x:"21",y:"29",width:"12",height:"2"},child:[]},{tag:"rect",attr:{x:"15",y:"28",width:"4",height:"4"},child:[]}]}]})(t)}function a$(t){return $J({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#3F51B5",d:"M42,29H20.8c-0.5,0-1-0.2-1.4-0.6l-3.7-3.7c-0.4-0.4-0.4-1,0-1.4l3.7-3.7c0.4-0.4,0.9-0.6,1.4-0.6H42 c0.6,0,1,0.4,1,1v8C43,28.6,42.6,29,42,29z"},child:[]},{tag:"rect",attr:{x:"9",y:"6",fill:"#CFD8DC",width:"2",height:"36"},child:[]},{tag:"g",attr:{fill:"#90A4AE"},child:[{tag:"circle",attr:{cx:"10",cy:"10",r:"3"},child:[]},{tag:"circle",attr:{cx:"10",cy:"24",r:"3"},child:[]},{tag:"circle",attr:{cx:"10",cy:"38",r:"3"},child:[]}]},{tag:"path",attr:{fill:"#448AFF",d:"M34,43H20.8c-0.5,0-1-0.2-1.4-0.6l-3.7-3.7c-0.4-0.4-0.4-1,0-1.4l3.7-3.7c0.4-0.4,0.9-0.6,1.4-0.6H34 c0.6,0,1,0.4,1,1v8C35,42.6,34.6,43,34,43z"},child:[]},{tag:"path",attr:{fill:"#00BCD4",d:"M35,15H20.8c-0.5,0-1-0.2-1.4-0.6l-3.7-3.7c-0.4-0.4-0.4-1,0-1.4l3.7-3.7C19.8,5.2,20.3,5,20.8,5H35 c0.6,0,1,0.4,1,1v8C36,14.6,35.6,15,35,15z"},child:[]}]})(t)}function i$(t){return $J({tag:"svg",attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#2196F3",d:"M40,22h-8l-4,4V12c0-2.2,1.8-4,4-4h8c2.2,0,4,1.8,4,4v6C44,20.2,42.2,22,40,22z"},child:[]},{tag:"circle",attr:{fill:"#FFA726",cx:"17",cy:"19",r:"8"},child:[]},{tag:"path",attr:{fill:"#607D8B",d:"M30,36.7c0,0-3.6-6.7-13-6.7S4,36.7,4,36.7V40h26V36.7z"},child:[]}]})(t)}function o$(t){return $J({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M333.5,201.4c0-22.1-15.6-34.3-43-34.3h-50.4v71.2h42.5C315.4,238.2,333.5,225,333.5,201.4z M517,188.6 c-9.5-30.9-10.9-68.8-9.8-98.1c1.1-30.5-22.7-58.5-54.7-58.5H123.7c-32.1,0-55.8,28.1-54.7,58.5c1,29.3-0.3,67.2-9.8,98.1 c-9.6,31-25.7,50.6-52.2,53.1v28.5c26.4,2.5,42.6,22.1,52.2,53.1c9.5,30.9,10.9,68.8,9.8,98.1c-1.1,30.5,22.7,58.5,54.7,58.5h328.7 c32.1,0,55.8-28.1,54.7-58.5c-1-29.3,0.3-67.2,9.8-98.1c9.6-31,25.7-50.6,52.1-53.1v-28.5C542.7,239.2,526.5,219.6,517,188.6z M300.2,375.1h-97.9V136.8h97.4c43.3,0,71.7,23.4,71.7,59.4c0,25.3-19.1,47.9-43.5,51.8v1.3c33.2,3.6,55.5,26.6,55.5,58.3 C383.4,349.7,352.1,375.1,300.2,375.1z M290.2,266.4h-50.1v78.4h52.3c34.2,0,52.3-13.7,52.3-39.5 C344.7,279.6,326.1,266.4,290.2,266.4z"},child:[]}]})(t)}function s$(t){return $J({tag:"svg",attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(t)}function c$(t){return $J({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 508c-6.7 0-13.5-1.8-19.4-5.2l-61.7-36.5c-9.2-5.2-4.7-7-1.7-8 12.3-4.3 14.8-5.2 27.9-12.7 1.4-.8 3.2-.5 4.6.4l47.4 28.1c1.7 1 4.1 1 5.7 0l184.7-106.6c1.7-1 2.8-3 2.8-5V149.3c0-2.1-1.1-4-2.9-5.1L226.8 37.7c-1.7-1-4-1-5.7 0L36.6 144.3c-1.8 1-2.9 3-2.9 5.1v213.1c0 2 1.1 4 2.9 4.9l50.6 29.2c27.5 13.7 44.3-2.4 44.3-18.7V167.5c0-3 2.4-5.3 5.4-5.3h23.4c2.9 0 5.4 2.3 5.4 5.3V378c0 36.6-20 57.6-54.7 57.6-10.7 0-19.1 0-42.5-11.6l-48.4-27.9C8.1 389.2.7 376.3.7 362.4V149.3c0-13.8 7.4-26.8 19.4-33.7L204.6 9c11.7-6.6 27.2-6.6 38.8 0l184.7 106.7c12 6.9 19.4 19.8 19.4 33.7v213.1c0 13.8-7.4 26.7-19.4 33.7L243.4 502.8c-5.9 3.4-12.6 5.2-19.4 5.2zm149.1-210.1c0-39.9-27-50.5-83.7-58-57.4-7.6-63.2-11.5-63.2-24.9 0-11.1 4.9-25.9 47.4-25.9 37.9 0 51.9 8.2 57.7 33.8.5 2.4 2.7 4.2 5.2 4.2h24c1.5 0 2.9-.6 3.9-1.7s1.5-2.6 1.4-4.1c-3.7-44.1-33-64.6-92.2-64.6-52.7 0-84.1 22.2-84.1 59.5 0 40.4 31.3 51.6 81.8 56.6 60.5 5.9 65.2 14.8 65.2 26.7 0 20.6-16.6 29.4-55.5 29.4-48.9 0-59.6-12.3-63.2-36.6-.4-2.6-2.6-4.5-5.3-4.5h-23.9c-3 0-5.3 2.4-5.3 5.3 0 31.1 16.9 68.2 97.8 68.2 58.4-.1 92-23.2 92-63.4z"},child:[]}]})(t)}function l$(t){return $J({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M418.2 177.2c-5.4-1.8-10.8-3.5-16.2-5.1.9-3.7 1.7-7.4 2.5-11.1 12.3-59.6 4.2-107.5-23.1-123.3-26.3-15.1-69.2.6-112.6 38.4-4.3 3.7-8.5 7.6-12.5 11.5-2.7-2.6-5.5-5.2-8.3-7.7-45.5-40.4-91.1-57.4-118.4-41.5-26.2 15.2-34 60.3-23 116.7 1.1 5.6 2.3 11.1 3.7 16.7-6.4 1.8-12.7 3.8-18.6 5.9C38.3 196.2 0 225.4 0 255.6c0 31.2 40.8 62.5 96.3 81.5 4.5 1.5 9 3 13.6 4.3-1.5 6-2.8 11.9-4 18-10.5 55.5-2.3 99.5 23.9 114.6 27 15.6 72.4-.4 116.6-39.1 3.5-3.1 7-6.3 10.5-9.7 4.4 4.3 9 8.4 13.6 12.4 42.8 36.8 85.1 51.7 111.2 36.6 27-15.6 35.8-62.9 24.4-120.5-.9-4.4-1.9-8.9-3-13.5 3.2-.9 6.3-1.9 9.4-2.9 57.7-19.1 99.5-50 99.5-81.7 0-30.3-39.4-59.7-93.8-78.4zM282.9 92.3c37.2-32.4 71.9-45.1 87.7-36 16.9 9.7 23.4 48.9 12.8 100.4-.7 3.4-1.4 6.7-2.3 10-22.2-5-44.7-8.6-67.3-10.6-13-18.6-27.2-36.4-42.6-53.1 3.9-3.7 7.7-7.2 11.7-10.7zM167.2 307.5c5.1 8.7 10.3 17.4 15.8 25.9-15.6-1.7-31.1-4.2-46.4-7.5 4.4-14.4 9.9-29.3 16.3-44.5 4.6 8.8 9.3 17.5 14.3 26.1zm-30.3-120.3c14.4-3.2 29.7-5.8 45.6-7.8-5.3 8.3-10.5 16.8-15.4 25.4-4.9 8.5-9.7 17.2-14.2 26-6.3-14.9-11.6-29.5-16-43.6zm27.4 68.9c6.6-13.8 13.8-27.3 21.4-40.6s15.8-26.2 24.4-38.9c15-1.1 30.3-1.7 45.9-1.7s31 .6 45.9 1.7c8.5 12.6 16.6 25.5 24.3 38.7s14.9 26.7 21.7 40.4c-6.7 13.8-13.9 27.4-21.6 40.8-7.6 13.3-15.7 26.2-24.2 39-14.9 1.1-30.4 1.6-46.1 1.6s-30.9-.5-45.6-1.4c-8.7-12.7-16.9-25.7-24.6-39s-14.8-26.8-21.5-40.6zm180.6 51.2c5.1-8.8 9.9-17.7 14.6-26.7 6.4 14.5 12 29.2 16.9 44.3-15.5 3.5-31.2 6.2-47 8 5.4-8.4 10.5-17 15.5-25.6zm14.4-76.5c-4.7-8.8-9.5-17.6-14.5-26.2-4.9-8.5-10-16.9-15.3-25.2 16.1 2 31.5 4.7 45.9 8-4.6 14.8-10 29.2-16.1 43.4zM256.2 118.3c10.5 11.4 20.4 23.4 29.6 35.8-19.8-.9-39.7-.9-59.5 0 9.8-12.9 19.9-24.9 29.9-35.8zM140.2 57c16.8-9.8 54.1 4.2 93.4 39 2.5 2.2 5 4.6 7.6 7-15.5 16.7-29.8 34.5-42.9 53.1-22.6 2-45 5.5-67.2 10.4-1.3-5.1-2.4-10.3-3.5-15.5-9.4-48.4-3.2-84.9 12.6-94zm-24.5 263.6c-4.2-1.2-8.3-2.5-12.4-3.9-21.3-6.7-45.5-17.3-63-31.2-10.1-7-16.9-17.8-18.8-29.9 0-18.3 31.6-41.7 77.2-57.6 5.7-2 11.5-3.8 17.3-5.5 6.8 21.7 15 43 24.5 63.6-9.6 20.9-17.9 42.5-24.8 64.5zm116.6 98c-16.5 15.1-35.6 27.1-56.4 35.3-11.1 5.3-23.9 5.8-35.3 1.3-15.9-9.2-22.5-44.5-13.5-92 1.1-5.6 2.3-11.2 3.7-16.7 22.4 4.8 45 8.1 67.9 9.8 13.2 18.7 27.7 36.6 43.2 53.4-3.2 3.1-6.4 6.1-9.6 8.9zm24.5-24.3c-10.2-11-20.4-23.2-30.3-36.3 9.6.4 19.5.6 29.5.6 10.3 0 20.4-.2 30.4-.7-9.2 12.7-19.1 24.8-29.6 36.4zm130.7 30c-.9 12.2-6.9 23.6-16.5 31.3-15.9 9.2-49.8-2.8-86.4-34.2-4.2-3.6-8.4-7.5-12.7-11.5 15.3-16.9 29.4-34.8 42.2-53.6 22.9-1.9 45.7-5.4 68.2-10.5 1 4.1 1.9 8.2 2.7 12.2 4.9 21.6 5.7 44.1 2.5 66.3zm18.2-107.5c-2.8.9-5.6 1.8-8.5 2.6-7-21.8-15.6-43.1-25.5-63.8 9.6-20.4 17.7-41.4 24.5-62.9 5.2 1.5 10.2 3.1 15 4.7 46.6 16 79.3 39.8 79.3 58 0 19.6-34.9 44.9-84.8 61.4zm-149.7-15c25.3 0 45.8-20.5 45.8-45.8s-20.5-45.8-45.8-45.8c-25.3 0-45.8 20.5-45.8 45.8s20.5 45.8 45.8 45.8z"},child:[]}]})(t)}function u$(t){return $J({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M24 18.588a1.529 1.529 0 01-1.895-.72l-3.45-4.771-.5-.667-4.003 5.444a1.466 1.466 0 01-1.802.708l5.158-6.92-4.798-6.251a1.595 1.595 0 011.9.666l3.576 4.83 3.596-4.81a1.435 1.435 0 011.788-.668L21.708 7.9l-2.522 3.283a.666.666 0 000 .994l4.804 6.412zM.002 11.576l.42-2.075c1.154-4.103 5.858-5.81 9.094-3.27 1.895 1.489 2.368 3.597 2.275 5.973H1.116C.943 16.447 4.005 19.009 7.92 17.7a4.078 4.078 0 002.582-2.876c.207-.666.548-.78 1.174-.588a5.417 5.417 0 01-2.589 3.957 6.272 6.272 0 01-7.306-.933 6.575 6.575 0 01-1.64-3.858c0-.235-.08-.455-.134-.666A88.33 88.33 0 010 11.577zm1.127-.286h9.654c-.06-3.076-2.001-5.258-4.59-5.278-2.882-.04-4.944 2.094-5.071 5.264z"},child:[]}]})(t)}function h$(t){return $J({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.872zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z"},child:[]}]})(t)}function d$(){return(0,ra.jsxs)(ra.Fragment,{children:[(0,ra.jsx)(NX,{}),(0,ra.jsxs)("div",{className:"container py-5",style:{marginTop:"30px",marginBottom:"50px"},children:[(0,ra.jsxs)("div",{className:"text-center mb-5",children:[(0,ra.jsx)("h1",{className:"display-4 fw-bold text-primary",children:"About PreBoost"}),(0,ra.jsx)("p",{className:"lead",children:"Revolutionizing Interview Preparation with AI and Advanced Analytics"})]}),(0,ra.jsx)("div",{className:"card shadow-lg rounded-4 border-0 overflow-hidden mb-5",children:(0,ra.jsxs)("div",{className:"card-body p-5",children:[(0,ra.jsx)("h2",{className:"fw-bold mb-4 text-primary",children:"Our Mission"}),(0,ra.jsx)("p",{className:"fs-5",children:"PreBoost is an innovative web-based platform designed to empower engineering students with cutting-edge interview preparation tools. We combine AI-generated questions, real-time speech analysis, and eye-tracking technology to create the most realistic and effective interview simulation experience."})]})}),(0,ra.jsxs)("div",{className:"row g-4 mb-5",children:[(0,ra.jsx)("div",{className:"col-md-6",children:(0,ra.jsx)("div",{className:"card h-100 shadow-sm rounded-4 border-0",children:(0,ra.jsxs)("div",{className:"card-body p-4",children:[(0,ra.jsx)("h3",{className:"fw-bold mb-4 text-primary",children:"Key Features"}),(0,ra.jsxs)("div",{className:"d-flex mb-3",children:[(0,ra.jsx)("div",{className:"me-3",children:(0,ra.jsx)(t$,{size:30})}),(0,ra.jsxs)("div",{children:[(0,ra.jsx)("h5",{className:"fw-bold",children:"AI-Driven Questions"}),(0,ra.jsx)("p",{children:"Dynamic technical questions tailored to your education, location, and resume"})]})]}),(0,ra.jsxs)("div",{className:"d-flex mb-3",children:[(0,ra.jsx)("div",{className:"me-3",children:(0,ra.jsx)(i$,{size:30})}),(0,ra.jsxs)("div",{children:[(0,ra.jsx)("h5",{className:"fw-bold",children:"Smart Speech Analysis"}),(0,ra.jsx)("p",{children:"Real-time transcription with WPM & fluency feedback"})]})]}),(0,ra.jsxs)("div",{className:"d-flex mb-3",children:[(0,ra.jsx)("div",{className:"me-3",children:(0,ra.jsx)(a$,{size:30})}),(0,ra.jsxs)("div",{children:[(0,ra.jsx)("h5",{className:"fw-bold",children:"Eye Tracking"}),(0,ra.jsx)("p",{children:"WebGazer.js monitors your focus during responses"})]})]}),(0,ra.jsxs)("div",{className:"d-flex",children:[(0,ra.jsx)("div",{className:"me-3",children:(0,ra.jsx)(r$,{size:30})}),(0,ra.jsxs)("div",{children:[(0,ra.jsx)("h5",{className:"fw-bold",children:"Resume-Based Practice"}),(0,ra.jsx)("p",{children:"Upload your resume for personalized question generation"})]})]})]})})}),(0,ra.jsx)("div",{className:"col-md-6",children:(0,ra.jsx)("div",{className:"card h-100 shadow-sm rounded-4 border-0",children:(0,ra.jsxs)("div",{className:"card-body p-4",children:[(0,ra.jsx)("h3",{className:"fw-bold mb-4 text-primary",children:"Technology Stack"}),(0,ra.jsxs)("div",{className:"row g-3",children:[(0,ra.jsx)("div",{className:"col-6",children:(0,ra.jsxs)("div",{className:"p-3 bg-light rounded-3 text-center",children:[(0,ra.jsx)(l$,{size:30,className:"text-primary mb-2"}),(0,ra.jsx)("h6",{children:"React.js"})]})}),(0,ra.jsx)("div",{className:"col-6",children:(0,ra.jsxs)("div",{className:"p-3 bg-light rounded-3 text-center",children:[(0,ra.jsx)(o$,{size:30,className:"text-primary mb-2"}),(0,ra.jsx)("h6",{children:"Bootstrap 5"})]})}),(0,ra.jsx)("div",{className:"col-6",children:(0,ra.jsxs)("div",{className:"p-3 bg-light rounded-3 text-center",children:[(0,ra.jsx)(c$,{size:30,className:"text-success mb-2"}),(0,ra.jsx)("h6",{children:"Node.js"})]})}),(0,ra.jsx)("div",{className:"col-6",children:(0,ra.jsxs)("div",{className:"p-3 bg-light rounded-3 text-center",children:[(0,ra.jsx)(u$,{size:30,className:"mb-2"}),(0,ra.jsx)("h6",{children:"Express"})]})}),(0,ra.jsx)("div",{className:"col-6",children:(0,ra.jsxs)("div",{className:"p-3 bg-light rounded-3 text-center",children:[(0,ra.jsx)(h$,{size:30,className:"mb-2"}),(0,ra.jsx)("h6",{children:"OpenAI API"})]})}),(0,ra.jsx)("div",{className:"col-6",children:(0,ra.jsxs)("div",{className:"p-3 bg-light rounded-3 text-center",children:[(0,ra.jsx)(n$,{size:30,className:"mb-2"}),(0,ra.jsx)("h6",{children:"WebGazer.js"})]})})]})]})})})]}),(0,ra.jsx)("div",{className:"card shadow-lg rounded-4 border-0",children:(0,ra.jsxs)("div",{className:"card-body p-5",children:[(0,ra.jsx)("h2",{className:"fw-bold mb-4 text-primary",children:"Who Can Benefit?"}),(0,ra.jsxs)("div",{className:"row g-4",children:[(0,ra.jsx)("div",{className:"col-md-6",children:(0,ra.jsxs)("div",{className:"p-4 bg-primary bg-opacity-10 rounded-3 h-100",children:[(0,ra.jsx)("h4",{className:"fw-bold",children:"Engineering Students"}),(0,ra.jsx)("p",{children:"Prepare for campus placements, GATE/UPSC technical rounds, and job interviews with realistic simulations and personalized feedback."})]})}),(0,ra.jsx)("div",{className:"col-md-6",children:(0,ra.jsxs)("div",{className:"p-4 bg-primary bg-opacity-10 rounded-3 h-100",children:[(0,ra.jsx)("h4",{className:"fw-bold",children:"Educational Institutions"}),(0,ra.jsx)("p",{children:"Provide your students with cutting-edge interview preparation tools and track their progress with detailed analytics."})]})})]})]})})]})]})}const f$=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let a=t.charCodeAt(r);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=63&a|128):55296===(64512&a)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&t.charCodeAt(++r)),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=63&a|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=63&a|128)}return e},p$={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<t.length;a+=3){const e=t[a],i=a+1<t.length,o=i?t[a+1]:0,s=a+2<t.length,c=s?t[a+2]:0,l=e>>2,u=(3&e)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;s||(d=64,i||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(f$(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const a=t[n++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const i=t[n++];e[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){const i=((7&a)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(i>>10)),e[r++]=String.fromCharCode(56320+(1023&i))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&a)<<12|(63&i)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<t.length;){const e=n[t.charAt(a++)],i=a<t.length?n[t.charAt(a)]:0;++a;const o=a<t.length?n[t.charAt(a)]:64;++a;const s=a<t.length?n[t.charAt(a)]:64;if(++a,null==e||null==i||null==o||null==s)throw new m$;const c=e<<2|i>>4;if(r.push(c),64!==o){const t=i<<4&240|o>>2;if(r.push(t),64!==s){const t=o<<6&192|s;r.push(t)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class m$ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const g$=function(t){return function(t){const e=f$(t);return p$.encodeByteArray(e,!0)}(t).replace(/\./g,"")},y$=function(t){try{return p$.decodeString(t,!0)}catch(Grt){console.error("base64Decode failed: ",Grt)}return null};function v$(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const b$=()=>{try{return v$().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_URL:"http://localhost:5000",REACT_APP_FIREBASE_API_KEY:"AIzaSyASrgqRnCVfgelj8XSt0Mera2QpTm6VXGU",REACT_APP_FIREBASE_APP_ID:"1:564546030199:web:661ea12f560ff1ec405472",REACT_APP_FIREBASE_AUTH_DOMAIN:"student-ai-interview.firebaseapp.com",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"564546030199",REACT_APP_FIREBASE_PROJECT_ID:"student-ai-interview",REACT_APP_FIREBASE_STORAGE_BUCKET:"student-ai-interview.firebasestorage.app"}.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"===typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(Grt){return}const e=t&&y$(t[1]);return e&&JSON.parse(e)})()}catch(Grt){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(Grt))}},w$=t=>{var e,n;return null===(n=null===(e=b$())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},x$=()=>{var t;return null===(t=b$())||void 0===t?void 0:t.config},k$=t=>{var e;return null===(e=b$())||void 0===e?void 0:e["_".concat(t)]};class _${constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"===typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,n))}}}function S$(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch(e){return!1}}async function T$(t){return(await fetch(t,{credentials:"include"})).ok}const I$={};let E$=!1;function N$(t,e){if("undefined"===typeof window||"undefined"===typeof document||!S$(window.location.host)||I$[t]===e||I$[t]||E$)return;function n(t){return"__firebase__banner__".concat(t)}I$[t]=e;const r="__firebase__banner",a=function(){const t={prod:[],emulator:[]};for(const e of Object.keys(I$))I$[e]?t.emulator.push(e):t.prod.push(e);return t}().prod.length>0;function i(){const t=document.createElement("span");return t.style.cursor="pointer",t.style.marginLeft="16px",t.style.fontSize="24px",t.innerHTML=" &times;",t.onclick=()=>{E$=!0,function(){const t=document.getElementById(r);t&&t.remove()}()},t}function o(){const t=function(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}(r),e=n("text"),o=document.getElementById(e)||document.createElement("span"),s=n("learnmore"),c=document.getElementById(s)||document.createElement("a"),l=n("preprendIcon"),u=document.getElementById(l)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(t.created){const e=t.element;!function(t){t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center"}(e),function(t,e){t.setAttribute("id",e),t.innerText="Learn more",t.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",t.setAttribute("target","__blank"),t.style.paddingLeft="5px",t.style.textDecoration="underline"}(c,s);const n=i();!function(t,e){t.setAttribute("width","24"),t.setAttribute("id",e),t.setAttribute("height","24"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.style.marginLeft="-6px"}(u,l),e.append(u,o,c,n),document.body.appendChild(e)}a?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",e)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function C$(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function A$(){var t;const e=null===(t=b$())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(Grt){return!1}}function R$(){return!A$()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function O$(){try{return"object"===typeof indexedDB}catch(Grt){return!1}}class D$ extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,D$.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,M$.prototype.create)}}class M${constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t){const e=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(t),r=this.errors[t],a=r?function(t,e){return t.replace(F$,(t,n)=>{const r=e[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,e):"Error",i="".concat(this.serviceName,": ").concat(a," (").concat(n,").");return new D$(n,i,e)}}const F$=/\{\$([^}]+)}/g;function P$(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const a of n){if(!r.includes(a))return!1;const n=t[a],i=e[a];if(L$(n)&&L$(i)){if(!P$(n,i))return!1}else if(n!==i)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function L$(t){return null!==t&&"object"===typeof t}function z$(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function B$(t){const e={};return t.replace(/^\?/,"").split("&").forEach(t=>{if(t){const[n,r]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(r)}}),e}function j$(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class U${constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(t=>{this.error(t)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,n){let r;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=function(t,e){if("object"!==typeof t||null===t)return!1;for(const n of e)if(n in t&&"function"===typeof t[n])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=V$),void 0===r.error&&(r.error=V$),void 0===r.complete&&(r.complete=V$);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(Grt){}}),this.observers.push(r),a}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(Grt){"undefined"!==typeof console&&console.error&&console.error(Grt)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function V$(){}function W$(t){return t&&t._delegate?t._delegate:t}class G${constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const H$="[DEFAULT]";class q${constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new _$;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(Grt){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),r=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(Grt){if(r)return null;throw Grt}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:H$})}catch(Grt){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(Grt){}}}}clearInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H$;this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H$;return this.instances.has(t)}getOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H$;return this.instancesOptions.get(t)||{}}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[a,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(a)&&i.resolve(r)}return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(t),this.onInitCallbacks.set(r,a);const i=this.instances.get(r);return i&&t(i,r),()=>{a.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const a of n)try{a(t,e)}catch(r){}}getOrInitializeService(t){let{instanceIdentifier:e,options:n={}}=t,r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:K$(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch(a){}return r||null}normalizeInstanceIdentifier(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H$;return this.component?this.component.multipleInstances?t:H$:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function K$(t){return t===H$?void 0:t}class X${constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component ".concat(t.name," has already been registered with ").concat(this.name));e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new q$(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const Y$=[];var Q$;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(Q$||(Q$={}));const J$={debug:Q$.DEBUG,verbose:Q$.VERBOSE,info:Q$.INFO,warn:Q$.WARN,error:Q$.ERROR,silent:Q$.SILENT},$$=Q$.INFO,Z$={[Q$.DEBUG]:"log",[Q$.VERBOSE]:"log",[Q$.INFO]:"info",[Q$.WARN]:"warn",[Q$.ERROR]:"error"},tZ=function(t,e){if(e<t.logLevel)return;const n=(new Date).toISOString(),r=Z$[e];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(e,")"));for(var a=arguments.length,i=new Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];console[r]("[".concat(n,"]  ").concat(t.name,":"),...i)};class eZ{constructor(t){this.name=t,this._logLevel=$$,this._logHandler=tZ,this._userLogHandler=null,Y$.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Q$))throw new TypeError('Invalid value "'.concat(t,'" assigned to `logLevel`'));this._logLevel=t}setLogLevel(t){this._logLevel="string"===typeof t?J$[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Q$.DEBUG,...e),this._logHandler(this,Q$.DEBUG,...e)}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Q$.VERBOSE,...e),this._logHandler(this,Q$.VERBOSE,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Q$.INFO,...e),this._logHandler(this,Q$.INFO,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Q$.WARN,...e),this._logHandler(this,Q$.WARN,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Q$.ERROR,...e),this._logHandler(this,Q$.ERROR,...e)}}let nZ,rZ;const aZ=new WeakMap,iZ=new WeakMap,oZ=new WeakMap,sZ=new WeakMap,cZ=new WeakMap;let lZ={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return iZ.get(t);if("objectStoreNames"===e)return t.objectStoreNames||oZ.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return dZ(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function uZ(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(rZ||(rZ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(fZ(this),n),dZ(aZ.get(this))}:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return dZ(t.apply(fZ(this),n))}:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];const i=t.call(fZ(this),e,...r);return oZ.set(i,e.sort?e.sort():[e]),dZ(i)}}function hZ(t){return"function"===typeof t?uZ(t):(t instanceof IDBTransaction&&function(t){if(iZ.has(t))return;const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",i),t.removeEventListener("abort",i)},a=()=>{e(),r()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",a),t.addEventListener("error",i),t.addEventListener("abort",i)});iZ.set(t,e)}(t),e=t,(nZ||(nZ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(t,lZ):t);var e}function dZ(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("success",a),t.removeEventListener("error",i)},a=()=>{e(dZ(t.result)),r()},i=()=>{n(t.error),r()};t.addEventListener("success",a),t.addEventListener("error",i)});return e.then(e=>{e instanceof IDBCursor&&aZ.set(e,t)}).catch(()=>{}),cZ.set(e,t),e}(t);if(sZ.has(t))return sZ.get(t);const e=hZ(t);return e!==t&&(sZ.set(t,e),cZ.set(e,t)),e}const fZ=t=>cZ.get(t);const pZ=["get","getKey","getAll","getAllKeys","count"],mZ=["put","add","delete","clear"],gZ=new Map;function yZ(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!==typeof e)return;if(gZ.get(e))return gZ.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,a=mZ.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!pZ.includes(n))return;const i=async function(t){const e=this.transaction(t,a?"readwrite":"readonly");let i=e.store;for(var o=arguments.length,s=new Array(o>1?o-1:0),c=1;c<o;c++)s[c-1]=arguments[c];return r&&(i=i.index(s.shift())),(await Promise.all([i[n](...s),a&&e.done]))[0]};return gZ.set(e,i),i}!function(t){lZ=t(lZ)}(t=>oe(oe({},t),{},{get:(e,n,r)=>yZ(e,n)||t.get(e,n,r),has:(e,n)=>!!yZ(e,n)||t.has(e,n)}));class vZ{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){const e=t.getImmediate();return"".concat(e.library,"/").concat(e.version)}return null}).filter(t=>t).join(" ")}}const bZ="@firebase/app",wZ="0.13.2",xZ=new eZ("@firebase/app"),kZ="@firebase/app-compat",_Z="@firebase/analytics-compat",SZ="@firebase/analytics",TZ="@firebase/app-check-compat",IZ="@firebase/app-check",EZ="@firebase/auth",NZ="@firebase/auth-compat",CZ="@firebase/database",AZ="@firebase/data-connect",RZ="@firebase/database-compat",OZ="@firebase/functions",DZ="@firebase/functions-compat",MZ="@firebase/installations",FZ="@firebase/installations-compat",PZ="@firebase/messaging",LZ="@firebase/messaging-compat",zZ="@firebase/performance",BZ="@firebase/performance-compat",jZ="@firebase/remote-config",UZ="@firebase/remote-config-compat",VZ="@firebase/storage",WZ="@firebase/storage-compat",GZ="@firebase/firestore",HZ="@firebase/ai",qZ="@firebase/firestore-compat",KZ="firebase",XZ="[DEFAULT]",YZ={[bZ]:"fire-core",[kZ]:"fire-core-compat",[SZ]:"fire-analytics",[_Z]:"fire-analytics-compat",[IZ]:"fire-app-check",[TZ]:"fire-app-check-compat",[EZ]:"fire-auth",[NZ]:"fire-auth-compat",[CZ]:"fire-rtdb",[AZ]:"fire-data-connect",[RZ]:"fire-rtdb-compat",[OZ]:"fire-fn",[DZ]:"fire-fn-compat",[MZ]:"fire-iid",[FZ]:"fire-iid-compat",[PZ]:"fire-fcm",[LZ]:"fire-fcm-compat",[zZ]:"fire-perf",[BZ]:"fire-perf-compat",[jZ]:"fire-rc",[UZ]:"fire-rc-compat",[VZ]:"fire-gcs",[WZ]:"fire-gcs-compat",[GZ]:"fire-fst",[qZ]:"fire-fst-compat",[HZ]:"fire-vertex","fire-js":"fire-js",[KZ]:"fire-js-all"},QZ=new Map,JZ=new Map,$Z=new Map;function ZZ(t,e){try{t.container.addComponent(e)}catch(Grt){xZ.debug("Component ".concat(e.name," failed to register with FirebaseApp ").concat(t.name),Grt)}}function t0(t){const e=t.name;if($Z.has(e))return xZ.debug("There were multiple attempts to register component ".concat(e,".")),!1;$Z.set(e,t);for(const n of QZ.values())ZZ(n,t);for(const n of JZ.values())ZZ(n,t);return!0}function e0(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function n0(t){return null!==t&&void 0!==t&&void 0!==t.settings}const r0=new M$("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class a0{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new G$("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw r0.create("app-deleted",{appName:this._name})}}const i0="11.10.0";function o0(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t;if("object"!==typeof e){e={name:e}}const r=Object.assign({name:XZ,automaticDataCollectionEnabled:!0},e),a=r.name;if("string"!==typeof a||!a)throw r0.create("bad-app-name",{appName:String(a)});if(n||(n=x$()),!n)throw r0.create("no-options");const i=QZ.get(a);if(i){if(P$(n,i.options)&&P$(r,i.config))return i;throw r0.create("duplicate-app",{appName:a})}const o=new X$(a);for(const c of $Z.values())o.addComponent(c);const s=new a0(n,r,o);return QZ.set(a,s),s}function s0(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:XZ;const e=QZ.get(t);if(!e&&t===XZ&&x$())return o0();if(!e)throw r0.create("no-app",{appName:t});return e}function c0(t,e,n){var r;let a=null!==(r=YZ[t])&&void 0!==r?r:t;n&&(a+="-".concat(n));const i=a.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const t=['Unable to register library "'.concat(a,'" with version "').concat(e,'":')];return i&&t.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&o&&t.push("and"),o&&t.push('version name "'.concat(e,'" contains illegal characters (whitespace or "/")')),void xZ.warn(t.join(" "))}t0(new G$("".concat(a,"-version"),()=>({library:a,version:e}),"VERSION"))}const l0="firebase-heartbeat-store";let u0=null;function h0(){return u0||(u0=function(t,e){let{blocked:n,upgrade:r,blocking:a,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(t,e),s=dZ(o);return r&&o.addEventListener("upgradeneeded",t=>{r(dZ(o.result),t.oldVersion,t.newVersion,dZ(o.transaction),t)}),n&&o.addEventListener("blocked",t=>n(t.oldVersion,t.newVersion,t)),s.then(t=>{i&&t.addEventListener("close",()=>i()),a&&t.addEventListener("versionchange",t=>a(t.oldVersion,t.newVersion,t))}).catch(()=>{}),s}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(l0)}catch(Grt){console.warn(Grt)}}}).catch(t=>{throw r0.create("idb-open",{originalErrorMessage:t.message})})),u0}async function d0(t,e){try{const n=(await h0()).transaction(l0,"readwrite"),r=n.objectStore(l0);await r.put(e,f0(t)),await n.done}catch(Grt){if(Grt instanceof D$)xZ.warn(Grt.message);else{const e=r0.create("idb-set",{originalErrorMessage:null===Grt||void 0===Grt?void 0:Grt.message});xZ.warn(e.message)}}}function f0(t){return"".concat(t.name,"!").concat(t.options.appId)}class p0{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new g0(e),this._heartbeatsCachePromise=this._storage.read().then(t=>(this._heartbeatsCache=t,t))}async triggerHeartbeat(){var t,e;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=m0();if(null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(t=>t.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const t=function(t){if(0===t.length)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(t,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(Grt){xZ.warn(Grt)}}async getHeartbeatsHeader(){var t;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=m0(),{heartbeatsToSend:n,unsentEntries:r}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=t.slice();for(const a of t){const t=n.find(t=>t.agent===a.agent);if(t){if(t.dates.push(a.date),y0(n)>e){t.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),y0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),a=g$(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(Grt){return xZ.warn(Grt),""}}}function m0(){return(new Date).toISOString().substring(0,10)}class g0{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!O$()&&new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var t;e((null===(t=a.error)||void 0===t?void 0:t.message)||"")}}catch(n){e(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await h0()).transaction(l0),n=await e.objectStore(l0).get(f0(t));return await e.done,n}catch(Grt){if(Grt instanceof D$)xZ.warn(Grt.message);else{const e=r0.create("idb-get",{originalErrorMessage:null===Grt||void 0===Grt?void 0:Grt.message});xZ.warn(e.message)}}}(this.app);return(null===t||void 0===t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return d0(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return d0(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function y0(t){return g$(JSON.stringify({version:2,heartbeats:t})).length}var v0;v0="",t0(new G$("platform-logger",t=>new vZ(t),"PRIVATE")),t0(new G$("heartbeat",t=>new p0(t),"PRIVATE")),c0(bZ,wZ,v0),c0(bZ,wZ,"esm2017"),c0("fire-js","");c0("firebase","11.10.0","app");function b0(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function w0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const x0=w0,k0=new M$("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),_0=new eZ("@firebase/auth");function S0(t){if(_0.logLevel<=Q$.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];_0.error("Auth (".concat(i0,"): ").concat(t),...n)}}function T0(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];throw A0(t,...n)}function I0(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return A0(t,...n)}function E0(t,e,n){const r=Object.assign(Object.assign({},x0()),{[e]:n});return new M$("auth","Firebase",r).create(e,{appName:t.name})}function N0(t){return E0(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function C0(t,e,n){if(!(e instanceof n))throw n.name!==e.constructor.name&&T0(t,"argument-error"),E0(t,"argument-error","Type of ".concat(e.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function A0(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if("string"!==typeof t){const e=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(e,...r)}return k0.create(t,...n)}function R0(t,e){if(!t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw A0(e,...r)}}function O0(t){const e="INTERNAL ASSERTION FAILED: "+t;throw S0(e),new Error(e)}function D0(t,e){t||O0(e)}function M0(){var t;return"undefined"!==typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function F0(){return"http:"===P0()||"https:"===P0()}function P0(){var t;return"undefined"!==typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}function L0(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(F0()||function(){const t="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof t&&void 0!==t.id}()||"connection"in navigator))||navigator.onLine}class z0{constructor(t,e){this.shortDelay=t,this.longDelay=e,D0(e>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(C$())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return L0()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function B0(t,e){D0(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?"".concat(n).concat(e.startsWith("/")?e.slice(1):e):n}class j0{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void O0("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void O0("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void O0("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const U0={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},V0=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],W0=new z0(3e4,6e4);function G0(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function H0(t,e,n,r){return q0(t,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let a={},i={};r&&("GET"===e?i=r:a={body:JSON.stringify(r)});const o=z$(Object.assign({key:t.config.apiKey},i)).slice(1),s=await t._getAdditionalHeaders();s["Content-Type"]="application/json",t.languageCode&&(s["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:s},a);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(c.referrerPolicy="no-referrer"),t.emulatorConfig&&S$(t.emulatorConfig.host)&&(c.credentials="include"),j0.fetch()(await X0(t,t.config.apiHost,n,o),c)})}async function q0(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},U0),e);try{const e=new Q0(t),a=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw J0(t,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const e=a.ok?i.errorMessage:i.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw J0(t,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw J0(t,"email-already-in-use",i);if("USER_DISABLED"===n)throw J0(t,"user-disabled",i);const s=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw E0(t,s,o);T0(t,s)}}catch(Grt){if(Grt instanceof D$)throw Grt;T0(t,"network-request-failed",{message:String(Grt)})}}async function K0(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await H0(t,e,n,r,a);return"mfaPendingCredential"in i&&T0(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function X0(t,e,n,r){const a="".concat(e).concat(n,"?").concat(r),i=t,o=i.config.emulator?B0(t.config,a):"".concat(t.config.apiScheme,"://").concat(a);if(V0.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(o).toString()}return o}function Y0(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Q0{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((t,e)=>{this.timer=setTimeout(()=>e(I0(this.auth,"network-request-failed")),W0.get())})}}function J0(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const a=I0(t,e,r);return a.customData._tokenResponse=n,a}function $0(t){return void 0!==t&&void 0!==t.enterprise}class Z0{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return Y0(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function t1(t,e){return H0(t,"GET","/v2/recaptchaConfig",G0(t,e))}async function e1(t,e){return H0(t,"POST","/v1/accounts:lookup",e)}function n1(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(Grt){}}function r1(t){return 1e3*Number(t)}function a1(t){const[e,n,r]=t.split(".");if(void 0===e||void 0===n||void 0===r)return S0("JWT malformed, contained fewer than 3 sections"),null;try{const t=y$(n);return t?JSON.parse(t):(S0("Failed to decode base64 JWT payload"),null)}catch(Grt){return S0("Caught error parsing JWT payload as JSON",null===Grt||void 0===Grt?void 0:Grt.toString()),null}}function i1(t){const e=a1(t);return R0(e,"internal-error"),R0("undefined"!==typeof e.exp,"internal-error"),R0("undefined"!==typeof e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}async function o1(t,e){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return e;try{return await e}catch(Grt){throw Grt instanceof D$&&function(t){let{code:e}=t;return e==="auth/".concat("user-disabled")||e==="auth/".concat("user-token-expired")}(Grt)&&t.auth.currentUser===t&&await t.auth.signOut(),Grt}}class s1{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(Grt){return void((null===Grt||void 0===Grt?void 0:Grt.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class c1{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=n1(this.lastLoginAt),this.creationTime=n1(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function l1(t){var e;const n=t.auth,r=await t.getIdToken(),a=await o1(t,e1(n,{idToken:r}));R0(null===a||void 0===a?void 0:a.users.length,n,"internal-error");const i=a.users[0];t._notifyReloadListener(i);const o=(null===(e=i.providerUserInfo)||void 0===e?void 0:e.length)?u1(i.providerUserInfo):[],s=function(t,e){const n=t.filter(t=>!e.some(e=>e.providerId===t.providerId));return[...n,...e]}(t.providerData,o),c=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(null===s||void 0===s?void 0:s.length),u=!!c&&l,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new c1(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}function u1(t){return t.map(t=>{var{providerId:e}=t,n=b0(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class h1{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){R0(t.idToken,"internal-error"),R0("undefined"!==typeof t.idToken,"internal-error"),R0("undefined"!==typeof t.refreshToken,"internal-error");const e="expiresIn"in t&&"undefined"!==typeof t.expiresIn?Number(t.expiresIn):i1(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){R0(0!==t.length,"internal-error");const e=i1(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(R0(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:r,expiresIn:a}=await async function(t,e){const n=await q0(t,{},async()=>{const n=z$({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:a}=t.config,i=await X0(t,r,"/v1/token","key=".concat(a)),o=await t._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const s={method:"POST",headers:o,body:n};return t.emulatorConfig&&S$(t.emulatorConfig.host)&&(s.credentials="include"),j0.fetch()(i,s)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,r,Number(a))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:r,expirationTime:a}=e,i=new h1;return n&&(R0("string"===typeof n,"internal-error",{appName:t}),i.refreshToken=n),r&&(R0("string"===typeof r,"internal-error",{appName:t}),i.accessToken=r),a&&(R0("number"===typeof a,"internal-error",{appName:t}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new h1,this.toJSON())}_performRefresh(){return O0("not implemented")}}function d1(t,e){R0("string"===typeof t||"undefined"===typeof t,"internal-error",{appName:e})}class f1{constructor(t){var{uid:e,auth:n,stsTokenManager:r}=t,a=b0(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new s1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new c1(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(t){const e=await o1(this,this.stsTokenManager.getToken(this.auth,t));return R0(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=W$(t),r=await n.getIdToken(e),a=a1(r);R0(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const i="object"===typeof a.firebase?a.firebase:void 0,o=null===i||void 0===i?void 0:i.sign_in_provider;return{claims:a,token:r,authTime:n1(r1(a.auth_time)),issuedAtTime:n1(r1(a.iat)),expirationTime:n1(r1(a.exp)),signInProvider:o||null,signInSecondFactor:(null===i||void 0===i?void 0:i.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=W$(t);await l1(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(R0(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(t=>Object.assign({},t)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new f1(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){R0(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await l1(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(n0(this.auth.app))return Promise.reject(N0(this.auth));const t=await this.getIdToken();return await o1(this,async function(t,e){return H0(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,r,a,i,o,s,c,l;const u=null!==(n=e.displayName)&&void 0!==n?n:void 0,h=null!==(r=e.email)&&void 0!==r?r:void 0,d=null!==(a=e.phoneNumber)&&void 0!==a?a:void 0,f=null!==(i=e.photoURL)&&void 0!==i?i:void 0,p=null!==(o=e.tenantId)&&void 0!==o?o:void 0,m=null!==(s=e._redirectEventId)&&void 0!==s?s:void 0,g=null!==(c=e.createdAt)&&void 0!==c?c:void 0,y=null!==(l=e.lastLoginAt)&&void 0!==l?l:void 0,{uid:v,emailVerified:b,isAnonymous:w,providerData:x,stsTokenManager:k}=e;R0(v&&k,t,"internal-error");const _=h1.fromJSON(this.name,k);R0("string"===typeof v,t,"internal-error"),d1(u,t.name),d1(h,t.name),R0("boolean"===typeof b,t,"internal-error"),R0("boolean"===typeof w,t,"internal-error"),d1(d,t.name),d1(f,t.name),d1(p,t.name),d1(m,t.name),d1(g,t.name),d1(y,t.name);const S=new f1({uid:v,auth:t,email:h,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:_,createdAt:g,lastLoginAt:y});return x&&Array.isArray(x)&&(S.providerData=x.map(t=>Object.assign({},t))),m&&(S._redirectEventId=m),S}static async _fromIdTokenResponse(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new h1;r.updateFromServerResponse(e);const a=new f1({uid:e.localId,auth:t,stsTokenManager:r,isAnonymous:n});return await l1(a),a}static async _fromGetAccountInfoResponse(t,e,n){const r=e.users[0];R0(void 0!==r.localId,"internal-error");const a=void 0!==r.providerUserInfo?u1(r.providerUserInfo):[],i=!(r.email&&r.passwordHash)&&!(null===a||void 0===a?void 0:a.length),o=new h1;o.updateFromIdToken(n);const s=new f1({uid:r.localId,auth:t,stsTokenManager:o,isAnonymous:i}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new c1(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===a||void 0===a?void 0:a.length)};return Object.assign(s,c),s}}const p1=new Map;function m1(t){D0(t instanceof Function,"Expected a class definition");let e=p1.get(t);return e?(D0(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,p1.set(t,e),e)}class g1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}g1.type="NONE";const y1=g1;function v1(t,e,n){return"firebase".concat(":",t,":").concat(e,":").concat(n)}class b1{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:r,name:a}=this.auth;this.fullUserKey=v1(this.userKey,r.apiKey,a),this.fullPersistenceKey=v1("persistence",r.apiKey,a),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if("string"===typeof t){const e=await e1(this.auth,{idToken:t}).catch(()=>{});return e?f1._fromGetAccountInfoResponse(this.auth,e,t):null}return f1._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!e.length)return new b1(m1(y1),t,n);const r=(await Promise.all(e.map(async t=>{if(await t._isAvailable())return t}))).filter(t=>t);let a=r[0]||m1(y1);const i=v1(n,t.config.apiKey,t.name);let o=null;for(const l of e)try{const e=await l._get(i);if(e){let n;if("string"===typeof e){const r=await e1(t,{idToken:e}).catch(()=>{});if(!r)break;n=await f1._fromGetAccountInfoResponse(t,r,e)}else n=f1._fromJSON(t,e);l!==a&&(o=n),a=l;break}}catch(c){}const s=r.filter(t=>t._shouldAllowMigration);return a._shouldAllowMigration&&s.length?(a=s[0],o&&await a._set(i,o.toJSON()),await Promise.all(e.map(async t=>{if(t!==a)try{await t._remove(i)}catch(c){}})),new b1(a,t,n)):new b1(a,t,n)}}function w1(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(S1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(x1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(I1(e))return"Blackberry";if(E1(e))return"Webos";if(k1(e))return"Safari";if((e.includes("chrome/")||_1(e))&&!e.includes("edge/"))return"Chrome";if(T1(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function x1(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C$();return/firefox\//i.test(t)}function k1(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:C$()).toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function _1(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C$();return/crios\//i.test(t)}function S1(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C$();return/iemobile/i.test(t)}function T1(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C$();return/android/i.test(t)}function I1(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C$();return/blackberry/i.test(t)}function E1(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C$();return/webos/i.test(t)}function N1(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C$();return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function C1(){return function(){const t=C$();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()&&10===document.documentMode}function A1(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C$();return N1(t)||T1(t)||E1(t)||I1(t)||/windows phone/i.test(t)||S1(t)}function R1(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(t){case"Browser":e=w1(C$());break;case"Worker":e="".concat(w1(C$()),"-").concat(t);break;default:e=t}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(e,"/","JsCore","/").concat(i0,"/").concat(r)}class O1{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise((n,r)=>{try{n(t(e))}catch(Grt){r(Grt)}});n.onAbort=e,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(Grt){e.reverse();for(const n of e)try{n()}catch(oK){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===Grt||void 0===Grt?void 0:Grt.message})}}}class D1{constructor(t){var e,n,r,a;const i=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=i.minPasswordLength)&&void 0!==e?e:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(a=t.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,r,a,i,o;const s={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,s),this.validatePasswordCharacterOptions(t,s),s.isValid&&(s.isValid=null===(e=s.meetsMinPasswordLength)||void 0===e||e),s.isValid&&(s.isValid=null===(n=s.meetsMaxPasswordLength)||void 0===n||n),s.isValid&&(s.isValid=null===(r=s.containsLowercaseLetter)||void 0===r||r),s.isValid&&(s.isValid=null===(a=s.containsUppercaseLetter)||void 0===a||a),s.isValid&&(s.isValid=null===(i=s.containsNumericCharacter)||void 0===i||i),s.isValid&&(s.isValid=null===(o=s.containsNonAlphanumericCharacter)||void 0===o||o),s}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),r&&(e.meetsMaxPasswordLength=t.length<=r)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let r=0;r<t.length;r++)n=t.charAt(r),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,r,a){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=a))}}class M1{constructor(t,e,n,r){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new P1(this),this.idTokenSubscription=new P1(this),this.beforeStateQueue=new O1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=k0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(t=>this._resolvePersistenceManagerAvailable=t)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=m1(e)),this._initializationPromise=this.queue(async()=>{var n,r,a;if(!this._deleted&&(this.persistenceManager=await b1.create(this,t),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(Grt){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(a=this.currentUser)||void 0===a?void 0:a.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUserFromIdToken(t){try{const e=await e1(this,{idToken:t}),n=await f1._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(n)}catch(Hrt){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",Hrt),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var e;if(n0(this.app)){const t=this.app.settings.authIdToken;return t?new Promise(e=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(t).then(e,e))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,a=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,i=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==i||!(null===o||void 0===o?void 0:o.user)||(r=o.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(Grt){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(Grt))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return R0(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(Grt){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await l1(t)}catch(Grt){if((null===Grt||void 0===Grt?void 0:Grt.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(n0(this.app))return Promise.reject(N0(this));const e=t?W$(t):null;return e&&R0(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return t&&R0(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return n0(this.app)?Promise.reject(N0(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return n0(this.app)?Promise.reject(N0(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(m1(t))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t){return H0(t,"GET","/v2/passwordPolicy",G0(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),e=new D1(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new M$("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged(()=>{n(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return H0(t,"POST","/v2/accounts:revokeToken",G0(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&m1(t)||this._popupRedirectResolver;R0(e,this,"argument-error"),this.redirectPersistenceManager=await b1.create(this,[m1(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,r){if(this._deleted)return()=>{};const a="function"===typeof e?e:e.next.bind(e);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(R0(o,this,"internal-error"),o.then(()=>{i||a(this.currentUser)}),"function"===typeof e){const a=t.addObserver(e,n,r);return()=>{i=!0,a()}}{const n=t.addObserver(e);return()=>{i=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return R0(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=R1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(n0(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null===e||void 0===e?void 0:e.error)&&function(t){if(_0.logLevel<=Q$.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];_0.warn("Auth (".concat(i0,"): ").concat(t),...n)}}("Error while retrieving App Check token: ".concat(e.error)),null===e||void 0===e?void 0:e.token}}function F1(t){return W$(t)}class P1{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t,e){const n=new U$(t,e);return n.subscribe.bind(n)}(t=>this.observer=t)}get next(){return R0(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let L1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function z1(t){return L1.loadJS(t)}function B1(t){return"__".concat(t).concat(Math.floor(1e6*Math.random()))}class j1{constructor(){this.enterprise=new U1}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class U1{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const V1="NO_RECAPTCHA";class W1{constructor(t){this.type="recaptcha-enterprise",this.auth=F1(t)}async verify(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(e,n,r){const a=window.grecaptcha;$0(a)?a.enterprise.ready(()=>{a.enterprise.execute(e,{action:t}).then(t=>{n(t)}).catch(()=>{n(V1)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new j1).execute("siteKey",{action:"verify"})}return new Promise((t,r)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise(async(e,n)=>{t1(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Z0(r);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(t=>{n(t)})})})(this.auth).then(a=>{if(!e&&$0(window.grecaptcha))n(a,t,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let e=L1.recaptchaEnterpriseScript;0!==e.length&&(e+=a),z1(e).then(()=>{n(a,t,r)}).catch(t=>{r(t)})}}).catch(t=>{r(t)})})}}async function G1(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=new W1(t);let o;if(a)o=V1;else try{o=await i.verify(n)}catch(c){o=await i.verify(n,!0)}const s=Object.assign({},e);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in s){const t=s.phoneEnrollmentInfo.phoneNumber,e=s.phoneEnrollmentInfo.recaptchaToken;Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:t,recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in s){const t=s.phoneSignInInfo.recaptchaToken;Object.assign(s,{phoneSignInInfo:{recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return s}return r?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function H1(t,e,n,r,a){var i,o;if("EMAIL_PASSWORD_PROVIDER"===a){if(null===(i=t._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await G1(t,e,n,"getOobCode"===n);return r(t,a)}return r(t,e).catch(async a=>{if(a.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const a=await G1(t,e,n,"getOobCode"===n);return r(t,a)}return Promise.reject(a)})}if("PHONE_PROVIDER"===a){if(null===(o=t._getRecaptchaConfig())||void 0===o?void 0:o.isProviderEnabled("PHONE_PROVIDER")){const a=await G1(t,e,n);return r(t,a).catch(async a=>{var i;if("AUDIT"===(null===(i=t._getRecaptchaConfig())||void 0===i?void 0:i.getProviderEnforcementState("PHONE_PROVIDER"))&&(a.code==="auth/".concat("missing-recaptcha-token")||a.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const a=await G1(t,e,n,!1,!0);return r(t,a)}return Promise.reject(a)})}{const a=await G1(t,e,n,!1,!0);return r(t,a)}}return Promise.reject(a+" provider is not supported.")}async function q1(t){const e=F1(t),n=await t1(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Z0(n);if(null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()){new W1(e).verify()}}function K1(t,e,n){const r=F1(t);R0(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!!(null===n||void 0===n?void 0:n.disableWarnings),i=X1(e),{host:o,port:s}=function(t){const e=X1(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const t=a[1];return{host:t,port:Y1(r.substr(t.length+1))}}{const[t,e]=r.split(":");return{host:t,port:Y1(e)}}}(e),c=null===s?"":":".concat(s),l={url:"".concat(i,"//").concat(o).concat(c,"/")},u=Object.freeze({host:o,port:s,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator)return R0(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void R0(P$(l,r.config.emulator)&&P$(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=l,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,S$(o)?(T$("".concat(i,"//").concat(o).concat(c)),N$("Auth",!0)):a||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}function X1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Y1(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class Q1{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return O0("not implemented")}_getIdTokenResponse(t){return O0("not implemented")}_linkToIdToken(t,e){return O0("not implemented")}_getReauthenticationResolver(t){return O0("not implemented")}}async function J1(t,e){return H0(t,"POST","/v1/accounts:signUp",e)}async function $1(t,e){return K0(t,"POST","/v1/accounts:signInWithPassword",G0(t,e))}async function Z1(t,e){return H0(t,"POST","/v1/accounts:sendOobCode",G0(t,e))}class t2 extends Q1{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=t,this._password=e,this._tenantId=r}static _fromEmailAndPassword(t,e){return new t2(t,e,"password")}static _fromEmailAndCode(t,e){return new t2(t,e,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"===typeof t?JSON.parse(t):t;if((null===e||void 0===e?void 0:e.email)&&(null===e||void 0===e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return H1(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",$1,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(t,e){return K0(t,"POST","/v1/accounts:signInWithEmailLink",G0(t,e))}(t,{email:this._email,oobCode:this._password});default:T0(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return H1(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",J1,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(t,e){return K0(t,"POST","/v1/accounts:signInWithEmailLink",G0(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:T0(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function e2(t,e){return K0(t,"POST","/v1/accounts:signInWithIdp",G0(t,e))}class n2 extends Q1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new n2(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):T0("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"===typeof t?JSON.parse(t):t,{providerId:n,signInMethod:r}=e,a=b0(e,["providerId","signInMethod"]);if(!n||!r)return null;const i=new n2(n,r);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(t){return e2(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,e2(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,e2(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=z$(e)}return t}}async function r2(t,e){return H0(t,"POST","/v1/accounts:sendVerificationCode",G0(t,e))}const a2={USER_NOT_FOUND:"user-not-found"};class i2 extends Q1{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new i2({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new i2({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return K0(t,"POST","/v1/accounts:signInWithPhoneNumber",G0(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await K0(t,"POST","/v1/accounts:signInWithPhoneNumber",G0(t,e));if(n.temporaryProof)throw J0(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return K0(t,"POST","/v1/accounts:signInWithPhoneNumber",G0(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),a2)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:r}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:r}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"===typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:r,temporaryProof:a}=t;return n||e||r||a?new i2({verificationId:e,verificationCode:n,phoneNumber:r,temporaryProof:a}):null}}class o2{constructor(t){var e,n,r,a,i,o;const s=B$(j$(t)),c=null!==(e=s.apiKey)&&void 0!==e?e:null,l=null!==(n=s.oobCode)&&void 0!==n?n:null,u=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=s.mode)&&void 0!==r?r:null);R0(c&&l&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=l,this.continueUrl=null!==(a=s.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(i=s.lang)&&void 0!==i?i:null,this.tenantId=null!==(o=s.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=B$(j$(t)).link,n=e?B$(j$(e)).deep_link_id:null,r=B$(j$(t)).deep_link_id;return(r?B$(j$(r)).link:null)||r||n||e||t}(t);try{return new o2(e)}catch(n){return null}}}class s2{constructor(){this.providerId=s2.PROVIDER_ID}static credential(t,e){return t2._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=o2.parseLink(e);return R0(n,"argument-error"),t2._fromEmailAndCode(t,n.code,n.tenantId)}}s2.PROVIDER_ID="password",s2.EMAIL_PASSWORD_SIGN_IN_METHOD="password",s2.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class c2{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class l2 extends c2{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class u2 extends l2{constructor(){super("facebook.com")}static credential(t){return n2._fromParams({providerId:u2.PROVIDER_ID,signInMethod:u2.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return u2.credentialFromTaggedObject(t)}static credentialFromError(t){return u2.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return u2.credential(e.oauthAccessToken)}catch(n){return null}}}u2.FACEBOOK_SIGN_IN_METHOD="facebook.com",u2.PROVIDER_ID="facebook.com";class h2 extends l2{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return n2._fromParams({providerId:h2.PROVIDER_ID,signInMethod:h2.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return h2.credentialFromTaggedObject(t)}static credentialFromError(t){return h2.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return h2.credential(n,r)}catch(a){return null}}}h2.GOOGLE_SIGN_IN_METHOD="google.com",h2.PROVIDER_ID="google.com";class d2 extends l2{constructor(){super("github.com")}static credential(t){return n2._fromParams({providerId:d2.PROVIDER_ID,signInMethod:d2.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return d2.credentialFromTaggedObject(t)}static credentialFromError(t){return d2.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return d2.credential(e.oauthAccessToken)}catch(n){return null}}}d2.GITHUB_SIGN_IN_METHOD="github.com",d2.PROVIDER_ID="github.com";class f2 extends l2{constructor(){super("twitter.com")}static credential(t,e){return n2._fromParams({providerId:f2.PROVIDER_ID,signInMethod:f2.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return f2.credentialFromTaggedObject(t)}static credentialFromError(t){return f2.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return f2.credential(n,r)}catch(a){return null}}}async function p2(t,e){return K0(t,"POST","/v1/accounts:signUp",G0(t,e))}f2.TWITTER_SIGN_IN_METHOD="twitter.com",f2.PROVIDER_ID="twitter.com";class m2{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await f1._fromIdTokenResponse(t,n,r),i=g2(n);return new m2({user:a,providerId:i,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const r=g2(n);return new m2({user:t,providerId:r,_tokenResponse:n,operationType:e})}}function g2(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class y2 extends D${constructor(t,e,n,r){var a;super(e.code,e.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,y2.prototype),this.customData={appName:t.name,tenantId:null!==(a=t.tenantId)&&void 0!==a?a:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,r){return new y2(t,e,n,r)}}function v2(t,e,n,r){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw y2._fromErrorAndOperation(t,n,e,r);throw n})}async function b2(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await o1(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return m2._forOperation(t,"link",r)}async function w2(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=t;if(n0(r.app))return Promise.reject(N0(r));const a="reauthenticate";try{const i=await o1(t,v2(r,a,e,t),n);R0(i.idToken,r,"internal-error");const o=a1(i.idToken);R0(o,r,"internal-error");const{sub:s}=o;return R0(t.uid===s,r,"user-mismatch"),m2._forOperation(t,a,i)}catch(Grt){throw(null===Grt||void 0===Grt?void 0:Grt.code)==="auth/".concat("user-not-found")&&T0(r,"user-mismatch"),Grt}}async function x2(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n0(t.app))return Promise.reject(N0(t));const r="signIn",a=await v2(t,r,e),i=await m2._fromIdTokenResponse(t,r,a);return n||await t._updateCurrentUser(i.user),i}async function k2(t,e){return x2(F1(t),e)}function _2(t,e,n){var r;R0((null===(r=n.url)||void 0===r?void 0:r.length)>0,t,"invalid-continue-uri"),R0("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),R0("undefined"===typeof n.linkDomain||n.linkDomain.length>0,t,"invalid-hosting-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.linkDomain=n.linkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(R0(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(R0(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}async function S2(t){const e=F1(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function T2(t,e){const n={identifier:e,continueUri:F0()?M0():"http://localhost"},{signinMethods:r}=await async function(t,e){return H0(t,"POST","/v1/accounts:createAuthUri",G0(t,e))}(W$(t),n);return r||[]}async function I2(t,e){const n=W$(t),r={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&_2(n.auth,r,e);const{email:a}=await async function(t,e){return Z1(t,e)}(n.auth,r);a!==t.email&&await t.reload()}function E2(t,e){return H0(t,"POST","/v2/accounts/mfaEnrollment:start",G0(t,e))}new WeakMap;const N2="__sak";class C2{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(N2,"1"),this.storage.removeItem(N2),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class A2 extends C2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=A1(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),r=this.localCache[e];n!==r&&t(e,r,n)}}onStorageEvent(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t.key)return void this.forAllChangedKeys((t,e,n)=>{this.notifyListeners(t,n)});const n=t.key;e?this.detachListener():this.stopPolling();const r=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},a=this.storage.getItem(n);C1()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(r,10):r()}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const r of Array.from(n))r(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}A2.type="LOCAL";const R2=A2;function O2(t){var e,n;const r=t.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=RegExp("".concat(r,"=([^;]+)"));return null!==(n=null===(e=document.cookie.match(a))||void 0===e?void 0:e[1])&&void 0!==n?n:null}function D2(t){const e="http:"===window.location.protocol;return"".concat(e?"__dev_":"__HOST-","FIREBASE_").concat(t.split(":")[3])}class M2{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(t){if(void 0===typeof window)return t;const e=new URL("".concat(window.location.origin,"/__cookies__"));return e.searchParams.set("finalTarget",t),e}async _isAvailable(){var t;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(t=navigator.cookieEnabled)||void 0===t||t))}async _set(t,e){}async _get(t){if(!this._isAvailable())return null;const e=D2(t);if(window.cookieStore){const t=await window.cookieStore.get(e);return null===t||void 0===t?void 0:t.value}return O2(e)}async _remove(t){if(!this._isAvailable())return;if(!await this._get(t))return;const e=D2(t);document.cookie="".concat(e,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(t,e){if(!this._isAvailable())return;const n=D2(t);if(window.cookieStore){const t=t=>{const r=t.changed.find(t=>t.name===n);r&&e(r.value);t.deleted.find(t=>t.name===n)&&e(null)},r=()=>window.cookieStore.removeEventListener("change",t);return this.listenerUnsubscribes.set(e,r),window.cookieStore.addEventListener("change",t)}let r=O2(n);const a=setInterval(()=>{const t=O2(n);t!==r&&(e(t),r=t)},1e3);this.listenerUnsubscribes.set(e,()=>clearInterval(a))}_removeListener(t,e){const n=this.listenerUnsubscribes.get(e);n&&(n(),this.listenerUnsubscribes.delete(e))}}M2.type="COOKIE";class F2 extends C2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}F2.type="SESSION";const P2=F2;class L2{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(e=>e.isListeningto(t));if(e)return e;const n=new L2(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:r,data:a}=e.data,i=this.handlersMap[r];if(!(null===i||void 0===i?void 0:i.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(i).map(async t=>t(e.origin,a)),s=await function(t){return Promise.all(t.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:s})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function z2(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<e;r++)n+=Math.floor(10*Math.random());return t+n}L2.receivers=[];class B2{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let a,i;return new Promise((o,s)=>{const c=z2("",20);r.port1.start();const l=setTimeout(()=>{s(new Error("unsupported_event"))},n);i={messageChannel:r,onMessage(t){const e=t;if(e.data.eventId===c)switch(e.data.status){case"ack":clearTimeout(l),a=setTimeout(()=>{s(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),o(e.data.response);break;default:clearTimeout(l),clearTimeout(a),s(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:t,eventId:c,data:e},[r.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function j2(){return window}function U2(){return"undefined"!==typeof j2().WorkerGlobalScope&&"function"===typeof j2().importScripts}const V2="firebaseLocalStorageDb",W2="firebaseLocalStorage",G2="fbase_key";class H2{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function q2(t,e){return t.transaction([W2],e?"readwrite":"readonly").objectStore(W2)}function K2(){const t=indexedDB.open(V2,1);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const e=t.result;try{e.createObjectStore(W2,{keyPath:G2})}catch(Grt){n(Grt)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(W2)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(V2);return new H2(t).toPromise()}(),e(await K2()))})})}async function X2(t,e,n){const r=q2(t,!0).put({[G2]:e,value:n});return new H2(r).toPromise()}function Y2(t,e){const n=q2(t,!0).delete(e);return new H2(n).toPromise()}class Q2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await K2()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(Grt){if(e++>3)throw Grt;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return U2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=L2._getInstance(U2()?self:null),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new B2(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(this.sender&&this.activeServiceWorker&&function(){var t;return(null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await K2();return await X2(t,N2,"1"),await Y2(t,N2),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(n=>X2(n,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(e=>async function(t,e){const n=q2(t,!1).get(e),r=await new H2(n).toPromise();return void 0===r?null:r.value}(e,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>Y2(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(t=>{const e=q2(t,!1).getAll();return new H2(e).toPromise()});if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:r,value:a}of t)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(a)&&(this.notifyListeners(r,a),e.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),e.push(r));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const r of Array.from(n))r(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Q2.type="LOCAL";const J2=Q2;function $2(t,e){return H0(t,"POST","/v2/accounts/mfaSignIn:start",G0(t,e))}B1("rcb"),new z0(3e4,6e4);const Z2="recaptcha";async function t3(t,e,n){var r;if(!t._getRecaptchaConfig())try{await q1(t)}catch(a){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let a;if(a="string"===typeof e?{phoneNumber:e}:e,"session"in a){const e=a.session;if("phoneNumber"in a){R0("enroll"===e.type,t,"internal-error");const r={idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},i=H1(t,r,"mfaSmsEnrollment",async(t,e)=>{if(e.phoneEnrollmentInfo.captchaResponse===V1){R0((null===n||void 0===n?void 0:n.type)===Z2,t,"argument-error");return E2(t,await e3(t,e,n))}return E2(t,e)},"PHONE_PROVIDER");return(await i.catch(t=>Promise.reject(t))).phoneSessionInfo.sessionInfo}{R0("signin"===e.type,t,"internal-error");const i=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;R0(i,t,"missing-multi-factor-info");const o={mfaPendingCredential:e.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},s=H1(t,o,"mfaSmsSignIn",async(t,e)=>{if(e.phoneSignInInfo.captchaResponse===V1){R0((null===n||void 0===n?void 0:n.type)===Z2,t,"argument-error");return $2(t,await e3(t,e,n))}return $2(t,e)},"PHONE_PROVIDER");return(await s.catch(t=>Promise.reject(t))).phoneResponseInfo.sessionInfo}}{const e={phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=H1(t,e,"sendVerificationCode",async(t,e)=>{if(e.captchaResponse===V1){R0((null===n||void 0===n?void 0:n.type)===Z2,t,"argument-error");return r2(t,await e3(t,e,n))}return r2(t,e)},"PHONE_PROVIDER");return(await r.catch(t=>Promise.reject(t))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function e3(t,e,n){R0(n.type===Z2,t,"argument-error");const r=await n.verify();R0("string"===typeof r,t,"argument-error");const a=Object.assign({},e);if("phoneEnrollmentInfo"in a){const t=a.phoneEnrollmentInfo.phoneNumber,e=a.phoneEnrollmentInfo.captchaResponse,n=a.phoneEnrollmentInfo.clientType,i=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:t,recaptchaToken:r,captchaResponse:e,clientType:n,recaptchaVersion:i}}),a}if("phoneSignInInfo"in a){const t=a.phoneSignInInfo.captchaResponse,e=a.phoneSignInInfo.clientType,n=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:t,clientType:e,recaptchaVersion:n}}),a}return Object.assign(a,{recaptchaToken:r}),a}class n3{constructor(t){this.providerId=n3.PROVIDER_ID,this.auth=F1(t)}verifyPhoneNumber(t,e){return t3(this.auth,t,W$(e))}static credential(t,e){return i2._fromVerification(t,e)}static credentialFromResult(t){const e=t;return n3.credentialFromTaggedObject(e)}static credentialFromError(t){return n3.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject(t){let{_tokenResponse:e}=t;if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?i2._fromTokenResponse(n,r):null}}function r3(t,e){return e?m1(e):(R0(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}n3.PROVIDER_ID="phone",n3.PHONE_SIGN_IN_METHOD="phone";class a3 extends Q1{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return e2(t,this._buildIdpRequest())}_linkToIdToken(t,e){return e2(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return e2(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function i3(t){return x2(t.auth,new a3(t),t.bypassAuthState)}function o3(t){const{auth:e,user:n}=t;return R0(n,e,"internal-error"),w2(n,new a3(t),t.bypassAuthState)}async function s3(t){const{auth:e,user:n}=t;return R0(n,e,"internal-error"),b2(n,new a3(t),t.bypassAuthState)}class c3{constructor(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=t,this.resolver=n,this.user=r,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(Grt){this.reject(Grt)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:r,tenantId:a,error:i,type:o}=t;if(i)return void this.reject(i);const s={auth:this.auth,requestUri:e,sessionId:n,tenantId:a||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(s))}catch(Grt){this.reject(Grt)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return i3;case"linkViaPopup":case"linkViaRedirect":return s3;case"reauthViaPopup":case"reauthViaRedirect":return o3;default:T0(this.auth,"internal-error")}}resolve(t){D0(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){D0(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const l3=new z0(2e3,1e4);async function u3(t,e,n){if(n0(t.app))return Promise.reject(I0(t,"operation-not-supported-in-this-environment"));const r=F1(t);C0(t,e,c2);const a=r3(r,n);return new h3(r,"signInViaPopup",e,a).executeNotNull()}class h3 extends c3{constructor(t,e,n,r,a){super(t,e,r,a),this.provider=n,this.authWindow=null,this.pollId=null,h3.currentPopupAction&&h3.currentPopupAction.cancel(),h3.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return R0(t,this.auth,"internal-error"),t}async onExecution(){D0(1===this.filter.length,"Popup operations only handle one event");const t=z2();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(I0(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(I0(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,h3.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(I0(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(t,l3.get())};t()}}h3.currentPopupAction=null;const d3=new Map;class f3 extends c3{constructor(t,e){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let t=d3.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=g3(e),r=m3(t);if(!await r._isAvailable())return!1;const a="true"===await r._get(n);return await r._remove(n),a}(this.resolver,this.auth),n=e?await super.execute():null;t=()=>Promise.resolve(n)}catch(Grt){t=()=>Promise.reject(Grt)}d3.set(this.auth._key(),t)}return this.bypassAuthState||d3.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function p3(t,e){d3.set(t._key(),e)}function m3(t){return m1(t._redirectPersistence)}function g3(t){return v1("pendingRedirect",t.config.apiKey,t.name)}async function y3(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n0(t.app))return Promise.reject(N0(t));const r=F1(t),a=r3(r,e),i=new f3(r,a,n),o=await i.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}class v3{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return w3(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!w3(t)){const r=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(I0(this.auth,r))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(b3(t))}saveEventToCache(t){this.cachedEventUids.add(b3(t)),this.lastProcessedEventTime=Date.now()}}function b3(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(t=>t).join("-")}function w3(t){let{type:e,error:n}=t;return"unknown"===e&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const x3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,k3=/^https?/;async function _3(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t){return H0(t,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(t);for(const r of e)try{if(S3(r))return}catch(n){}T0(t,"unauthorized-domain")}function S3(t){const e=M0(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return""===a.hostname&&""===r?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&a.hostname===r}if(!k3.test(n))return!1;if(x3.test(t))return r===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const T3=new z0(3e4,6e4);function I3(){const t=j2().___jsl;if(null===t||void 0===t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}function E3(t){return new Promise((e,n)=>{var r,a,i;function o(){I3(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{I3(),n(I0(t,"network-request-failed"))},timeout:T3.get()})}if(null===(a=null===(r=j2().gapi)||void 0===r?void 0:r.iframes)||void 0===a?void 0:a.Iframe)e(gapi.iframes.getContext());else{if(!(null===(i=j2().gapi)||void 0===i?void 0:i.load)){const e=B1("iframefcb");return j2()[e]=()=>{gapi.load?o():n(I0(t,"network-request-failed"))},z1("".concat(L1.gapiScript,"?onload=").concat(e)).catch(t=>n(t))}o()}}).catch(t=>{throw N3=null,t})}let N3=null;const C3=new z0(5e3,15e3),A3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},R3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function O3(t){const e=t.config;R0(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?B0(e,"emulator/auth/iframe"):"https://".concat(t.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:e.apiKey,appName:t.name,v:i0},a=R3.get(t.config.apiHost);a&&(r.eid=a);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),"".concat(n,"?").concat(z$(r).slice(1))}async function D3(t){const e=await function(t){return N3=N3||E3(t),N3}(t),n=j2().gapi;return R0(n,t,"internal-error"),e.open({where:document.body,url:O3(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:A3,dontclear:!0},e=>new Promise(async(n,r)=>{await e.restyle({setHideOnLeave:!1});const a=I0(t,"network-request-failed"),i=j2().setTimeout(()=>{r(a)},C3.get());function o(){j2().clearTimeout(i),n(e)}e.ping(o).then(o,()=>{r(a)})}))}const M3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class F3{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(Grt){}}}function P3(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const i=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let s="";const c=Object.assign(Object.assign({},M3),{width:r.toString(),height:a.toString(),top:i,left:o}),l=C$().toLowerCase();n&&(s=_1(l)?"_blank":n),x1(l)&&(e=e||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce((t,e)=>{let[n,r]=e;return"".concat(t).concat(n,"=").concat(r,",")},"");if(function(){var t;return N1(arguments.length>0&&void 0!==arguments[0]?arguments[0]:C$())&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==s)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(e||"",s),new F3(null);const h=window.open(e||"",s,u);R0(h,t,"popup-blocked");try{h.focus()}catch(Grt){}return new F3(h)}const L3="__/auth/handler",z3="emulator/auth/handler",B3=encodeURIComponent("fac");async function j3(t,e,n,r,a,i){R0(t.config.authDomain,t,"auth-domain-config-required"),R0(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:i0,eventId:a};if(e instanceof c2){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(i||{}))o[t]=e}if(e instanceof l2){const t=e.getScopes().filter(t=>""!==t);t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const s=o;for(const u of Object.keys(s))void 0===s[u]&&delete s[u];const c=await t._getAppCheckToken(),l=c?"#".concat(B3,"=").concat(encodeURIComponent(c)):"";return"".concat(function(t){let{config:e}=t;if(!e.emulator)return"https://".concat(e.authDomain,"/").concat(L3);return B0(e,z3)}(t),"?").concat(z$(s).slice(1)).concat(l)}const U3="webStorageSupport";const V3=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=P2,this._completeRedirectFn=y3,this._overrideRedirectResult=p3}async _openPopup(t,e,n,r){var a;D0(null===(a=this.eventManagers[t._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");return P3(t,await j3(t,e,n,M0(),r),z2())}async _openRedirect(t,e,n,r){await this._originValidation(t);return function(t){j2().location.href=t}(await j3(t,e,n,M0(),r)),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(D0(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch(()=>{delete this.eventManagers[e]}),n}async initAndGetManager(t){const e=await D3(t),n=new v3(t);return e.register("authEvent",e=>{R0(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event");return{status:n.onEvent(e.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(U3,{type:U3},n=>{var r;const a=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[U3];void 0!==a&&e(!!a),T0(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=_3(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return A1()||k1()||N1()}};var W3="@firebase/auth",G3="1.10.8";class H3{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(t)}}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(e=>{t((null===e||void 0===e?void 0:e.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){R0(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const q3=k$("authIdTokenMaxAge")||300;let K3=null;var X3;!function(t){L1=t}({loadJS:t=>new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=t=>{const e=I0("internal-error");e.customData=t,n(e)},r.type="text/javascript",r.charset="UTF-8",function(){var t,e;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),X3="Browser",t0(new G$("auth",(t,e)=>{let{options:n}=e;const r=t.getProvider("app").getImmediate(),a=t.getProvider("heartbeat"),i=t.getProvider("app-check-internal"),{apiKey:o,authDomain:s}=r.options;R0(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:s,clientPlatform:X3,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:R1(X3)},l=new M1(r,a,i,c);return function(t,e){const n=(null===e||void 0===e?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(m1);(null===e||void 0===e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,null===e||void 0===e?void 0:e.popupRedirectResolver)}(l,n),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider("auth-internal").initialize()})),t0(new G$("auth-internal",t=>(t=>new H3(t))(F1(t.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),c0(W3,G3,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(X3)),c0(W3,G3,"esm2017");var Y3,Q3,J3="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},$3={};(function(){var t;function e(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(t,e,n){n||(n=0);var r=Array(16);if("string"===typeof e)for(var a=0;16>a;++a)r[a]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(a=0;16>a;++a)r[a]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],a=t.g[2];var i=t.g[3],o=e+(i^n&(a^i))+r[0]+3614090360&4294967295;o=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=(n=(a=(i=(e=n+(o<<7&4294967295|o>>>25))+((o=i+(a^e&(n^a))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^a&(i^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^n&(a^i))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^e&(n^a))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^a&(i^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^n&(a^i))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^e&(n^a))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^a&(i^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^n&(a^i))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=i+(a^e&(n^a))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=a+(n^i&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^a&(i^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(a^i&(n^a))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=a+(e^n&(i^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^e&(a^i))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(a^i&(n^a))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=a+(e^n&(i^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^e&(a^i))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(a^i&(n^a))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=a+(e^n&(i^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^e&(a^i))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(a^i&(n^a))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=i+(n^a&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=a+(e^n&(i^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(i^e&(a^i))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^a^i)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=i+(e^n^a)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^a^i)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=i+(e^n^a)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^a^i)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=i+(e^n^a)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^a^i)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=i+(e^n^a)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=a+(i^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(a^i^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(a^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(e|~a))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=a+(e^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(a^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(e|~a))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=a+(e^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(a^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(e|~a))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=a+(e^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(i^(a|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((i=(e=n+((o=e+(a^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=i+(n^(e|~a))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((a=i+((o=a+(e^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(a+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+a&4294967295,t.g[3]=t.g[3]+i&4294967295}function r(t,e){this.h=e;for(var n=[],r=!0,a=t.length-1;0<=a;a--){var i=0|t[a];r&&i==e||(n[a]=i,r=!1)}this.g=n}!function(t,e){function n(){}n.prototype=e.prototype,t.D=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.C=function(t,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return e.prototype[n].apply(t,a)}}(e,function(){this.blockSize=-1}),e.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},e.prototype.u=function(t,e){void 0===e&&(e=t.length);for(var r=e-this.blockSize,a=this.B,i=this.h,o=0;o<e;){if(0==i)for(;o<=r;)n(this,t,o),o+=this.blockSize;if("string"===typeof t){for(;o<e;)if(a[i++]=t.charCodeAt(o++),i==this.blockSize){n(this,a),i=0;break}}else for(;o<e;)if(a[i++]=t[o++],i==this.blockSize){n(this,a),i=0;break}}this.h=i,this.o+=e},e.prototype.v=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.o;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.u(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var a={};function i(t){return-128<=t&&128>t?function(t,e){var n=a;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(t){return new r([0|t],0>t?-1:0)}):new r([0|t],0>t?-1:0)}function o(t){if(isNaN(t)||!isFinite(t))return s;if(0>t)return d(o(-t));for(var e=[],n=1,a=0;t>=n;a++)e[a]=t/n|0,n*=4294967296;return new r(e,0)}var s=i(0),c=i(1),l=i(16777216);function u(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function h(t){return-1==t.h}function d(t){for(var e=t.g.length,n=[],a=0;a<e;a++)n[a]=~t.g[a];return new r(n,~t.h).add(c)}function f(t,e){return t.add(d(e))}function p(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function m(t,e){this.g=t,this.h=e}function g(t,e){if(u(e))throw Error("division by zero");if(u(t))return new m(s,s);if(h(t))return e=g(d(t),e),new m(d(e.g),d(e.h));if(h(e))return e=g(t,d(e)),new m(d(e.g),e.h);if(30<t.g.length){if(h(t)||h(e))throw Error("slowDivide_ only works with positive integers.");for(var n=c,r=e;0>=r.l(t);)n=y(n),r=y(r);var a=v(n,1),i=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var l=i.add(r);0>=l.l(t)&&(a=a.add(n),i=l),r=v(r,1),n=v(n,1)}return e=f(t,a.j(e)),new m(a,e)}for(a=s;0<=t.l(e);){for(n=Math.max(1,Math.floor(t.m()/e.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),l=(i=o(n)).j(e);h(l)||0<l.l(t);)l=(i=o(n-=r)).j(e);u(i)&&(i=c),a=a.add(i),t=f(t,l)}return new m(a,t)}function y(t){for(var e=t.g.length+1,n=[],a=0;a<e;a++)n[a]=t.i(a)<<1|t.i(a-1)>>>31;return new r(n,t.h)}function v(t,e){var n=e>>5;e%=32;for(var a=t.g.length-n,i=[],o=0;o<a;o++)i[o]=0<e?t.i(o+n)>>>e|t.i(o+n+1)<<32-e:t.i(o+n);return new r(i,t.h)}(t=r.prototype).m=function(){if(h(this))return-d(this).m();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.i(n);t+=(0<=r?r:4294967296+r)*e,e*=4294967296}return t},t.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(u(this))return"0";if(h(this))return"-"+d(this).toString(t);for(var e=o(Math.pow(t,6)),n=this,r="";;){var a=g(n,e).g,i=((0<(n=f(n,a.j(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(u(n=a))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},t.i=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},t.l=function(t){return h(t=f(this,t))?-1:u(t)?0:1},t.abs=function(){return h(this)?d(this):this},t.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],a=0,i=0;i<=e;i++){var o=a+(65535&this.i(i))+(65535&t.i(i)),s=(o>>>16)+(this.i(i)>>>16)+(t.i(i)>>>16);a=s>>>16,o&=65535,s&=65535,n[i]=s<<16|o}return new r(n,-2147483648&n[n.length-1]?-1:0)},t.j=function(t){if(u(this)||u(t))return s;if(h(this))return h(t)?d(this).j(d(t)):d(d(this).j(t));if(h(t))return d(this.j(d(t)));if(0>this.l(l)&&0>t.l(l))return o(this.m()*t.m());for(var e=this.g.length+t.g.length,n=[],a=0;a<2*e;a++)n[a]=0;for(a=0;a<this.g.length;a++)for(var i=0;i<t.g.length;i++){var c=this.i(a)>>>16,f=65535&this.i(a),m=t.i(i)>>>16,g=65535&t.i(i);n[2*a+2*i]+=f*g,p(n,2*a+2*i),n[2*a+2*i+1]+=c*g,p(n,2*a+2*i+1),n[2*a+2*i+1]+=f*m,p(n,2*a+2*i+1),n[2*a+2*i+2]+=c*m,p(n,2*a+2*i+2)}for(a=0;a<e;a++)n[a]=n[2*a+1]<<16|n[2*a];for(a=e;a<2*e;a++)n[a]=0;return new r(n,0)},t.A=function(t){return g(this,t).h},t.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],a=0;a<e;a++)n[a]=this.i(a)&t.i(a);return new r(n,this.h&t.h)},t.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],a=0;a<e;a++)n[a]=this.i(a)|t.i(a);return new r(n,this.h|t.h)},t.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],a=0;a<e;a++)n[a]=this.i(a)^t.i(a);return new r(n,this.h^t.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,Q3=$3.Md5=e,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return d(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=o(Math.pow(n,8)),a=s,i=0;i<e.length;i+=8){var c=Math.min(8,e.length-i),l=parseInt(e.substring(i,i+c),n);8>c?(c=o(Math.pow(n,c)),a=a.j(c).add(o(l))):a=(a=a.j(r)).add(o(l))}return a},Y3=$3.Integer=r}).apply("undefined"!==typeof J3?J3:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Z3,t4,e4,n4,r4,a4,i4,o4,s4="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},c4={};(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t};var n=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof s4&&s4];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(t,r){if(r)t:{var a=n;t=t.split(".");for(var i=0;i<t.length-1;i++){var o=t[i];if(!(o in a))break t;a=a[o]}(r=r(i=a[t=t[t.length-1]]))!=i&&null!=r&&e(a,t,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,r=!1,a={next:function(){if(!r&&n<t.length){var a=n++;return{value:e(a,t[a]),done:!1}}return r=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,function(t,e){return e})}});var r=r||{},a=this||self;function i(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function o(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function s(t,e,n){return t.call.apply(t.bind,arguments)}function c(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function l(t,e,n){return(l=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?s:c).apply(null,arguments)}function u(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function h(t,e){function n(){}n.prototype=e.prototype,t.aa=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Qb=function(t,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return e.prototype[n].apply(t,a)}}function d(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function f(t,e){for(let n=1;n<arguments.length;n++){const e=arguments[n];if(i(e)){const n=t.length||0,r=e.length||0;t.length=n+r;for(let a=0;a<r;a++)t[n+a]=e[a]}else t.push(e)}}function p(t){return/^[\s\xa0]*$/.test(t)}function m(){var t=a.navigator;return t&&(t=t.userAgent)?t:""}function g(t){return g[" "](t),t}g[" "]=function(){};var y=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function v(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function b(t){const e={};for(const n in t)e[n]=t[n];return e}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(t,e){let n,r;for(let a=1;a<arguments.length;a++){for(n in r=arguments[a],r)t[n]=r[n];for(let e=0;e<w.length;e++)n=w[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function k(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function _(t){a.setTimeout(()=>{throw t},0)}function S(){var t=C;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var T=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new I,t=>t.reset());class I{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}let E,N=!1,C=new class{constructor(){this.h=this.g=null}add(t,e){const n=T.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},A=()=>{const t=a.Promise.resolve(void 0);E=()=>{t.then(R)}};var R=()=>{for(var t;t=S();){try{t.h.call(t.g)}catch(n){_(n)}var e=T;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}N=!1};function O(){this.s=this.s,this.C=this.C}function D(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}O.prototype.s=!1,O.prototype.ma=function(){this.s||(this.s=!0,this.N())},O.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};a.addEventListener("test",t,e),a.removeEventListener("test",t,e)}catch(n){}return t}();function F(t,e){if(D.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(y){t:{try{g(e.nodeName);var a=!0;break t}catch(hs){}a=!1}a||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:P[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&F.aa.h.call(this)}}h(F,D);var P={2:"touch",3:"pen",4:"mouse"};F.prototype.h=function(){F.aa.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var L="closure_listenable_"+(1e6*Math.random()|0),z=0;function B(t,e,n,r,a){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ha=a,this.key=++z,this.da=this.fa=!1}function j(t){t.da=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function U(t){this.src=t,this.g={},this.h=0}function V(t,e){var n=e.type;if(n in t.g){var r,a=t.g[n],i=Array.prototype.indexOf.call(a,e,void 0);(r=0<=i)&&Array.prototype.splice.call(a,i,1),r&&(j(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function W(t,e,n,r){for(var a=0;a<t.length;++a){var i=t[a];if(!i.da&&i.listener==e&&i.capture==!!n&&i.ha==r)return a}return-1}U.prototype.add=function(t,e,n,r,a){var i=t.toString();(t=this.g[i])||(t=this.g[i]=[],this.h++);var o=W(t,e,r,a);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new B(e,this.src,i,!!r,a)).fa=n,t.push(e)),e};var G="closure_lm_"+(1e6*Math.random()|0),H={};function q(t,e,n,r,a){if(r&&r.once)return X(t,e,n,r,a);if(Array.isArray(e)){for(var i=0;i<e.length;i++)q(t,e[i],n,r,a);return null}return n=et(n),t&&t[L]?t.K(e,n,o(r)?!!r.capture:!!r,a):K(t,e,n,!1,r,a)}function K(t,e,n,r,a,i){if(!e)throw Error("Invalid event type");var s=o(a)?!!a.capture:!!a,c=Z(t);if(c||(t[G]=c=new U(t)),(n=c.add(e,n,r,s,i)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}const e=$;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)M||(a=s),void 0===a&&(a=!1),t.addEventListener(e.toString(),r,a);else if(t.attachEvent)t.attachEvent(J(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function X(t,e,n,r,a){if(Array.isArray(e)){for(var i=0;i<e.length;i++)X(t,e[i],n,r,a);return null}return n=et(n),t&&t[L]?t.L(e,n,o(r)?!!r.capture:!!r,a):K(t,e,n,!0,r,a)}function Y(t,e,n,r,a){if(Array.isArray(e))for(var i=0;i<e.length;i++)Y(t,e[i],n,r,a);else r=o(r)?!!r.capture:!!r,n=et(n),t&&t[L]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=W(i=t.g[e],n,r,a))&&(j(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete t.g[e],t.h--)))):t&&(t=Z(t))&&(e=t.g[e.toString()],t=-1,e&&(t=W(e,n,r,a)),(n=-1<t?e[t]:null)&&Q(n))}function Q(t){if("number"!==typeof t&&t&&!t.da){var e=t.src;if(e&&e[L])V(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(J(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Z(e))?(V(n,t),0==n.h&&(n.src=null,e[G]=null)):j(t)}}}function J(t){return t in H?H[t]:H[t]="on"+t}function $(t,e){if(t.da)t=!0;else{e=new F(e,this);var n=t.listener,r=t.ha||t.src;t.fa&&Q(t),t=n.call(r,e)}return t}function Z(t){return(t=t[G])instanceof U?t:null}var tt="__closure_events_fn_"+(1e9*Math.random()>>>0);function et(t){return"function"===typeof t?t:(t[tt]||(t[tt]=function(e){return t.handleEvent(e)}),t[tt])}function nt(){O.call(this),this.i=new U(this),this.M=this,this.F=null}function rt(t,e){var n,r=t.F;if(r)for(n=[];r;r=r.F)n.push(r);if(t=t.M,r=e.type||e,"string"===typeof e)e=new D(e,t);else if(e instanceof D)e.target=e.target||t;else{var a=e;x(e=new D(r,t),a)}if(a=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];a=at(o,r,!0,e)&&a}if(a=at(o=e.g=t,r,!0,e)&&a,a=at(o,r,!1,e)&&a,n)for(i=0;i<n.length;i++)a=at(o=e.g=n[i],r,!1,e)&&a}function at(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var a=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.da&&o.capture==n){var s=o.listener,c=o.ha||o.src;o.fa&&V(t.i,o),a=!1!==s.call(c,r)&&a}}return a&&!r.defaultPrevented}function it(t,e,n){if("function"===typeof t)n&&(t=l(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=l(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function ot(t){t.g=it(()=>{t.g=null,t.i&&(t.i=!1,ot(t))},t.l);const e=t.h;t.h=null,t.m.apply(null,e)}h(nt,O),nt.prototype[L]=!0,nt.prototype.removeEventListener=function(t,e,n,r){Y(this,t,e,n,r)},nt.prototype.N=function(){if(nt.aa.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)j(n[r]);delete e.g[t],e.h--}}this.F=null},nt.prototype.K=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},nt.prototype.L=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};class st extends O{constructor(t,e){super(),this.m=t,this.l=e,this.h=null,this.i=!1,this.g=null}j(t){this.h=arguments,this.g?this.i=!0:ot(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ct(t){O.call(this),this.h=t,this.g={}}h(ct,O);var lt=[];function ut(t){v(t.g,function(t,e){this.g.hasOwnProperty(e)&&Q(t)},t),t.g={}}ct.prototype.N=function(){ct.aa.N.call(this),ut(this)},ct.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ht=a.JSON.stringify,dt=a.JSON.parse,ft=class{stringify(t){return a.JSON.stringify(t,void 0)}parse(t){return a.JSON.parse(t,void 0)}};function pt(){}function mt(t){return t.h||(t.h=t.i())}function gt(){}pt.prototype.h=null;var yt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function vt(){D.call(this,"d")}function bt(){D.call(this,"c")}h(vt,D),h(bt,D);var wt={},xt=null;function kt(){return xt=xt||new nt}function _t(t){D.call(this,wt.La,t)}function St(t){const e=kt();rt(e,new _t(e))}function Tt(t,e){D.call(this,wt.STAT_EVENT,t),this.stat=e}function It(t){const e=kt();rt(e,new Tt(e,t))}function Et(t,e){D.call(this,wt.Ma,t),this.size=e}function Nt(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){t()},e)}function Ct(){this.g=!0}function At(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var i=a[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<a.length;o++)a[o]=""}}}return ht(n)}catch(s){return e}}(t,n)+(r?" "+r:"")})}wt.La="serverreachability",h(_t,D),wt.STAT_EVENT="statevent",h(Tt,D),wt.Ma="timingevent",h(Et,D),Ct.prototype.xa=function(){this.g=!1},Ct.prototype.info=function(){};var Rt,Ot={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Dt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Mt(){}function Ft(t,e,n,r){this.j=t,this.i=e,this.l=n,this.R=r||1,this.U=new ct(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Pt}function Pt(){this.i=null,this.g="",this.h=!1}h(Mt,pt),Mt.prototype.g=function(){return new XMLHttpRequest},Mt.prototype.i=function(){return{}},Rt=new Mt;var Lt={},zt={};function Bt(t,e,n){t.L=1,t.v=he(oe(e)),t.m=n,t.P=!0,jt(t,null)}function jt(t,e){t.F=Date.now(),Wt(t),t.A=oe(t.v);var n=t.A,r=t.R;Array.isArray(r)||(r=[String(r)]),Te(n.i,"t",r),t.C=0,n=t.j.J,t.h=new Pt,t.g=fn(t.j,n?e:null,!t.m),0<t.O&&(t.M=new st(l(t.Y,t,t.g),t.O)),e=t.U,n=t.g,r=t.ca;var a="readystatechange";Array.isArray(a)||(a&&(lt[0]=a.toString()),a=lt);for(var i=0;i<a.length;i++){var o=q(n,a[i],r||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}e=t.H?b(t.H):{},t.m?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.m,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),St(),function(t,e,n,r,a,i){t.info(function(){if(t.g)if(i)for(var o="",s=i.split("&"),c=0;c<s.length;c++){var l=s[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+e+"\n"+n+"\n"+o})}(t.i,t.u,t.A,t.l,t.R,t.m)}function Ut(t){return!!t.g&&("GET"==t.u&&2!=t.L&&t.j.Ca)}function Vt(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?zt:(n=Number(e.substring(n,r)),isNaN(n)?Lt:(r+=1)+n>e.length?zt:(e=e.slice(r,r+n),t.C=r+n,e))}function Wt(t){t.S=Date.now()+t.I,Gt(t,t.I)}function Gt(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Nt(l(t.ba,t),e)}function Ht(t){t.B&&(a.clearTimeout(t.B),t.B=null)}function qt(t){0==t.j.G||t.J||cn(t.j,t)}function Kt(t){Ht(t);var e=t.M;e&&"function"==typeof e.ma&&e.ma(),t.M=null,ut(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.ma())}function Xt(t,e){try{var n=t.j;if(0!=n.G&&(n.g==t||Zt(n.h,t)))if(!t.K&&Zt(n.h,t)&&3==n.G){try{var r=n.Da.g.parse(e)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;sn(n),Qe(n)}rn(n),It(18)}}else n.za=a[1],0<n.za-n.T&&37500>a[2]&&n.F&&0==n.v&&!n.C&&(n.C=Nt(l(n.Za,n),6e3));if(1>=$t(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((t.K||n.g==t)&&sn(n),!p(e))for(a=n.Da.g.parse(e),e=0;e<a.length;e++){let l=a[e];if(n.T=l[0],l=l[1],2==n.G)if("c"==l[0]){n.K=l[1],n.ia=l[2];const e=l[3];null!=e&&(n.la=e,n.j.info("VER="+n.la));const a=l[4];null!=a&&(n.Aa=a,n.j.info("SVER="+n.Aa));const u=l[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var i=r.h;i.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(te(i,i.h),i.h=null))}if(r.D){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(r.ya=t,ue(r.I,r.D,t))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-t.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=t;if((r=n).qa=dn(r,r.J?r.ia:null,r.W),o.K){ee(r.h,o);var s=o,c=r.L;c&&(s.I=c),s.B&&(Ht(s),Wt(s)),r.g=o}else nn(r);0<n.i.length&&$e(n)}else"stop"!=l[0]&&"close"!=l[0]||un(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?un(n,7):Ye(n):"noop"!=l[0]&&n.l&&n.l.ta(l),n.v=0)}St()}catch(u){}}Ft.prototype.ca=function(t){t=t.target;const e=this.M;e&&3==He(t)?e.j():this.Y(t)},Ft.prototype.Y=function(t){try{if(t==this.g)t:{const d=He(this.g);var e=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||qe(this.g)))){this.J||4!=d||7==e||St(),Ht(this);var n=this.g.Z();this.X=n;e:if(Ut(this)){var r=qe(this.g);t="";var i=r.length,o=4==He(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Kt(this),qt(this);var s="";break e}this.h.i=new a.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:!(o&&e==i-1)});r.length=0,this.h.g+=t,this.C=0,s=this.h.g}else s=this.g.oa();if(this.o=200==n,function(t,e,n,r,a,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+e+"\n"+n+"\n"+i+" "+o})}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(c)){var u=c;break e}}u=null}if(!(n=u)){this.o=!1,this.s=3,It(12),Kt(this),qt(this);break t}At(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xt(this,n)}if(this.P){let t;for(n=!0;!this.J&&this.C<s.length;){if(t=Vt(this,s),t==zt){4==d&&(this.s=4,It(14),n=!1),At(this.i,this.l,null,"[Incomplete Response]");break}if(t==Lt){this.s=4,It(15),At(this.i,this.l,s,"[Invalid Chunk]"),n=!1;break}At(this.i,this.l,t,null),Xt(this,t)}if(Ut(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=s.length||this.h.h||(this.s=1,It(16),n=!1),this.o=this.o&&n,n){if(0<s.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+s.length),an(h),h.M=!0,It(11))}}else At(this.i,this.l,s,"[Invalid Chunked Response]"),Kt(this),qt(this)}else At(this.i,this.l,s,null),Xt(this,s);4==d&&Kt(this),this.o&&!this.J&&(4==d?cn(this.j,this):(this.o=!1,Wt(this)))}else(function(t){const e={};t=(t.g&&2<=He(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(p(t[r]))continue;var n=k(t[r]);const a=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const i=e[a]||[];e[a]=i,i.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,function(t){return t.join(", ")})})(this.g),400==n&&0<s.indexOf("Unknown SID")?(this.s=3,It(12)):(this.s=0,It(13)),Kt(this),qt(this)}}}catch(Bq){}},Ft.prototype.cancel=function(){this.J=!0,Kt(this)},Ft.prototype.ba=function(){this.B=null;const t=Date.now();0<=t-this.S?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.i,this.A),2!=this.L&&(St(),It(17)),Kt(this),this.s=2,qt(this)):Gt(this,this.S-t)};var Yt=class{constructor(t,e){this.g=t,this.map=e}};function Qt(t){this.l=t||10,a.PerformanceNavigationTiming?t=0<(t=a.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Jt(t){return!!t.h||!!t.g&&t.g.size>=t.j}function $t(t){return t.h?1:t.g?t.g.size:0}function Zt(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function te(t,e){t.g?t.g.add(e):t.h=e}function ee(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ne(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return d(t.i)}function re(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(i(t)||"string"===typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.na&&"function"==typeof t.na)return t.na();if(!t.V||"function"!=typeof t.V){if("undefined"!==typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!==typeof Set&&t instanceof Set)){if(i(t)||"string"===typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function(t){if(t.V&&"function"==typeof t.V)return t.V();if("undefined"!==typeof Map&&t instanceof Map||"undefined"!==typeof Set&&t instanceof Set)return Array.from(t.values());if("string"===typeof t)return t.split("");if(i(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),a=r.length,o=0;o<a;o++)e.call(void 0,r[o],n&&n[o],t)}Qt.prototype.cancel=function(){if(this.i=ne(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var ae=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ie(t){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,t instanceof ie){this.h=t.h,se(this,t.j),this.o=t.o,this.g=t.g,ce(this,t.s),this.l=t.l;var e=t.i,n=new xe;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),le(this,n),this.m=t.m}else t&&(e=String(t).match(ae))?(this.h=!1,se(this,e[1]||"",!0),this.o=de(e[2]||""),this.g=de(e[3]||"",!0),ce(this,e[4]),this.l=de(e[5]||"",!0),le(this,e[6]||"",!0),this.m=de(e[7]||"")):(this.h=!1,this.i=new xe(null,this.h))}function oe(t){return new ie(t)}function se(t,e,n){t.j=n?de(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ce(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.s=e}else t.s=null}function le(t,e,n){e instanceof xe?(t.i=e,function(t,e){e&&!t.j&&(ke(t),t.i=null,t.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(_e(this,e),Te(this,n,t))},t)),t.j=e}(t.i,t.h)):(n||(e=fe(e,be)),t.i=new xe(e,t.h))}function ue(t,e,n){t.i.set(e,n)}function he(t){return ue(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function de(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function fe(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,pe),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function pe(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ie.prototype.toString=function(){var t=[],e=this.j;e&&t.push(fe(e,ge,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.o)&&t.push(fe(e,ge,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(fe(n,"/"==n.charAt(0)?ve:ye,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.m)&&t.push("#",fe(n,we)),t.join("")};var me,ge=/[#\/\?@]/g,ye=/[#\?:]/g,ve=/[#\?]/g,be=/[#\?@]/g,we=/#/g;function xe(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ke(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),a=null;if(0<=r){var i=t[n].substring(0,r);a=t[n].substring(r+1)}else i=t[n];e(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function _e(t,e){ke(t),e=Ie(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Se(t,e){return ke(t),e=Ie(t,e),t.g.has(e)}function Te(t,e,n){_e(t,e),0<n.length&&(t.i=null,t.g.set(Ie(t,e),d(n)),t.h+=n.length)}function Ie(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Ee(t,e,n,r,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),r(n)}catch(hs){}}function Ne(){this.g=new ft}function Ce(t,e,n){const r=n||"";try{re(t,function(t,n){let a=t;o(t)&&(a=ht(t)),e.push(r+n+"="+encodeURIComponent(a))})}catch(Grt){throw e.push(r+"type="+encodeURIComponent("_badmap")),Grt}}function Ae(t){this.l=t.Ub||null,this.j=t.eb||!1}function Re(t,e){nt.call(this),this.D=t,this.o=e,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Oe(t){t.j.read().then(t.Pa.bind(t)).catch(t.ga.bind(t))}function De(t){t.readyState=4,t.l=null,t.j=null,t.v=null,Me(t)}function Me(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Fe(t){let e="";return v(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function Pe(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Fe(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):ue(t,e,n))}function Le(t){nt.call(this),this.headers=new Map,this.o=t||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(t=xe.prototype).add=function(t,e){ke(this),this.i=null,t=Ie(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},t.forEach=function(t,e){ke(this),this.g.forEach(function(n,r){n.forEach(function(n){t.call(e,n,r,this)},this)},this)},t.na=function(){ke(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const a=t[r];for(let t=0;t<a.length;t++)n.push(e[r])}return n},t.V=function(t){ke(this);let e=[];if("string"===typeof t)Se(this,t)&&(e=e.concat(this.g.get(Ie(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},t.set=function(t,e){return ke(this),this.i=null,Se(this,t=Ie(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var a=i;""!==o[r]&&(a+="="+encodeURIComponent(String(o[r]))),t.push(a)}}return this.i=t.join("&")},h(Ae,pt),Ae.prototype.g=function(){return new Re(this.l,this.j)},Ae.prototype.i=(me={},function(){return me}),h(Re,nt),(t=Re.prototype).open=function(t,e){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=t,this.A=e,this.readyState=1,Me(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.u,method:this.B,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||a).fetch(new Request(this.A,e)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,De(this)),this.readyState=0},t.Sa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Me(this)),this.g&&(this.readyState=3,Me(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Oe(this)}else t.text().then(this.Ra.bind(this),this.ga.bind(this))},t.Pa=function(t){if(this.g){if(this.o&&t.value)this.response.push(t.value);else if(!this.o){var e=t.value?t.value:new Uint8Array(0);(e=this.v.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?De(this):Me(this),3==this.readyState&&Oe(this)}},t.Ra=function(t){this.g&&(this.response=this.responseText=t,De(this))},t.Qa=function(t){this.g&&(this.response=t,De(this))},t.ga=function(){this.g&&De(this)},t.setRequestHeader=function(t,e){this.u.append(t,e)},t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Re.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}}),h(Le,nt);var ze=/^https?$/i,Be=["POST","PUT"];function je(t,e){t.h=!1,t.g&&(t.j=!0,t.g.abort(),t.j=!1),t.l=e,t.m=5,Ue(t),We(t)}function Ue(t){t.A||(t.A=!0,rt(t,"complete"),rt(t,"error"))}function Ve(t){if(t.h&&"undefined"!=typeof r&&(!t.v[1]||4!=He(t)||2!=t.Z()))if(t.u&&4==He(t))it(t.Ea,0,t);else if(rt(t,"readystatechange"),4==He(t)){t.h=!1;try{const r=t.Z();t:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===r){var o=String(t.D).match(ae)[1]||null;!o&&a.self&&a.self.location&&(o=a.self.location.protocol.slice(0,-1)),i=!ze.test(o?o.toLowerCase():"")}n=i}if(n)rt(t,"complete"),rt(t,"success");else{t.m=6;try{var s=2<He(t)?t.g.statusText:""}catch(c){s=""}t.l=s+" ["+t.Z()+"]",Ue(t)}}finally{We(t)}}}function We(t,e){if(t.g){Ge(t);const n=t.g,r=t.v[0]?()=>{}:null;t.g=null,t.v=null,e||rt(t,"ready");try{n.onreadystatechange=r}catch(Grt){}}}function Ge(t){t.I&&(a.clearTimeout(t.I),t.I=null)}function He(t){return t.g?t.g.readyState:0}function qe(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.H){case"":case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Ke(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Xe(t){this.Aa=0,this.i=[],this.j=new Ct,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ke("failFast",!1,t),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ke("baseRetryDelayMs",5e3,t),this.cb=Ke("retryDelaySeedMs",1e4,t),this.Wa=Ke("forwardChannelMaxRetries",2,t),this.wa=Ke("forwardChannelRequestTimeoutMs",2e4,t),this.pa=t&&t.xmlHttpFactory||void 0,this.Xa=t&&t.Tb||void 0,this.Ca=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.h=new Qt(t&&t.concurrentRequestLimit),this.Da=new Ne,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=t&&t.Rb||!1,t&&t.xa&&this.j.xa(),t&&t.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&t&&t.detectBufferingProxy||!1,this.ja=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.ja=t.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Ye(t){if(Je(t),3==t.G){var e=t.U++,n=oe(t.I);if(ue(n,"SID",t.K),ue(n,"RID",e),ue(n,"TYPE","terminate"),tn(t,n),(e=new Ft(t,t.j,e)).L=2,e.v=he(oe(n)),n=!1,a.navigator&&a.navigator.sendBeacon)try{n=a.navigator.sendBeacon(e.v.toString(),"")}catch(r){}!n&&a.Image&&((new Image).src=e.v,n=!0),n||(e.g=fn(e.j,null),e.g.ea(e.v)),e.F=Date.now(),Wt(e)}hn(t)}function Qe(t){t.g&&(an(t),t.g.cancel(),t.g=null)}function Je(t){Qe(t),t.u&&(a.clearTimeout(t.u),t.u=null),sn(t),t.h.cancel(),t.s&&("number"===typeof t.s&&a.clearTimeout(t.s),t.s=null)}function $e(t){if(!Jt(t.h)&&!t.s){t.s=!0;var e=t.Ga;E||A(),N||(E(),N=!0),C.add(e,t),t.B=0}}function Ze(t,e){var n;n=e?e.l:t.U++;const r=oe(t.I);ue(r,"SID",t.K),ue(r,"RID",n),ue(r,"AID",t.T),tn(t,r),t.m&&t.o&&Pe(r,t.m,t.o),n=new Ft(t,t.j,n,t.B+1),null===t.m&&(n.H=t.o),e&&(t.i=e.D.concat(t.i)),e=en(t,n,1e3),n.I=Math.round(.5*t.wa)+Math.round(.5*t.wa*Math.random()),te(t.h,n),Bt(n,r,e)}function tn(t,e){t.H&&v(t.H,function(t,n){ue(e,n,t)}),t.l&&re({},function(t,n){ue(e,n,t)})}function en(t,e,n){n=Math.min(t.i.length,n);var r=t.l?l(t.l.Na,t.l,t):null;t:{var a=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=a[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let i=!0;for(let o=0;o<n;o++){let n=a[o].g;const s=a[o].map;if(n-=e,0>n)e=Math.max(0,a[o].g-100),i=!1;else try{Ce(s,t,"req"+n+"_")}catch(Bq){r&&r(s)}}if(i){r=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,r}function nn(t){if(!t.g&&!t.u){t.Y=1;var e=t.Fa;E||A(),N||(E(),N=!0),C.add(e,t),t.v=0}}function rn(t){return!(t.g||t.u||3<=t.v)&&(t.Y++,t.u=Nt(l(t.Fa,t),ln(t,t.v)),t.v++,!0)}function an(t){null!=t.A&&(a.clearTimeout(t.A),t.A=null)}function on(t){t.g=new Ft(t,t.j,"rpc",t.Y),null===t.m&&(t.g.H=t.o),t.g.O=0;var e=oe(t.qa);ue(e,"RID","rpc"),ue(e,"SID",t.K),ue(e,"AID",t.T),ue(e,"CI",t.F?"0":"1"),!t.F&&t.ja&&ue(e,"TO",t.ja),ue(e,"TYPE","xmlhttp"),tn(t,e),t.m&&t.o&&Pe(e,t.m,t.o),t.L&&(t.g.I=t.L);var n=t.g;t=t.ia,n.L=1,n.v=he(oe(e)),n.m=null,n.P=!0,jt(n,t)}function sn(t){null!=t.C&&(a.clearTimeout(t.C),t.C=null)}function cn(t,e){var n=null;if(t.g==e){sn(t),an(t),t.g=null;var r=2}else{if(!Zt(t.h,e))return;n=e.D,ee(t.h,e),r=1}if(0!=t.G)if(e.o)if(1==r){n=e.m?e.m.length:0,e=Date.now()-e.F;var a=t.B;rt(r=kt(),new Et(r,n)),$e(t)}else nn(t);else if(3==(a=e.s)||0==a&&0<e.X||!(1==r&&function(t,e){return!($t(t.h)>=t.h.j-(t.s?1:0))&&(t.s?(t.i=e.D.concat(t.i),!0):!(1==t.G||2==t.G||t.B>=(t.Va?0:t.Wa))&&(t.s=Nt(l(t.Ga,t,e),ln(t,t.B)),t.B++,!0))}(t,e)||2==r&&rn(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),a){case 1:un(t,5);break;case 4:un(t,10);break;case 3:un(t,6);break;default:un(t,2)}}function ln(t,e){let n=t.Ta+Math.floor(Math.random()*t.cb);return t.isActive()||(n*=2),n*e}function un(t,e){if(t.j.info("Error code "+e),2==e){var n=l(t.fb,t),r=t.Xa;const e=!r;r=new ie(r||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||se(r,"https"),he(r),e?function(t,e){const n=new Ct;if(a.Image){const r=new Image;r.onload=u(Ee,n,"TestLoadImage: loaded",!0,e,r),r.onerror=u(Ee,n,"TestLoadImage: error",!1,e,r),r.onabort=u(Ee,n,"TestLoadImage: abort",!1,e,r),r.ontimeout=u(Ee,n,"TestLoadImage: timeout",!1,e,r),a.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(r.toString(),n):function(t,e){new Ct;const n=new AbortController,r=setTimeout(()=>{n.abort(),Ee(0,0,!1,e)},1e4);fetch(t,{signal:n.signal}).then(t=>{clearTimeout(r),t.ok?Ee(0,0,!0,e):Ee(0,0,!1,e)}).catch(()=>{clearTimeout(r),Ee(0,0,!1,e)})}(r.toString(),n)}else It(2);t.G=0,t.l&&t.l.sa(e),hn(t),Je(t)}function hn(t){if(t.G=0,t.ka=[],t.l){const e=ne(t.h);0==e.length&&0==t.i.length||(f(t.ka,e),f(t.ka,t.i),t.h.i.length=0,d(t.i),t.i.length=0),t.l.ra()}}function dn(t,e,n){var r=n instanceof ie?oe(n):new ie(n);if(""!=r.g)e&&(r.g=e+"."+r.g),ce(r,r.s);else{var i=a.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var o=new ie(null);r&&se(o,r),e&&(o.g=e),i&&ce(o,i),n&&(o.l=n),r=o}return n=t.D,e=t.ya,n&&e&&ue(r,n,e),ue(r,"VER",t.la),tn(t,r),r}function fn(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ca&&!t.pa?new Le(new Ae({eb:n})):new Le(t.pa)).Ha(t.J),e}function pn(){}function mn(){}function gn(t,e){nt.call(this),this.g=new Xe(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.o=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.va&&(t?t["X-WebChannel-Client-Profile"]=e.va:t={"X-WebChannel-Client-Profile":e.va}),this.g.S=t,(t=e&&e.Sb)&&!p(t)&&(this.g.m=t),this.v=e&&e.supportsCrossDomainXhr||!1,this.u=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!p(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new bn(this)}function yn(t){vt.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function vn(){bt.call(this),this.status=1}function bn(t){this.g=t}(t=Le.prototype).Ha=function(t){this.J=t},t.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Rt.g(),this.v=this.o?mt(this.o):mt(Rt),this.g.onreadystatechange=l(this.Ea,this);try{this.B=!0,this.g.open(e,String(t),!0),this.B=!1}catch(hs){return void je(this,hs)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const t of r.keys())n.set(t,r.get(t))}r=Array.from(n.keys()).find(t=>"content-type"==t.toLowerCase()),i=a.FormData&&t instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Be,e,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of n)this.g.setRequestHeader(a,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ge(this),this.u=!0,this.g.send(t),this.u=!1}catch(hs){je(this,hs)}},t.abort=function(t){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=t||7,rt(this,"complete"),rt(this,"abort"),We(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),We(this,!0)),Le.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ve(this):this.bb())},t.bb=function(){Ve(this)},t.isActive=function(){return!!this.g},t.Z=function(){try{return 2<He(this)?this.g.status:-1}catch(me){return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch(me){return""}},t.Oa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),dt(e)}},t.Ba=function(){return this.m},t.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(t=Xe.prototype).la=8,t.G=1,t.connect=function(t,e,n,r){It(0),this.W=t,this.H=e||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=dn(this,null,this.W),$e(this)},t.Ga=function(t){if(this.s)if(this.s=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const a=new Ft(this,this.j,t);let i=this.o;if(this.S&&(i?(i=b(i),x(i,this.S)):i=this.S),null!==this.m||this.O||(a.H=i,i=null),this.P)t:{for(var e=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=en(this,a,e),ue(n=oe(this.I),"RID",t),ue(n,"CVER",22),this.D&&ue(n,"X-HTTP-Session-Id",this.D),tn(this,n),i&&(this.O?e="headers="+encodeURIComponent(String(Fe(i)))+"&"+e:this.m&&Pe(n,this.m,i)),te(this.h,a),this.Ua&&ue(n,"TYPE","init"),this.P?(ue(n,"$req",e),ue(n,"SID","null"),a.T=!0,Bt(a,n,null)):Bt(a,n,e),this.G=2}}else 3==this.G&&(t?Ze(this,t):0==this.i.length||Jt(this.h)||Ze(this))},t.Fa=function(){if(this.u=null,on(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var t=2*this.R;this.j.info("BP detection timer enabled: "+t),this.A=Nt(l(this.ab,this),t)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,It(10),Qe(this),on(this))},t.Za=function(){null!=this.C&&(this.C=null,Qe(this),rn(this),It(19))},t.fb=function(t){t?(this.j.info("Successfully pinged google.com"),It(2)):(this.j.info("Failed to ping google.com"),It(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=pn.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){},mn.prototype.g=function(t,e){return new gn(t,e)},h(gn,nt),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Ye(this.g)},gn.prototype.o=function(t){var e=this.g;if("string"===typeof t){var n={};n.__data__=t,t=n}else this.u&&((n={}).__data__=ht(t),t=n);e.i.push(new Yt(e.Ya++,t)),3==e.G&&$e(e)},gn.prototype.N=function(){this.g.l=null,delete this.j,Ye(this.g),delete this.g,gn.aa.N.call(this)},h(yn,vt),h(vn,bt),h(bn,pn),bn.prototype.ua=function(){rt(this.g,"a")},bn.prototype.ta=function(t){rt(this.g,new yn(t))},bn.prototype.sa=function(t){rt(this.g,new vn)},bn.prototype.ra=function(){rt(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,o4=c4.createWebChannelTransport=function(){return new mn},i4=c4.getStatEventTarget=function(){return kt()},a4=c4.Event=wt,r4=c4.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ot.NO_ERROR=0,Ot.TIMEOUT=8,Ot.HTTP_ERROR=6,n4=c4.ErrorCode=Ot,Dt.COMPLETE="complete",e4=c4.EventType=Dt,gt.EventType=yt,yt.OPEN="a",yt.CLOSE="b",yt.ERROR="c",yt.MESSAGE="d",nt.prototype.listen=nt.prototype.K,t4=c4.WebChannel=gt,c4.FetchXmlHttpFactory=Ae,Le.prototype.listenOnce=Le.prototype.L,Le.prototype.getLastError=Le.prototype.Ka,Le.prototype.getLastErrorCode=Le.prototype.Ba,Le.prototype.getStatus=Le.prototype.Z,Le.prototype.getResponseJson=Le.prototype.Oa,Le.prototype.getResponseText=Le.prototype.oa,Le.prototype.send=Le.prototype.ea,Le.prototype.setWithCredentials=Le.prototype.Ha,Z3=c4.XhrIo=Le}).apply("undefined"!==typeof s4?s4:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const l4="@firebase/firestore",u4="4.8.0";class h4{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}h4.UNAUTHENTICATED=new h4(null),h4.GOOGLE_CREDENTIALS=new h4("google-credentials-uid"),h4.FIRST_PARTY=new h4("first-party-uid"),h4.MOCK_USER=new h4("mock-user");let d4="11.10.0";const f4=new eZ("@firebase/firestore");function p4(){return f4.logLevel}function m4(t){if(f4.logLevel<=Q$.DEBUG){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const a=n.map(v4);f4.debug("Firestore (".concat(d4,"): ").concat(t),...a)}}function g4(t){if(f4.logLevel<=Q$.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const a=n.map(v4);f4.error("Firestore (".concat(d4,"): ").concat(t),...a)}}function y4(t){if(f4.logLevel<=Q$.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const a=n.map(v4);f4.warn("Firestore (".concat(d4,"): ").concat(t),...a)}}function v4(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function b4(t,e,n){let r="Unexpected state";"string"==typeof e?r=e:n=e,w4(t,r,n)}function w4(t,e,n){let r="FIRESTORE (".concat(d4,") INTERNAL ASSERTION FAILED: ").concat(e," (ID: ").concat(t.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(t){r+=" CONTEXT: "+n}throw g4(r),new Error(r)}function x4(t,e,n,r){let a="Unexpected state";"string"==typeof n?a=n:r=n,t||w4(e,a,r)}function k4(t,e){return t}const _4={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class S4 extends D${constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class T4{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class I4{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}}class E4{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(h4.UNAUTHENTICATED))}shutdown(){}}class N4{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class C4{constructor(t){this.t=t,this.currentUser=h4.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){x4(void 0===this.o,42304);let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let a=new T4;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new T4,t.enqueueRetryable(()=>r(this.currentUser))};const i=()=>{const e=a;t.enqueueRetryable(async()=>{await e.promise,await r(this.currentUser)})},o=t=>{m4("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(t=>o(t)),setTimeout(()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(m4("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new T4)}},0),i()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.i!==t?(m4("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(x4("string"==typeof e.accessToken,31837,{l:e}),new I4(e.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return x4(null===t||"string"==typeof t,2055,{h:t}),new h4(t)}}class A4{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=h4.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class R4{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new A4(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable(()=>e(h4.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class O4{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class D4{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,n0(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){x4(void 0===this.o,3512);const n=t=>{null!=t.error&&m4("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(t.error.message));const n=t.token!==this.m;return this.m=t.token,m4("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable(()=>n(e))};const r=t=>{m4("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(t=>r(t)),setTimeout(()=>{if(!this.appCheck){const t=this.V.getImmediate({optional:!0});t?r(t):m4("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new O4(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(t=>t?(x4("string"==typeof t.token,44558,{tokenResult:t}),this.m=t.token,new O4(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function M4(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}function F4(){return new TextEncoder}class P4{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=M4(40);for(let r=0;r<n.length;++r)e.length<20&&n[r]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return e}}function L4(t,e){return t<e?-1:t>e?1:0}function z4(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),a=e.codePointAt(n);if(r!==a){if(r<128&&a<128)return L4(r,a);{const i=F4(),o=j4(i.encode(B4(t,n)),i.encode(B4(e,n)));return 0!==o?o:L4(r,a)}}n+=r>65535?2:1}return L4(t.length,e.length)}function B4(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function j4(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return L4(t[n],e[n]);return L4(t.length,e.length)}function U4(t,e,n){return t.length===e.length&&t.every((t,r)=>n(t,e[r]))}const V4="__name__";class W4{constructor(t,e,n){void 0===e?e=0:e>t.length&&b4(637,{offset:e,range:t.length}),void 0===n?n=t.length-e:n>t.length-e&&b4(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===W4.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof W4?t.forEach(t=>{e.push(t)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=W4.compareSegments(t.get(r),e.get(r));if(0!==n)return n}return L4(t.length,e.length)}static compareSegments(t,e){const n=W4.isNumericId(t),r=W4.isNumericId(e);return n&&!r?-1:!n&&r?1:n&&r?W4.extractNumericId(t).compare(W4.extractNumericId(e)):z4(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return Y3.fromString(t.substring(4,t.length-2))}}class G4 extends W4{construct(t,e,n){return new G4(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const a of n){if(a.indexOf("//")>=0)throw new S4(_4.INVALID_ARGUMENT,"Invalid segment (".concat(a,"). Paths must not contain // in them."));t.push(...a.split("/").filter(t=>t.length>0))}return new G4(t)}static emptyPath(){return new G4([])}}const H4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class q4 extends W4{construct(t,e,n){return new q4(t,e,n)}static isValidIdentifier(t){return H4.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),q4.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===V4}static keyField(){return new q4([V4])}static fromServerFormat(t){const e=[];let n="",r=0;const a=()=>{if(0===n.length)throw new S4(_4.INVALID_ARGUMENT,"Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));e.push(n),n=""};let i=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new S4(_4.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new S4(_4.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(i=!i,r++):"."!==e||i?(n+=e,r++):(a(),r++)}if(a(),i)throw new S4(_4.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new q4(e)}static emptyPath(){return new q4([])}}class K4{constructor(t){this.path=t}static fromPath(t){return new K4(G4.fromString(t))}static fromName(t){return new K4(G4.fromString(t).popFirst(5))}static empty(){return new K4(G4.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===G4.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return G4.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new K4(new G4(t.slice()))}}function X4(t,e,n){if(!n)throw new S4(_4.INVALID_ARGUMENT,"Function ".concat(t,"() cannot be called with an empty ").concat(e,"."))}function Y4(t){if(!K4.isDocumentKey(t))throw new S4(_4.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(t," has ").concat(t.length,"."))}function Q4(t){if(K4.isDocumentKey(t))throw new S4(_4.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(t," has ").concat(t.length,"."))}function J4(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function $4(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t="".concat(t.substring(0,20),"...")),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?"a custom ".concat(e," object"):"an object"}}return"function"==typeof t?"a function":b4(12329,{type:typeof t})}function Z4(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new S4(_4.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=$4(t);throw new S4(_4.INVALID_ARGUMENT,"Expected type '".concat(e.name,"', but it was: ").concat(n))}}return t}function t5(t,e){const n={typeString:t};return e&&(n.value=e),n}function e5(t,e){if(!J4(t))throw new S4(_4.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const a=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n="JSON missing required field: '".concat(r,"'");break}const o=t[r];if(a&&typeof o!==a){n="JSON field '".concat(r,"' must be a ").concat(a,".");break}if(void 0!==i&&o!==i.value){n="Expected '".concat(r,"' field to equal '").concat(i.value,"'");break}}if(n)throw new S4(_4.INVALID_ARGUMENT,n);return!0}const n5=-62135596800,r5=1e6;class a5{static now(){return a5.fromMillis(Date.now())}static fromDate(t){return a5.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*r5);return new a5(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new S4(_4.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new S4(_4.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<n5)throw new S4(_4.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new S4(_4.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/r5}_compareTo(t){return this.seconds===t.seconds?L4(this.nanoseconds,t.nanoseconds):L4(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:a5._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(e5(t,a5._jsonSchema))return new a5(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-n5;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}a5._jsonSchemaVersion="firestore/timestamp/1.0",a5._jsonSchema={type:t5("string",a5._jsonSchemaVersion),seconds:t5("number"),nanoseconds:t5("number")};class i5{static fromTimestamp(t){return new i5(t)}static min(){return new i5(new a5(0,0))}static max(){return new i5(new a5(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const o5=-1;class s5{constructor(t,e,n,r){this.indexId=t,this.collectionGroup=e,this.fields=n,this.indexState=r}}s5.UNKNOWN_ID=-1;function c5(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,a=i5.fromTimestamp(1e9===r?new a5(n+1,0):new a5(n,r));return new u5(a,K4.empty(),e)}function l5(t){return new u5(t.readTime,t.key,o5)}class u5{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new u5(i5.min(),K4.empty(),o5)}static max(){return new u5(i5.max(),K4.empty(),o5)}}function h5(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=K4.comparator(t.documentKey,e.documentKey),0!==n?n:L4(t.largestBatchId,e.largestBatchId))}const d5="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class f5{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}async function p5(t){if(t.code!==_4.FAILED_PRECONDITION||t.message!==d5)throw t;m4("LocalStore","Unexpectedly lost primary lease")}class m5{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&b4(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new m5((n,r)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,r)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,r)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof m5?e:m5.resolve(e)}catch(t){return m5.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):m5.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):m5.reject(e)}static resolve(t){return new m5((e,n)=>{e(t)})}static reject(t){return new m5((e,n)=>{n(t)})}static waitFor(t){return new m5((e,n)=>{let r=0,a=0,i=!1;t.forEach(t=>{++r,t.next(()=>{++a,i&&a===r&&e()},t=>n(t))}),i=!0,a===r&&e()})}static or(t){let e=m5.resolve(!1);for(const n of t)e=e.next(t=>t?m5.resolve(t):n());return e}static forEach(t,e){const n=[];return t.forEach((t,r)=>{n.push(e.call(this,t,r))}),this.waitFor(n)}static mapArray(t,e){return new m5((n,r)=>{const a=t.length,i=new Array(a);let o=0;for(let s=0;s<a;s++){const c=s;e(t[c]).next(t=>{i[c]=t,++o,o===a&&n(i)},t=>r(t))}})}static doWhile(t,e){return new m5((n,r)=>{const a=()=>{!0===t()?e().next(()=>{a()},r):n()};a()})}}function g5(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function y5(t){return"IndexedDbTransactionError"===t.name}class v5{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this._e(t),this.ae=t=>e.writeSequenceNumber(t))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}v5.ue=-1;const b5=-1;function w5(t){return null==t}function x5(t){return 0===t&&1/t==-1/0}function k5(t){return"number"==typeof t&&Number.isInteger(t)&&!x5(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const _5="\x01";function S5(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=I5(e)),e=T5(t.get(n),e);return I5(e)}function T5(t,e){let n=e;const r=t.length;for(let a=0;a<r;a++){const e=t.charAt(a);switch(e){case"\0":n+="\x01\x10";break;case _5:n+="\x01\x11";break;default:n+=e}}return n}function I5(t){return t+_5+"\x01"}const E5="remoteDocuments",N5="owner",C5="mutationQueues",A5="mutations";const R5="documentMutations",O5="remoteDocumentsV14",D5="remoteDocumentGlobal",M5="targets",F5="targetDocuments",P5="targetGlobal",L5="collectionParents",z5="clientMetadata",B5="bundles",j5="namedQueries",U5="indexConfiguration",V5="indexState",W5="indexEntries",G5="documentOverlays",H5="globals",q5=[C5,A5,R5,E5,M5,N5,P5,F5,z5,D5,L5,B5,j5],K5=[C5,A5,R5,O5,M5,N5,P5,F5,z5,D5,L5,B5,j5,G5],X5=K5,Y5=[...X5,U5,V5,W5];function Q5(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function J5(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Z5{constructor(t,e){this.comparator=t,this.root=e||e6.EMPTY}insert(t,e){return new Z5(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,e6.BLACK,null,null))}remove(t){return new Z5(this.comparator,this.root.remove(t,this.comparator).copy(null,null,e6.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.inorderTraversal((e,n)=>(t.push("".concat(e,":").concat(n)),!1)),"{".concat(t.join(", "),"}")}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new t6(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new t6(this.root,t,this.comparator,!1)}getReverseIterator(){return new t6(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new t6(this.root,t,this.comparator,!0)}}class t6{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let a=1;for(;!t.isEmpty();)if(a=e?n(t.key,e):1,e&&r&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class e6{constructor(t,e,n,r,a){this.key=t,this.value=e,this.color=null!=n?n:e6.RED,this.left=null!=r?r:e6.EMPTY,this.right=null!=a?a:e6.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,a){return new e6(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const a=n(t,r.key);return r=a<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===a?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return e6.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return e6.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,e6.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,e6.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw b4(43730,{key:this.key,value:this.value});if(this.right.isRed())throw b4(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw b4(27949);return t+(this.isRed()?0:1)}}e6.EMPTY=null,e6.RED=!0,e6.BLACK=!1,e6.EMPTY=new class{constructor(){this.size=0}get key(){throw b4(57766)}get value(){throw b4(16141)}get color(){throw b4(16727)}get left(){throw b4(29726)}get right(){throw b4(36894)}copy(t,e,n,r,a){return this}insert(t,e,n){return new e6(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class n6{constructor(t){this.comparator=t,this.data=new Z5(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,n)=>(t(e),!1))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new r6(this.data.getIterator())}getIteratorFrom(t){return new r6(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(t=>{e=e.add(t)}),e}isEqual(t){if(!(t instanceof n6))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new n6(this.comparator);return e.data=t,e}}class r6{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class a6{constructor(t){this.fields=t,t.sort(q4.comparator)}static empty(){return new a6([])}unionWith(t){let e=new n6(q4.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new a6(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return U4(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class i6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class o6{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new i6("Invalid base64 string: "+t):t}}(t);return new o6(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new o6(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return L4(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}o6.EMPTY_BYTE_STRING=new o6("");const s6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function c6(t){if(x4(!!t,39018),"string"==typeof t){let e=0;const n=s6.exec(t);if(x4(!!n,46558,{timestamp:t}),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:l6(t.seconds),nanos:l6(t.nanos)}}function l6(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function u6(t){return"string"==typeof t?o6.fromBase64String(t):o6.fromUint8Array(t)}const h6="server_timestamp",d6="__type__",f6="__previous_value__",p6="__local_write_time__";function m6(t){var e,n;return(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{})[d6])||void 0===n?void 0:n.stringValue)===h6}function g6(t){const e=t.mapValue.fields[f6];return m6(e)?g6(e):e}function y6(t){const e=c6(t.mapValue.fields[p6].timestampValue);return new a5(e.seconds,e.nanos)}class v6{constructor(t,e,n,r,a,i,o,s,c,l){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=s,this.useFetchStreams=c,this.isUsingEmulator=l}}const b6="(default)";class w6{constructor(t,e){this.projectId=t,this.database=e||b6}static empty(){return new w6("","")}get isDefaultDatabase(){return this.database===b6}isEqual(t){return t instanceof w6&&t.projectId===this.projectId&&t.database===this.database}}const x6="__type__",k6="__max__",_6={mapValue:{fields:{__type__:{stringValue:k6}}}},S6="__vector__",T6="value";function I6(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?m6(t)?4:W6(t)?9007199254740991:U6(t)?10:11:b4(28295,{value:t})}function E6(t,e){if(t===e)return!0;const n=I6(t);if(n!==I6(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return y6(t).isEqual(y6(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=c6(t.timestampValue),r=c6(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return u6(t.bytesValue).isEqual(u6(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return l6(t.geoPointValue.latitude)===l6(e.geoPointValue.latitude)&&l6(t.geoPointValue.longitude)===l6(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return l6(t.integerValue)===l6(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=l6(t.doubleValue),r=l6(e.doubleValue);return n===r?x5(n)===x5(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return U4(t.arrayValue.values||[],e.arrayValue.values||[],E6);case 10:case 11:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Q5(n)!==Q5(r))return!1;for(const a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!E6(n[a],r[a])))return!1;return!0}(t,e);default:return b4(52216,{left:t})}}function N6(t,e){return void 0!==(t.values||[]).find(t=>E6(t,e))}function C6(t,e){if(t===e)return 0;const n=I6(t),r=I6(e);if(n!==r)return L4(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return L4(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=l6(t.integerValue||t.doubleValue),r=l6(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return A6(t.timestampValue,e.timestampValue);case 4:return A6(y6(t),y6(e));case 5:return z4(t.stringValue,e.stringValue);case 6:return function(t,e){const n=u6(t),r=u6(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let a=0;a<n.length&&a<r.length;a++){const t=L4(n[a],r[a]);if(0!==t)return t}return L4(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=L4(l6(t.latitude),l6(e.latitude));return 0!==n?n:L4(l6(t.longitude),l6(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return R6(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n,r,a,i;const o=t.fields||{},s=e.fields||{},c=null===(n=o[T6])||void 0===n?void 0:n.arrayValue,l=null===(r=s[T6])||void 0===r?void 0:r.arrayValue,u=L4((null===(a=null==c?void 0:c.values)||void 0===a?void 0:a.length)||0,(null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0);return 0!==u?u:R6(c,l)}(t.mapValue,e.mapValue);case 11:return function(t,e){if(t===_6.mapValue&&e===_6.mapValue)return 0;if(t===_6.mapValue)return 1;if(e===_6.mapValue)return-1;const n=t.fields||{},r=Object.keys(n),a=e.fields||{},i=Object.keys(a);r.sort(),i.sort();for(let o=0;o<r.length&&o<i.length;++o){const t=z4(r[o],i[o]);if(0!==t)return t;const e=C6(n[r[o]],a[i[o]]);if(0!==e)return e}return L4(r.length,i.length)}(t.mapValue,e.mapValue);default:throw b4(23264,{le:n})}}function A6(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return L4(t,e);const n=c6(t),r=c6(e),a=L4(n.seconds,r.seconds);return 0!==a?a:L4(n.nanos,r.nanos)}function R6(t,e){const n=t.values||[],r=e.values||[];for(let a=0;a<n.length&&a<r.length;++a){const t=C6(n[a],r[a]);if(t)return t}return L4(n.length,r.length)}function O6(t){return D6(t)}function D6(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=c6(t);return"time(".concat(e.seconds,",").concat(e.nanos,")")}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return u6(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return K4.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return"geo(".concat(t.latitude,",").concat(t.longitude,")")}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const r of t.values||[])n?n=!1:e+=",",e+=D6(r);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const a of e)r?r=!1:n+=",",n+="".concat(a,":").concat(D6(t.fields[a]));return n+"}"}(t.mapValue):b4(61005,{value:t})}function M6(t){switch(I6(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=g6(t);return e?16+M6(e):16;case 5:return 2*t.stringValue.length;case 6:return u6(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(t){return(t.values||[]).reduce((t,e)=>t+M6(e),0)}(t.arrayValue);case 10:case 11:return function(t){let e=0;return J5(t.fields,(t,n)=>{e+=t.length+M6(n)}),e}(t.mapValue);default:throw b4(13486,{value:t})}}function F6(t,e){return{referenceValue:"projects/".concat(t.projectId,"/databases/").concat(t.database,"/documents/").concat(e.path.canonicalString())}}function P6(t){return!!t&&"integerValue"in t}function L6(t){return!!t&&"arrayValue"in t}function z6(t){return!!t&&"nullValue"in t}function B6(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function j6(t){return!!t&&"mapValue"in t}function U6(t){var e,n;return(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{})[x6])||void 0===n?void 0:n.stringValue)===S6}function V6(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return J5(t.mapValue.fields,(t,n)=>e.mapValue.fields[t]=V6(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=V6(t.arrayValue.values[n]);return e}return Object.assign({},t)}function W6(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===k6}class G6{constructor(t){this.value=t}static empty(){return new G6({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!j6(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=V6(e)}setAll(t){let e=q4.emptyPath(),n={},r=[];t.forEach((t,a)=>{if(!e.isImmediateParentOf(a)){const t=this.getFieldsMap(e);this.applyChanges(t,n,r),n={},r=[],e=a.popLast()}t?n[a.lastSegment()]=V6(t):r.push(a.lastSegment())});const a=this.getFieldsMap(e);this.applyChanges(a,n,r)}delete(t){const e=this.field(t.popLast());j6(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return E6(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];j6(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){J5(e,(e,n)=>t[e]=n);for(const r of n)delete t[r]}clone(){return new G6(V6(this.value))}}function H6(t){const e=[];return J5(t.fields,(t,n)=>{const r=new q4([t]);if(j6(n)){const t=H6(n.mapValue).fields;if(0===t.length)e.push(r);else for(const n of t)e.push(r.child(n))}else e.push(r)}),new a6(e)}class q6{constructor(t,e,n,r,a,i,o){this.key=t,this.documentType=e,this.version=n,this.readTime=r,this.createTime=a,this.data=i,this.documentState=o}static newInvalidDocument(t){return new q6(t,0,i5.min(),i5.min(),i5.min(),G6.empty(),0)}static newFoundDocument(t,e,n,r){return new q6(t,1,e,i5.min(),n,r,0)}static newNoDocument(t,e){return new q6(t,2,e,i5.min(),i5.min(),G6.empty(),0)}static newUnknownDocument(t,e){return new q6(t,3,e,i5.min(),i5.min(),G6.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(i5.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=G6.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=G6.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=i5.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof q6&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new q6(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class K6{constructor(t,e){this.position=t,this.inclusive=e}}function X6(t,e,n){let r=0;for(let a=0;a<t.position.length;a++){const i=e[a],o=t.position[a];if(r=i.field.isKeyField()?K4.comparator(K4.fromName(o.referenceValue),n.key):C6(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Y6(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!E6(t.position[n],e.position[n]))return!1;return!0}class Q6{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=t,this.dir=e}}function J6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class $6{}class Z6 extends $6{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new s9(t,e,n):"array-contains"===e?new h9(t,n):"in"===e?new d9(t,n):"not-in"===e?new f9(t,n):"array-contains-any"===e?new p9(t,n):new Z6(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new c9(t,n):new l9(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&void 0===e.nullValue&&this.matchesComparison(C6(e,this.value)):null!==e&&I6(this.value)===I6(e)&&this.matchesComparison(C6(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return b4(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class t9 extends $6{constructor(t,e){super(),this.filters=t,this.op=e,this.he=null}static create(t,e){return new t9(t,e)}matches(t){return e9(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.he||(this.he=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function e9(t){return"and"===t.op}function n9(t){return r9(t)&&e9(t)}function r9(t){for(const e of t.filters)if(e instanceof t9)return!1;return!0}function a9(t){if(t instanceof Z6)return t.field.canonicalString()+t.op.toString()+O6(t.value);if(n9(t))return t.filters.map(t=>a9(t)).join(",");{const e=t.filters.map(t=>a9(t)).join(",");return"".concat(t.op,"(").concat(e,")")}}function i9(t,e){return t instanceof Z6?function(t,e){return e instanceof Z6&&t.op===e.op&&t.field.isEqual(e.field)&&E6(t.value,e.value)}(t,e):t instanceof t9?function(t,e){return e instanceof t9&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce((t,n,r)=>t&&i9(n,e.filters[r]),!0)}(t,e):void b4(19439)}function o9(t){return t instanceof Z6?function(t){return"".concat(t.field.canonicalString()," ").concat(t.op," ").concat(O6(t.value))}(t):t instanceof t9?function(t){return t.op.toString()+" {"+t.getFilters().map(o9).join(" ,")+"}"}(t):"Filter"}class s9 extends Z6{constructor(t,e,n){super(t,e,n),this.key=K4.fromName(n.referenceValue)}matches(t){const e=K4.comparator(t.key,this.key);return this.matchesComparison(e)}}class c9 extends Z6{constructor(t,e){super(t,"in",e),this.keys=u9("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class l9 extends Z6{constructor(t,e){super(t,"not-in",e),this.keys=u9("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function u9(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>K4.fromName(t.referenceValue))}class h9 extends Z6{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return L6(e)&&N6(e.arrayValue,this.value)}}class d9 extends Z6{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&N6(this.value.arrayValue,e)}}class f9 extends Z6{constructor(t,e){super(t,"not-in",e)}matches(t){if(N6(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&void 0===e.nullValue&&!N6(this.value.arrayValue,e)}}class p9 extends Z6{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!L6(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>N6(this.value.arrayValue,t))}}class m9{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=a,this.startAt=i,this.endAt=o,this.Pe=null}}function g9(t){return new m9(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function y9(t){const e=k4(t);if(null===e.Pe){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(t=>a9(t)).join(","),t+="|ob:",t+=e.orderBy.map(t=>function(t){return t.field.canonicalString()+t.dir}(t)).join(","),w5(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(t=>O6(t)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(t=>O6(t)).join(",")),e.Pe=t}return e.Pe}function v9(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!J6(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!i9(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Y6(t.startAt,e.startAt)&&Y6(t.endAt,e.endAt)}function b9(t){return K4.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class w9{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=a,this.limitType=i,this.startAt=o,this.endAt=s,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function x9(t,e,n,r,a,i,o,s){return new w9(t,e,n,r,a,i,o,s)}function k9(t){return new w9(t)}function _9(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function S9(t){return null!==t.collectionGroup}function T9(t){const e=k4(t);if(null===e.Te){e.Te=[];const t=new Set;for(const a of e.explicitOrderBy)e.Te.push(a),t.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",r=function(t){let e=new n6(q4.comparator);return t.filters.forEach(t=>{t.getFlattenedFilters().forEach(t=>{t.isInequality()&&(e=e.add(t.field))})}),e}(e);r.forEach(r=>{t.has(r.canonicalString())||r.isKeyField()||e.Te.push(new Q6(r,n))}),t.has(q4.keyField().canonicalString())||e.Te.push(new Q6(q4.keyField(),n))}return e.Te}function I9(t){const e=k4(t);return e.Ie||(e.Ie=E9(e,T9(t))),e.Ie}function E9(t,e){if("F"===t.limitType)return g9(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(t=>{const e="desc"===t.dir?"asc":"desc";return new Q6(t.field,e)});const n=t.endAt?new K6(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new K6(t.startAt.position,t.startAt.inclusive):null;return g9(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function N9(t,e){const n=t.filters.concat([e]);return new w9(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function C9(t,e,n){return new w9(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function A9(t,e){return v9(I9(t),I9(e))&&t.limitType===e.limitType}function R9(t){return"".concat(y9(I9(t)),"|lt:").concat(t.limitType)}function O9(t){return"Query(target=".concat(function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: [".concat(t.filters.map(t=>o9(t)).join(", "),"]")),w5(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: [".concat(t.orderBy.map(t=>function(t){return"".concat(t.field.canonicalString()," (").concat(t.dir,")")}(t)).join(", "),"]")),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(t=>O6(t)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(t=>O6(t)).join(",")),"Target(".concat(e,")")}(I9(t)),"; limitType=").concat(t.limitType,")")}function D9(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):K4.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of T9(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const r=X6(t,e,n);return t.inclusive?r<=0:r<0}(t.startAt,T9(t),e))&&!(t.endAt&&!function(t,e,n){const r=X6(t,e,n);return t.inclusive?r>=0:r>0}(t.endAt,T9(t),e))}(t,e)}function M9(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function F9(t){return(e,n)=>{let r=!1;for(const a of T9(t)){const t=P9(a,e,n);if(0!==t)return t;r=r||a.field.isKeyField()}return 0}}function P9(t,e,n){const r=t.field.isKeyField()?K4.comparator(e.key,n.key):function(t,e,n){const r=e.data.field(t),a=n.data.field(t);return null!==r&&null!==a?C6(r,a):b4(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return b4(19790,{direction:t.dir})}}class L9{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[r,a]of n)if(this.equalsFn(r,t))return a}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],t))return void(r[a]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(t){J5(this.inner,(e,n)=>{for(const[r,a]of n)t(r,a)})}isEmpty(){return $5(this.inner)}size(){return this.innerSize}}const z9=new Z5(K4.comparator);function B9(){return z9}const j9=new Z5(K4.comparator);function U9(){let t=j9;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const a of n)t=t.insert(a.key,a);return t}function V9(t){let e=j9;return t.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function W9(){return H9()}function G9(){return H9()}function H9(){return new L9(t=>t.toString(),(t,e)=>t.isEqual(e))}const q9=new Z5(K4.comparator),K9=new n6(K4.comparator);function X9(){let t=K9;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const a of n)t=t.add(a);return t}const Y9=new n6(L4);function Q9(){return Y9}function J9(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:x5(e)?"-0":e}}function $9(t){return{integerValue:""+t}}function Z9(t,e){return k5(e)?$9(e):J9(t,e)}class t8{constructor(){this._=void 0}}function e8(t,e,n){return t instanceof a8?function(t,e){const n={fields:{[d6]:{stringValue:h6},[p6]:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&m6(e)&&(e=g6(e)),e&&(n.fields[f6]=e),{mapValue:n}}(n,e):t instanceof i8?o8(t,e):t instanceof s8?c8(t,e):function(t,e){const n=r8(t,e),r=u8(n)+u8(t.Ee);return P6(n)&&P6(t.Ee)?$9(r):J9(t.serializer,r)}(t,e)}function n8(t,e,n){return t instanceof i8?o8(t,e):t instanceof s8?c8(t,e):n}function r8(t,e){return t instanceof l8?function(t){return P6(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class a8 extends t8{}class i8 extends t8{constructor(t){super(),this.elements=t}}function o8(t,e){const n=h8(e);for(const r of t.elements)n.some(t=>E6(t,r))||n.push(r);return{arrayValue:{values:n}}}class s8 extends t8{constructor(t){super(),this.elements=t}}function c8(t,e){let n=h8(e);for(const r of t.elements)n=n.filter(t=>!E6(t,r));return{arrayValue:{values:n}}}class l8 extends t8{constructor(t,e){super(),this.serializer=t,this.Ee=e}}function u8(t){return l6(t.integerValue||t.doubleValue)}function h8(t){return L6(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class d8{constructor(t,e){this.version=t,this.transformResults=e}}class f8{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new f8}static exists(t){return new f8(void 0,t)}static updateTime(t){return new f8(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function p8(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class m8{}function g8(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new I8(t.key,f8.none()):new x8(t.key,t.data,f8.none());{const n=t.data,r=G6.empty();let a=new n6(q4.comparator);for(let t of e.fields)if(!a.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?r.delete(t):r.set(t,e),a=a.add(t)}return new k8(t.key,r,new a6(a.toArray()),f8.none())}}function y8(t,e,n){t instanceof x8?function(t,e,n){const r=t.value.clone(),a=S8(t.fieldTransforms,e,n.transformResults);r.setAll(a),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof k8?function(t,e,n){if(!p8(t.precondition,e))return void e.convertToUnknownDocument(n.version);const r=S8(t.fieldTransforms,e,n.transformResults),a=e.data;a.setAll(_8(t)),a.setAll(r),e.convertToFoundDocument(n.version,a).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function v8(t,e,n,r){return t instanceof x8?function(t,e,n,r){if(!p8(t.precondition,e))return n;const a=t.value.clone(),i=T8(t.fieldTransforms,r,e);return a.setAll(i),e.convertToFoundDocument(e.version,a).setHasLocalMutations(),null}(t,e,n,r):t instanceof k8?function(t,e,n,r){if(!p8(t.precondition,e))return n;const a=T8(t.fieldTransforms,r,e),i=e.data;return i.setAll(_8(t)),i.setAll(a),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map(t=>t.field))}(t,e,n,r):function(t,e,n){return p8(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function b8(t,e){let n=null;for(const r of t.fieldTransforms){const t=e.data.field(r.field),a=r8(r.transform,t||null);null!=a&&(null===n&&(n=G6.empty()),n.set(r.field,a))}return n||null}function w8(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&U4(t,e,(t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof i8&&e instanceof i8||t instanceof s8&&e instanceof s8?U4(t.elements,e.elements,E6):t instanceof l8&&e instanceof l8?E6(t.Ee,e.Ee):t instanceof a8&&e instanceof a8}(t.transform,e.transform)}(t,e))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class x8 extends m8{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class k8 extends m8{constructor(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function _8(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function S8(t,e,n){const r=new Map;x4(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let a=0;a<n.length;a++){const i=t[a],o=i.transform,s=e.data.field(i.field);r.set(i.field,n8(o,s,n[a]))}return r}function T8(t,e,n){const r=new Map;for(const a of t){const t=a.transform,i=n.data.field(a.field);r.set(a.field,e8(t,i,e))}return r}class I8 extends m8{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class E8 extends m8{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class N8{constructor(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let r=0;r<this.mutations.length;r++){const e=this.mutations[r];e.key.isEqual(t.key)&&y8(e,t,n[r])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=v8(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=v8(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=G9();return this.mutations.forEach(r=>{const a=t.get(r.key),i=a.overlayedDocument;let o=this.applyToLocalView(i,a.mutatedFields);o=e.has(r.key)?null:o;const s=g8(i,o);null!==s&&n.set(r.key,s),i.isValidDocument()||i.convertToNoDocument(i5.min())}),n}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),X9())}isEqual(t){return this.batchId===t.batchId&&U4(this.mutations,t.mutations,(t,e)=>w8(t,e))&&U4(this.baseMutations,t.baseMutations,(t,e)=>w8(t,e))}}class C8{constructor(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}static from(t,e,n){x4(t.mutations.length===n.length,58842,{Ve:t.mutations.length,me:n.length});let r=q9;const a=t.mutations;for(let i=0;i<a.length;i++)r=r.insert(a[i].key,n[i].version);return new C8(t,e,n,r)}}class A8{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class R8{constructor(t,e){this.count=t,this.unchangedNames=e}}var O8,D8;function M8(t){switch(t){case _4.OK:return b4(64938);case _4.CANCELLED:case _4.UNKNOWN:case _4.DEADLINE_EXCEEDED:case _4.RESOURCE_EXHAUSTED:case _4.INTERNAL:case _4.UNAVAILABLE:case _4.UNAUTHENTICATED:return!1;case _4.INVALID_ARGUMENT:case _4.NOT_FOUND:case _4.ALREADY_EXISTS:case _4.PERMISSION_DENIED:case _4.FAILED_PRECONDITION:case _4.ABORTED:case _4.OUT_OF_RANGE:case _4.UNIMPLEMENTED:case _4.DATA_LOSS:return!0;default:return b4(15467,{code:t})}}function F8(t){if(void 0===t)return g4("GRPC error has no .code"),_4.UNKNOWN;switch(t){case O8.OK:return _4.OK;case O8.CANCELLED:return _4.CANCELLED;case O8.UNKNOWN:return _4.UNKNOWN;case O8.DEADLINE_EXCEEDED:return _4.DEADLINE_EXCEEDED;case O8.RESOURCE_EXHAUSTED:return _4.RESOURCE_EXHAUSTED;case O8.INTERNAL:return _4.INTERNAL;case O8.UNAVAILABLE:return _4.UNAVAILABLE;case O8.UNAUTHENTICATED:return _4.UNAUTHENTICATED;case O8.INVALID_ARGUMENT:return _4.INVALID_ARGUMENT;case O8.NOT_FOUND:return _4.NOT_FOUND;case O8.ALREADY_EXISTS:return _4.ALREADY_EXISTS;case O8.PERMISSION_DENIED:return _4.PERMISSION_DENIED;case O8.FAILED_PRECONDITION:return _4.FAILED_PRECONDITION;case O8.ABORTED:return _4.ABORTED;case O8.OUT_OF_RANGE:return _4.OUT_OF_RANGE;case O8.UNIMPLEMENTED:return _4.UNIMPLEMENTED;case O8.DATA_LOSS:return _4.DATA_LOSS;default:return b4(39323,{code:t})}}(D8=O8||(O8={}))[D8.OK=0]="OK",D8[D8.CANCELLED=1]="CANCELLED",D8[D8.UNKNOWN=2]="UNKNOWN",D8[D8.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",D8[D8.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",D8[D8.NOT_FOUND=5]="NOT_FOUND",D8[D8.ALREADY_EXISTS=6]="ALREADY_EXISTS",D8[D8.PERMISSION_DENIED=7]="PERMISSION_DENIED",D8[D8.UNAUTHENTICATED=16]="UNAUTHENTICATED",D8[D8.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",D8[D8.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",D8[D8.ABORTED=10]="ABORTED",D8[D8.OUT_OF_RANGE=11]="OUT_OF_RANGE",D8[D8.UNIMPLEMENTED=12]="UNIMPLEMENTED",D8[D8.INTERNAL=13]="INTERNAL",D8[D8.UNAVAILABLE=14]="UNAVAILABLE",D8[D8.DATA_LOSS=15]="DATA_LOSS";let P8=null;const L8=new Y3([4294967295,4294967295],0);function z8(t){const e=F4().encode(t),n=new Q3;return n.update(e),new Uint8Array(n.digest())}function B8(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Y3([n,r],0),new Y3([a,i],0)]}class j8{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new U8("Invalid padding: ".concat(e));if(n<0)throw new U8("Invalid hash count: ".concat(n));if(t.length>0&&0===this.hashCount)throw new U8("Invalid hash count: ".concat(n));if(0===t.length&&0!==e)throw new U8("Invalid padding when bitmap length is 0: ".concat(e));this.fe=8*t.length-e,this.ge=Y3.fromNumber(this.fe)}pe(t,e,n){let r=t.add(e.multiply(Y3.fromNumber(n)));return 1===r.compare(L8)&&(r=new Y3([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.fe)return!1;const e=z8(t),[n,r]=B8(e);for(let a=0;a<this.hashCount;a++){const t=this.pe(n,r,a);if(!this.ye(t))return!1}return!0}static create(t,e,n){const r=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),i=new j8(a,r,e);return n.forEach(t=>i.insert(t)),i}insert(t){if(0===this.fe)return;const e=z8(t),[n,r]=B8(e);for(let a=0;a<this.hashCount;a++){const t=this.pe(n,r,a);this.we(t)}}we(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class U8 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class V8{constructor(t,e,n,r,a){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const r=new Map;return r.set(t,W8.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new V8(i5.min(),r,new Z5(L4),B9(),X9())}}class W8{constructor(t,e,n,r,a){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new W8(n,e,X9(),X9(),X9())}}class G8{constructor(t,e,n,r){this.Se=t,this.removedTargetIds=e,this.key=n,this.be=r}}class H8{constructor(t,e){this.targetId=t,this.De=e}}class q8{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o6.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}class K8{constructor(){this.ve=0,this.Ce=Q8(),this.Fe=o6.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return 0!==this.ve}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=X9(),e=X9(),n=X9();return this.Ce.forEach((r,a)=>{switch(a){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:b4(38017,{changeType:a})}}),new W8(this.Fe,this.Me,t,e,n)}ke(){this.xe=!1,this.Ce=Q8()}qe(t,e){this.xe=!0,this.Ce=this.Ce.insert(t,e)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,x4(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class X8{constructor(t){this.We=t,this.Ge=new Map,this.ze=B9(),this.je=Y8(),this.Je=Y8(),this.He=new Z5(L4)}Ye(t){for(const e of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(e,t.be):this.Xe(e,t.key,t.be);for(const e of t.removedTargetIds)this.Xe(e,t.key,t.be)}et(t){this.forEachTarget(t,e=>{const n=this.tt(e);switch(t.state){case 0:this.nt(e)&&n.Be(t.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(t.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(e);break;case 3:this.nt(e)&&(n.Ke(),n.Be(t.resumeToken));break;case 4:this.nt(e)&&(this.rt(e),n.Be(t.resumeToken));break;default:b4(56790,{state:t.state})}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Ge.forEach((t,n)=>{this.nt(n)&&e(n)})}it(t){const e=t.targetId,n=t.De.count,r=this.st(e);if(r){const a=r.target;if(b9(a))if(0===n){const t=new K4(a.path);this.Xe(e,t,q6.newNoDocument(t,i5.min()))}else x4(1===n,20013,{expectedCount:n});else{const r=this.ot(e);if(r!==n){const n=this._t(t),a=n?this.ut(n,t,r):1;if(0!==a){this.rt(e);const t=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(e,t)}null==P8||P8.ct(function(t,e,n,r,a){var i,o,s,c,l,u;const h={localCacheCount:t,existenceFilterCount:e.count,databaseId:n.database,projectId:n.projectId},d=e.unchangedNames;return d&&(h.bloomFilter={applied:0===a,hashCount:null!==(i=null==d?void 0:d.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(c=null===(s=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===s?void 0:s.length)&&void 0!==c?c:0,padding:null!==(u=null===(l=null==d?void 0:d.bits)||void 0===l?void 0:l.padding)&&void 0!==u?u:0,mightContain:t=>{var e;return null!==(e=null==r?void 0:r.mightContain(t))&&void 0!==e&&e}}),h}(r,t.De,this.We.lt(),n,a))}}}}_t(t){const e=t.De.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:a=0}=e;let i,o;try{i=u6(n).toUint8Array()}catch(t){if(t instanceof i6)return y4("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new j8(i,r,a)}catch(t){return y4(t instanceof U8?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.fe?null:o}ut(t,e,n){return e.De.count===n-this.ht(t,e.targetId)?0:2}ht(t,e){const n=this.We.getRemoteKeysForTarget(e);let r=0;return n.forEach(n=>{const a=this.We.lt(),i="projects/".concat(a.projectId,"/databases/").concat(a.database,"/documents/").concat(n.path.canonicalString());t.mightContain(i)||(this.Xe(e,n,null),r++)}),r}Pt(t){const e=new Map;this.Ge.forEach((n,r)=>{const a=this.st(r);if(a){if(n.current&&b9(a.target)){const e=new K4(a.target.path);this.Tt(e).has(r)||this.It(r,e)||this.Xe(r,e,q6.newNoDocument(e,t))}n.Ne&&(e.set(r,n.Le()),n.ke())}});let n=X9();this.Je.forEach((t,e)=>{let r=!0;e.forEachWhile(t=>{const e=this.st(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(r=!1,!1)}),r&&(n=n.add(t))}),this.ze.forEach((e,n)=>n.setReadTime(t));const r=new V8(t,e,this.He,this.ze,n);return this.ze=B9(),this.je=Y8(),this.Je=Y8(),this.He=new Z5(L4),r}Ze(t,e){if(!this.nt(t))return;const n=this.It(t,e.key)?2:0;this.tt(t).qe(e.key,n),this.ze=this.ze.insert(e.key,e),this.je=this.je.insert(e.key,this.Tt(e.key).add(t)),this.Je=this.Je.insert(e.key,this.dt(e.key).add(t))}Xe(t,e,n){if(!this.nt(t))return;const r=this.tt(t);this.It(t,e)?r.qe(e,1):r.Qe(e),this.Je=this.Je.insert(e,this.dt(e).delete(t)),this.Je=this.Je.insert(e,this.dt(e).add(t)),n&&(this.ze=this.ze.insert(e,n))}removeTarget(t){this.Ge.delete(t)}ot(t){const e=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let e=this.Ge.get(t);return e||(e=new K8,this.Ge.set(t,e)),e}dt(t){let e=this.Je.get(t);return e||(e=new n6(L4),this.Je=this.Je.insert(t,e)),e}Tt(t){let e=this.je.get(t);return e||(e=new n6(L4),this.je=this.je.insert(t,e)),e}nt(t){const e=null!==this.st(t);return e||m4("WatchChangeAggregator","Detected inactive target",t),e}st(t){const e=this.Ge.get(t);return e&&e.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new K8),this.We.getRemoteKeysForTarget(t).forEach(e=>{this.Xe(t,e,null)})}It(t,e){return this.We.getRemoteKeysForTarget(t).has(e)}}function Y8(){return new Z5(K4.comparator)}function Q8(){return new Z5(K4.comparator)}const J8={asc:"ASCENDING",desc:"DESCENDING"},$8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Z8={and:"AND",or:"OR"};class t7{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function e7(t,e){return t.useProto3Json||w5(e)?e:{value:e}}function n7(t,e){return t.useProto3Json?"".concat(new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+e.nanoseconds).slice(-9),"Z"):{seconds:""+e.seconds,nanos:e.nanoseconds}}function r7(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function a7(t,e){return n7(t,e.toTimestamp())}function i7(t){return x4(!!t,49232),i5.fromTimestamp(function(t){const e=c6(t);return new a5(e.seconds,e.nanos)}(t))}function o7(t,e){return s7(t,e).canonicalString()}function s7(t,e){const n=function(t){return new G4(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function c7(t){const e=G4.fromString(t);return x4(N7(e),10190,{key:e.toString()}),e}function l7(t,e){return o7(t.databaseId,e.path)}function u7(t,e){const n=c7(e);if(n.get(1)!==t.databaseId.projectId)throw new S4(_4.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new S4(_4.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new K4(p7(n))}function h7(t,e){return o7(t.databaseId,e)}function d7(t){const e=c7(t);return 4===e.length?G4.emptyPath():p7(e)}function f7(t){return new G4(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function p7(t){return x4(t.length>4&&"documents"===t.get(4),29091,{key:t.toString()}),t.popFirst(5)}function m7(t,e,n){return{name:l7(t,e),fields:n.value.mapValue.fields}}function g7(t,e){let n;if(e instanceof x8)n={update:m7(t,e.key,e.value)};else if(e instanceof I8)n={delete:l7(t,e.key)};else if(e instanceof k8)n={update:m7(t,e.key,e.data),updateMask:E7(e.fieldMask)};else{if(!(e instanceof E8))return b4(16599,{Rt:e.type});n={verify:l7(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(t=>function(t,e){const n=e.transform;if(n instanceof a8)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof i8)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof s8)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof l8)return{fieldPath:e.field.canonicalString(),increment:n.Ee};throw b4(20930,{transform:e.transform})}(0,t))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:a7(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:b4(27497)}(t,e.precondition)),n}function y7(t,e){return{documents:[h7(t,e.path)]}}function v7(t,e){const n={structuredQuery:{}},r=e.path;let a;null!==e.collectionGroup?(a=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=h7(t,a);const i=function(t){if(0!==t.length)return I7(t9.create(t,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(t){if(0!==t.length)return t.map(t=>function(t){return{field:S7(t.field),direction:x7(t.dir)}}(t))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const s=e7(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{Vt:n,parent:a}}function b7(t){let e=d7(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){x4(1===r,65062);const t=n.from[0];t.allDescendants?a=t.collectionId:e=e.child(t.collectionId)}let i=[];n.where&&(i=function(t){const e=w7(t);return e instanceof t9&&n9(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map(t=>function(t){return new Q6(T7(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))}(n.orderBy));let s=null;n.limit&&(s=function(t){let e;return e="object"==typeof t?t.value:t,w5(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new K6(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new K6(n,e)}(n.endAt)),x9(e,a,o,i,s,"F",c,l)}function w7(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=T7(t.unaryFilter.field);return Z6.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=T7(t.unaryFilter.field);return Z6.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=T7(t.unaryFilter.field);return Z6.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=T7(t.unaryFilter.field);return Z6.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return b4(61313);default:return b4(60726)}}(t):void 0!==t.fieldFilter?function(t){return Z6.create(T7(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return b4(58110);default:return b4(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return t9.create(t.compositeFilter.filters.map(t=>w7(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return b4(1026)}}(t.compositeFilter.op))}(t):b4(30097,{filter:t})}function x7(t){return J8[t]}function k7(t){return $8[t]}function _7(t){return Z8[t]}function S7(t){return{fieldPath:t.canonicalString()}}function T7(t){return q4.fromServerFormat(t.fieldPath)}function I7(t){return t instanceof Z6?function(t){if("=="===t.op){if(B6(t.value))return{unaryFilter:{field:S7(t.field),op:"IS_NAN"}};if(z6(t.value))return{unaryFilter:{field:S7(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(B6(t.value))return{unaryFilter:{field:S7(t.field),op:"IS_NOT_NAN"}};if(z6(t.value))return{unaryFilter:{field:S7(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:S7(t.field),op:k7(t.op),value:t.value}}}(t):t instanceof t9?function(t){const e=t.getFilters().map(t=>I7(t));return 1===e.length?e[0]:{compositeFilter:{op:_7(t.op),filters:e}}}(t):b4(54877,{filter:t})}function E7(t){const e=[];return t.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function N7(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class C7{constructor(t,e,n,r){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i5.min(),i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:i5.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:o6.EMPTY_BYTE_STRING,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=s}withSequenceNumber(t){return new C7(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new C7(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new C7(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new C7(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class A7{constructor(t){this.gt=t}}function R7(t){const e=b7({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?C9(e,e.limit,"L"):e}class O7{constructor(){}bt(t,e){this.Dt(t,e),e.vt()}Dt(t,e){if("nullValue"in t)this.Ct(e,5);else if("booleanValue"in t)this.Ct(e,10),e.Ft(t.booleanValue?1:0);else if("integerValue"in t)this.Ct(e,15),e.Ft(l6(t.integerValue));else if("doubleValue"in t){const n=l6(t.doubleValue);isNaN(n)?this.Ct(e,13):(this.Ct(e,15),x5(n)?e.Ft(0):e.Ft(n))}else if("timestampValue"in t){let n=t.timestampValue;this.Ct(e,20),"string"==typeof n&&(n=c6(n)),e.Mt("".concat(n.seconds||"")),e.Ft(n.nanos||0)}else if("stringValue"in t)this.xt(t.stringValue,e),this.Ot(e);else if("bytesValue"in t)this.Ct(e,30),e.Nt(u6(t.bytesValue)),this.Ot(e);else if("referenceValue"in t)this.Bt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Ct(e,45),e.Ft(n.latitude||0),e.Ft(n.longitude||0)}else"mapValue"in t?W6(t)?this.Ct(e,Number.MAX_SAFE_INTEGER):U6(t)?this.Lt(t.mapValue,e):(this.kt(t.mapValue,e),this.Ot(e)):"arrayValue"in t?(this.qt(t.arrayValue,e),this.Ot(e)):b4(19022,{Qt:t})}xt(t,e){this.Ct(e,25),this.$t(t,e)}$t(t,e){e.Mt(t)}kt(t,e){const n=t.fields||{};this.Ct(e,55);for(const r of Object.keys(n))this.xt(r,e),this.Dt(n[r],e)}Lt(t,e){var n,r;const a=t.fields||{};this.Ct(e,53);const i=T6,o=(null===(r=null===(n=a[i].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.Ct(e,15),e.Ft(l6(o)),this.xt(i,e),this.Dt(a[i],e)}qt(t,e){const n=t.values||[];this.Ct(e,50);for(const r of n)this.Dt(r,e)}Bt(t,e){this.Ct(e,37),K4.fromName(t).path.forEach(t=>{this.Ct(e,60),this.$t(t,e)})}Ct(t,e){t.Ft(e)}Ot(t){t.Ft(2)}}O7.Ut=new O7;class D7{constructor(){this.Dn=new M7}addToCollectionParentIndex(t,e){return this.Dn.add(e),m5.resolve()}getCollectionParents(t,e){return m5.resolve(this.Dn.getEntries(e))}addFieldIndex(t,e){return m5.resolve()}deleteFieldIndex(t,e){return m5.resolve()}deleteAllFieldIndexes(t){return m5.resolve()}createTargetIndexes(t,e){return m5.resolve()}getDocumentsMatchingTarget(t,e){return m5.resolve(null)}getIndexType(t,e){return m5.resolve(0)}getFieldIndexes(t,e){return m5.resolve([])}getNextCollectionGroupToUpdate(t){return m5.resolve(null)}getMinOffset(t,e){return m5.resolve(u5.min())}getMinOffsetFromCollectionGroup(t,e){return m5.resolve(u5.min())}updateCollectionGroup(t,e,n){return m5.resolve()}updateIndexEntries(t,e){return m5.resolve()}}class M7{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new n6(G4.comparator),a=!r.has(n);return this.index[e]=r.add(n),a}has(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new n6(G4.comparator)).toArray()}}new Uint8Array(0);const F7={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},P7=41943040;class L7{static withCacheSize(t){return new L7(t,L7.DEFAULT_COLLECTION_PERCENTILE,L7.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}L7.DEFAULT_COLLECTION_PERCENTILE=10,L7.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,L7.DEFAULT=new L7(P7,L7.DEFAULT_COLLECTION_PERCENTILE,L7.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),L7.DISABLED=new L7(-1,0,0);class z7{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new z7(0)}static ur(){return new z7(-1)}}const B7="LruGarbageCollector",j7=1048576;function U7(t,e){let[n,r]=t,[a,i]=e;const o=L4(n,a);return 0===o?L4(r,i):o}class V7{constructor(t){this.Tr=t,this.buffer=new n6(U7),this.Ir=0}dr(){return++this.Ir}Er(t){const e=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(e);else{const t=this.buffer.last();U7(e,t)<0&&(this.buffer=this.buffer.delete(t).add(e))}}get maxValue(){return this.buffer.last()[0]}}class W7{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Ar=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return null!==this.Ar}Rr(t){m4(B7,"Garbage collection scheduled in ".concat(t,"ms")),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){y5(t)?m4(B7,"Ignoring IndexedDB error during garbage collection: ",t):await p5(t)}await this.Rr(3e5)})}}class G7{constructor(t,e){this.Vr=t,this.params=e}calculateTargetCount(t,e){return this.Vr.mr(t).next(t=>Math.floor(e/100*t))}nthSequenceNumber(t,e){if(0===e)return m5.resolve(v5.ue);const n=new V7(e);return this.Vr.forEachTarget(t,t=>n.Er(t.sequenceNumber)).next(()=>this.Vr.gr(t,t=>n.Er(t))).next(()=>n.maxValue)}removeTargets(t,e,n){return this.Vr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.Vr.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(m4("LruGarbageCollector","Garbage collection skipped; disabled"),m5.resolve(F7)):this.getCacheSize(t).next(n=>n<this.params.cacheSizeCollectionThreshold?(m4("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),F7):this.pr(t,e))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,e){let n,r,a,i,o,s,c;const l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(e=>(e>this.params.maximumSequenceNumbersToCollect?(m4("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(e)),r=this.params.maximumSequenceNumbersToCollect):r=e,i=Date.now(),this.nthSequenceNumber(t,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(t,n,e))).next(e=>(a=e,s=Date.now(),this.removeOrphanedDocuments(t,n))).next(t=>(c=Date.now(),p4()<=Q$.DEBUG&&m4("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(i-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-i)+"ms\n"+"\tRemoved ".concat(a," targets in ")+(s-o)+"ms\n"+"\tRemoved ".concat(t," documents in ")+(c-s)+"ms\n"+"Total Duration: ".concat(c-l,"ms")),m5.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:a,documentsRemoved:t})))}}function H7(t,e){return new G7(t,e)}class q7{constructor(){this.changes=new L9(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,q6.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?m5.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class K7{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class X7{constructor(t,e,n,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=r}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next(r=>(n=r,this.remoteDocumentCache.getEntry(t,e))).next(t=>(null!==n&&v8(n.mutation,t,a6.empty(),a5.now()),t))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.getLocalViewOfDocuments(t,e,X9()).next(()=>e))}getLocalViewOfDocuments(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:X9();const r=W9();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,n).next(t=>{let e=U9();return t.forEach((t,n)=>{e=e.insert(t,n.overlayedDocument)}),e}))}getOverlayedDocuments(t,e){const n=W9();return this.populateOverlays(t,n,e).next(()=>this.computeViews(t,e,n,X9()))}populateOverlays(t,e,n){const r=[];return n.forEach(t=>{e.has(t)||r.push(t)}),this.documentOverlayCache.getOverlays(t,r).next(t=>{t.forEach((t,n)=>{e.set(t,n)})})}computeViews(t,e,n,r){let a=B9();const i=H9(),o=H9();return e.forEach((t,e)=>{const o=n.get(e.key);r.has(e.key)&&(void 0===o||o.mutation instanceof k8)?a=a.insert(e.key,e):void 0!==o?(i.set(e.key,o.mutation.getFieldMask()),v8(o.mutation,e,o.mutation.getFieldMask(),a5.now())):i.set(e.key,a6.empty())}),this.recalculateAndSaveOverlays(t,a).next(t=>(t.forEach((t,e)=>i.set(t,e)),e.forEach((t,e)=>{var n;return o.set(t,new K7(e,null!==(n=i.get(t))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(t,e){const n=H9();let r=new Z5((t,e)=>t-e),a=X9();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(t=>{for(const a of t)a.keys().forEach(t=>{const i=e.get(t);if(null===i)return;let o=n.get(t)||a6.empty();o=a.applyToLocalView(i,o),n.set(t,o);const s=(r.get(a.batchId)||X9()).add(t);r=r.insert(a.batchId,s)})}).next(()=>{const i=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),s=r.key,c=r.value,l=G9();c.forEach(t=>{if(!a.has(t)){const r=g8(e.get(t),n.get(t));null!==r&&l.set(t,r),a=a.add(t)}}),i.push(this.documentOverlayCache.saveOverlays(t,s,l))}return m5.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.recalculateAndSaveOverlays(t,e))}getDocumentsMatchingQuery(t,e,n,r){return function(t){return K4.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):S9(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,r):this.getDocumentsMatchingCollectionQuery(t,e,n,r)}getNextDocuments(t,e,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next(a=>{const i=r-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-a.size):m5.resolve(W9());let o=o5,s=a;return i.next(e=>m5.forEach(e,(e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),a.get(e)?m5.resolve():this.remoteDocumentCache.getEntry(t,e).next(t=>{s=s.insert(e,t)}))).next(()=>this.populateOverlays(t,e,a)).next(()=>this.computeViews(t,s,e,X9())).next(t=>({batchId:o,changes:V9(t)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new K4(e)).next(t=>{let e=U9();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})}getDocumentsMatchingCollectionGroupQuery(t,e,n,r){const a=e.collectionGroup;let i=U9();return this.indexManager.getCollectionParents(t,a).next(o=>m5.forEach(o,o=>{const s=function(t,e){return new w9(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(a));return this.getDocumentsMatchingCollectionQuery(t,s,n,r).next(t=>{t.forEach((t,e)=>{i=i.insert(t,e)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,e,n,r){let a;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,a,r))).next(t=>{a.forEach((e,n)=>{const r=n.getKey();null===t.get(r)&&(t=t.insert(r,q6.newInvalidDocument(r)))});let n=U9();return t.forEach((t,r)=>{const i=a.get(t);void 0!==i&&v8(i.mutation,r,a6.empty(),a5.now()),D9(e,r)&&(n=n.insert(t,r))}),n})}}class Y7{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,e){return m5.resolve(this.Br.get(e))}saveBundleMetadata(t,e){return this.Br.set(e.id,function(t){return{id:t.id,version:t.version,createTime:i7(t.createTime)}}(e)),m5.resolve()}getNamedQuery(t,e){return m5.resolve(this.Lr.get(e))}saveNamedQuery(t,e){return this.Lr.set(e.name,function(t){return{name:t.name,query:R7(t.bundledQuery),readTime:i7(t.readTime)}}(e)),m5.resolve()}}class Q7{constructor(){this.overlays=new Z5(K4.comparator),this.kr=new Map}getOverlay(t,e){return m5.resolve(this.overlays.get(e))}getOverlays(t,e){const n=W9();return m5.forEach(e,e=>this.getOverlay(t,e).next(t=>{null!==t&&n.set(e,t)})).next(()=>n)}saveOverlays(t,e,n){return n.forEach((n,r)=>{this.wt(t,e,r)}),m5.resolve()}removeOverlaysForBatchId(t,e,n){const r=this.kr.get(n);return void 0!==r&&(r.forEach(t=>this.overlays=this.overlays.remove(t)),this.kr.delete(n)),m5.resolve()}getOverlaysForCollection(t,e,n){const r=W9(),a=e.length+1,i=new K4(e.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const t=o.getNext().value,i=t.getKey();if(!e.isPrefixOf(i.path))break;i.path.length===a&&t.largestBatchId>n&&r.set(t.getKey(),t)}return m5.resolve(r)}getOverlaysForCollectionGroup(t,e,n,r){let a=new Z5((t,e)=>t-e);const i=this.overlays.getIterator();for(;i.hasNext();){const t=i.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=a.get(t.largestBatchId);null===e&&(e=W9(),a=a.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=W9(),s=a.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach((t,e)=>o.set(t,e)),!(o.size()>=r)););return m5.resolve(o)}wt(t,e,n){const r=this.overlays.get(n.key);if(null!==r){const t=this.kr.get(r.largestBatchId).delete(n.key);this.kr.set(r.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new A8(e,n));let a=this.kr.get(e);void 0===a&&(a=X9(),this.kr.set(e,a)),this.kr.set(e,a.add(n.key))}}class J7{constructor(){this.sessionToken=o6.EMPTY_BYTE_STRING}getSessionToken(t){return m5.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,m5.resolve()}}class $7{constructor(){this.qr=new n6(Z7.Qr),this.$r=new n6(Z7.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,e){const n=new Z7(t,e);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(t,e){t.forEach(t=>this.addReference(t,e))}removeReference(t,e){this.Wr(new Z7(t,e))}Gr(t,e){t.forEach(t=>this.removeReference(t,e))}zr(t){const e=new K4(new G4([])),n=new Z7(e,t),r=new Z7(e,t+1),a=[];return this.$r.forEachInRange([n,r],t=>{this.Wr(t),a.push(t.key)}),a}jr(){this.qr.forEach(t=>this.Wr(t))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const e=new K4(new G4([])),n=new Z7(e,t),r=new Z7(e,t+1);let a=X9();return this.$r.forEachInRange([n,r],t=>{a=a.add(t.key)}),a}containsKey(t){const e=new Z7(t,0),n=this.qr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Z7{constructor(t,e){this.key=t,this.Hr=e}static Qr(t,e){return K4.comparator(t.key,e.key)||L4(t.Hr,e.Hr)}static Ur(t,e){return L4(t.Hr,e.Hr)||K4.comparator(t.key,e.key)}}class ttt{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.er=1,this.Yr=new n6(Z7.Qr)}checkEmpty(t){return m5.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,r){const a=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new N8(a,e,n,r);this.mutationQueue.push(i);for(const o of r)this.Yr=this.Yr.add(new Z7(o.key,a)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return m5.resolve(i)}lookupMutationBatch(t,e){return m5.resolve(this.Zr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,r=this.Xr(n),a=r<0?0:r;return m5.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return m5.resolve(0===this.mutationQueue.length?b5:this.er-1)}getAllMutationBatches(t){return m5.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Z7(e,0),r=new Z7(e,Number.POSITIVE_INFINITY),a=[];return this.Yr.forEachInRange([n,r],t=>{const e=this.Zr(t.Hr);a.push(e)}),m5.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new n6(L4);return e.forEach(t=>{const e=new Z7(t,0),r=new Z7(t,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([e,r],t=>{n=n.add(t.Hr)})}),m5.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,r=n.length+1;let a=n;K4.isDocumentKey(a)||(a=a.child(""));const i=new Z7(new K4(a),0);let o=new n6(L4);return this.Yr.forEachWhile(t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.Hr)),!0)},i),m5.resolve(this.ei(o))}ei(t){const e=[];return t.forEach(t=>{const n=this.Zr(t);null!==n&&e.push(n)}),e}removeMutationBatch(t,e){x4(0===this.ti(e.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Yr;return m5.forEach(e.mutations,r=>{const a=new Z7(r.key,e.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.Yr=n})}rr(t){}containsKey(t,e){const n=new Z7(e,0),r=this.Yr.firstAfterOrEqual(n);return m5.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,m5.resolve()}ti(t,e){return this.Xr(t)}Xr(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Zr(t){const e=this.Xr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class ett{constructor(t){this.ni=t,this.docs=new Z5(K4.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,r=this.docs.get(n),a=r?r.size:0,i=this.ni(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return m5.resolve(n?n.document.mutableCopy():q6.newInvalidDocument(e))}getEntries(t,e){let n=B9();return e.forEach(t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():q6.newInvalidDocument(t))}),m5.resolve(n)}getDocumentsMatchingQuery(t,e,n,r){let a=B9();const i=e.path,o=new K4(i.child("__id-9223372036854775808__")),s=this.docs.getIteratorFrom(o);for(;s.hasNext();){const{key:t,value:{document:o}}=s.getNext();if(!i.isPrefixOf(t.path))break;t.path.length>i.length+1||h5(l5(o),n)<=0||(r.has(o.key)||D9(e,o))&&(a=a.insert(o.key,o.mutableCopy()))}return m5.resolve(a)}getAllFromCollectionGroup(t,e,n,r){b4(9500)}ri(t,e){return m5.forEach(this.docs,t=>e(t))}newChangeBuffer(t){return new ntt(this)}getSize(t){return m5.resolve(this.size)}}class ntt extends q7{constructor(t){super(),this.Or=t}applyChanges(t){const e=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?e.push(this.Or.addEntry(t,r)):this.Or.removeEntry(n)}),m5.waitFor(e)}getFromCache(t,e){return this.Or.getEntry(t,e)}getAllFromCache(t,e){return this.Or.getEntries(t,e)}}class rtt{constructor(t){this.persistence=t,this.ii=new L9(t=>y9(t),v9),this.lastRemoteSnapshotVersion=i5.min(),this.highestTargetId=0,this.si=0,this.oi=new $7,this.targetCount=0,this._i=z7.ar()}forEachTarget(t,e){return this.ii.forEach((t,n)=>e(n)),m5.resolve()}getLastRemoteSnapshotVersion(t){return m5.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return m5.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),m5.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.si&&(this.si=e),m5.resolve()}hr(t){this.ii.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this._i=new z7(e),this.highestTargetId=e),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,e){return this.hr(e),this.targetCount+=1,m5.resolve()}updateTargetData(t,e){return this.hr(e),m5.resolve()}removeTargetData(t,e){return this.ii.delete(e.target),this.oi.zr(e.targetId),this.targetCount-=1,m5.resolve()}removeTargets(t,e,n){let r=0;const a=[];return this.ii.forEach((i,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.ii.delete(i),a.push(this.removeMatchingKeysForTargetId(t,o.targetId)),r++)}),m5.waitFor(a).next(()=>r)}getTargetCount(t){return m5.resolve(this.targetCount)}getTargetData(t,e){const n=this.ii.get(e)||null;return m5.resolve(n)}addMatchingKeys(t,e,n){return this.oi.Kr(e,n),m5.resolve()}removeMatchingKeys(t,e,n){this.oi.Gr(e,n);const r=this.persistence.referenceDelegate,a=[];return r&&e.forEach(e=>{a.push(r.markPotentiallyOrphaned(t,e))}),m5.waitFor(a)}removeMatchingKeysForTargetId(t,e){return this.oi.zr(e),m5.resolve()}getMatchingKeysForTargetId(t,e){const n=this.oi.Jr(e);return m5.resolve(n)}containsKey(t,e){return m5.resolve(this.oi.containsKey(e))}}class att{constructor(t,e){this.ai={},this.overlays={},this.ui=new v5(0),this.ci=!1,this.ci=!0,this.li=new J7,this.referenceDelegate=t(this),this.hi=new rtt(this),this.indexManager=new D7,this.remoteDocumentCache=function(t){return new ett(t)}(t=>this.referenceDelegate.Pi(t)),this.serializer=new A7(e),this.Ti=new Y7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Q7,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ai[t.toKey()];return n||(n=new ttt(e,this.referenceDelegate),this.ai[t.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,e,n){m4("MemoryPersistence","Starting transaction:",t);const r=new itt(this.ui.next());return this.referenceDelegate.Ii(),n(r).next(t=>this.referenceDelegate.di(r).next(()=>t)).toPromise().then(t=>(r.raiseOnCommittedEvent(),t))}Ei(t,e){return m5.or(Object.values(this.ai).map(n=>()=>n.containsKey(t,e)))}}class itt extends f5{constructor(t){super(),this.currentSequenceNumber=t}}class ott{constructor(t){this.persistence=t,this.Ai=new $7,this.Ri=null}static Vi(t){return new ott(t)}get mi(){if(this.Ri)return this.Ri;throw b4(60996)}addReference(t,e,n){return this.Ai.addReference(n,e),this.mi.delete(n.toString()),m5.resolve()}removeReference(t,e,n){return this.Ai.removeReference(n,e),this.mi.add(n.toString()),m5.resolve()}markPotentiallyOrphaned(t,e){return this.mi.add(e.toString()),m5.resolve()}removeTarget(t,e){this.Ai.zr(e.targetId).forEach(t=>this.mi.add(t.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next(t=>{t.forEach(t=>this.mi.add(t.toString()))}).next(()=>n.removeTargetData(t,e))}Ii(){this.Ri=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return m5.forEach(this.mi,n=>{const r=K4.fromPath(n);return this.fi(t,r).next(t=>{t||e.removeEntry(r,i5.min())})}).next(()=>(this.Ri=null,e.apply(t)))}updateLimboDocument(t,e){return this.fi(t,e).next(t=>{t?this.mi.delete(e.toString()):this.mi.add(e.toString())})}Pi(t){return 0}fi(t,e){return m5.or([()=>m5.resolve(this.Ai.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ei(t,e)])}}class stt{constructor(t,e){this.persistence=t,this.gi=new L9(t=>S5(t.path),(t,e)=>t.isEqual(e)),this.garbageCollector=H7(this,e)}static Vi(t,e){return new stt(t,e)}Ii(){}di(t){return m5.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}mr(t){const e=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next(t=>e.next(e=>t+e))}yr(t){let e=0;return this.gr(t,t=>{e++}).next(()=>e)}gr(t,e){return m5.forEach(this.gi,(n,r)=>this.Sr(t,n,r).next(t=>t?m5.resolve():e(r)))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const r=this.persistence.getRemoteDocumentCache(),a=r.newChangeBuffer();return r.ri(t,r=>this.Sr(t,r,e).next(t=>{t||(n++,a.removeEntry(r,i5.min()))})).next(()=>a.apply(t)).next(()=>n)}markPotentiallyOrphaned(t,e){return this.gi.set(e,t.currentSequenceNumber),m5.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.gi.set(n,t.currentSequenceNumber),m5.resolve()}removeReference(t,e,n){return this.gi.set(n,t.currentSequenceNumber),m5.resolve()}updateLimboDocument(t,e){return this.gi.set(e,t.currentSequenceNumber),m5.resolve()}Pi(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=M6(t.data.value)),e}Sr(t,e,n){return m5.or([()=>this.persistence.Ei(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const t=this.gi.get(e);return m5.resolve(void 0!==t&&t>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class ctt{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.Is=n,this.ds=r}static Es(t,e){let n=X9(),r=X9();for(const a of e.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:r=r.add(a.doc.key)}return new ctt(t,e.fromCache,n,r)}}class ltt{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class utt{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=R$()?8:g5(C$())>0?6:4}initialize(t,e){this.gs=t,this.indexManager=e,this.As=!0}getDocumentsMatchingQuery(t,e,n,r){const a={result:null};return this.ps(t,e).next(t=>{a.result=t}).next(()=>{if(!a.result)return this.ys(t,e,r,n).next(t=>{a.result=t})}).next(()=>{if(a.result)return;const n=new ltt;return this.ws(t,e,n).next(r=>{if(a.result=r,this.Rs)return this.Ss(t,e,n,r.size)})}).next(()=>a.result)}Ss(t,e,n,r){return n.documentReadCount<this.Vs?(p4()<=Q$.DEBUG&&m4("QueryEngine","SDK will not create cache indexes for query:",O9(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),m5.resolve()):(p4()<=Q$.DEBUG&&m4("QueryEngine","Query:",O9(e),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.fs*r?(p4()<=Q$.DEBUG&&m4("QueryEngine","The SDK decides to create cache indexes for query:",O9(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,I9(e))):m5.resolve())}ps(t,e){if(_9(e))return m5.resolve(null);let n=I9(e);return this.indexManager.getIndexType(t,n).next(r=>0===r?null:(null!==e.limit&&1===r&&(e=C9(e,null,"F"),n=I9(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next(r=>{const a=X9(...r);return this.gs.getDocuments(t,a).next(r=>this.indexManager.getMinOffset(t,n).next(n=>{const i=this.bs(e,r);return this.Ds(e,i,a,n.readTime)?this.ps(t,C9(e,null,"F")):this.vs(t,i,e,n)}))})))}ys(t,e,n,r){return _9(e)||r.isEqual(i5.min())?m5.resolve(null):this.gs.getDocuments(t,n).next(a=>{const i=this.bs(e,a);return this.Ds(e,i,n,r)?m5.resolve(null):(p4()<=Q$.DEBUG&&m4("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),O9(e)),this.vs(t,i,e,c5(r,o5)).next(t=>t))})}bs(t,e){let n=new n6(F9(t));return e.forEach((e,r)=>{D9(t,r)&&(n=n.add(r))}),n}Ds(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const a="F"===t.limitType?e.last():e.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}ws(t,e,n){return p4()<=Q$.DEBUG&&m4("QueryEngine","Using full collection scan to execute query:",O9(e)),this.gs.getDocumentsMatchingQuery(t,e,u5.min(),n)}vs(t,e,n,r){return this.gs.getDocumentsMatchingQuery(t,n,r).next(t=>(e.forEach(e=>{t=t.insert(e.key,e)}),t))}}const htt="LocalStore";class dtt{constructor(t,e,n,r){this.persistence=t,this.Cs=e,this.serializer=r,this.Fs=new Z5(L4),this.Ms=new L9(t=>y9(t),v9),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(n)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new X7(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Fs))}}function ftt(t,e,n,r){return new dtt(t,e,n,r)}async function ptt(t,e){const n=k4(t);return await n.persistence.runTransaction("Handle user change","readonly",t=>{let r;return n.mutationQueue.getAllMutationBatches(t).next(a=>(r=a,n.Ns(e),n.mutationQueue.getAllMutationBatches(t))).next(e=>{const a=[],i=[];let o=X9();for(const t of r){a.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next(t=>({Bs:t,removedBatchIds:a,addedBatchIds:i}))})})}function mtt(t){const e=k4(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function gtt(t,e,n){let r=X9(),a=X9();return n.forEach(t=>r=r.add(t)),e.getEntries(t,r).next(t=>{let r=B9();return n.forEach((n,i)=>{const o=t.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(a=a.add(n)),i.isNoDocument()&&i.version.isEqual(i5.min())?(e.removeEntry(n,i.readTime),r=r.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(i),r=r.insert(n,i)):m4(htt,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)}),{Ls:r,ks:a}})}function ytt(t,e){const n=k4(t);return n.persistence.runTransaction("Get next mutation batch","readonly",t=>(void 0===e&&(e=b5),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e)))}function vtt(t,e){const n=k4(t);return n.persistence.runTransaction("Allocate target","readwrite",t=>{let r;return n.hi.getTargetData(t,e).next(a=>a?(r=a,m5.resolve(r)):n.hi.allocateTargetId(t).next(a=>(r=new C7(e,a,"TargetPurposeListen",t.currentSequenceNumber),n.hi.addTargetData(t,r).next(()=>r))))}).then(t=>{const r=n.Fs.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(t.targetId,t),n.Ms.set(e,t.targetId)),t})}async function btt(t,e,n){const r=k4(t),a=r.Fs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,t=>r.persistence.referenceDelegate.removeTarget(t,a))}catch(t){if(!y5(t))throw t;m4(htt,"Failed to update sequence numbers for target ".concat(e,": ").concat(t))}r.Fs=r.Fs.remove(e),r.Ms.delete(a.target)}function wtt(t,e,n){const r=k4(t);let a=i5.min(),i=X9();return r.persistence.runTransaction("Execute query","readwrite",t=>function(t,e,n){const r=k4(t),a=r.Ms.get(n);return void 0!==a?m5.resolve(r.Fs.get(a)):r.hi.getTargetData(e,n)}(r,t,I9(e)).next(e=>{if(e)return a=e.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(t,e.targetId).next(t=>{i=t})}).next(()=>r.Cs.getDocumentsMatchingQuery(t,e,n?a:i5.min(),n?i:X9())).next(t=>(xtt(r,M9(e),t),{documents:t,qs:i})))}function xtt(t,e,n){let r=t.xs.get(e)||i5.min();n.forEach((t,e)=>{e.readTime.compareTo(r)>0&&(r=e.readTime)}),t.xs.set(e,r)}class ktt{constructor(){this.activeTargetIds=Q9()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class _tt{constructor(){this.Fo=new ktt,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,e,n){this.Mo[t]=e}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new ktt,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Stt{xo(t){}shutdown(){}}const Ttt="ConnectivityMonitor";class Itt{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){m4(Ttt,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){m4(Ttt,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ett=null;function Ntt(){return null===Ett?Ett=268435456+Math.round(2147483648*Math.random()):Ett++,"0x"+Ett.toString(16)}const Ctt="RestConnection",Att={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Rtt{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=e+"://"+t.host,this.Uo="projects/".concat(n,"/databases/").concat(r),this.Ko=this.databaseId.database===b6?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Wo(t,e,n,r,a){const i=Ntt(),o=this.Go(t,e.toUriEncodedString());m4(Ctt,"Sending RPC '".concat(t,"' ").concat(i,":"),o,n);const s={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(s,r,a);const{host:c}=new URL(o),l=S$(c);return this.jo(t,o,s,n,l).then(e=>(m4(Ctt,"Received RPC '".concat(t,"' ").concat(i,": "),e),e),e=>{throw y4(Ctt,"RPC '".concat(t,"' ").concat(i," failed with error: "),e,"url: ",o,"request:",n),e})}Jo(t,e,n,r,a,i){return this.Wo(t,e,n,r,a)}zo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+d4,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((e,n)=>t[n]=e),n&&n.headers.forEach((e,n)=>t[n]=e)}Go(t,e){const n=Att[t];return"".concat(this.$o,"/v1/").concat(e,":").concat(n)}terminate(){}}class Ott{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}const Dtt="WebChannelConnection";class Mtt extends Rtt{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,e,n,r,a){const i=Ntt();return new Promise((a,o)=>{const s=new Z3;s.setWithCredentials(!0),s.listenOnce(e4.COMPLETE,()=>{try{switch(s.getLastErrorCode()){case n4.NO_ERROR:const e=s.getResponseJson();m4(Dtt,"XHR for RPC '".concat(t,"' ").concat(i," received:"),JSON.stringify(e)),a(e);break;case n4.TIMEOUT:m4(Dtt,"RPC '".concat(t,"' ").concat(i," timed out")),o(new S4(_4.DEADLINE_EXCEEDED,"Request time out"));break;case n4.HTTP_ERROR:const n=s.getStatus();if(m4(Dtt,"RPC '".concat(t,"' ").concat(i," failed with status:"),n,"response text:",s.getResponseText()),n>0){let t=s.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(_4).indexOf(e)>=0?e:_4.UNKNOWN}(e.status);o(new S4(t,e.message))}else o(new S4(_4.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new S4(_4.UNAVAILABLE,"Connection failed."));break;default:b4(9055,{c_:t,streamId:i,l_:s.getLastErrorCode(),h_:s.getLastError()})}}finally{m4(Dtt,"RPC '".concat(t,"' ").concat(i," completed."))}});const c=JSON.stringify(r);m4(Dtt,"RPC '".concat(t,"' ").concat(i," sending request:"),r),s.send(e,"POST",c,n,15)})}P_(t,e,n){const r=Ntt(),a=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=o4(),o=i4(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(s.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(s.useFetchStreams=!0),this.zo(s.initMessageHeaders,e,n),s.encodeInitMessageHeaders=!0;const l=a.join("");m4(Dtt,"Creating RPC '".concat(t,"' stream ").concat(r,": ").concat(l),s);const u=i.createWebChannel(l,s);this.T_(u);let h=!1,d=!1;const f=new Ott({Ho:e=>{d?m4(Dtt,"Not sending because RPC '".concat(t,"' stream ").concat(r," is closed:"),e):(h||(m4(Dtt,"Opening RPC '".concat(t,"' stream ").concat(r," transport.")),u.open(),h=!0),m4(Dtt,"RPC '".concat(t,"' stream ").concat(r," sending:"),e),u.send(e))},Yo:()=>u.close()}),p=(t,e,n)=>{t.listen(e,t=>{try{n(t)}catch(t){setTimeout(()=>{throw t},0)}})};return p(u,t4.EventType.OPEN,()=>{d||(m4(Dtt,"RPC '".concat(t,"' stream ").concat(r," transport opened.")),f.s_())}),p(u,t4.EventType.CLOSE,()=>{d||(d=!0,m4(Dtt,"RPC '".concat(t,"' stream ").concat(r," transport closed")),f.__(),this.I_(u))}),p(u,t4.EventType.ERROR,e=>{d||(d=!0,y4(Dtt,"RPC '".concat(t,"' stream ").concat(r," transport errored. Name:"),e.name,"Message:",e.message),f.__(new S4(_4.UNAVAILABLE,"The operation could not be completed")))}),p(u,t4.EventType.MESSAGE,e=>{var n;if(!d){const a=e.data[0];x4(!!a,16349);const i=a,o=(null==i?void 0:i.error)||(null===(n=i[0])||void 0===n?void 0:n.error);if(o){m4(Dtt,"RPC '".concat(t,"' stream ").concat(r," received error:"),o);const e=o.status;let n=function(t){const e=O8[t];if(void 0!==e)return F8(e)}(e),a=o.message;void 0===n&&(n=_4.INTERNAL,a="Unknown error status: "+e+" with message "+o.message),d=!0,f.__(new S4(n,a)),u.close()}else m4(Dtt,"RPC '".concat(t,"' stream ").concat(r," received:"),a),f.a_(a)}}),p(o,a4.STAT_EVENT,e=>{e.stat===r4.PROXY?m4(Dtt,"RPC '".concat(t,"' stream ").concat(r," detected buffering proxy")):e.stat===r4.NOPROXY&&m4(Dtt,"RPC '".concat(t,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{f.o_()},0),f}terminate(){this.u_.forEach(t=>t.close()),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter(e=>e===t)}}function Ftt(){return"undefined"!=typeof document?document:null}function Ptt(t){return new t7(t,!0)}class Ltt{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Fi=t,this.timerId=e,this.d_=n,this.E_=r,this.A_=a,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const e=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),r=Math.max(0,e-n);r>0&&m4("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.R_," ms, delay with jitter: ").concat(e," ms, last attempt: ").concat(n," ms ago)")),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,()=>(this.m_=Date.now(),t())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){null!==this.V_&&(this.V_.skipDelay(),this.V_=null)}cancel(){null!==this.V_&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}const ztt="PersistentStream";class Btt{constructor(t,e,n,r,a,i,o,s){this.Fi=t,this.w_=n,this.S_=r,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=s,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Ltt(t,e)}M_(){return 1===this.state||5===this.state||this.x_()}x_(){return 2===this.state||3===this.state}start(){this.C_=0,4!==this.state?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&null===this.D_&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,4!==t?this.F_.reset():e&&e.code===_4.RESOURCE_EXHAUSTED?(g4(e.toString()),g4("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):e&&e.code===_4.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(e)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),e=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(t=>{let[n,r]=t;this.b_===e&&this.W_(n,r)},e=>{t(()=>{const t=new S4(_4.UNKNOWN,"Fetching auth token failed: "+e.message);return this.G_(t)})})}W_(t,e){const n=this.K_(this.b_);this.stream=this.z_(t,e),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(t=>{n(()=>this.G_(t))}),this.stream.onMessage(t=>{n(()=>1==++this.C_?this.j_(t):this.onNext(t))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(t){return m4(ztt,"close with error: ".concat(t)),this.stream=null,this.close(4,t)}K_(t){return e=>{this.Fi.enqueueAndForget(()=>this.b_===t?e():(m4(ztt,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class jtt extends Btt{constructor(t,e,n,r,a,i){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,r,i),this.serializer=a}z_(t,e){return this.connection.P_("Listen",t,e)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:b4(39313,{state:t})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],i=function(t,e){return t.useProto3Json?(x4(void 0===e||"string"==typeof e,58123),o6.fromBase64String(e||"")):(x4(void 0===e||e instanceof Buffer||e instanceof Uint8Array,16193),o6.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,s=o&&function(t){const e=void 0===t.code?_4.UNKNOWN:F8(t.code);return new S4(e,t.message||"")}(o);n=new q8(r,a,i,s||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=u7(t,r.document.name),i=i7(r.document.updateTime),o=r.document.createTime?i7(r.document.createTime):i5.min(),s=new G6({mapValue:{fields:r.document.fields}}),c=q6.newFoundDocument(a,i,o,s),l=r.targetIds||[],u=r.removedTargetIds||[];n=new G8(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=u7(t,r.document),i=r.readTime?i7(r.readTime):i5.min(),o=q6.newNoDocument(a,i),s=r.removedTargetIds||[];n=new G8([],s,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=u7(t,r.document),i=r.removedTargetIds||[];n=new G8([],i,a,null)}else{if(!("filter"in e))return b4(11601,{At:e});{e.filter;const t=e.filter;t.targetId;const{count:r=0,unchangedNames:a}=t,i=new R8(r,a),o=t.targetId;n=new H8(o,i)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return i5.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?i5.min():e.readTime?i7(e.readTime):i5.min()}(t);return this.listener.J_(e,n)}H_(t){const e={};e.database=f7(this.serializer),e.addTarget=function(t,e){let n;const r=e.target;if(n=b9(r)?{documents:y7(t,r)}:{query:v7(t,r).Vt},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=r7(t,e.resumeToken);const r=e7(t,e.expectedCount);null!==r&&(n.expectedCount=r)}else if(e.snapshotVersion.compareTo(i5.min())>0){n.readTime=n7(t,e.snapshotVersion.toTimestamp());const r=e7(t,e.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return b4(28987,{purpose:t})}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.k_(e)}Y_(t){const e={};e.database=f7(this.serializer),e.removeTarget=t,this.k_(e)}}class Utt extends Btt{constructor(t,e,n,r,a,i){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,r,i),this.serializer=a}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(t,e){return this.connection.P_("Write",t,e)}j_(t){return x4(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,x4(!t.writeResults||0===t.writeResults.length,55816),this.listener.ea()}onNext(t){x4(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.F_.reset();const e=function(t,e){return t&&t.length>0?(x4(void 0!==e,14353),t.map(t=>function(t,e){let n=t.updateTime?i7(t.updateTime):i7(e);return n.isEqual(i5.min())&&(n=i7(e)),new d8(n,t.transformResults||[])}(t,e))):[]}(t.writeResults,t.commitTime),n=i7(t.commitTime);return this.listener.ta(n,e)}na(){const t={};t.database=f7(this.serializer),this.k_(t)}X_(t){const e={streamToken:this.lastStreamToken,writes:t.map(t=>g7(this.serializer,t))};this.k_(e)}}class Vtt{}class Wtt extends Vtt{constructor(t,e,n,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new S4(_4.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,e,n,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(a=>{let[i,o]=a;return this.connection.Wo(t,s7(e,n),r,i,o)}).catch(t=>{throw"FirebaseError"===t.name?(t.code===_4.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new S4(_4.UNKNOWN,t.toString())})}Jo(t,e,n,r,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[o,s]=i;return this.connection.Jo(t,s7(e,n),r,o,s,a)}).catch(t=>{throw"FirebaseError"===t.name?(t.code===_4.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new S4(_4.UNKNOWN,t.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class Gtt{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){0===this.sa&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(t){"Online"===this.state?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca("Connection failed 1 times. Most recent error: ".concat(t.toString())),this.ua("Offline")))}set(t){this.ha(),this.sa=0,"Online"===t&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const e="Could not reach Cloud Firestore backend. ".concat(t,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this._a?(g4(e),this._a=!1):m4("OnlineStateTracker",e)}ha(){null!==this.oa&&(this.oa.cancel(),this.oa=null)}}const Htt="RemoteStore";class qtt{constructor(t,e,n,r,a){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=a,this.Ea.xo(t=>{n.enqueueAndForget(async()=>{eet(this)&&(m4(Htt,"Restarting streams for network reachability change."),await async function(t){const e=k4(t);e.Ia.add(4),await Xtt(e),e.Aa.set("Unknown"),e.Ia.delete(4),await Ktt(e)}(this))})}),this.Aa=new Gtt(n,r)}}async function Ktt(t){if(eet(t))for(const e of t.da)await e(!0)}async function Xtt(t){for(const e of t.da)await e(!1)}function Ytt(t,e){const n=k4(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),tet(n)?Ztt(n):xet(n).x_()&&Jtt(n,e))}function Qtt(t,e){const n=k4(t),r=xet(n);n.Ta.delete(e),r.x_()&&$tt(n,e),0===n.Ta.size&&(r.x_()?r.B_():eet(n)&&n.Aa.set("Unknown"))}function Jtt(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(i5.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}xet(t).H_(e)}function $tt(t,e){t.Ra.$e(e),xet(t).Y_(e)}function Ztt(t){t.Ra=new X8({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),xet(t).start(),t.Aa.aa()}function tet(t){return eet(t)&&!xet(t).M_()&&t.Ta.size>0}function eet(t){return 0===k4(t).Ia.size}function net(t){t.Ra=void 0}async function ret(t){t.Aa.set("Online")}async function aet(t){t.Ta.forEach((e,n)=>{Jtt(t,e)})}async function iet(t,e){net(t),tet(t)?(t.Aa.la(e),Ztt(t)):t.Aa.set("Unknown")}async function oet(t,e,n){if(t.Aa.set("Online"),e instanceof q8&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const r of e.targetIds)t.Ta.has(r)&&(await t.remoteSyncer.rejectListen(r,n),t.Ta.delete(r),t.Ra.removeTarget(r))}(t,e)}catch(n){m4(Htt,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await set(t,n)}else if(e instanceof G8?t.Ra.Ye(e):e instanceof H8?t.Ra.it(e):t.Ra.et(e),!n.isEqual(i5.min()))try{const e=await mtt(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.Ra.Pt(e);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const a=t.Ta.get(r);a&&t.Ta.set(r,a.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach((e,n)=>{const r=t.Ta.get(e);if(!r)return;t.Ta.set(e,r.withResumeToken(o6.EMPTY_BYTE_STRING,r.snapshotVersion)),$tt(t,e);const a=new C7(r.target,e,n,r.sequenceNumber);Jtt(t,a)}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){m4(Htt,"Failed to raise snapshot:",e),await set(t,e)}}async function set(t,e,n){if(!y5(e))throw e;t.Ia.add(1),await Xtt(t),t.Aa.set("Offline"),n||(n=()=>mtt(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{m4(Htt,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await Ktt(t)})}function cet(t,e){return e().catch(n=>set(t,n,e))}async function uet(t){const e=k4(t),n=ket(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:b5;for(;het(e);)try{const t=await ytt(e.localStore,r);if(null===t){0===e.Pa.length&&n.B_();break}r=t.batchId,det(e,t)}catch(t){await set(e,t)}fet(e)&&pet(e)}function het(t){return eet(t)&&t.Pa.length<10}function det(t,e){t.Pa.push(e);const n=ket(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function fet(t){return eet(t)&&!ket(t).M_()&&t.Pa.length>0}function pet(t){ket(t).start()}async function met(t){ket(t).na()}async function get(t){const e=ket(t);for(const n of t.Pa)e.X_(n.mutations)}async function yet(t,e,n){const r=t.Pa.shift(),a=C8.from(r,e,n);await cet(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await uet(t)}async function vet(t,e){e&&ket(t).Z_&&await async function(t,e){if(function(t){return M8(t)&&t!==_4.ABORTED}(e.code)){const n=t.Pa.shift();ket(t).N_(),await cet(t,()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e)),await uet(t)}}(t,e),fet(t)&&pet(t)}async function bet(t,e){const n=k4(t);n.asyncQueue.verifyOperationInProgress(),m4(Htt,"RemoteStore received new credentials");const r=eet(n);n.Ia.add(3),await Xtt(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await Ktt(n)}async function wet(t,e){const n=k4(t);e?(n.Ia.delete(2),await Ktt(n)):e||(n.Ia.add(2),await Xtt(n),n.Aa.set("Unknown"))}function xet(t){return t.Va||(t.Va=function(t,e,n){const r=k4(t);return r.ia(),new jtt(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Zo:ret.bind(null,t),e_:aet.bind(null,t),n_:iet.bind(null,t),J_:oet.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),tet(t)?Ztt(t):t.Aa.set("Unknown")):(await t.Va.stop(),net(t))})),t.Va}function ket(t){return t.ma||(t.ma=function(t,e,n){const r=k4(t);return r.ia(),new Utt(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:met.bind(null,t),n_:vet.bind(null,t),ea:get.bind(null,t),ta:yet.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await uet(t)):(await t.ma.stop(),t.Pa.length>0&&(m4(Htt,"Stopping write stream with ".concat(t.Pa.length," pending writes")),t.Pa=[]))})),t.ma}class _et{constructor(t,e,n,r,a){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=a,this.deferred=new T4,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(t=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,r,a){const i=Date.now()+n,o=new _et(t,e,i,r,a);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new S4(_4.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Tet(t,e){if(g4("AsyncQueue","".concat(e,": ").concat(t)),y5(t))return new S4(_4.UNAVAILABLE,"".concat(e,": ").concat(t));throw t}class Iet{static emptySet(t){return new Iet(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||K4.comparator(e.key,n.key):(t,e)=>K4.comparator(t.key,e.key),this.keyedMap=U9(),this.sortedSet=new Z5(this.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,n)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Iet))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(!t.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new Iet;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class Eet{constructor(){this.fa=new Z5(K4.comparator)}track(t){const e=t.doc.key,n=this.fa.get(e);n?0!==t.type&&3===n.type?this.fa=this.fa.insert(e,t):3===t.type&&1!==n.type?this.fa=this.fa.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.fa=this.fa.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.fa=this.fa.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.fa=this.fa.remove(e):1===t.type&&2===n.type?this.fa=this.fa.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.fa=this.fa.insert(e,{type:2,doc:t.doc}):b4(63341,{At:t,ga:n}):this.fa=this.fa.insert(e,t)}pa(){const t=[];return this.fa.inorderTraversal((e,n)=>{t.push(n)}),t}}class Net{constructor(t,e,n,r,a,i,o,s,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=s,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,r,a){const i=[];return e.forEach(t=>{i.push({type:0,doc:t})}),new Net(t,e,Iet.emptySet(e),i,n,r,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&A9(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0}}class Cet{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(t=>t.ba())}}class Aet{constructor(){this.queries=Ret(),this.onlineState="Unknown",this.Da=new Set}terminate(){!function(t,e){const n=k4(t),r=n.queries;n.queries=Ret(),r.forEach((t,n)=>{for(const r of n.wa)r.onError(e)})}(this,new S4(_4.ABORTED,"Firestore shutting down"))}}function Ret(){return new L9(t=>R9(t),A9)}async function Oet(t,e){const n=k4(t);let r=3;const a=e.query;let i=n.queries.get(a);i?!i.Sa()&&e.ba()&&(r=2):(i=new Cet,r=e.ba()?0:1);try{switch(r){case 0:i.ya=await n.onListen(a,!0);break;case 1:i.ya=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(t){const n=Tet(t,"Initialization of query '".concat(O9(e.query),"' failed"));return void e.onError(n)}n.queries.set(a,i),i.wa.push(e),e.va(n.onlineState),i.ya&&e.Ca(i.ya)&&Pet(n)}async function Det(t,e){const n=k4(t),r=e.query;let a=3;const i=n.queries.get(r);if(i){const t=i.wa.indexOf(e);t>=0&&(i.wa.splice(t,1),0===i.wa.length?a=e.ba()?0:1:!i.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Met(t,e){const n=k4(t);let r=!1;for(const a of e){const t=a.query,e=n.queries.get(t);if(e){for(const t of e.wa)t.Ca(a)&&(r=!0);e.ya=a}}r&&Pet(n)}function Fet(t,e,n){const r=k4(t),a=r.queries.get(e);if(a)for(const i of a.wa)i.onError(n);r.queries.delete(e)}function Pet(t){t.Da.forEach(t=>{t.next()})}var Let,zet;(zet=Let||(Let={})).Fa="default",zet.Cache="cache";class Bet{constructor(t,e,n){this.query=t,this.Ma=e,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new Net(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),e=!0):this.Ba(t,this.onlineState)&&(this.La(t),e=!0),this.Oa=t,e}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let e=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),e=!0),e}Ba(t,e){if(!t.fromCache)return!0;if(!this.ba())return!0;const n="Offline"!==e;return(!this.options.ka||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Na(t){if(t.docChanges.length>0)return!0;const e=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}La(t){t=Net.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==Let.Cache}}class jet{constructor(t){this.key=t}}class Uet{constructor(t){this.key=t}}class Vet{constructor(t,e){this.query=t,this.Ha=e,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=X9(),this.mutatedKeys=X9(),this.Xa=F9(t),this.eu=new Iet(this.Xa)}get tu(){return this.Ha}nu(t,e){const n=e?e.ru:new Eet,r=e?e.eu:this.eu;let a=e?e.mutatedKeys:this.mutatedKeys,i=r,o=!1;const s="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((t,e)=>{const l=r.get(t),u=D9(this.query,e)?e:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.iu(l,u)||(n.track({type:2,doc:u}),f=!0,(s&&this.Xa(u,s)>0||c&&this.Xa(u,c)<0)&&(o=!0)):!l&&u?(n.track({type:0,doc:u}),f=!0):l&&!u&&(n.track({type:1,doc:l}),f=!0,(s||c)&&(o=!0)),f&&(u?(i=i.add(u),a=d?a.add(t):a.delete(t)):(i=i.delete(t),a=a.delete(t)))}),null!==this.query.limit)for(;i.size>this.query.limit;){const t="F"===this.query.limitType?i.last():i.first();i=i.delete(t.key),a=a.delete(t.key),n.track({type:1,doc:t})}return{eu:i,ru:n,Ds:o,mutatedKeys:a}}iu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,r){const a=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const i=t.ru.pa();i.sort((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return b4(20277,{At:t})}};return n(t)-n(e)}(t.type,e.type)||this.Xa(t.doc,e.doc)),this.su(n),r=null!=r&&r;const o=e&&!r?this.ou():[],s=0===this.Za.size&&this.current&&!r?1:0,c=s!==this.Ya;return this.Ya=s,0!==i.length||c?{snapshot:new Net(this.query,t.eu,a,i,t.mutatedKeys,0===s,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:o}:{_u:o}}va(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Eet,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),t.modifiedDocuments.forEach(t=>{}),t.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=X9(),this.eu.forEach(t=>{this.au(t.key)&&(this.Za=this.Za.add(t.key))});const e=[];return t.forEach(t=>{this.Za.has(t)||e.push(new Uet(t))}),this.Za.forEach(n=>{t.has(n)||e.push(new jet(n))}),e}uu(t){this.Ha=t.qs,this.Za=X9();const e=this.nu(t.documents);return this.applyChanges(e,!0)}cu(){return Net.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,0===this.Ya,this.hasCachedResults)}}const Wet="SyncEngine";class Get{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Het{constructor(t){this.key=t,this.lu=!1}}class qet{constructor(t,e,n,r,a,i){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.hu={},this.Pu=new L9(t=>R9(t),A9),this.Tu=new Map,this.Iu=new Set,this.du=new Z5(K4.comparator),this.Eu=new Map,this.Au=new $7,this.Ru={},this.Vu=new Map,this.mu=z7.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return!0===this.fu}}async function Ket(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=pnt(t);let a;const i=r.Pu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.cu()):a=await Yet(r,e,n,!0),a}async function Xet(t,e){const n=pnt(t);await Yet(n,e,!0,!1)}async function Yet(t,e,n,r){const a=await vtt(t.localStore,I9(e)),i=a.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let s;return r&&(s=await Qet(t,e,i,"current"===o,a.resumeToken)),t.isPrimaryClient&&n&&Ytt(t.remoteStore,a),s}async function Qet(t,e,n,r,a){t.gu=(e,n,r)=>async function(t,e,n,r){let a=e.view.nu(n);a.Ds&&(a=await wtt(t.localStore,e.query,!1).then(t=>{let{documents:n}=t;return e.view.nu(n,a)}));const i=r&&r.targetChanges.get(e.targetId),o=r&&null!=r.targetMismatches.get(e.targetId),s=e.view.applyChanges(a,t.isPrimaryClient,i,o);return cnt(t,e.targetId,s._u),s.snapshot}(t,e,n,r);const i=await wtt(t.localStore,e,!0),o=new Vet(e,i.qs),s=o.nu(i.documents),c=W8.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,a),l=o.applyChanges(s,t.isPrimaryClient,c);cnt(t,n,l._u);const u=new Get(e,n,o);return t.Pu.set(e,u),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),l.snapshot}async function Jet(t,e,n){const r=k4(t),a=r.Pu.get(e),i=r.Tu.get(a.targetId);if(i.length>1)return r.Tu.set(a.targetId,i.filter(t=>!A9(t,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await btt(r.localStore,a.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(a.targetId),n&&Qtt(r.remoteStore,a.targetId),ont(r,a.targetId)}).catch(p5)):(ont(r,a.targetId),await btt(r.localStore,a.targetId,!0))}async function $et(t,e){const n=k4(t),r=n.Pu.get(e),a=n.Tu.get(r.targetId);n.isPrimaryClient&&1===a.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Qtt(n.remoteStore,r.targetId))}async function Zet(t,e){const n=k4(t);try{const t=await function(t,e){const n=k4(t),r=e.snapshotVersion;let a=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",t=>{const i=n.Os.newChangeBuffer({trackRemovals:!0});a=n.Fs;const o=[];e.targetChanges.forEach((i,s)=>{const c=a.get(s);if(!c)return;o.push(n.hi.removeMatchingKeys(t,i.removedDocuments,s).next(()=>n.hi.addMatchingKeys(t,i.addedDocuments,s)));let l=c.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(s)?l=l.withResumeToken(o6.EMPTY_BYTE_STRING,i5.min()).withLastLimboFreeSnapshotVersion(i5.min()):i.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(i.resumeToken,r)),a=a.insert(s,l),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(c,l,i)&&o.push(n.hi.updateTargetData(t,l))});let s=B9(),c=X9();if(e.documentUpdates.forEach(r=>{e.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),o.push(gtt(t,i,e.documentUpdates).next(t=>{s=t.Ls,c=t.ks})),!r.isEqual(i5.min())){const e=n.hi.getLastRemoteSnapshotVersion(t).next(e=>n.hi.setTargetsMetadata(t,t.currentSequenceNumber,r));o.push(e)}return m5.waitFor(o).next(()=>i.apply(t)).next(()=>n.localDocuments.getLocalViewOfDocuments(t,s,c)).next(()=>s)}).then(t=>(n.Fs=a,t))}(n.localStore,e);e.targetChanges.forEach((t,e)=>{const r=n.Eu.get(e);r&&(x4(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?r.lu=!0:t.modifiedDocuments.size>0?x4(r.lu,14607):t.removedDocuments.size>0&&(x4(r.lu,42227),r.lu=!1))}),await hnt(n,t,e)}catch(t){await p5(t)}}function tnt(t,e,n){const r=k4(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const t=[];r.Pu.forEach((n,r)=>{const a=r.view.va(e);a.snapshot&&t.push(a.snapshot)}),function(t,e){const n=k4(t);n.onlineState=e;let r=!1;n.queries.forEach((t,n)=>{for(const a of n.wa)a.va(e)&&(r=!0)}),r&&Pet(n)}(r.eventManager,e),t.length&&r.hu.J_(t),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ent(t,e,n){const r=k4(t);r.sharedClientState.updateQueryState(e,"rejected",n);const a=r.Eu.get(e),i=a&&a.key;if(i){let t=new Z5(K4.comparator);t=t.insert(i,q6.newNoDocument(i,i5.min()));const n=X9().add(i),a=new V8(i5.min(),new Map,new Z5(L4),t,n);await Zet(r,a),r.du=r.du.remove(i),r.Eu.delete(e),unt(r)}else await btt(r.localStore,e,!1).then(()=>ont(r,e,n)).catch(p5)}async function nnt(t,e){const n=k4(t),r=e.batch.batchId;try{const t=await function(t,e){const n=k4(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",t=>{const r=e.batch.keys(),a=n.Os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){const a=n.batch,i=a.keys();let o=m5.resolve();return i.forEach(t=>{o=o.next(()=>r.getEntry(e,t)).next(e=>{const i=n.docVersions.get(t);x4(null!==i,48541),e.version.compareTo(i)<0&&(a.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),r.addEntry(e)))})}),o.next(()=>t.mutationQueue.removeMutationBatch(e,a))}(n,t,e,a).next(()=>a.apply(t)).next(()=>n.mutationQueue.performConsistencyCheck(t)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=X9();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e))).next(()=>n.localDocuments.getDocuments(t,r))})}(n.localStore,e);int(n,r,null),ant(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await hnt(n,t)}catch(t){await p5(t)}}async function rnt(t,e,n){const r=k4(t);try{const t=await function(t,e){const n=k4(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",t=>{let r;return n.mutationQueue.lookupMutationBatch(t,e).next(e=>(x4(null!==e,37113),r=e.keys(),n.mutationQueue.removeMutationBatch(t,e))).next(()=>n.mutationQueue.performConsistencyCheck(t)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,r)).next(()=>n.localDocuments.getDocuments(t,r))})}(r.localStore,e);int(r,e,n),ant(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await hnt(r,t)}catch(n){await p5(n)}}function ant(t,e){(t.Vu.get(e)||[]).forEach(t=>{t.resolve()}),t.Vu.delete(e)}function int(t,e,n){const r=k4(t);let a=r.Ru[r.currentUser.toKey()];if(a){const t=a.get(e);t&&(n?t.reject(n):t.resolve(),a=a.remove(e)),r.Ru[r.currentUser.toKey()]=a}}function ont(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(e=>{t.Au.containsKey(e)||snt(t,e)})}function snt(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);null!==n&&(Qtt(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),unt(t))}function cnt(t,e,n){for(const r of n)r instanceof jet?(t.Au.addReference(r.key,e),lnt(t,r)):r instanceof Uet?(m4(Wet,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||snt(t,r.key)):b4(19791,{yu:r})}function lnt(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(m4(Wet,"New document in limbo: "+n),t.Iu.add(r),unt(t))}function unt(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new K4(G4.fromString(e)),r=t.mu.next();t.Eu.set(r,new Het(n)),t.du=t.du.insert(n,r),Ytt(t.remoteStore,new C7(I9(k9(n.path)),r,"TargetPurposeLimboResolution",v5.ue))}}async function hnt(t,e,n){const r=k4(t),a=[],i=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((t,s)=>{o.push(r.gu(s,e,n).then(t=>{var e;if((t||n)&&r.isPrimaryClient){const a=t?!t.fromCache:null===(e=null==n?void 0:n.targetChanges.get(s.targetId))||void 0===e?void 0:e.current;r.sharedClientState.updateQueryState(s.targetId,a?"current":"not-current")}if(t){a.push(t);const e=ctt.Es(s.targetId,t);i.push(e)}}))}),await Promise.all(o),r.hu.J_(a),await async function(t,e){const n=k4(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",t=>m5.forEach(e,e=>m5.forEach(e.Is,r=>n.persistence.referenceDelegate.addReference(t,e.targetId,r)).next(()=>m5.forEach(e.ds,r=>n.persistence.referenceDelegate.removeReference(t,e.targetId,r)))))}catch(t){if(!y5(t))throw t;m4(htt,"Failed to update sequence numbers: "+t)}for(const r of e){const t=r.targetId;if(!r.fromCache){const e=n.Fs.get(t),r=e.snapshotVersion,a=e.withLastLimboFreeSnapshotVersion(r);n.Fs=n.Fs.insert(t,a)}}}(r.localStore,i))}async function dnt(t,e){const n=k4(t);if(!n.currentUser.isEqual(e)){m4(Wet,"User change. New user:",e.toKey());const t=await ptt(n.localStore,e);n.currentUser=e,function(t,e){t.Vu.forEach(t=>{t.forEach(t=>{t.reject(new S4(_4.CANCELLED,e))})}),t.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await hnt(n,t.Bs)}}function fnt(t,e){const n=k4(t),r=n.Eu.get(e);if(r&&r.lu)return X9().add(r.key);{let t=X9();const r=n.Tu.get(e);if(!r)return t;for(const e of r){const r=n.Pu.get(e);t=t.unionWith(r.view.tu)}return t}}function pnt(t){const e=k4(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Zet.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=fnt.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ent.bind(null,e),e.hu.J_=Met.bind(null,e.eventManager),e.hu.pu=Fet.bind(null,e.eventManager),e}function mnt(t){const e=k4(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nnt.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rnt.bind(null,e),e}class gnt{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Ptt(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,e){return null}Fu(t,e){return null}vu(t){return ftt(this.persistence,new utt,t.initialUser,this.serializer)}Du(t){return new att(ott.Vi,this.serializer)}bu(t){return new _tt}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}gnt.provider={build:()=>new gnt};class ynt extends gnt{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,e){x4(this.persistence.referenceDelegate instanceof stt,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new W7(n,t.asyncQueue,e)}Du(t){const e=void 0!==this.cacheSizeBytes?L7.withCacheSize(this.cacheSizeBytes):L7.DEFAULT;return new att(t=>stt.Vi(t,e),this.serializer)}}class vnt{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>tnt(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=dnt.bind(null,this.syncEngine),await wet(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new Aet}createDatastore(t){const e=Ptt(t.databaseInfo.databaseId),n=function(t){return new Mtt(t)}(t.databaseInfo);return function(t,e,n,r){return new Wtt(t,e,n,r)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,r,a){return new qtt(t,e,n,r,a)}(this.localStore,this.datastore,t.asyncQueue,t=>tnt(this.syncEngine,t,0),Itt.C()?new Itt:new Stt)}createSyncEngine(t,e){return function(t,e,n,r,a,i,o){const s=new qet(t,e,n,r,a,i);return o&&(s.fu=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(t){const e=k4(t);m4(Htt,"RemoteStore shutting down."),e.Ia.add(5),await Xtt(e),e.Ea.shutdown(),e.Aa.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate(),null===(e=this.eventManager)||void 0===e||e.terminate()}}vnt.provider={build:()=>new vnt};class bnt{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):g4("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,e){setTimeout(()=>{this.muted||t(e)},0)}}const wnt="FirestoreClient";class xnt{constructor(t,e,n,r,a){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=h4.UNAUTHENTICATED,this.clientId=P4.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async t=>{m4(wnt,"Received user=",t.uid),await this.authCredentialListener(t),this.user=t}),this.appCheckCredentials.start(n,t=>(m4(wnt,"Received new app check token=",t),this.appCheckCredentialListener(t,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new T4;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Tet(e,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function knt(t,e){t.asyncQueue.verifyOperationInProgress(),m4(wnt,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async t=>{r.isEqual(t)||(await ptt(e.localStore,t),r=t)}),e.persistence.setDatabaseDeletedListener(()=>{y4("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{m4("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(t=>{y4("Terminating Firestore due to IndexedDb database deletion failed",t)})}),t._offlineComponents=e}async function _nt(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Snt(t);m4(wnt,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(t=>bet(e.remoteStore,t)),t.setAppCheckTokenChangeListener((t,n)=>bet(e.remoteStore,n)),t._onlineComponents=e}async function Snt(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){m4(wnt,"Using user provided OfflineComponentProvider");try{await knt(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===_4.FAILED_PRECONDITION||t.code===_4.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;y4("Error using user provided cache. Falling back to memory cache: "+n),await knt(t,new gnt)}}else m4(wnt,"Using default OfflineComponentProvider"),await knt(t,new ynt(void 0));return t._offlineComponents}async function Tnt(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(m4(wnt,"Using user provided OnlineComponentProvider"),await _nt(t,t._uninitializedComponentsProvider._online)):(m4(wnt,"Using default OnlineComponentProvider"),await _nt(t,new vnt))),t._onlineComponents}function Int(t){return Tnt(t).then(t=>t.syncEngine)}async function Ent(t){const e=await Tnt(t),n=e.eventManager;return n.onListen=Ket.bind(null,e.syncEngine),n.onUnlisten=Jet.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Xet.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=$et.bind(null,e.syncEngine),n}function Nnt(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new T4;return t.asyncQueue.enqueueAndForget(async()=>function(t,e,n,r,a){const i=new bnt({next:n=>{i.Ou(),e.enqueueAndForget(()=>Det(t,o)),n.fromCache&&"server"===r.source?a.reject(new S4(_4.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(n)},error:t=>a.reject(t)}),o=new Bet(n,i,{includeMetadataChanges:!0,ka:!0});return Oet(t,o)}(await Ent(t),t.asyncQueue,e,n,r)),r.promise}function Cnt(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Ant=new Map,Rnt="firestore.googleapis.com",Ont=!0;class Dnt{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new S4(_4.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Rnt,this.ssl=Ont}else this.host=t.host,this.ssl=null!==(e=t.ssl)&&void 0!==e?e:Ont;if(this.isUsingEmulator=void 0!==t.emulatorOptions,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=P7;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<j7)throw new S4(_4.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new S4(_4.INVALID_ARGUMENT,"".concat(t," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Cnt(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new S4(_4.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (must not be NaN)"));if(t.timeoutSeconds<5)throw new S4(_4.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (minimum allowed value is 5)"));if(t.timeoutSeconds>30)throw new S4(_4.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Mnt{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dnt({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new S4(_4.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new S4(_4.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dnt(t),this._emulatorOptions=t.emulatorOptions||{},void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new E4;switch(t.type){case"firstParty":return new R4(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new S4(_4.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Ant.get(t);e&&(m4("ComponentProvider","Removing Datastore"),Ant.delete(t),e.terminate())}(this),Promise.resolve()}}function Fnt(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var a;t=Z4(t,Mnt);const i=S$(e),o=t._getSettings(),s=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c="".concat(e,":").concat(n);i&&(T$("https://".concat(c)),N$("Firestore",!0)),o.host!==Rnt&&o.host!==c&&y4("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},o),{host:c,ssl:i,emulatorOptions:r});if(!P$(l,s)&&(t._setSettings(l),r.mockUserToken)){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=h4.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[g$(JSON.stringify({alg:"none",type:"JWT"})),g$(JSON.stringify(i)),""].join(".")}(r.mockUserToken,null===(a=t._app)||void 0===a?void 0:a.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new S4(_4.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new h4(i)}t._authCredentials=new N4(new I4(e,n))}}class Pnt{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Pnt(this.firestore,t,this._query)}}class Lnt{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new znt(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new Lnt(this.firestore,t,this._key)}toJSON(){return{type:Lnt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(e5(e,Lnt._jsonSchema))return new Lnt(t,n||null,new K4(G4.fromString(e.referencePath)))}}Lnt._jsonSchemaVersion="firestore/documentReference/1.0",Lnt._jsonSchema={type:t5("string",Lnt._jsonSchemaVersion),referencePath:t5("string")};class znt extends Pnt{constructor(t,e,n){super(t,e,k9(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new Lnt(this.firestore,null,new K4(t))}withConverter(t){return new znt(this.firestore,t,this._path)}}function Bnt(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(t=W$(t),1===arguments.length&&(e=P4.newId()),X4("doc","path",e),t instanceof Mnt){const n=G4.fromString(e,...r);return Y4(n),new Lnt(t,null,new K4(n))}{if(!(t instanceof Lnt||t instanceof znt))throw new S4(_4.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(G4.fromString(e,...r));return Y4(n),new Lnt(t.firestore,t instanceof znt?t.converter:null,new K4(n))}}const jnt="AsyncQueue";class Unt{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Ltt(this,"async_queue_retry"),this.oc=()=>{const t=Ftt();t&&m4(jnt,"Visibility state changed to "+t.visibilityState),this.F_.y_()},this._c=t;const e=Ftt();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const e=Ftt();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise(()=>{});const e=new T4;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Zu.push(t),this.cc()))}async cc(){if(0!==this.Zu.length){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(Grt){if(!y5(Grt))throw Grt;m4(jnt,"Operation failed with retryable error: "+Grt)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(t){const e=this._c.then(()=>(this.nc=!0,t().catch(t=>{throw this.tc=t,this.nc=!1,g4("INTERNAL UNHANDLED ERROR: ",Vnt(t)),t}).then(t=>(this.nc=!1,t))));return this._c=e,e}enqueueAfterDelay(t,e,n){this.ac(),this.sc.indexOf(t)>-1&&(e=0);const r=_et.createAndSchedule(this,t,e,n,t=>this.lc(t));return this.ec.push(r),r}ac(){this.tc&&b4(47125,{hc:Vnt(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do{t=this._c,await t}while(t!==this._c)}Tc(t){for(const e of this.ec)if(e.timerId===t)return!0;return!1}Ic(t){return this.Pc().then(()=>{this.ec.sort((t,e)=>t.targetTimeMs-e.targetTimeMs);for(const e of this.ec)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Pc()})}dc(t){this.sc.push(t)}lc(t){const e=this.ec.indexOf(t);this.ec.splice(e,1)}}function Vnt(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}class Wnt extends Mnt{constructor(t,e,n,r){super(t,e,n,r),this.type="firestore",this._queue=new Unt,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Unt(t),this._firestoreClient=void 0,await t}}}function Gnt(t){if(t._terminated)throw new S4(_4.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Hnt(t),t._firestoreClient}function Hnt(t){var e,n,r;const a=t._freezeSettings(),i=function(t,e,n,r){return new v6(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Cnt(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||(null===(n=a.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=a.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new xnt(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(t){const e=null==t?void 0:t._online.build();return{_offline:null==t?void 0:t._offline.build(e),_online:e}}(t._componentsProvider))}class qnt{constructor(t){this._byteString=t}static fromBase64String(t){try{return new qnt(o6.fromBase64String(t))}catch(t){throw new S4(_4.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new qnt(o6.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:qnt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(e5(t,qnt._jsonSchema))return qnt.fromBase64String(t.bytes)}}qnt._jsonSchemaVersion="firestore/bytes/1.0",qnt._jsonSchema={type:t5("string",qnt._jsonSchemaVersion),bytes:t5("string")};class Knt{constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(let r=0;r<e.length;++r)if(0===e[r].length)throw new S4(_4.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new q4(e)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Xnt{constructor(t){this._methodName=t}}class Ynt{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new S4(_4.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new S4(_4.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return L4(this._lat,t._lat)||L4(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ynt._jsonSchemaVersion}}static fromJSON(t){if(e5(t,Ynt._jsonSchema))return new Ynt(t.latitude,t.longitude)}}Ynt._jsonSchemaVersion="firestore/geoPoint/1.0",Ynt._jsonSchema={type:t5("string",Ynt._jsonSchemaVersion),latitude:t5("number"),longitude:t5("number")};class Qnt{constructor(t){this._values=(t||[]).map(t=>t)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(this._values,t._values)}toJSON(){return{type:Qnt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(e5(t,Qnt._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(t=>"number"==typeof t))return new Qnt(t.vectorValues);throw new S4(_4.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Qnt._jsonSchemaVersion="firestore/vectorValue/1.0",Qnt._jsonSchema={type:t5("string",Qnt._jsonSchemaVersion),vectorValues:t5("object")};const Jnt=/^__.*__$/;class $nt{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new k8(t,this.data,this.fieldMask,e,this.fieldTransforms):new x8(t,this.data,e,this.fieldTransforms)}}function Znt(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw b4(40011,{Ec:t})}}class trt{constructor(t,e,n,r,a,i){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===a&&this.Ac(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(t){return new trt(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Rc({path:n,mc:!1});return r.fc(t),r}gc(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Rc({path:n,mc:!1});return r.Ac(),r}yc(t){return this.Rc({path:void 0,mc:!0})}wc(t){return drt(t,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}Ac(){if(this.path)for(let t=0;t<this.path.length;t++)this.fc(this.path.get(t))}fc(t){if(0===t.length)throw this.wc("Document fields must not be empty");if(Znt(this.Ec)&&Jnt.test(t))throw this.wc('Document fields cannot begin and end with "__"')}}class ert{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ptt(t)}Dc(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new trt({Ec:t,methodName:e,bc:n,path:q4.emptyPath(),mc:!1,Sc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nrt(t){const e=t._freezeSettings(),n=Ptt(t._databaseId);return new ert(t._databaseId,!!e.ignoreUndefinedProperties,n)}function rrt(t,e,n,r,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=t.Dc(i.merge||i.mergeFields?2:0,e,n,a);crt("Data must be an object, but it was:",o,r);const s=ort(r,o);let c,l;if(i.merge)c=new a6(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const t=[];for(const r of i.mergeFields){const a=lrt(e,r,n);if(!o.contains(a))throw new S4(_4.INVALID_ARGUMENT,"Field '".concat(a,"' is specified in your field mask but missing from your input data."));frt(t,a)||t.push(a)}c=new a6(t),l=o.fieldTransforms.filter(t=>c.covers(t.field))}else c=null,l=o.fieldTransforms;return new $nt(new G6(s),c,l)}function art(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return irt(n,t.Dc(r?4:3,e))}function irt(t,e){if(srt(t=W$(t)))return crt("Unsupported field value:",e,t),ort(t,e);if(t instanceof Xnt)return function(t,e){if(!Znt(e.Ec))throw e.wc("".concat(t._methodName,"() can only be used with update() and set()"));if(!e.path)throw e.wc("".concat(t._methodName,"() is not currently supported inside arrays"));const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&4!==e.Ec)throw e.wc("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const a of t){let t=irt(a,e.yc(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=W$(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Z9(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=a5.fromDate(t);return{timestampValue:n7(e.serializer,n)}}if(t instanceof a5){const n=new a5(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:n7(e.serializer,n)}}if(t instanceof Ynt)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof qnt)return{bytesValue:r7(e.serializer,t._byteString)};if(t instanceof Lnt){const n=e.databaseId,r=t.firestore._databaseId;if(!r.isEqual(n))throw e.wc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:o7(t.firestore._databaseId||e.databaseId,t._key.path)}}if(t instanceof Qnt)return function(t,e){return{mapValue:{fields:{[x6]:{stringValue:S6},[T6]:{arrayValue:{values:t.toArray().map(t=>{if("number"!=typeof t)throw e.wc("VectorValues must only contain numeric values.");return J9(e.serializer,t)})}}}}}}(t,e);throw e.wc("Unsupported field value: ".concat($4(t)))}(t,e)}function ort(t,e){const n={};return $5(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):J5(t,(t,r)=>{const a=irt(r,e.Vc(t));null!=a&&(n[t]=a)}),{mapValue:{fields:n}}}function srt(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof a5||t instanceof Ynt||t instanceof qnt||t instanceof Lnt||t instanceof Xnt||t instanceof Qnt)}function crt(t,e,n){if(!srt(n)||!J4(n)){const r=$4(n);throw"an object"===r?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function lrt(t,e,n){if((e=W$(e))instanceof Knt)return e._internalPath;if("string"==typeof e)return hrt(t,e);throw drt("Field path arguments must be of type string or ",t,!1,void 0,n)}const urt=new RegExp("[~\\*/\\[\\]]");function hrt(t,e,n){if(e.search(urt)>=0)throw drt("Invalid field path (".concat(e,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,n);try{return new Knt(...e.split("."))._internalPath}catch(r){throw drt("Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,n)}}function drt(t,e,n,r,a){const i=r&&!r.isEmpty(),o=void 0!==a;let s="Function ".concat(e,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=" in field ".concat(r)),o&&(c+=" in document ".concat(a)),c+=")"),new S4(_4.INVALID_ARGUMENT,s+t+c)}function frt(t,e){return t.some(t=>t.isEqual(e))}class prt{constructor(t,e,n,r,a){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Lnt(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new mrt(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(grt("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class mrt extends prt{data(){return super.data()}}function grt(t,e){return"string"==typeof e?hrt(t,e):e instanceof Knt?e._internalPath:e._delegate._internalPath}function yrt(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new S4(_4.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vrt{}class brt extends vrt{}class wrt extends brt{constructor(t,e,n){super(),this._field=t,this._op=e,this._value=n,this.type="where"}static _create(t,e,n){return new wrt(t,e,n)}_apply(t){const e=this._parse(t);return Srt(t._query,e),new Pnt(t.firestore,t.converter,N9(t._query,e))}_parse(t){const e=nrt(t.firestore),n=function(t,e,n,r,a,i,o){let s;if(a.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new S4(_4.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(i,"' queries on documentId()."));if("in"===i||"not-in"===i){_rt(o,i);const e=[];for(const n of o)e.push(krt(r,t,n));s={arrayValue:{values:e}}}else s=krt(r,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||_rt(o,i),s=art(n,e,o,"in"===i||"not-in"===i);return Z6.create(a,i,s)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value);return n}}class xrt extends vrt{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new xrt(t,e)}_parse(t){const e=this._queryConstraints.map(e=>e._parse(t)).filter(t=>t.getFilters().length>0);return 1===e.length?e[0]:t9.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return 0===e.getFilters().length?t:(function(t,e){let n=t;const r=e.getFlattenedFilters();for(const a of r)Srt(n,a),n=N9(n,a)}(t._query,e),new Pnt(t.firestore,t.converter,N9(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function krt(t,e,n){if("string"==typeof(n=W$(n))){if(""===n)throw new S4(_4.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!S9(e)&&-1!==n.indexOf("/"))throw new S4(_4.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=e.path.child(G4.fromString(n));if(!K4.isDocumentKey(r))throw new S4(_4.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return F6(t,new K4(r))}if(n instanceof Lnt)return F6(t,n._key);throw new S4(_4.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat($4(n),"."))}function _rt(t,e){if(!Array.isArray(t)||0===t.length)throw new S4(_4.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(e.toString(),"' filters."))}function Srt(t,e){const n=function(t,e){for(const n of t)for(const t of n.getFlattenedFilters())if(e.indexOf(t.op)>=0)return t.op;return null}(t.filters,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==n)throw n===e.op?new S4(_4.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(e.op.toString(),"' filter.")):new S4(_4.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(e.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class Trt{convertValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(I6(t)){case 0:return null;case 1:return t.booleanValue;case 2:return l6(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(u6(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw b4(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return J5(t,(t,r)=>{n[t]=this.convertValue(r,e)}),n}convertVectorValue(t){var e,n,r;const a=null===(r=null===(n=null===(e=t.fields)||void 0===e?void 0:e[T6].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(t=>l6(t.doubleValue));return new Qnt(a)}convertGeoPoint(t){return new Ynt(l6(t.latitude),l6(t.longitude))}convertArray(t,e){return(t.values||[]).map(t=>this.convertValue(t,e))}convertServerTimestamp(t,e){switch(e){case"previous":const n=g6(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(y6(t));default:return null}}convertTimestamp(t){const e=c6(t);return new a5(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=G4.fromString(t);x4(N7(n),9688,{name:t});const r=new w6(n.get(1),n.get(3)),a=new K4(n.popFirst(5));return r.isEqual(e)||g4("Document ".concat(a," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(e.projectId,"/").concat(e.database,") instead.")),a}}function Irt(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Ert{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Nrt extends prt{constructor(t,e,n,r,a,i){super(t,e,n,r,i),this._firestore=t,this._firestoreImpl=t,this.metadata=a}exists(){return super.exists()}data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const e=new Crt(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(grt("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new S4(_4.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=Nrt._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),t&&t.isValidDocument()&&t.isFoundDocument()?(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e):e}}Nrt._jsonSchemaVersion="firestore/documentSnapshot/1.0",Nrt._jsonSchema={type:t5("string",Nrt._jsonSchemaVersion),bundleSource:t5("string","DocumentSnapshot"),bundleName:t5("string"),bundle:t5("string")};class Crt extends Nrt{data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(t)}}class Art{constructor(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Ert(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(n=>{t.call(e,new Crt(this._firestore,this._userDataWriter,n.key,n,new Ert(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const t=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new S4(_4.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map(n=>{const r=new Crt(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Ert(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:e++}})}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(t=>e||3!==t.type).map(e=>{const r=new Crt(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Ert(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let a=-1,i=-1;return 0!==e.type&&(a=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),i=n.indexOf(e.doc.key)),{type:Rrt(e.type),doc:r,oldIndex:a,newIndex:i}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new S4(_4.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Art._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=P4.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],r=[];return this.docs.forEach(t=>{null!==t._document&&(e.push(t._document),n.push(this._userDataWriter.convertObjectMap(t._document.data.value.mapValue.fields,"previous")),r.push(t.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function Rrt(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return b4(61501,{type:t})}}Art._jsonSchemaVersion="firestore/querySnapshot/1.0",Art._jsonSchema={type:t5("string",Art._jsonSchemaVersion),bundleSource:t5("string","QuerySnapshot"),bundleName:t5("string"),bundle:t5("string")};class Ort extends Trt{constructor(t){super(),this.firestore=t}convertBytes(t){return new qnt(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new Lnt(this.firestore,null,e)}}function Drt(t,e){return function(t,e){const n=new T4;return t.asyncQueue.enqueueAndForget(async()=>async function(t,e,n){const r=mnt(t);try{const t=await function(t,e){const n=k4(t),r=a5.now(),a=e.reduce((t,e)=>t.add(e.key),X9());let i,o;return n.persistence.runTransaction("Locally write mutations","readwrite",t=>{let s=B9(),c=X9();return n.Os.getEntries(t,a).next(t=>{s=t,s.forEach((t,e)=>{e.isValidDocument()||(c=c.add(t))})}).next(()=>n.localDocuments.getOverlayedDocuments(t,s)).next(a=>{i=a;const o=[];for(const t of e){const e=b8(t,i.get(t.key).overlayedDocument);null!=e&&o.push(new k8(t.key,e,H6(e.value.mapValue),f8.exists(!0)))}return n.mutationQueue.addMutationBatch(t,r,o,e)}).next(e=>{o=e;const r=e.applyToLocalDocumentSet(i,c);return n.documentOverlayCache.saveOverlays(t,e.batchId,r)})}).then(()=>({batchId:o.batchId,changes:V9(i)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let r=t.Ru[t.currentUser.toKey()];r||(r=new Z5(L4)),r=r.insert(e,n),t.Ru[t.currentUser.toKey()]=r}(r,t.batchId,n),await hnt(r,t.changes),await uet(r.remoteStore)}catch(t){const e=Tet(t,"Failed to persist write");n.reject(e)}}(await Int(t),e,n)),n.promise}(Gnt(t),e)}new WeakMap;!function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(t){d4=t}(i0),t0(new G$("firestore",(t,n)=>{let{instanceIdentifier:r,options:a}=n;const i=t.getProvider("app").getImmediate(),o=new Wnt(new C4(t.getProvider("auth-internal")),new D4(i,t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new S4(_4.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new w6(t.options.projectId,e)}(i,r),i);return a=Object.assign({useFetchStreams:e},a),o._setSettings(a),o},"PUBLIC").setMultipleInstances(!0)),c0(l4,u4,t),c0(l4,u4,"esm2017")}();const Mrt=o0({apiKey:"AIzaSyASrgqRnCVfgelj8XSt0Mera2QpTm6VXGU",authDomain:"student-ai-interview.firebaseapp.com",projectId:"student-ai-interview",storageBucket:"student-ai-interview.firebasestorage.app",messagingSenderId:"564546030199",appId:"1:564546030199:web:661ea12f560ff1ec405472"}),Frt=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s0();const e=e0(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=e0(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(P$(n.getOptions(),null!==e&&void 0!==e?e:{}))return t;T0(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:V3,persistence:[J2,R2,P2]}),r=k$("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const t=new URL(r,location.origin);if(location.origin===t.origin){const e=(a=t.toString(),async t=>{const e=t&&await t.getIdTokenResult(),n=e&&((new Date).getTime()-Date.parse(e.issuedAtTime))/1e3;if(n&&n>q3)return;const r=null===e||void 0===e?void 0:e.token;K3!==r&&(K3=r,await fetch(a,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(t,e,n){W$(t).beforeAuthStateChanged(e,n)}(n,e,()=>e(n.currentUser)),function(t,e,n,r){W$(t).onIdTokenChanged(e,n,r)}(n,t=>e(t))}}var a;const i=w$("auth");return i&&K1(n,"http://".concat(i)),n}(Mrt),Prt=new h2,Lrt=new d2,zrt=function(t,e){const n="object"==typeof t?t:s0(),r="string"==typeof t?t:e||b6,a=e0(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const t=(t=>{const e=w$(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error("Invalid host ".concat(e," with no separate hostname and port!"));const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]})("firestore");t&&Fnt(a,...t)}return a}(Mrt),Brt=()=>{const t=Et();return(0,ra.jsxs)("button",{onClick:async()=>{try{(await u3(Frt,Prt)).user?(alert(" Login Success"),t("/home")):alert("Login failed")}catch(Hrt){console.error("Google Login Failed:",Hrt.message)}},className:"btn btn-outline-primary d-flex align-items-center gap-2",children:[(0,ra.jsx)(e$,{size:20}),"Login with Google"]})},jrt=()=>(0,ra.jsxs)("button",{onClick:async()=>{try{const t=await u3(Frt,Lrt);console.log("Logged in user:",t.user)}catch(t){console.error("GitHub login failed:",t.message)}},className:"btn btn-outline-dark d-flex align-items-center gap-2",children:[(0,ra.jsx)(s$,{size:20}),"Login with GitHub"]}),Urt=()=>{const t=Et(),[e,n]=(0,C.useState)(!0),[r,a]=(0,C.useState)({email:"",password:""}),[i,o]=(0,C.useState)({email:"",password:""}),[s,c]=(0,C.useState)(""),[l,u]=(0,C.useState)(!1);(0,C.useEffect)(()=>{s&&(alert(s),c(""))},[s]);return(0,ra.jsxs)("div",{className:"form-structor",children:[(0,ra.jsxs)("div",{className:"signup ".concat(e?"slide-up":""),children:[(0,ra.jsxs)("h2",{className:"form-title",onClick:()=>!l&&n(!1),children:[(0,ra.jsx)("span",{children:"or"}),"Sign up"]}),(0,ra.jsxs)("div",{className:"form-holder",children:[(0,ra.jsx)("div",{className:"d-flex justify-content-center align-items-center mt-2",children:(0,ra.jsxs)("div",{children:[(0,ra.jsx)(Brt,{}),(0,ra.jsx)(jrt,{})]})}),(0,ra.jsxs)("div",{className:"d-flex align-items-center my-3",children:[(0,ra.jsx)("div",{className:"flex-grow-1 border-top"}),(0,ra.jsx)("span",{className:"mx-3 text-muted",children:"Or"}),(0,ra.jsx)("div",{className:"flex-grow-1 border-top"})]}),(0,ra.jsx)("input",{type:"email",className:"input",placeholder:"Email",value:r.email,onChange:t=>a(oe(oe({},r),{},{email:t.target.value})),disabled:l}),(0,ra.jsx)("input",{type:"password",className:"input",placeholder:"Password",value:r.password,onChange:t=>a(oe(oe({},r),{},{password:t.target.value})),disabled:l})]}),(0,ra.jsx)("button",{className:"submit-btn",onClick:async()=>{if(r.email&&r.password)try{if(await(async t=>{try{return(await T2(Frt,t)).length>0}catch(e){return console.error("Error checking email:",e),!1}})(r.email))return c("Email already registered. Please login instead."),void n(!0);const t=await async function(t,e,n){if(n0(t.app))return Promise.reject(N0(t));const r=F1(t),a=H1(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",p2,"EMAIL_PASSWORD_PROVIDER"),i=await a.catch(e=>{throw e.code==="auth/".concat("password-does-not-meet-requirements")&&S2(t),e}),o=await m2._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(o.user),o}(Frt,r.email,r.password),e=t.user;await I2(e),u(!0),c("Verification email sent. Please check your inbox.");const a=setInterval(async()=>{await e.reload(),e.emailVerified&&(clearInterval(a),u(!1),await function(t,e,n){t=Z4(t,Lnt);const r=Z4(t.firestore,Wnt),a=Irt(t.converter,e,n);return Drt(r,[rrt(nrt(r),"setDoc",t._key,a,null!==t.converter,n).toMutation(t._key,f8.none())])}(Bnt(zrt,"users",e.uid),{email:e.email,createdAt:new Date,emailVerified:!0}),c("Email verified! Account created successfully. Please login."),await function(t){return W$(t).signOut()}(Frt),n(!0))},5e3);return()=>{clearInterval(a),e.emailVerified||setTimeout(async()=>{await e.delete()},36e5)}}catch(t){u(!1),"auth/email-already-in-use"===t.code?c("Email already registered. Please login instead."):c("Signup error: ".concat(t.message))}else c("Email and password are required.")},disabled:l,children:l?"Verifying...":"Sign up"})]}),(0,ra.jsx)("div",{className:"login ".concat(e?"":"slide-up"),children:(0,ra.jsxs)("div",{className:"center",children:[(0,ra.jsxs)("h2",{className:"form-title",onClick:()=>n(!0),children:[(0,ra.jsx)("span",{children:"or"}),"Log in"]}),(0,ra.jsxs)("div",{className:"form-holder",children:[(0,ra.jsx)("input",{type:"email",className:"input",placeholder:"Email",value:i.email,onChange:t=>o(oe(oe({},i),{},{email:t.target.value}))}),(0,ra.jsx)("input",{type:"password",className:"input",placeholder:"Password",value:i.password,onChange:t=>o(oe(oe({},i),{},{password:t.target.value}))})]}),(0,ra.jsx)("button",{className:"submit-btn",onClick:async()=>{if(i.email&&i.password)try{const e=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(t=W$(t),X4("collection","path",e),t instanceof Mnt){const n=G4.fromString(e,...r);return Q4(n),new znt(t,null,n)}{if(!(t instanceof Lnt||t instanceof znt))throw new S4(_4.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(G4.fromString(e,...r));return Q4(n),new znt(t.firestore,null,n)}}(zrt,"users"),r=function(t,e){let n=[];for(var r=arguments.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];e instanceof vrt&&n.push(e),n=n.concat(a),function(t){const e=t.filter(t=>t instanceof xrt).length,n=t.filter(t=>t instanceof wrt).length;if(e>1||e>0&&n>0)throw new S4(_4.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)t=o._apply(t);return t}(e,function(t,e,n){const r=e,a=grt("where",t);return wrt._create(a,r,n)}("email","==",i.email)),a=await function(t){t=Z4(t,Pnt);const e=Z4(t.firestore,Wnt),n=Gnt(e),r=new Ort(e);return yrt(t._query),Nnt(n,t._query).then(n=>new Art(e,r,t,n))}(r);if(a.empty)return c("Account not found. Please sign up first."),void n(!1);await function(t,e,n){return n0(t.app)?Promise.reject(N0(t)):k2(W$(t),s2.credential(e,n)).catch(async e=>{throw e.code==="auth/".concat("password-does-not-meet-requirements")&&S2(t),e})}(Frt,i.email,i.password);t("/home")}catch(e){"auth/user-not-found"===e.code?(c("Account not found. Please sign up first."),n(!1)):"auth/wrong-password"===e.code?c("Incorrect password."):c("Login error: ".concat(e.message))}else c("Email and password are required.")},children:"Log in"})]})})]})};const Vrt=function(){return(0,ra.jsx)(Qt,{children:(0,ra.jsxs)(Gt,{children:[(0,ra.jsx)(Vt,{path:"/",element:(0,ra.jsx)(Urt,{})}),(0,ra.jsx)(Vt,{path:"/home",element:(0,ra.jsx)(DX,{})}),(0,ra.jsx)(Vt,{path:"/checking",element:(0,ra.jsx)(MX,{})}),(0,ra.jsx)(Vt,{path:"/Beginner",element:(0,ra.jsx)(FX,{})}),(0,ra.jsx)(Vt,{path:"/Intermediate",element:(0,ra.jsx)(PX,{})}),(0,ra.jsx)(Vt,{path:"/Expert",element:(0,ra.jsx)(VJ,{})}),(0,ra.jsx)(Vt,{path:"/engineering",element:(0,ra.jsx)(CX,{})}),(0,ra.jsx)(Vt,{path:"/english",element:(0,ra.jsx)(RX,{})}),(0,ra.jsx)(Vt,{path:"/upsc",element:(0,ra.jsx)(OX,{})}),(0,ra.jsx)(Vt,{path:"/About",element:(0,ra.jsx)(d$,{})})]})})},Wrt=t=>{t&&t instanceof Function&&n.e(453).then(n.bind(n,6453)).then(e=>{let{getCLS:n,getFID:r,getFCP:a,getLCP:i,getTTFB:o}=e;n(t),r(t),a(t),i(t),o(t)})};R.createRoot(document.getElementById("root")).render((0,ra.jsx)(C.StrictMode,{children:(0,ra.jsx)(Vrt,{})})),Wrt()})()})();
//# sourceMappingURL=main.d031ba82.js.map